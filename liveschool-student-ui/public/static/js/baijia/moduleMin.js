window["BJY-SDK"]=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=1349)}([function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t){var n=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";var i={int:parseInt,float:parseFloat};return function(e,t,n){if("number"!==$.type(e)){var r=i[n];e=r?r(e,10):$.isNumeric(e)?+e:NaN}return isNaN(e)?t:e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){t.window=$(window),t.document=$(document),t.html=$(document.documentElement),t.body=$(document.body)}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=new Yox({}),r=n(232);return t.trigger=function(e,n){return i.fire(e,n||{}),t},t.on=function(e,n){return e?i.on(e,n):r.warn("eventEmitter.on(name) name is undefined"),t},t.one=function(e,n){return e?i.once(e,n):r.warn("eventEmitter.one(name) name is undefined"),t},t.off=function(e,n){return e||r.danger("自爆启动，请等待..."),i.off(e,n),t},t.has=function(e){return i.$emitter.has(e)},t.emit=function(e,t){var n=new Yox.Event(e);return t?i.fire(n,t):i.fire(n),n},t.BIND_BASE_EVENT_START="bind_base_event_start",t.CLASSROOM_CONNECT_TRIGGER="classroom_connect_trigger",t.CLASSROOM_CONNECT_TIMEOUT="classroom_connect_timeout",t.CLASSROOM_CONNECT_SUCCESS="classroom_connect_success",t.CLASSROOM_CONNECT_FAIL="classroom_connect_fail",t.CLASSROOM_CONNECT_START="classroom_connect_start",t.CLASSROOM_CONNECT_END="classroom_connect_end",t.CLASSROOM_CONNECT_DEBUG="classroom_connect_debug",t.CLASSROOM_EXIT_TRIGGER="classroom_exit_trigger",t.CLASSROOM_EXIT_START="classroom_exit_start",t.CLASSROOM_EXIT_END="classroom_exit_end",t.UNSUPPORTED_END_TYPE="unsupported_end_type",t.INTERFACE_FETCH_SUCCESS="interface_fetch_success",t.INTERFACE_FETCH_FAIL="interface_fetch_fail",t.ROOM_SERVER_OFFLINE="room_server_offline",t.CHAT_SERVER_OFFLINE="chat_server_offline",t.LINK_TYPE_INIT="link_type_init",t.WEBSOCKET_SEND="websocket_send",t.WEBSOCKET_RECEIVE="websocket_receive",t.WEBSOCKET_CLOSE="websocket_close",t.MASTER_SERVER_CONNECT_SUCCESS="master_server_connect_success",t.MASTER_SERVER_CONNECT_FAIL="master_server_connect_fail",t.MASTER_SERVER_CONNECT_TIMEOUT="master_server_connect_timeout",t.CHAT_SERVER_CONNECT_TRIGGER="chat_server_connect_trigger",t.CHAT_SERVER_CONNECT_SUCCESS="chat_server_connect_success",t.CHAT_SERVER_CONNECT_FAIL="chat_server_connect_fail",t.CHAT_SERVER_LOGIN_SUCCESS="chat_server_login_success",t.CHAT_SERVER_LOGIN_FAIL="chat_server_login_fail",t.ROOM_SERVER_CONNECT_SUCCESS="room_server_connect_success",t.ROOM_SERVER_CONNECT_FAIL="room_server_connect_fail",t.ROOM_SERVER_CONNECT_TIMEOUT="room_server_connect_timeout",t.ROOM_SERVER_LOGIN_SUCCESS="room_server_login_success",t.ROOM_SERVER_LOGIN_FAIL="room_server_login_fail",t.ROOM_SERVER_LOGIN_OVERFLOW="room_server_login_overflow",t.ROOM_SERVER_LOGIN_KICKED_OUT="room_server_login_kicked_out",t.ROOM_SERVER_LOGIN_AUDITION_END="room_server_login_audition_end",t.ROOM_SERVER_LOGIN_CONFLICT="room_server_login_conflict",t.LOGIN_CONFLICT="login_conflict",t.SERVER_INFO_FETCH_SUCCESS="server_info_fetch_success",t.SERVER_INFO_FETCH_FAIL="server_info_fetch_fail",t.CLASS_START="class_start",t.CLASS_END="class_end",t.CLASS_START_TRIGGER="class_start_trigger",t.CLASS_END_TRIGGER="class_end_trigger",t.USER_SEARCH_REQ="user_search_req",t.USER_SEARCH_RES="user_search_res",t.USER_ACTIVE_REQ="user_active_req",t.USER_ACTIVE_RES="user_active_res",t.USER_ACTIVE_ADD_TRIGGER="user_active_add_trigger",t.USER_ACTIVE_ADD="user_active_add",t.USER_ACTIVE_ADD_DENY="user_active_add_deny",t.USER_ACTIVE_REMOVE_TRIGGER="user_active_remove_trigger",t.USER_ACTIVE_REMOVE="user_active_remove",t.USER_ADD="user_add",t.USER_REMOVE="user_remove",t.USER_UPDATE="user_update",t.TEACHER_ADD="teacher_add",t.TEACHER_REMOVE="teacher_remove",t.TEACHER_UPDATE="teacher_update",t.ASSISTANT_ADD="assistant_add",t.ASSISTANT_REMOVE="assistant_remove",t.ASSISTANT_UPDATE="assistant_update",t.STUDENT_ADD="student_add",t.STUDENT_REMOVE="student_remove",t.STUDENT_UPDATE="student_update",t.GUEST_ADD="guest_add",t.GUEST_REMOVE="guest_remove",t.GUEST_UPDATE="guest_update",t.USER_IN="user_in",t.USER_OUT="user_out",t.USER_MORE_REQ="user_more_req",t.USER_MORE_RES="user_more_res",t.MEDIA_PUBLISH_RES="media_publish_res",t.MEDIA_SUBSCRIBE_RES="media_subscribe_res",t.BLOCKED_USER_LIST_REQ="blocked_user_list_req",t.BLOCKED_USER_LIST_RES="blocked_user_list_res",t.USER_BLOCKED="user_blocked",t.BLOCKED_USER_ADD="blocked_user_add",t.ALL_BLOCKED_USERS_REMOVE="all_blocked_users_remove",t.BLOCKED_USER_REMOVE="blocked_user_remove",t.BLOCKED_LIST_TOGGLE="blocked_list_toggle",t.BLOCKED_LIST_SHOW_All="blocked_list_show_all",t.FORBID_USER_ADD="forbid_user_add",t.FORBID_USER_REMOVE="forbid_user_remove",t.H5_DOC_ALL_REQ="h5_doc_all_req",t.H5_DOC_ALL_RES="h5_doc_all_res",t.H5_DOC_ADD_TRIGGER="h5_doc_add_trigger",t.H5_DOC_ADD="h5_doc_add",t.H5_DOC_REMOVE_TRIGGER="h5_doc_remove_trigger",t.H5_DOC_REMOVE="h5_doc_remove",t.H5_DOC_UPDATE_TRIGGER="h5_doc_update_trigger",t.H5_DOC_UPDATE="h5_doc_update",t.DOC_ALL_REQ="doc_all_req",t.DOC_ALL_RES="doc_all_res",t.DOC_ATTACH_REQ="doc_attach_req",t.DOC_ATTACH_RES="doc_attach_res",t.DOC_DETACH_REQ="doc_detach_req",t.DOC_DETACH_RES="doc_detach_res",t.DOC_LIBRARY_LIST_REQ="doc_library_list_req",t.DOC_LIBRARY_LIST_RES="doc_library_list_res",t.DOC_ADD_TRIGGER="doc_add_trigger",t.DOC_ADD="doc_add",t.DOC_UPDATE_TRIGGER="doc_update_trigger",t.DOC_UPDATE="doc_update",t.DOC_REMOVE_TRIGGER="doc_remove_trigger",t.DOC_REMOVE="doc_remove",t.PAGE_AUTH_CHANGE="page_auth_change",t.PAINT_AUTH_CHANGE="paint_auth_change",t.SCREEN_SHARE_AUTH_CHANGE="screen_share_auth_change",t.ASSIST_CAMERA_AUTH_CHANGE="assist_camera_auth_change",t.SHAPE_ALL_REQ="shape_all_req",t.SHAPE_ALL_RES="shape_all_res",t.SHAPE_APPEND_TRIGGER="shape_append_trigger",t.SHAPE_APPEND="shape_append",t.SHAPE_ADD_TRIGGER="shape_add_trigger",t.SHAPE_ADD="shape_add",t.SHAPE_REMOVE_TRIGGER="shape_remove_trigger",t.SHAPE_REMOVE="shape_remove",t.SHAPE_UPDATE_TRIGGER="shape_update_trigger",t.SHAPE_UPDATE="shape_update",t.SHAPE_LASER_TRIGGER="shape_laser_trigger",t.SHAPE_LASER="shape_laser",t.SHAPE_TEXT_INPUT="shape_text_input",t.MESSAGE_SEND="message_send",t.MESSAGE_RECEIVE="message_receive",t.MESSAGE_REVOKE_REQ="message_revoke_req",t.MESSAGE_REVOKE_RES="message_revoke_res",t.MESSAGE_REVOKE="message_revoke",t.WHISPER_TO="whisper_to",t.MESSAGE_PULL_REQ="message_pull_req",t.MESSAGE_PULL_RES="message_pull_res",t.WINDOW_RESIZE="window_resize",t.PAGE_CHANGE_TRIGGER="page_change_trigger",t.PAGE_CHANGE_START="page_change_start",t.PAGE_CHANGE_END="page_change_end",t.SERVER_PAGE_CHANGE="server_page_change",t.CLIENT_PAGE_CHANGE="client_page_change",t.MAX_PAGE_CHANGE="max_page_change",t.SPEAK_APPLY_REQ_TRIGGER="speak_apply_trigger",t.SPEAK_APPLY_RES_TRIGGER="speak_apply_res_trigger",t.SPEAK_APPLY_REQ="speak_apply_req",t.SPEAK_APPLY_RES="speak_apply_res",t.MEDIA_SWITCH_TRIGGER="media_switch_trigger",t.ASSIST_MEDIA_SWITCH_TRIGGER="assist_media_switch_trigger",t.MEDIA_REPUBLISH_TRIGGER="media_republish_trigger",t.ASSIST_MEDIA_REPUBLISH_TRIGGER="media_republish_ext_trigger",t.MEDIA_REPUBLISH="media_republish",t.ASSIST_MEDIA_REPUBLISH="media_republish_ext",t.MEDIA_PUBLISH_TRIGGER="media_publish_trigger",t.ASSIST_MEDIA_PUBLISH_TRIGGER="media_publish_ext_trigger",t.MEDIA_PUBLISH="media_publish",t.ASSIST_MEDIA_PUBLISH="media_publish_ext",t.WEBRTC_MIX_MEDIA_PUBLISH="webrtc_mix_media_publish",t.MEDIA_REMOTE_CONTROL_TRIGGER="media_remote_control_trigger",t.MEDIA_CONTROL_TRIGGER="media_remote_control",t.COMMAND_SEND="command_send",t.COMMAND_RECEIVE="command_receive",t.BROADCAST_SEND="broadcast_send",t.BROADCAST_RECEIVE="broadcast_receive",t.BROADCAST_CACHE_RES="broadcast_cache_res",t.CUSTOMCAST_RECEIVE="customcast_receive",t.CUSTOMCAST_CACHE_RES="customcast_cache_res",t.TRACE_LOG="trace_log",t.NOTICE_REQ="notice_req",t.NOTICE_RES="notice_res",t.NOTICE_CHANGE_TRIGGER="notice_change_trigger",t.NOTICE_CHANGE="notice_change",t.STICKY_NOTICE_REQ="sticky_notice_req",t.STICKY_NOTICE_RES="sticky_notice_res",t.STICKY_NOTICE_CHANGE_TRIGGER="sticky_notice_change_trigger",t.STICKY_NOTICE_CHANGE="sticky_notice_change",t.MY_GIFT_REQ="my_gift_req",t.MY_GIFT_RES="my_gift_res",t.GIFT_SEND="gift_send",t.GIFT_RECEIVE="gift_receive",t.MESSAGE_SEND_FORBID_TRIGGER="message_send_forbid_trigger",t.MESSAGE_SEND_FORBID="message_send_forbid",t.MESSAGE_SEND_FORBID_ALL_TRIGGER="message_send_forbid_all_trigger",t.MESSAGE_SEND_FORBID_ALL="message_send_forbid_all",t.MESSAGE_SEND_FORBID_ALL_RES="message_send_forbid_all_res",t.MESSAGE_SEND_FORBID_ALL_CHANGE_TRIGGER="message_send_forbid_all_change_trigger",t.MESSAGE_SEND_FORBID_ALL_CHANGE="message_send_forbid_all_change",t.VIRTUAL_USER_NUMBER_SET_TRIGGER="virtual_user_number_set_trigger",t.GET_VIRTUAL_USER_NUMBER_REQ="get_virtual_user_number_req",t.GET_VIRTUAL_USER_NUMBER_RES="get_virtual_user_number_res",t.SPEAK_APPLY_FORBID_ALL_CHANGE_TRIGGER="speak_apply_forbid_all_change_trigger",t.SPEAK_APPLY_FORBID_ALL_CHANGE="speak_apply_forbid_all_change",t.ENABLE_USER_IN_TIPS_CHANGE_TRIGGER="enable_user_in_tips_change_trigger",t.ENABLE_USER_IN_TIPS_CHANGE="enable_user_in_tips_change",t.REMOTER_USER_APPLY_HANDLE="user_apply_handle_by_remoter",t.REMOTER_TOGGLE_APPLYLIST="remoter_toggle_applylist",t.MIC_FORBID_ALL_CHANGE_TRIGGER="mic_forbid_all_change_trigger",t.MIC_FORBID_ALL_CHANGE="mic_forbid_all_change",t.USER_COUNT_CHANGE="user_count_change",t.TOTAL_USER_COUNT_CHANGE="total_user_count_change",t.STUDENT_LIST_REQ="student_list_req",t.STUDENT_LIST_RES="student_list_res",t.CLOUD_RECORD_END_TRIGGER="cloud_record_end_trigger",t.START_PROCESSING_CLOUD_RECORD="start_processing_cloud_record",t.CLOUD_RECORD_END_SEND="cloud_record_end_send",t.BLOCK_TASK_CREATE="block_task_create",t.USER_STATE_REQ="user_state_req",t.USER_STATE_RES="user_state_res",t.GROUP_SIZE_REQ="group_size_req",t.GROUP_SIZE_RES="group_size_res",t.CALL_CUSTOM_SERVICE_TRIGGER="call_custom_service_trigger",t.LOTTERY_COMPLETE_REQ="lottery_complete_req",t.LOTTERY_COMPLETE_RES="lottery_complete_res",t.LOTTERY_SEND="lottery_send",t.LOTTERY_RECEIVE="lottery_receive",t.LOTTERY_DRAW_REQ="lottery_draw_req",t.LOTTERY_DRAW_RES="lottery_draw_res",t.LOTTERY_RESULT_REQ="lottery_result_req",t.LOTTERY_RESULT_RES="lottery_result_res",t.VIEW_RENDER_TRIGGER="view_render_trigger",t.CLOUD_RECORD_START_TRIGGER="cloud_record_start_trigger",t.CLOUD_RECORD_PAUSE_TRIGGER="cloud_record_pause_trigger",t.CLOUD_RECORD_RESTART_TRIGGER="cloud_record_restart_trigger",t.CLOUD_RECORD_START_SEND="cloud_record_start_send",t.CLOUD_RECORD_START="cloud_record_start",t.CLOUD_RECORD_RESTART="cloud_record_restart",t.CLOUD_RECORD_PAUSE="cloud_record_pause",t.CLOUD_RECORD_END="cloud_record_end",t.CLOUD_RECORD_COMMAND_SEND="cloud_record_command_send",t.CLOUD_RECORD_COMMAND_ACCEPT="cloud_record_command_accept",t.ROLL_CALL_TRIGGER="roll_call_trigger",t.ROLL_CALL="roll_call",t.ROLL_CALL_RES="roll_call_res",t.ROLL_CALL_FINISH="roll_call_finish",t.ROLL_CALL_RESULT="roll_call_result",t.SPEAK_INVITE_REQ_TRIGGER="speak_invite_req_trigger",t.SPEAK_INVITE_REQ="speak_invite_req",t.SPEAK_INVITE_RES_TRIGGER="speak_invite_res_trigger",t.SPEAK_INVITE_PENDING_LIST="speak_invite_pending_list",t.SPEAK_INVITE_RES="speak_invite_res",t.PRESENTER_CHANGE_TRIGGER="presenter_change_trigger",t.PRESENTER_CHANGE="presenter_change",t.SPEAK_ENABLE="speak_enable",t.SPEAK_DISABLE="speak_disable",t.FULLSCREEN_ENTER="fullscreen_enter",t.FULLSCREEN_EXIT="fullscreen_exit",t.FULLSCREEN_EXIT_TRIGGER="fullscreen_exit_trigger",t.FULLSCREEN_ENTER_TRIGGER="fullscreen_enter_trigger",t.VIDEO_RESOLUTION_CHANGE_TRIGGER="video_resolution_change_trigger",t.MIXAUDIO_MUTE_PUBLISH_TRIGGER="mixaudio_mute_publish_trigger",t.VIDEO_RESOLUTION_CHANGE="video_resolution_change",t.UPLINK_LINK_TYPE_CHANGE="uplink_link_type_change",t.DOWNLINK_LINK_TYPE_CHANGE="downlink_link_type_change",t.REMOTER_HANDLE_SPEAK_APPLY="remoter_handle_speak_apply",t.DEVICE_SETTINGS_OPEN="device_settings_open",t.DEVICE_SETTINGS_START="device_settings_start",t.KICK_OUT_TRIGGER="kick_out_trigger",t.KICK_OUT="kick_out",t.USER_UNBLOCK_TRIGGER="user_unblock_trigger",t.USER_UNBLOCK="user_unblock",t.ALL_USERS_UNBLOCK_TRIGGER="all_user_unblock_trigger",t.ALL_USERS_UNBLOCK="all_users_unblock",t.CLASS_SWITCH_TRIGGER="class_switch_trigger",t.CLASS_SWITCH="class_switch",t.MEDIA_PUBLISH_DENY="media_publish_deny",t.MEDIA_REPUBLISH_DENY="media_republish_deny",t.MEDIA_PUBLISH_EXT_DENY="media_publish_ext_deny",t.MEDIA_REPUBLISH_EXT_DENY="media_republish_ext_deny",t.SPEAK_APPLY_ACCEPT_RESULT="speak_apply_accept_result",t.SPEAK_INVITE_DENY="speak_invite_deny",t.SPEAK_REMOTE_CONTROL_DENY="speak_remote_control_deny",t.RECORD_SHAPE_CLEAN="record_shape_clean",t.SCREEN_SHARE_START_BROADCAST="screen_share_start_broadcast",t.SCREEN_SHARE_STOP_BROADCAST="screen_share_stop_broadcast",t.PLAY_MEDIA_BROADCAST_TRIGGER="play_media_broadcast_trigger",t.PLAY_MEDIA_BROADCAST="play_media_broadcast",t.EXTRA_STREAM_TERMINATE_BROADCAST_TRIGGER="extra_stream_terminate_broadcast_trigger",t.EXTRA_STREAM_TERMINATE_BROADCAST="extra_stream_terminate_broadcast",t.SEND_HEARTBEAT="send_heartbeat",t.SWITCH_STUDENT_PAINT_TRIGGER="switch_student_paint_trigger",t.SWITCH_STUDENT_PAINT="switch_student_paint",t.SWITCH_STUDENT_AUTH_TRIGGER="switch_student_auth_trigger",t.SWITCH_STUDENT_AUTH="switch_student_auth",t.INTERACTION_SEND="interaction_send",t.INTERACTION_RECEIVE="interaction_receive",t.STUDENT_PPT_AUTH_CHANGE_TRIGGER="student_ppt_auth_change_trigger",t.STUDENT_PPT_AUTH_CHANGE="student_ppt_auth_change",t.FORBID_USER_ALL_LIST_RES="forbid_user_all_list_res",t.FORBID_LIST_TOGGLE="forbid_list_toggle",t.FORBID_LIST_SHOW_All="forbid_list_show_all",t.SURVEY_PREV_REQ="survey_prev_req",t.SURVEY_PREV_RES="survey_prev_res",t.SURVEY_QUESTION_SEND="survey_question_send",t.SURVEY_QUESTION_MODIFY="survey_question_modify",t.SURVEY_QUESTION_DELETE="survey_question_delete",t.SURVEY_QUESTION_DELETE_RECEIVE="survey_question_delete_receive",t.SURVEY_QUESTION_END="survey_question_end",t.SURVEY_QUESTION_END_RECEIVE="survey_question_end_receive",t.SURVEY_QUESTION_CLEAR="survey_question_clear",t.SURVEY_QUESTION_CLEAR_RECEIVE="survey_question_clear_receive",t.SURVEY_QUESTION_RECEIVE="survey_question_receive",t.SURVEY_ANSWER_SEND="survey_answer_send",t.START_ENROLL_TRIGGER="start_enroll_trigger",t.START_ENROLL="start_enroll",t.ENROLL_SUBMIT_ERROR="enroll_submit_error",t.ENROLL_SUBMIT_SUCCESS="enroll_submit_success",t.ENROLL_INVALID_PHONENUMBER="enroll_invalid_phonenumber",t.CLEAR_ENROLL_INFO="clear_enroll_info",t.GIVE_THUMBUP_TRIGGER="give_thumbup_trigger",t.GET_THUMBUP_NUMBER_RES="get_thumbup_number_res",t.SURVEY_ANSWER_COUNT="survey_answer_count",t.REMOTER_KEYBOARD_DOWN="keyboard_down",t.KEYBOARD_UP="keyboard_up",t.SURVEY_ANSWER_USER="survey_answer_user",t.SIDE_TOOLBAR_CLICK="side_tool_bar_click",t.WEBRTC_SERVER_CONNECT_SUCCESS="WEBRTC_SERVER_CONNECT_SUCCESS",t.WEBRTC_SERVER_CONNECT_TIMEOUT="webrtc_server_timeout",t.WEBRTC_SERVER_CONNECT_ERROR="webrtc_server_error",t.KEYBOARD_TRIGGER_SPEAKER_VOLUME_LAYER_HIDE="keyboard_trigger_speaker_volume_layer_hide",t.KEYBOARD_TRIGGER_SPEAKER_VOLUME_LAYER_SHOW="keyboard_trigger_speaker_volume_layer_show",t.KEYBOARD_TRIGGER_MIC_VOLUME_LAYER_HIDE="keyboard_trigger_mic_volume_layer_hide",t.KEYBOARD_TRIGGER_MIC_VOLUME_LAYER_SHOW="keyboard_trigger_mic_volume_layer_show",t.USER_UPDATE_TRIGGER="user_update_trigger",t.USER_UPDATE_RES="user_update_res",t.USER_LANGUAGE_CHANGE_AND_RESTART_TRIGGER="user_language_change_and_restart_trigger",t.USER_LANGUAGE_CHANGE_AND_RESTART="user_language_change_and_restart",t.OPEN_EXTENSION_GUIDE="open_extension_guide",t.WEBRTC_INFO_RES="webrtc_info_res",t.SCREEN_SHARE_WHEN_CLASS_END="screen_share_class_end",t.MUTE_ALL_MIC_TRIGGER="mute_all_mic_trigger",t.MUTE_ALL_MIC="mute_all_mic",t.MESSAGE_TRANSLATE_SEND="message_translate_send",t.MESSAGE_TRANSLATE_RECEIVE="message_translate_receive",t.MEDIA_STATUS_CHANGE="media_status_change",t.SNIPPET_PUBLISH="snippet_publish",t.SNIPPET_PARTICIPATE="snippet_participate",t.SNIPPET_SUBMIT="snippet_submit",t.SNIPPET_PULL_RES="snippet_pull_res",t.MEDIA_FILE_STREAM_CLOSED="media_file_stream_closed",t.BORROW_PAINTER_TOOL="borrow_painter_tool",t.TEST_NETWORK_TRIGGER="test_network_trigger",t.HANDUP_APPLY_TRIGGER="handup_apply_trigger",t.NETWORK_DETECTION_BEGIN="network_detection_begin",t.NETWORK_DETECTION_FINISH="network_detection_finish",t.USER_FUZZY_QUERY_REQ="user_fuzzy_query_req",t.USER_FUZZY_QUERY_RES="user_fuzzy_query_res",t.OS_NOTIFY="os_notify",t.SHAPE_PREVIEW_CHANGE="shape_preview_change",t.PAGE_ADD_TRIGGER="page_add_trigger",t.PAGE_ADD="page_add",t.PAGE_DELETE_TRIGGER="page_delete_trigger",t.PAGE_DELETE="page_delete",t.GROUP_INFO_REQ="group_info_req",t.GROUP_INFO="group_info",t.GROUP_INFO_UPDATE_TRIGGER="group_info_update_trigger",t.GROUP_INFO_UPDATE="group_info_update",t.GROUP_MEMBER_UPDATE_TRIGGER="group_member_update_trigger",t.GROUP_MEMBER_UPDATE="group_member_update",t.PARENT_ROOM_QUIZ_REQ="parent_room_quiz_req",t.PARENT_ROOM_QUIZ_RES="parent_room_quiz_res",t.LOCAL_AUDIO_MUTE="local_audio_mute",t.LOCAL_VIDEO_MUTE="local_video_mute",t.CAN_TURNING_PAGE_CHANGE="can_turning_page_change",t.REMOTER_KEYCODE_MAP_CHANGE="remoter_keycode_map_change",t.CLASSROOM_REAL_START_TIME="classroom_real_start_time",t.HEARTBEAT_RECEIVE="heartbeat_receive",t}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(2),r=n(1),a=n(29),o=n(17),s=n(16),u=function(e,t,n){var c,l,d,_=e&u.F,f=e&u.G,p=e&u.S,h=e&u.P,g=e&u.B,E=e&u.W,v=f?r:r[t]||(r[t]={}),m=v.prototype,S=f?i:p?i[t]:(i[t]||{}).prototype;for(c in f&&(n=t),n)(l=!_&&S&&void 0!==S[c])&&s(v,c)||(d=l?S[c]:n[c],v[c]=f&&"function"!=typeof S[c]?n[c]:g&&l?a(d,i):E&&S[c]==d?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(d):h&&"function"==typeof d?a(Function.call,d):d,h&&((v.virtual||(v.virtual={}))[c]=d,e&u.R&&m&&!m[c]&&o(m,c,d)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i=new Yox({}),r=i.set;return i.set=function(e,t){r.apply(this,Array.prototype.slice.call(arguments))},i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){e.exports=n(74)},function(e,t,n){e.exports=!n(15)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.SECOND=1e3,t.MINUTE=6e4,t.DOC_QUALITY_LOW=1,t.DOC_QUALITY_HIGH=2,t.DOC_QUALITY_LOW_RATIO=.4,t.DOC_FIT_VIEW=1,t.DOC_FIT_WIDTH=2,t.DOC_FIT_HEIGHT=3,t.DOC_VISIBLE_TRUE=1,t.DOC_VISIBLE_FALSE=0,t.WEBSOCKET_TRY_CONNECT_COUNT=3,t.HEARTBEAT_INTERVAL=1e4,t.MASTER_SERVER_CONNECT_TIMEOUT=2e4,t.SERVER_INFO_FETCH_TIMEOUT=3e3,t.ROOM_SERVER_CONNECT_TIMEOUT=2e4,t.CHAT_SERVER_CONNECT_TIMEOUT=2e4,t.SERVER_CONNECT_DELAY=4e3,t.END_TYPE_PC_BROWSER=0,t.END_TYPE_PC_CLIENT=1,t.END_TYPE_MOBILE_BROWSER=2,t.END_TYPE_MOBILE_APPLE=3,t.END_TYPE_MOBILE_ANDROID=4,t.END_TYPE_MAC_CLIENT=5,t.END_TYPE_XIAOCHENGXU=6,t.CLASSROOM_TRY_ENTER_COUNT=20,t.CLASSROOM_CONNECT_TIMEOUT=15e3,t.MEDIA_TYPE_AUDIO=1,t.MEDIA_TYPE_VIDEO=0,t.ROLE_TYPE_TEACHER=1,t.ROLE_TYPE_ASSISTANT=2,t.ROLE_TYPE_STUDENT=0,t.ROLE_TYPE_GUEST=3,t.ROLE_TYPE_PUBLIC=5,t.MORE_USER_COUNT=20,t.USER_STATUS_ONLINE=0,t.USER_STATUS_HIDDEN=1,t.USER_STATUS_ACTIVE=1,t.USER_STATUS_NOT_ACTIVE=0,t.USER_AUDITION=1,t.VIDEO_QUALITY_LOW=0,t.VIDEO_QUALITY_MEDIUM=1,t.VIDEO_QUALITY_HIGH=2,t.VIDEO_QUALITY_SUPER=3,t.VIDEO_QUALITY_720P=4,t.VIDEO_QUALITY_1080P=5,t.VIDEO_QUALITY_1080P_HIGH=6,t.VIDEO_QUALITY_4K=7,t.VIDEO_QUALITY_720P_HIGH=8,t.CAMERA_QUALITY_MAP={},t.CAMERA_QUALITY_MAP[t.VIDEO_QUALITY_LOW]="low",t.CAMERA_QUALITY_MAP[t.VIDEO_QUALITY_MEDIUM]="std",t.CAMERA_QUALITY_MAP[t.VIDEO_QUALITY_HIGH]="high",t.CAMERA_QUALITY_MAP[t.VIDEO_QUALITY_SUPER]="super",t.CAMERA_QUALITY_MAP[t.VIDEO_QUALITY_720P]="720p",t.CAMERA_QUALITY_MAP[t.VIDEO_QUALITY_720P_HIGH]="720pHigh",t.CAMERA_QUALITY_MAP[t.VIDEO_QUALITY_1080P]="1080p",t.CAMERA_QUALITY_MAP[t.VIDEO_QUALITY_1080P_HIGH]="1080pHigh",t.CAMERA_QUALITY_MAP[t.VIDEO_QUALITY_4K]="4k",t.CAMERA_RATIO_4_3=0,t.CAMERA_RATIO_16_9=1,t.SPEAK_STATE_LIMIT=1,t.SPEAK_STATE_FREE=0,t.MESSAGE_DEBUG=["zhls","sgsx"],t.MESSAGE_TIME_GAP=12e4,t.MESSAGE_TYPE_TEXT=0,t.MESSAGE_TYPE_EMOJI=1,t.MESSAGE_TYPE_IMAGE=2,t.AUDIO_CODEC_AAC=1,t.AUDIO_CODEC_SPEEX=2,t.LINK_TYPE_TCP=0,t.LINK_TYPE_UDP=1,t.MIC_VOLUME_MAX=100,t.MIC_VOLUME_MIN=0,t.MIC_VOLUME_DEFAULT=50,t.SPEAKER_VOLUME_MAX=100,t.SPEAKER_VOLUME_DEFAULT=50,t.CAN_WHISPER=1,t.MESSAGE_TO_ALL="-1",t.MEDIA_PUBLISH_BY_USER=0,t.MEDIA_PUBLISH_BY_CLASS=1,t.MEDIA_PUBLISH_BY_CAMERA_DEVICE=2,t.MEDIA_PUBLISH_BY_CAMERA_SETTING=3,t.MEDIA_PUBLISH_BY_MIC_DEVICE=4,t.MEDIA_PUBLISH_BY_MIC_SETTING=5,t.MEDIA_PUBLISH_BY_LINK_TYPE=6,t.MEDIA_PUBLISH_BY_CHANGE_SERVER=10,t.MEDIA_PUBLISH_BY_START_SCREEN_SHARE=7,t.MEDIA_PUBLISH_BY_STOP_SCREEN_SHARE=8,t.MEDIA_PUBLISH_BY_OFFLINE=9,t.LINK_TYPE_CHANGE_BY_BAD_NETWORK=0,t.REPLAY_BY_CHANGE_SERVER=1,t.STREAM_ID_ORIGIN=0,t.STREAM_ID_ASSISTANT=1,t.STREAM_ID_MIX_AUDIO=2,t.STREAM_ID_EXTRA_DEFINITION=8,t.ROOM_SERVER_OFFLINE_BY_BROWSER=0,t.ROOM_SERVER_OFFLINE_BY_SERVER=1,t.NONE_GROUP_ID=0,t.LOGIN_CONFLICT_KEY="loginConflict",t.KEYBOARD_TOGGLE_STUDENT_MIC=85,t.KEYBOARD_TOGGLE_STUDENT_CAMERA=87,t.KEYBOARD_CLOSE_ALL_MIC=86,t.KEYBOARD_RETURN=84,t.KEYBOARD_TOGGLE_CLASS_STATUS=83,t.KEYBOARD_REFRESH=82,t.KEYBOARD_PAGEUP=33,t.KEYBOARD_PAGEDOWN=34,t.KEYBOARD_TOGGLE_CLOUD_RECORD=79,t.KEYBOARD_TOGGLE_CAMERA=78,t.KEYBOARD_MIC_MINUS=75,t.KEYBOARD_MIC_ADD=77,t.KEYBOARD_SPEAKER_MINUS=74,t.KEYBOARD_SPEAKER_ADD=72,t.KEYBOARD_DEBUG_PANEL_SHOW=80,t.KEYBOARD_TOGGLE_SELF_VIDEO=78,t.KEYBOARD_REMOTER_GREY=65,t.KEYBOARD_REMOTER_RED=66,t.KEYBOARD_REMOTER_GREEN=67,t.KEYBOARD_REMOTER_BLUE=68,t.KEYBOARD_HANDUP=73,t.KEYBOARD_NET_DETECTION=71,t.KEYBOARD_UI_AUTO_HIDE_TIME=5e3,t.SIGNAL_RES_WAIT_TIME=5e3,t.SIGNAL_RES_TIMEOUT="timeout",t.SIGNAL_RES_ERROR="error",t.STORAGE_KEY_SYSTEM_LANGUAGE="bjy_system_language",t.STORAGE_KEY_REMOTER_KEYCODE_MAP="bjy_remoter_keycode_map",t.STORAGE_KEY_REMOTER_TIP_SHOW="bjy_remoter_tip_show",t.STORAGE_KEY_COMPOSED_VIRTUAL_CAMERAS="bjy_composed_virtual_camera",t.STORAGE_KEY_HIDDEN_VIRTUAL_CAMERAS="bjy_hidden_virtual_camera",t.CHINESE_SIMPLIFIED="chinese",t.ENGLISH="english",t.SHARE_TARGET_ASSIST=1,t.SHARE_TARGET_MAIN=2,t.CLASS_TYPE_SMALLCOURSE=4,t.CLASS_TYPE_SHUANGSHI=5,t.WEBRTC_TYPE_BJY=1,t.WEBRTC_TYPE_AGORA=2,t.TOKEN_GENERATE_TYPE={DEFAULT:0,SINGLE_CHANNEL:1},t.MEDIA_TYPE_MAIN_CAMERA="0",t.MEDIA_TYPE_ASSIST_CAMERA="1",t.MEDIA_TYPE_FILE="2",t.MEDIA_TYPE_MAIN_SCREEN_SHARE="3",t.MEDIA_TYPE_ASSIST_SCREEN_SHARE="4",t.PREFIX_OF_SNIPPET_SHAPE_MESSAGE="s_",t.SNIPPET_DOC_ID_LOCAL="s_0",t.SNIPPET_DOC_ID_BROAD="0",t.SNIPPET_DOC_PAGE=0,t.SNIPPET_LAYER_OF_MANAGER="0",t.SNIPPET_LAYER_OF_ALL="all",t.DISPLAY_TYPE_HIDE=0,t.DISPLAY_TYPE_NORMAL=1,t.DISPLAY_TYPE_REPOSITION=2,t.DISPLAY_TYPE_FULLSCREEN=3,t.DISPLAY_TYPE_MAX=4,t.AGORA_APPID="6f80992cb6b64da1985c306f29d07ca6",t.PLAYER_TYPE={MAIN_CAMERA:0,ASSIST_CAMERA:1,MEDIA_FILE:2,MAIN_SCREEN_SHARE:3,ASSIST_SCREEN_SHARE:4},t.CLASS_SWITCH_TYPE_RECONNECT=0,t.CLASS_SWITCH_TYPE_RELOAD=1,t.BUFFERED_BROADCAST_LIST=["answer_start","answer_end"],t.ANSWER_TYPE_MULTI_CHOICE=0,t.ANSWER_TYPE_JUDGEMENT=1,t.DRAGGING_CLASS_NAME_FOR_BODY="bjy-dragging",t.THUMBUP_COUNT_LIMIT=5,t.SHARE_LASER_BROADCAST_INTERVAL=1e3,t.USER_ACTIVE_ADD_DENY_REASON_OVERLOAD=1,t.USER_ACTIVE_ADD_DENY_REASON_NOT_EXIST=2,t.USER_SPECIAL_GUIDE_STA=2,t.CUSTOMCAST_KEY_OF_H5_DOC="h5_doc",t.ACCEPT_EXT_OF_H5_DOC=[".zip"],t.USER_NAME="昵称",t.DEFAULT_USER_IN_TIPS_CONTENT="欢迎“昵称”进入教室",t.VIRTUAL_CAMERA_NAME="百家云虚拟摄像头",t.INTERACTION="INTERACTION",t.HANDLE_HANDUP="HANDLE_HANDUP",t.NET_DETECTION="NET_DETECTION",t.SWITCH_NEXT_CAMERA="SWITCH_NEXT_CAMERA"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(27),a=n(36),o=n(20),s=(n(33),n(23)),u=n(25),c=n(21),l=n(44),d=(n(28),n(34)),_={},f="__update_async__";function p(e,t,n,i,r){return function(a,u,c){var l=this;if($.isPlainObject(a))return c=u,void $.each(a,function(e,t){l[n](e,t,c)});c=c||{};var d=l[i](a),_=l.constructor[e+"Validator"];if(_&&$.isFunction(_[a])&&(u=_[a].call(l,u,c)),$.isFunction(r)&&(u=r(l,u,c)),(d!==u||c.force)&&(l[t][a]=u,!c.silent)){var p={};o(p,c),p.newValue=u,p.oldValue=d;var h={};h[a]=p;var g=function(e){e&&e[a]&&l.execute(e[a],[u,d,p])};if(g(l.inner("watchSync")),g(l.option("watchSync")),c.sync)return g(l.constructor[e+"Updater"]),g(l.option("watch")),void l.emit(e+"change",h);var E=l.inner(e+"Changes");E||(E={},l.inner(e+"Changes",E)),$.extend(E,h),l.inner(f)||l.inner(f,s(function(){l.sync(f)}))}}}var h={};function g(){this.error("initStruct() can just call one time.")}var E={initStruct:function(){var e=this,t=e.option("mainElement"),n=e.option("mainTemplate");if("string"===$.type(n)){var i,r=e.option("share"),a=e.type+n;r&&(t=h[a]),t?e.option("replace")?l(t,i=$(n)):t.html(n):(i=$(n),r&&(h[a]=i)),i&&(t=i,e.option("mainElement",t))}var o=e.option("parentSelector");o&&!t.parent().is(o)&&t.appendTo(o),e.initStruct=g},warn:function(e){"undefined"!=typeof console&&console.warn(["[CC warn]",this.type,e].join(" "))},error:function(e){throw new Error(["[CC error]",this.type,e].join(" "))},live:function(e,t,n){var i=this.inner("main");return i&&i.on(e+this.namespace(),t,n),this},emit:function(e,t){var n=this.option("context")||this;(e=c(e)).cc=n;var i=[e];$.isPlainObject(t)&&i.push(t),e.type=e.type.toLowerCase();var r=n.get$();r.trigger.apply(r,i);var a="on"+e.type;return e.isPropagationStopped()||!1!==n.execute(a,i)||(e.preventDefault(),e.stopPropagation()),n.execute(a+"_",i),e},dispatch:function(e,t){if(!e.isPropagationStopped()){e.originalEvent||(e.originalEvent={preventDefault:$.noop,stopPropagation:$.noop});var n=$.Event(e);n.type="dispatch",this.emit(n,t),n.isPropagationStopped()&&(e.preventDefault(),e.stopPropagation())}},before:function(e,t){return this.on("before"+e.toLowerCase(),t)},after:function(e,t){return this.on("after"+e.toLowerCase(),t)},find:function(e){var t=this.inner("main");if(t){var n=t.find(e);if(n.length)return n}},appendTo:function(e){var t=this.inner("main");t&&t.appendTo(e)},prependTo:function(e){var t=this.inner("main");t&&t.prependTo(e)},execute:function(e,t){var n=e;if("string"===$.type(e)&&(n=this.option(e)),$.isFunction(n)){var i=this.option("context")||this;return $.isArray(t)?n.apply(i,t):n.call(i,t)}},renderWith:function(e,t,n){var i=this;t||(t=i.option("renderTemplate"))||(t=i.option("mainTemplate")),n||(n=i.option("mainElement"));var r,a=i.option("renderSelector");a&&(n=n.find(a)),$.isPlainObject(e)||$.isArray(e)?r=i.execute("render",[e,t]):"string"===$.type(e)&&(r=e),n.html(r)},namespace:function(){return"."+this.guid},option:function(e,t){var n=this;if(1===arguments.length&&"string"===$.type(e))return n.options[e];$.isPlainObject(e)?$.each(e,function(e,t){n.option(e,t)}):n.options[e]=t},inner:function(e,t){var n=this,i=n.inners||{};if(1===arguments.length&&"string"===$.type(e))return i[e];$.isPlainObject(e)?$.each(e,function(e,t){n.inner(e,t)}):i[e]=t},is:function(e){return this.states[e]},state:p("state","states","state","is",function(e,t){return u(t,!1)}),get:function(e){return this.properties[e]},set:p("property","properties","set","get")},v={sync:function(){var e=this,t=function(t,n,i){$.each(t,function(r,a){return e.execute(n[r],[a.newValue,a.oldValue,i?t:a])})};$.each(["property","state"],function(n,i){var r=e.inner(i+"Changes");if(r){e.inner(i+"Changes",null);var a=e.constructor[i+"Updater"];a&&t(r,a,!0);var o=e.option("watch");o&&t(r,o),e.emit(i+"change",r)}}),arguments[0]!==f&&e.execute(e.inner(f)),e.inner(f,!1)},_sync:function(){if(!this.inner(f))return!1},_init:function(){if(this.is("initCalled"))return!1;this.state("initCalled",!0)},_dispose:function(){if(this.is("disposeCalled"))return!1;this.state("disposeCalled",!0)}};function m(e,t,n,i,r){var a,o=e["before"===i?"_"+t:t+"_"];if($.isFunction(o)&&(!1===(a=o.apply(e,n))||$.isPlainObject(a)||(a=null)),!1===a)return!1;var s=!1;return a&&a.dispatch&&(s=!0,delete a.dispatch),(r=$.Event(r)).type=i+t,e.emit(r,a),s&&e.dispatch(r,a),!r.isDefaultPrevented()&&void 0}t.extend=function(e,t){o(e,v),$.each(e,function(n,i){var r=n.indexOf("_");if($.isFunction(i)&&0!==r&&r!==n.length-1&&!($.isArray(t)&&$.inArray(n,t)>=0)){a(e,n,function(e){return m(this,n,arguments,"before",e)},function(e){var t=this,r=arguments,a=function(){return m(t,n,r,"after",e)};if(i.length+1===r.length){var o=r[r.length-1];if(o&&$.isFunction(o.then))return void o.then(a)}a()})}}),o(e,E),d.extend(e)},t.init=function(e,t){return t||(t={}),o(t,e.constructor.defaultOptions),t.onafterinit_=function(){e.state("inited",!0)},t.onafterdispose_=function(){e.state("disposed",!0),e.off();var t=e.inner("main");e.option("removeOnDispose")&&t&&t.remove(),s(function(){delete _[e.guid],e.properties=e.options=e.changes=e.states=e.inners=e.guid=null})},_[e.guid=r()]=e,e.properties={},e.options=t,e.states={},e.inners={},e.init(),e},t.dispose=function(e){e.sync();var t=e.inner("main")||e.option("mainElement");t&&t.off(e.namespace())}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(62)("wks"),r=n(50),a=n(2).Symbol,o="function"==typeof a;(e.exports=function(e){return i[e]||(i[e]=o&&a[e]||(o?a:r)("Symbol."+e))}).store=i},function(e,t,n){var i=n(18),r=n(57),a=n(39),o=Object.defineProperty;t.f=n(9)?Object.defineProperty:function(e,t,n){if(i(e),t=a(t,!0),i(n),r)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var i=n(14),r=n(30);e.exports=n(9)?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(10);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t){return e=e.jquery?e[0]:e,t=t.jquery?t[0]:t,!(!e||!t)&&(e===t||$.contains(e,t))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t){$.isPlainObject(t)&&$.each(t,function(t,n){t in e||(e[t]=n)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e){return e&&!e[$.expando]&&(e="string"===$.type(e)||e.type?$.Event(e):$.Event(null,e)),e||$.Event()}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(80),r=n(32);e.exports=function(e){return i(r(e))}},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e){var t=setTimeout(e,0);return function(){clearTimeout(t)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t){var n=[];return"number"===$.type(e)&&(e=""+e),e&&"string"===$.type(e)&&$.each(e.split(t),function(e,t){(t=$.trim(t))&&n.push(t)}),n}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t){return"boolean"!==$.type(e)&&(1===arguments.length&&(t=!!e),e=t),e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(7),a=n(230),o=n(11),s=n(95),u=n(214),c=n(118),l=n(75);function d(e){return null==e&&(e=r.get("user.type")),e===o.ROLE_TYPE_TEACHER}function _(e,t){return null==e?(e=r.get("user.type"),t=r.get("user.group")):null==t&&(t=o.NONE_GROUP_ID),e===o.ROLE_TYPE_ASSISTANT&&t===o.NONE_GROUP_ID}function f(e){return null==e&&(e=r.get("user.type")),e===o.ROLE_TYPE_STUDENT}function p(e){return null==e&&(e=r.get("user.type")),e===o.ROLE_TYPE_GUEST}function h(e){var t;return e&&(t=s.find(e)),t||(t=r.get("user")),t.status===o.USER_STATUS_ONLINE}function g(){return r.get("user.isAudition")===o.USER_AUDITION}t.isClient=u,t.isTeacher=d,t.isPresenter=function(e){return null==e&&(e=r.get("user.id")),r.get("presenterId")===e},t.isStudent=f,t.isAssistant=_,t.isGroupAssistant=function(e,t){return null==e?(e=r.get("user.type"),t=r.get("user.group")):null==t&&(t=o.NONE_GROUP_ID),e===o.ROLE_TYPE_ASSISTANT&&t!==o.NONE_GROUP_ID},t.isGuest=p,t.isSelf=function(e){return r.get("user.id")===e},t.isSelfByNumber=function(e){return r.get("user.number")===e},t.isAdmin=function(e){return t.isTeacher(e)||t.isAssistant(e)},t.isSelfAssist=function(e){return r.get("user.id2")===e},t.isVisible=h,t.isAudition=g,t.isWebRTCMixUser=function(e){return"webrtcMixUser"===e},t.canStudentUseBrush=function(){return!0===r.get("user.audioOn")&&r.get("partner.disableLiveGrantStudentBrush")&&!g()},t.isCameraCoverEnabled=function(){return 1==r.get("partner.liveEnableSetCover")},t.canUseUdpPush=function(){return!1},t.canUseUdpPull=function(){return!1},t.canPaint=function(){var e=a.canvas;return e&&(e=t.isTeacher()&&BJY.data.adminAuth.getUserPainterAuth()||t.isAssistant()&&BJY.data.adminAuth.getUserPainterAuth()||t.canStudentUseBrush()),e&&h()},t.canServerPage=function(){return r.get("embed")?(t.isTeacher()||t.isAssistant())&&h():(t.isTeacher()||t.isAssistant())&&BJY.data.adminAuth.getUserDocumentControlAuth()&&h()},t.canPage=function(){return r.get("embed")||!((f()||p())&&!0===r.get("user.audioOn"))},t.canForbidAllUserSendMessage=function(){return!1},t.canWhisperTeacherInForbidAllMode=function(){return 1===r.get("partner.canWhisperTeacherInForbidAllMode")&&!g()},t.canSendMessage=function(){var e=r.get("userState.forbidSendMessage.duration")>0,n=r.get("class.forbidAll")>0||r.get("class.forbidSuperGroup")>0||r.get("class.forbidSelfGroup")>0;return h()&&(!t.isStudent()||!e&&!n)},t.canChangePresenter=function(){return r.get("user.id")===r.get("presenterId")||d()||_()&&!r.get("presenterId")},t.canCloseUserMedia=function(){return(d()||_())&&h()},t.supportDoubleCamera=function(){return!1},t.canUseDoubleCamera=function(){return!1},t.canPublishMixedAudioStream=function(){return!1},t.isNameMobileNumber=function(){return"mobile"===r.get("partner.liveInvitationNameTip")},t.canSetTouchEnable=function(){return!1},t.canManageSpeak=function(){return(t.isTeacher()||t.isAssistant())&&t.isVisible()},t.canKickOut=function(){return(t.isTeacher()||t.isAssistant())&&r.get("partner.enableKickOut",!0)},t.canPlayPlayback=function(){return(t.isTeacher()||t.isAssistant())&&r.get("partner.enableCreateSpotLive",!1)},t.canSelectSpeaker=function(){return null!=r.get("cefApiVersion")||t.isWebRTC()&&t.canSupportWebRTC()&&!g()},t.canPublishMuteStream=function(){var e=r.get("cefApiVersion");return null==e||e>="6.6.5"},t.canPublishExtraStream=function(){return!1},t.canPublishBlackStream=function(){return r.get("cefApiVersion")>="6.7.0"&&!t.isWebRTC()},t.canCloudRecordWhenMuteMic=function(){var e=r.get("cefApiVersion");return!e||e>="6.6.5"},t.canSetHardwareAccelerate=function(){return r.get("cefApiVersion")>="6.6.5"&&"windows"===BJY.os.name&&!t.isWebRTC()},t.isWebRTC=function(){return r.get("class.webrtcType",0)>0},t.canSupportWebRTC=function(){return r.get("cefApiVersion")>="6.8.5"||BJY.browser.chrome&&BJY.browser.version>"69"},t.canSupportFlv=function(){return BJY.flvjs&&BJY.flvjs.isSupported()&&!BJY.browser.ie&&!BJY.browser.safari},t.isPlayerExtensionCef=function(){return!t.isWebRTC()&&u(r.get("user.endType"))},t.isPlayerExtensionWebRTC=function(){return t.isWebRTC()},t.isWebRTCRecord=function(){return/^true$/.test(l.parseQuery(location.search).webrtcRecord)},t.NetDiskLeftMB=function(){var e=r.get("class.quotaUsed"),t=r.get("class.quotaTotal");return Math.floor((t-e)/1024/1024)},t.NetDiskExceedMB=function(){return Math.abs(t.NetDiskLeftMB())},t.isNetDiskPoor=function(){return r.get("class.quotaUsed")>.9*r.get("class.quotaTotal")},t.isNetDiskExceed=function(){return r.get("class.quotaUsed")>=r.get("class.quotaTotal")+r.get("class.quotaExceed")},t.isNetDiskEmpty=function(){return t.NetDiskLeftMB()<=0},t.canCheckGrayscaleRelease=function(){return!0===window.bjy_GrayRelease},t.canStudentPaintByNumber=function(e){return e=e||r.get("user.number"),!g()&&-1!==(r.get("class.studentPaintAuth")||[]).indexOf(e)},t.canStudentDocumentControlByNumber=function(e){return e=e||r.get("user.number"),!g()&&-1!==(r.get("class.studentDocumentControlAuth")||[]).indexOf(e)},t.canStudentScreenShareByNumber=function(e){return e=e||r.get("user.number"),!g()&&-1!==(r.get("class.studentScreenShareAuth")||[]).indexOf(e)},t.canStudentAssistCameraByNumber=function(e){return e=e||r.get("user.number"),!g()&&-1!==(r.get("class.studentAssistCameraAuth")||[]).indexOf(e)},t.canSetMicSpeakerSeparately=function(){return t.isWebRTC()&&c()&&r.get("cefApiVersion")>="7.2.0"&&"windows"===BJY.os.name},t.parentSwitchClass=function(){return!1},t.canForbidSendMessage=function(e){return t.isTeacher()||t.isAssistant()},t.canApplySpeak=function(){return t.isStudent()&&!g()},t.canTurnOnMic=function(){return t.isWebRTC()&&c()&&r.get("cefApiVersion")>="7.3.0"},t.enableEchoCancellation=function(){return!0},t.useTcpPullWithoutSpeak=function(){return!1},t.enableClassEndEvaluation=function(){return t.isStudent()&&r.get("partner.classEndEvaluationSwitch")&&r.get("class.hasClassEndEvaluation")},t.enableManageUserInTips=function(){return!t.isStudent()&&r.get("partner.enableManageUserInTips")},t.canManageInteraction=function(){return t.isTeacher()||t.isAssistant()}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){return window.ccInstanceIndex=window.ccInstanceIndex||1,function(){return"cc_"+ ++window.ccInstanceIndex}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";function i(e){return e.is("body")||"static"!==e.css("position")}return function(e){if(e.is("body"))return e;for(var t=e.parent();!i(t);)t=t.parent();return t}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(37);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";function i(e){$.extend(this,e)}var r=i.prototype;return r.start=function(){var e=this;e.stop();var t=e.timeout,n=e.interval,i=function(){"number"===$.type(e.count)?e.count++:e.count=1,!1!==e.task()&&e.timer?e.timer=setTimeout(i,n):e.stop()};null==t&&(t=n),e.timer=setTimeout(i,t)},r.stop=function(){this.timer&&(clearTimeout(this.timer),this.timer=null,this.count=0)},r.dispose=function(){this.stop(),this.task=this.timeout=this.interval=null},i}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(20),a=n(21),o={get$:function(){return this.$||(this.$=$({})),this.$},on:function(e,t,n){return this.get$().on(e,t,n),this},once:function(e,t,n){return this.get$().one(e,t,n),this},off:function(e,t){return this.get$().off(e,t),this},emit:function(e,t){return e=a(e),this.get$().trigger(e,t),e}};t.extend=function(e){r(e,o)}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports=!0},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t,n,i){var r="string"===$.type(t),a=r?e[t]:e;r||(i=n,n=t);var o=function(){var e,t=$.makeArray(arguments);if($.isFunction(n)&&(e=n.apply(this,t)),!1!==e){if($.isFunction(a)&&(e=a.apply(this,t)),$.isFunction(i)){t.push(e);var r=i.apply(this,t);"undefined"!==$.type(r)&&(e=r)}return e}};return r?e[t]=o:o}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t,n){return $.each(t,function(t,i){e=e.replace(new RegExp("\\$\\{"+t+"\\}","g"),function(){return i}),n||(e=e.replace(/\n/g,"<br>"))}),e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(10);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var i=n(85),r=n(63);e.exports=Object.keys||function(e){return i(e,r)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var i=n(32);e.exports=function(e){return Object(i(e))}},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(326);return function e(t){var n=$.isArray(t)?[]:{};return $.each(t,function(t,i){($.isPlainObject(i)||$.isArray(i))&&(i=e(i)),n[r(t)]=i}),n}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e){"use strict";return function(e,t){e=e[0],t=t[0],e.parentNode.replaceChild(t,e)}}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t,n){var i;return t="number"===$.type(t)?t:50,function(){if(!i){var r=this,a=$.makeArray(arguments);n&&e.apply(r,a),i=setTimeout(function(){i=null,n||e.apply(r,a)},t)}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(10),r=n(2).document,a=i(r)&&i(r.createElement);e.exports=function(e){return a?r.createElement(e):{}}},function(e,t){e.exports={}},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t,n){return e<t?e=t:e>n&&(e=n),e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t){var n=$.type(e);return"number"===n?e=""+e:"string"!==n&&(1===arguments.length&&(t=""),e=t),e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){var t=n(52);return function(e){var n=BJY.store;if(/http|\/\//.test(e))return e;var i,r=n.get("env");return r?(r="production"===r?"":r+"-",t(BJY.apiOrigin,location.protocol+"//"+r+"www.baijiayun.com")+e):(i=/test(-at)?(\S*)baijiayun.com/.test(location.host)?location.protocol+"//test-www.baijiayun.com":/beta(-at)?(\S*)baijiayun.com/.test(location.host)?location.protocol+"//beta-www.baijiayun.com":location.protocol+"//www.baijiayun.com",t(BJY.apiOrigin,i)+e)}}.call(t,n,t,e))||(e.exports=i)},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(82)();t.support=r,r?(t.set=function e(t,n){if($.isPlainObject(t))$.each(t,e);else try{localStorage[t]=n}catch(e){}},t.get=function(e){var t;try{t=localStorage[e]}catch(e){}return t},t.remove=function(e){try{localStorage.removeItem(e)}catch(e){}}):t.set=t.get=t.remove=$.noop}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(14).f,r=n(16),a=n(13)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,a)&&i(e,a,{configurable:!0,value:t})}},function(e,t,n){e.exports=!n(9)&&!n(15)(function(){return 7!=Object.defineProperty(n(48)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t){return null==t&&(t=2),new Array(t-(""+e).length+1).join("0")+e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e){var t=(""+e).split(".");return 2===t.length?t[1].length:0}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t){var n,i=(""+e).split(".");return t>=0||(t=0),1===i.length?n=e+new Array(t+1).join("0"):(t=Math.max(0,t-i[1].length),n=i.join("")+new Array(t+1).join("0")),+n}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(62)("keys"),r=n(50);e.exports=function(e){return i[e]||(i[e]=r(e))}},function(e,t,n){var i=n(1),r=n(2),a=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n(35)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,i){var r;void 0===(r=function(t,n,r){"use strict";var a=i(103),o=i(68);function s(e){return e.originalEvent.changedTouches[0]}var u=document.createElement("div"),c={support:"ontouchend"in u,click:"touchstart",down:"touchstart",move:"touchmove",up:"touchend",page:function(e){var t=s(e);return{x:t.pageX,y:t.pageY}},client:function(e){var t=s(e);return{x:t.clientX,y:t.clientY}},offset:function(e){var t=s(e);return{x:t.offsetX,y:t.offsetY}}},l={support:"onclick"in u,click:"click",down:"mousedown",move:"mousemove",up:"mouseup",page:function(e){return a(e)},client:function(e){return{x:e.clientX,y:e.clientY}},offset:function(){return o(e)}};return u=null,{touch:c,mouse:l}}.call(n,i,n,t))||(t.exports=r)},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){e.exports=n(216)},function(e,t,n){"use strict";var i;void 0===(i=function(e){var t=n(122)();return function(e){var n=BJY.config;return t===n.ENGLISH?e.english:BJY.isLive?e.chineseLive:e.chineseClassroom}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e){var t=e.offsetX,n=e.offsetY;if("number"!==$.type(t)){var i=e.target.getBoundingClientRect();t=e.clientX-i.left,n=e.clientY-i.top}return{x:t,y:n}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i,r=n(55),a=n(73),o=n(120);t.init=function(){i=o.localStorage()?r:a,t.init=$.noop},t.set=function(e,n){i||t.init(),i.set(e,n)},t.get=function(e,n){return i||t.init(),void 0===i.get(e)?n:i.get(e)},t.remove=function(e){i||t.init(),i.remove(e)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i,r=n(7),a=n(231),o={production:{ip:"video-ms.baijiayun.com",port:290,wssIp:"video-ms.baijiayun.com",wssPort:443},beta:{ip:"beta-video-ms.baijiayun.com",port:80,wssIp:"beta-video-ms.baijiayun.com",wssPort:443},test:{ip:"test-video-ms.baijiayun.com",port:290,wssIp:"test-video-ms.baijiayun.com",wssPort:443}};function s(e){e&&Yox.array.each(e,function(e){e.url=a(e)})}function u(e,t){$.isArray(t)||(t=[t]);var n={},i=function(e){return e.ip+e.port};$.each(e,function(e,t){n[i(t)]=1}),$.each(t,function(t,r){n[i(r)]||e.push(r)})}t.init=function(){i={masterServerList:[],roomServerList:[],roomProxyServerList:[],parentRoomServerList:[],parentRoomProxyServerList:[],chatServerList:[],chatProxyServerList:[],liveServerList:[],udpUplinkServerList:[],udpDownlinkServerList:[],webrtcServerList:[],activeMasterServer:{},activeRoomServer:{},activeLiveServer:{},useUdpPush:null,useUdpPull:null};var e="https:"===location.protocol,t=r.get("partner.ms")||o[r.get("env")],n=(e?t.wssProxy:t.proxy)||[];n.unshift({ip:e?t.wssIp:t.ip,port:e?t.wssPort:t.port}),s(n),i.masterServerList=n},t.getMasterServerList=function(){return i.masterServerList},t.takeTurnMasterServerList=function(){i.masterServerList.push(i.masterServerList.shift())},t.getRoomProxyServerList=function(){return r.get("isClassSwitching")&&r.get("class.id")===r.get("parentId")?i.parentRoomProxyServerList:i.roomProxyServerList},t.setRoomProxyServerList=function(e){s(e),i.roomProxyServerList=e},t.setParentRoomProxyServerList=function(e){s(e),i.roomParentProxyServerList=e},t.getChatProxyServerList=function(){return i.chatProxyServerList},t.setChatProxyServerList=function(e){s(e),i.chatProxyServerList=e},t.getRoomServerList=function(){return r.get("isClassSwitching")&&r.get("class.id")===r.get("parentId")?i.parentRoomServerList:i.roomServerList},t.addRoomServer=function(e,t){t&&(i.roomServerList.length=0),u(i.roomServerList,e)},t.addParentRoomServer=function(e,t){t&&(i.parentRoomServerList.length=0),u(i.parentRoomServerList,e)},t.getChatServerList=function(){return i.chatServerList},t.addChatServer=function(e,t){t&&(i.chatServerList.length=0),u(i.chatServerList,e)},t.getLiveServerList=function(){return i.liveServerList},t.addLiveServer=function(e){!function(e,t){var n={},i=[],r=function(e){return e.pull};$.each(e,function(e,t){n[r(t)]=1}),$.each(t,function(e,t){n[r(t)]||i.push(e)}),i.sort(function(e,t){return e-t});for(var a=0,o=i.length;a<o;a++)e.push(t[i[a]])}(i.liveServerList,e)},t.getUdpUplinkServerList=function(){return i.udpUplinkServerList},t.setUdpUplinkServerList=function(e){i.udpUplinkServerList=[],u(i.udpUplinkServerList,e)},t.getUdpDownlinkServerList=function(){return i.udpDownlinkServerList},t.setUdpDownlinkServerList=function(e){i.udpDownlinkServerList=[],u(i.udpDownlinkServerList,e)},t.getActiveMasterServer=function(){return i.activeMasterServer},t.setActiveMasterServer=function(e){i.activeMasterServer=e},t.getActiveRoomServer=function(){return i.activeRoomServer},t.setActiveRoomServer=function(e){i.activeRoomServer=e},t.getActiveChatServer=function(){return i.activeChatServer},t.setActiveChatServer=function(e){i.activeChatServer=e},t.setWebrtcServer=function(e){i.webrtcServerList=e},t.getWebrtcServerList=function(){return i.webrtcServerList},t.setWebrtcSignalUri=function(e){i.webrtcSignalUri=e},t.getWebrtcSignalUri=function(e){return i.webrtcSignalUri}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(){return window.innerWidth||document.documentElement.clientWidth}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(){return window.innerHeight||document.documentElement.clientHeight}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(24),a=n(91);function o(e,t,n){var i=n.expires;$.isNumeric(i)&&(i=a(new Date,i)),document.cookie=[encodeURIComponent(e),"=",encodeURIComponent(t),i?";expires="+i.toUTCString():"",n.path?";path="+n.path:"",n.domain?";domain="+n.domain:"",n.secure?";secure":""].join("")}t.get=function(e){var t=function(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));var t={};try{e=decodeURIComponent(e.replace(/\+/g," ")),$.each(r(e,";"),function(e,n){var i=r(n,"="),a=i[0],o=i[1];a&&(t[a]=o)})}catch(e){}return t}(document.cookie);return"string"===$.type(e)?t[e]:t},t.set=function(e,n,i){$.isPlainObject(e)&&(i=n,n=null),i=$.extend({},t.defaultOptions,i),null===n?$.each(e,function(e,t){o(e,t,i)}):o(e,n,i)},t.remove=function(e,n){(n=n||{}).expires=-1,o(e,"",$.extend({},t.defaultOptions,n))},t.defaultOptions={}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(1),r=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(24);t.parseQuery=function(e){var t={};if("string"===$.type(e)&&e.indexOf("=")>=0){var n=e.charAt(0),i="?"===n||"#"===n?1:0;i>0&&(e=e.substr(i)),$.each(r(e,"&"),function(e,n){var i=n.split("=");if(2===i.length){var r=$.trim(i[0]);r&&(t[r]=decodeURIComponent(i[1]))}})}return t},t.stringifyQuery=function(e){var t=[];return $.isPlainObject(e)&&$.each(e,function(e,n){t.push(e+"="+encodeURIComponent(n))}),t.join("&")},t.parse=function(e){null==e&&(e=document.URL);var t=document.createElement("a");t.href=e,e=t.href;var n="";t.protocol&&t.host?n=t.protocol+"//"+t.host:/^(http[s]?:\/\/[^\/]+)(?=\/)/.test(e)&&(n=RegExp.$1);var i=n.split(":");0===n.indexOf("http:")&&3===i.length&&80==i[2]&&(i.length=2,n=i.join(":"));var r=t.pathname;return r&&"/"!==r.charAt(0)&&(r="/"+r),{origin:n,pathname:r,search:t.search,hash:t.hash}},t.mixin=function(e,n,i){"boolean"===$.type(n)&&2===arguments.length&&(i=n,n=null),null==n&&(n=document.URL);var r=t.parse(n),a=t.parseQuery(i?r.hash:r.search);return $.extend(a,e),a=$.param(a),n=r.origin+r.pathname,i?n+=r.search:a&&(n+="?"+a),i?a&&(n+="#"+a):n+=r.hash,n}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(){return Math.max(document.body.scrollLeft,document.documentElement.scrollLeft)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(){return Math.max(document.body.scrollTop,document.documentElement.scrollTop)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(96),a=n(51),o=n(97),s=n(19),u=n(98),c=n(99),l=n(100),d=n(76),_=n(77),f=n(71),p=n(72),h=n(101),g=n(102),E=n(12),v=n(64),m=n(4).body;function S(e){E.init(this,e)}var A=S.prototype;A.type="Draggable",A.init=function(){var e=this,t=e.option("mainElement"),n=e.option("mainSelector");e.inner({main:t});var i=e.option("containerElement");i||(i=r());var E,v=e.option("draggingClass"),S=e.option("containerDraggingClass"),A=e.option("bodyDraggingClass")||"dragging";e.execute("init",{mainElement:t,mainSelector:n,namespace:e.namespace(),downHandler:function(r){var h,g=n?$(r.currentTarget):t,v=r[$.expando];if(v){var m=e.option("includeSelector"),S=e.option("excludeSelector"),A=r.target;if(m&&!u(A,m,g)||S&&u(A,S,g))return;$.each(b,function(e,t){if(0===r.type.indexOf(e))return h=t,!1})}else r.type&&(h=b[r.type]);h||(h=b.mouse),I=g,e.emit("pick",{mainElement:I}),E=o(I),C.left=E.left,C.top=E.top;var L="fixed"===E.position,D=i.is("html,body"),N=!0;D||(N=s(i,I));var P,k,w,U,M,x,V=l(I),G=c(i);v?(P=h.absoluteX(r)-V.x,k=h.absoluteY(r)-V.y):(P=r.offsetX,k=r.offsetY),N&&(D||(P-=i.scrollLeft(),k-=i.scrollTop()),L||(P+=G.x,k+=G.y));var B=f(),H=p(),Y=_(),F=d(),j=F+B,W=Y+H;L?D?(w=0,U=0):(w=a(G.x,F,j),U=a(G.y,Y,W)):D?(w=-1*G.x,U=-1*G.y):N?(w=0,U=0):(w=G.x,U=G.y),null==M&&(!D&&N?(M=i.prop("scrollWidth"),x=i.prop("scrollHeight")):(M=i.innerWidth(),x=i.innerHeight())),D&&(M<B&&(M=B),x<H&&(x=H)),L&&(w+M>j&&(M=j-w),U+x>W&&(x=W-U)),M=Math.max(0,M-I.outerWidth(!0)),x=Math.max(0,x-I.outerHeight(!0));var K=e.option("axis");return y="y"===K?O.constant(E.left):O.variable(h[L?"fixedX":"absoluteX"],P,w,w+M),T="x"===K?O.constant(E.top):O.variable(h[L?"fixedY":"absoluteY"],k,U,U+x),R=0,!0},moveHandler:function(t){if(null!=R){if(C.left=y(t),C.top=T(t),0===R){if(E&&(I.css(E),E=null),e.emit("beforedrag",$.extend({},C)).isDefaultPrevented())return;g(),v&&I.addClass(v),S&&i.addClass(S),A&&m.addClass(A)}R++,e.emit("drag",$.extend({},C)).isDefaultPrevented()||e.execute("dragAnimation",{mainElement:I,mainStyle:C})}},upHandler:function(){null!=R&&(R>0&&(h(),v&&I.removeClass(v),S&&i.removeClass(S),A&&m.removeClass(A),e.emit("afterdrag",$.extend({},C))),e.emit("drop",{mainElement:I}),R=y=T=E=I=null)}})},A.dispose=function(){E.dispose(this)},E.extend(A);var y,T,R,I,C={},O={constant:function(e){return function(){return e}},variable:function(e,t,n,i){return function(r){return a(e(r)-t,n,i)}}},b={};return $.each(v,function(e,t){t.support&&(b[e]={absoluteX:function(e){return t.client(e).x+d()},absoluteY:function(e){return t.client(e).y+_()},fixedX:function(e){return t.client(e).x},fixedY:function(e){return t.client(e).y}})}),S}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i,r=n(11),a=n(7),o=n(238);t.init=function(e){return i=new o({interval:r.SECOND,retryCount:r.WEBSOCKET_TRY_CONNECT_COUNT,timeout:r.ROOM_SERVER_CONNECT_TIMEOUT,native:window.WebSocket,onSend:e.onSend,onReceive:e.onReceive,onOpen:e.onOpen,onClose:e.onClose,onError:e.onError,onTimeout:e.onTimeout})},t.send=function(e){var t=a.get("user");e.class_id=a.get("class").id,e.user_id=t.id,e.ts=(new Date).getTime(),e.signal_send_by={id:t.id,number:t.number,type:t.type,group:t.group,end_type:t.endType},i&&i.send(e)},t.socketSend=function(e){i.send(e)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(41);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t,n){var i=n(54),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(){return void 0!==window.localStorage}}.call(t,n,t,e))||(e.exports=i)},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var i=n(18),r=n(165),a=n(63),o=n(61)("IE_PROTO"),s=function(){},u=function(){var e,t=n(48)("iframe"),i=a.length;for(t.style.display="none",n(130).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;i--;)delete u.prototype[a[i]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=i(e),n=new s,s.prototype=null,n[o]=e):n=u(),void 0===t?n:r(n,t)}},function(e,t,n){var i=n(16),r=n(22),a=n(125)(!1),o=n(61)("IE_PROTO");e.exports=function(e,t){var n,s=r(e),u=0,c=[];for(n in s)n!=o&&i(s,n)&&c.push(n);for(;t.length>u;)i(s,n=t[u++])&&(~a(c,n)||c.push(n));return c}},function(e,t,n){t.f=n(13)},function(e,t,n){var i=n(2),r=n(1),a=n(35),o=n(86),s=n(14).f;e.exports=function(e){var t=r.Symbol||(r.Symbol=a?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t,n){var i=n(183),r=n(185);function a(e){return(a="function"==typeof r&&"symbol"==typeof i?function(e){return typeof e}:function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":typeof e})(e)}function o(t){return"function"==typeof r&&"symbol"===a(i)?e.exports=o=function(e){return a(e)}:e.exports=o=function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":a(e)},o(t)}e.exports=o},function(e,t,n){"use strict";var i=n(163)(!0);n(90)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var i=n(35),r=n(6),a=n(114),o=n(17),s=n(49),u=n(164),c=n(56),l=n(142),d=n(13)("iterator"),_=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,n,p,h,g,E){u(n,t,p);var v,m,S,A=function(e){if(!_&&e in I)return I[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},y=t+" Iterator",T="values"==h,R=!1,I=e.prototype,C=I[d]||I["@@iterator"]||h&&I[h],O=C||A(h),b=h?T?A("entries"):O:void 0,L="Array"==t&&I.entries||C;if(L&&(S=l(L.call(new e)))!==Object.prototype&&S.next&&(c(S,y,!0),i||"function"==typeof S[d]||o(S,d,f)),T&&C&&"values"!==C.name&&(R=!0,O=function(){return C.call(this)}),i&&!E||!_&&!R&&I[d]||o(I,d,O),s[t]=O,s[y]=f,h)if(v={values:T?O:A("values"),keys:g?O:A("keys"),entries:b},E)for(m in v)m in I||a(I,m,v[m]);else r(r.P+r.F*(_||R),t,v);return v}},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(92);return function(e,t){return r(e,24*t)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(93);return function(e,t){return r(e,60*t)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(94);return function(e,t){return r(e,60*t)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t){return"date"===$.type(e)&&(e=e.getTime()),new Date(e+1e3*t)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(43),a=n(295),o=n(7),s=n(11),u=n(5),c=n(148),l={},d={},_={0:{id:0,name:"",color:"",count:0,hasMore:!0}},f=[],p={};function h(e){return e||0===e}function g(e){var t=l[e];if(t&&t===d[t.number])return t}function E(e,t){var n=e.type===s.ROLE_TYPE_TEACHER,i=e.id===o.get("user.id"),a=$.extend({},t);n&&$.extend(a,o.get("teacher")),i&&(delete e.sessionId,$.extend(a,o.get("user"))),$.extend(a,e),a=r(a),n&&o.set("teacher",a),i&&o.set("user",a);var u=o.get("presenterId");return u?e.id===u&&o.set("presenter",a):n&&(o.set("presenterId",a.id),o.set("presenter",a)),a}t.add=function(e,n){$.isArray(e)||(e=[e]);var i=[];$.each(e,function(e,r){if(r){var o=r.id,s=r.number;if(h(o)){var u=a(o);if($.extend(r,u),r.mediaExt){var _=r.mediaExt;$.each(_,function(e,n){c.mediaAssistCamera(n.id)&&(r.id2=n.id),n.videoOn&&t.updateAssistActive(r.id,!0,n.id)})}if(g(o))return void t.update(r);if(0!=s){var f=d[r.number];f&&h(f.id)&&t.remove(f.id)}r=E(r),l[o]=d[s]=r,(r.audioOn||r.videoOn||n)&&t.updateActive(r.id,!0),i.push(r)}}});var r=t.group(i),s=r.teacherList;1===s.length&&(o.set("teacher",s[0]),u.trigger(u.TEACHER_ADD,{userList:s}));var _=r.assistantList;_.length>0&&u.trigger(u.ASSISTANT_ADD,{userList:_});var f=r.studentList;f.length>0&&u.trigger(u.STUDENT_ADD,{userList:f});var p=r.guestList;p.length>0&&u.trigger(u.GUEST_ADD,{userList:p}),i.length>0&&u.trigger(u.USER_ADD,{userList:i})},t.remove=function(e){var n=g(e);if(n&&(n=Yox.object.extend({},n))){var i;switch(n.videoOn=n.audioOn=null,n.type){case s.ROLE_TYPE_TEACHER:i=u.TEACHER_REMOVE;break;case s.ROLE_TYPE_ASSISTANT:i=u.ASSISTANT_REMOVE;break;case s.ROLE_TYPE_STUDENT:i=u.STUDENT_REMOVE;break;case s.ROLE_TYPE_GUEST:default:i=u.GUEST_REMOVE}var r=o.get("presenterId");return r&&n.id===r&&(o.set("presenterId",""),o.set("presenter",null)),t.updateActive(n.id,!1),t.updateAssistActive(n.id,!1),delete l[e],delete d[n.number],u.trigger(i,{user:n}),u.trigger(u.USER_REMOVE,{user:n}),!0}return!1},t.updateActive=function(e,t){if(t)-1===f.indexOf(e)&&(f.push(e),u.trigger(u.USER_ACTIVE_ADD,{user:g(e)||{}}));else if(!1===t){var n=f.indexOf(e);n>-1&&(f.splice(n,1),u.trigger(u.USER_ACTIVE_REMOVE,{user:g(e)||{}}))}},t.updateAssistActive=function(e,t,n){if(n||!t){c.mediaAssistCamera(n)&&(n=s.MEDIA_TYPE_ASSIST_CAMERA);var i=p[n];if(t)i?-1===i.indexOf(e)&&i.push(e):(i=p[n]=[]).push(e);else if(!1===t)if(i){var r=i.indexOf(e);r>-1&&i.splice(r,1)}else n||Yox.object.each(p,function(t,n){if(t){var i=t.indexOf(e);i>-1&&t.splice(i,1)}})}},t.update=function(e,n){var i=g(e.id);if(null!=i){var r=function e(t,n){var i=[];return $.each(t,function(t,r){$.isArray(r)||$.isPlainObject(r)?(null==n[t]||e(r,n[t]).length>0)&&i.push(t):r!==n[t]&&i.push(t)}),i}(e,i);if(0===r.length)return;var a={};c.smallCourse()&&"hack_mobile"!==n&&(n instanceof Array?n.push("group"):n=["group"]),$.each(r,function(t,r){if(Yox.is.array(n)&&Yox.array.has(n,r))return e[r]=i[r],!0;a[r]=e[r]});var o,_=E(e,i);switch(l[e.id]=d[e.number]=_,e.type){case s.ROLE_TYPE_TEACHER:o=u.TEACHER_UPDATE;break;case s.ROLE_TYPE_ASSISTANT:o=u.ASSISTANT_UPDATE;break;case s.ROLE_TYPE_STUDENT:o=u.STUDENT_UPDATE;break;case s.ROLE_TYPE_GUEST:o=u.GUEST_UPDATE}var f={user:_,update:a};return u.trigger(o,f),u.trigger(u.USER_UPDATE,f),_}d[e.number]||t.add(e)},t.find=function(e){return g(e)},t.getMediaPlayerId=function(e){return e||(e=o.get("user.id")),+e+ +s.MEDIA_TYPE_FILE+""},t.findByNumber=function(e){var t=d[e];return t&&g(t.id)},t.active=function(){var e=[];return f.forEach(function(t){var n=g(t);n&&e.push(n)}),e},t.activeAssist=function(e){var t=[],n=p[e];return n&&n.forEach(function(e){var n=g(e);n&&t.push(n)}),t},t.isActive=function(e){return e=e||o.get("user.id"),f.indexOf(e)>-1&&!!g(e)},t.all=function(){var e=[];return $.each(l,function(t){var n=g(t);n&&e.push(n)}),e},t.group=function(e){var t=[],n=[],i=[],r=[];return $.each(e||l,function(e,a){switch(a.type){case s.ROLE_TYPE_TEACHER:t.push(a);break;case s.ROLE_TYPE_ASSISTANT:n.push(a);break;case s.ROLE_TYPE_STUDENT:i.push(a);break;case s.ROLE_TYPE_GUEST:r.push(a)}}),{teacherList:t,assistantList:n,studentList:i,guestList:r}},t.hasAssistant=function(){var e=!1;return $.each(l,function(t){if(g(t).type===s.ROLE_TYPE_ASSISTANT)return e=!0,!1}),e},t.getGroupsInfo=function(){return Yox.object.copy(_,!0)},t.getGroupInfoById=function(e){return Yox.object.copy(_[e],!0)},t.addGroupInfo=function(e){$.isArray(e)||(e=[e]),$.each(e,function(e,t){var n=_[t.id];n?Yox.object.extend(n,t):(t.count||(t.count=0),!1!==t.hasMore&&(t.hasMore=!0),_[t.id]=t)})},t.removeGroupInfo=function(e){delete _[e]},t.updateGroupInfo=function(e,n){null!=e&&(_[e]?_[e]=Yox.object.extend(_[e],n):(n.id=e,t.addGroupInfo(n)))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(4);return function(){return r.body.prop("clientHeight")<r.html.prop("clientHeight")?r.html:r.body}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(28);return function(e){var t=r(e),n=e.css("position"),i=parseInt(e.css("left"),10),a=parseInt(e.css("top"),10),o=isNaN(i),s=isNaN(a);if(o||s)if(1===t.length){var u=e.offset(),c=t.offset();o&&(i=u.left-c.left-(parseInt(t.css("border-left-width"),10)||0)),s&&(a=u.top-c.top-(parseInt(t.css("border-top-width"),10)||0))}else i=a=0;return n&&"static"!==n||(n="absolute"),{position:n,left:i,top:a}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(4),a=n(19);return function(e,t,n){var i=!1;return $.isArray(t)&&(t=t.join(",")),n||(n=r.document),n.find(t).each(function(){if(i=a(this,e))return!1}),i}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(3);return function(e){var t=e.offset(),n=e.css("border-left-width"),i=e.css("border-top-width");return{x:t.left+r(n,0,"int"),y:t.top+r(i,0,"int")}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(3);return function(e){var t=e.offset(),n=r(e.css("margin-left"),0,"int"),i=r(e.css("margin-top"),0,"int");return{x:t.left-n,y:t.top-i}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return document.selection?function(){document.body.onselectstart=null}:$.noop}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return document.selection?function(){document.body.onselectstart=function(){return!1}}:$.noop}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e){var t=e.pageX,n=e.pageY;if("number"!==$.type(t)){var i=document.documentElement;t=e.clientX+i.scrollLeft,n=e.clientY+i.scrollTop}return{x:t,y:n}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){e.exports=n(211)},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},,,,function(e,t,n){"use strict";var i;void 0===(i=function(e){var t=n(7),i=n(3),r=[];return t.watch("class.playBuffer",function(e){e=i(e,0),e*=1e3;var t=$.now();$.each(r,function(n,i){if(i&&i.buffer!==e){clearTimeout(i.timer);var r=t-i.timestamp;r>=e?i.action():(i.buffer=e,i.timestamp=t,i.timer=setTimeout(i.action,e-r))}})}),function(e,n,a){var o=!1,s=t.get("user.id");if(a&&e===s&&$.each(r,function(e,t){t.type===a&&(o=!0)}),e===s&&!o)return n();var u=i(t.get("class.playBuffer"),0);if(!(u>0))return n();var c=function(){n(),Yox.array.remove(r,l)},l={type:a||"",action:c,buffer:u*=1e3,timestamp:$.now(),timer:setTimeout(c,u)};r.push(l)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){n(166);for(var i=n(2),r=n(17),a=n(49),o=n(13)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var c=s[u],l=i[c],d=l&&l.prototype;d&&!d[o]&&r(d,o,c),a[c]=a.Array}},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(176),a=n(177),o=n(161),s=n(178),u=n(3),c=n(51),l=n(19),d=n(68),_=n(78),f=n(12),p=n(179),h=n(64),g=n(180),E=n(4).document;function v(e){f.init(this,e)}var m=v.prototype;return m.type="Slider",m.init=function(){var e=this;e.initStruct();var t,n=e.option("mainElement"),i=n.find(e.option("thumbSelector")),r=e.option("trackSelector"),a=r?n.find(r):n,o=e.option("barSelector");o&&(t=n.find(o));var s=g[e.option("orientation")],c=e.option("reverse"),f=function(t,n){return"number"!==$.type(t)&&(t=u(t,0,"float")),c&&(t=e.inner("maxPixel")-t),v(e.pixelToValue(t),n)},v=function(t,n){var i={action:n},r=e.get("value");return e.set("value",t,i),r!==e.get("value")},m=e.namespace(),S=new _({mainElement:i,containerElement:a,containerDraggingClass:e.option("draggingClass"),axis:s.axis,init:function(e){$.each(h,function(t,n){n.support&&i.on(n.down+m,function(t){e.downHandler(t)&&E.off(m).on(n.move+m,e.moveHandler).on(n.up+m,function(){e.upHandler(),E.off(m)})})})},dragAnimation:function(e){f(e.mainStyle[s.position],"drag")}}),A=function(t,n){e.emit(t,n)};S.on("beforedrag",A).on("drag",A).on("afterdrag",A),a.on("click"+m,function(t){l(i,t.target)||f(d(t)[s.axis]-e.inner("thumbSize")/2,"click")});var y,T=e.option("scrollStep"),R=e.option("scrollStepType"),I=$.isFunction(T);if(I||T>0){y=[];var C=function(t,n){var i=n.delta,r=I?T(i):i*T;if(r){c&&(r*=-1);var a=e.get("value");return!("value"===R?v(a+r,"scroll"):f(e.valueToPixel(a)+r,"scroll"))}},O=function(e){p.init(e),e.on(p.WHEEL,C),y.push(e)};O(a);var b=e.option("scrollElement");b&&O(b)}e.inner({main:n,track:a,thumb:i,bar:t,drager:S,wheels:y}),e.set({minValue:e.option("minValue"),maxValue:e.option("maxValue")}),e.refresh();var L=e.option("value");"number"===$.type(L)?v(L):f(i.css(s.position))},m.refresh=function(){var e,t,n=this,i=g[n.option("orientation")],u=n.inner("track"),c=n.inner("thumb")[i.outerSize](!0),l=u[i.innerSize]()-c,d=n.get("minValue"),_=n.get("maxValue"),f=n.option("step");if("number"===$.type(f)){var p=o(l,o(a(_,d),f));e=function(e){return r(d,s(Math.round(o(e,p)),f))},t=function(e){return s(o(a(e,d),f),p)}}else e=function(e){return r(d,s(a(_,d),o(e,l)))},t=function(e){return s(a(e,d),o(l,a(_,d)))};n.inner({thumbSize:c,maxPixel:l}),n.pixelToValue=e,n.valueToPixel=t;var h=n.get("value");"number"===$.type(h)&&n.set("value",h,{force:!0})},m.dispose=function(){var e=this;f.dispose(e);var t=e.namespace();E.off(t),e.inner("thumb").off(t),e.inner("track").off(t),e.inner("drager").dispose();var n=e.inner("wheels");n&&$.each(n,function(e,t){p.dispose(t)})},f.extend(m),v.propertyUpdater={value:function(e,t,n){var i,r=this,a=g[r.option("orientation")],o=r.inner("thumb"),s=r.inner("thumbSize"),u=r.valueToPixel(e),c=r.inner("bar");c&&((i={})[a.size]=u+s/2),r.option("reverse")&&(u=r.inner("maxPixel")-u);var l={};l[a.position]=u;var d={thumbElement:o,thumbStyle:l};i&&(d.barStyle=i,d.barElement=c);var _=n.value;_.action&&(d.action=_.action),r.execute("slideAnimation",d)}},v.propertyValidator={value:function(e){var t=this.get("minValue"),n=this.get("maxValue");return c(u(e,t),t,n)},minValue:function(e){return null==(e=u(e,null))&&this.error("minValue must be a number."),e},maxValue:function(e){return null==(e=u(e,null))&&this.error("maxValue must be a number."),e}},v}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(78),a=n(4);return function(e){return new r({mainElement:e.element,containerElement:e.containerElement||a.body,mainDraggingClass:e.draggingClass,bodyDraggingClass:e.bodyDraggingClass,includeSelector:e.includeSelector,excludeSelector:e.excludeSelector,dragAnimation:e.dragAnimation,onbeforedrag:e.onbeforedrag,ondrag:e.ondrag,onafterdrag:e.onafterdrag,init:function(e){var t=e.namespace;e.mainElement.on("mousedown"+t,function(n){e.downHandler(n)&&a.document.off(t).on("mousemove"+t,e.moveHandler).on("mouseup"+t,function(n){e.upHandler(n),a.document.off(t)})})}})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(54),r=Math.max,a=Math.min;e.exports=function(e,t){return(e=i(e))<0?r(e+t,0):a(e,t)}},function(e,t,n){e.exports=n(17)},function(e,t,n){var i=n(41);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";var i;return function(){if(i)return i;var e=$.Deferred(),t=new Image;return t.onload=t.onerror=function(){2===t.height?e.resolve():e.reject()},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",i=e,e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){e.exports=n(203)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(){return!BJY.browser.wechat&&"function"==typeof window.cefQuery}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){e.exports=n(201)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=document.createElement("musicode").style,a=["Webkit","Moz","O","ms"];function o(e){var t=e.charAt(0).toUpperCase()+e.slice(1),n=(e+" "+a.join(t+" ")+t).split(" "),i=!1;return $.each(n,function(e,t){if(t in r)return i=!0,!1}),i}t.animation=function(){return o("animationName")},t.boxShadow=function(){return o("boxShadow")},t.flexbox=function(){return o("flexWrap")},t.transform=function(){return o("transform")},t.webp=n(116),t.webSocket=n(143),t.localStorage=n(82),t.flash=n(144),t.canvas=n(145),t.placeholder=n(146),t.input=n(147)}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(343);return function e(t){var n=$.isArray(t)?[]:{};return $.each(t,function(t,i){($.isPlainObject(i)||$.isArray(i))&&(i=e(i)),n[r(t)]=i}),n}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(75),a=n(11),o=n(69),s=a.STORAGE_KEY_SYSTEM_LANGUAGE,u=a.CHINESE_SIMPLIFIED,c=a.ENGLISH,l={chinese:1,english:1};return function(){var e=r.parseQuery(location.search).language;if(!l[e]){var t=o.get(s);if(t)return t;e=(e=navigator.systemLanguage||navigator.browserLanguage||navigator.userLanguage||navigator.language).toLowerCase().indexOf("en")>-1?c:u}return e}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},,function(e,t,n){var i=n(22),r=n(81),a=n(113);e.exports=function(e){return function(t,n,o){var s,u=i(t),c=r(u.length),l=a(o,c);if(e&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}}},function(e,t,n){var i=n(85),r=n(63).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},function(e,t){},function(e,t,n){e.exports=n(218)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(3),a=n(4);return function(e){var t,n,i,o,s,u,c=e.element,l=e.safeTop,d=e.safeRight,_=e.safeBottom,f=e.safeLeft,p=e.minWidth,h=e.minHeight,g=e.keepRatio,E=e.bodyDraggingClass||"cc-element-resizing",v=c.width(),m=c.height(),S=v/m,A=c.offset();switch("fixed"!==c.css("position")?(t=c.offsetParent().offset(),A.top-=t.top,A.left-=t.left):t={left:0,top:0},e.point){case"lt":n=A.left+c.width(),i=A.top+c.height(),o=n-p,s=i-h,u=function(e,t){e>o&&(e=o),"number"==typeof f&&e<f&&(e=f),t>s&&(t=s),"number"==typeof l&&t<l&&(t=l),v=n-e,g?(m=v/S,"number"==typeof _&&t+m>_&&(v=(m=_-t)*S)):m=i-t,c.css({top:i-m>l?i-m:t,left:n-v>f?n-v:e,width:v,height:m})};break;case"t":i=A.top+c.height(),s=i-h,u=function(e,t){g||(t>s&&(t=s),"number"==typeof l&&t<l&&(t=l),c.css({top:t,height:i-t}))};break;case"rt":n=A.left,i=A.top+c.height(),o=n+p,s=i-h,u=function(e,t){e<o&&(e=o),"number"==typeof d&&e>d&&(e=d),t>s&&(t=s),"number"==typeof l&&t<l&&(t=l),v=e-n,g?(m=v/S,"number"==typeof _&&t+m>_&&(v=(m=_-t)*S)):m=i-t,c.css({top:i-m>l?i-m:t,left:n,width:v,height:m})};break;case"l":n=A.left+c.width(),o=n-p,u=function(e,t){g||(e>o&&(e=o),"number"==typeof f&&e<f&&(e=f),c.css({left:e,width:n-e}))};break;case"r":n=A.left,o=n+p,u=function(e,t){g||(e<o&&(e=o),"number"==typeof d&&e>d&&(e=d),c.css({width:e-n}))};break;case"lb":n=A.left+c.width(),i=A.top,o=n-p,s=i+h,u=function(e,t){e>o&&(e=o),"number"==typeof f&&e<f&&(e=f),v=n-e,g?(m=v/S,t=r(c.css("top"),0,"int"),"number"==typeof _&&t+m>_&&(v=(m=_-t)*S)):(t<s&&(t=s),"number"==typeof _&&t>_&&(t=_),m=t-i),c.css({left:e,width:v,height:m})};break;case"b":i=A.top,s=i+h,u=function(e,t){g||(t<s&&(t=s),"number"==typeof _&&t>_&&(t=_),c.css({height:t-i}))};break;case"rb":n=A.left,i=A.top,o=n+p,s=i+h,u=function(e,t){e<o&&(e=o),"number"==typeof d&&e>d&&(e=d),v=e-n,g?(m=v/S,t=r(c.css("top"),0,"int"),"number"==typeof _&&t+m>_&&(v=(m=_-t)*S)):(t<s&&(t=s),"number"==typeof _&&t>_&&(t=_),m=t-i),c.css({width:v,height:m})}}var y=".cc_function_resize"+$.now();a.document.on("mousemove"+y,function(n){return u(n.clientX-t.left,n.clientY-t.top),e.onChange&&e.onChange(),E&&a.body.addClass(E),!1}).on("mouseup"+y,function(t){a.document.off(y),E&&a.body.removeClass(E),e.onComplete&&setTimeout(function(){e.onComplete({left:r(c.css("left"),0,"int"),top:r(c.css("top"),0,"int"),width:c.width(),height:c.height()})},200)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(2).document;e.exports=i&&i.documentElement},function(e,t,n){e.exports=n(278)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t,i){var a=n(3),o=n(342),s=n(235),u=n(7),c=n(69),l="bjy_prev_enter_date";function d(){var e=l,t=c.get(e),n=c.get(t);if(n)try{n=JSON.parse(n)}catch(e){}return $.isPlainObject(n)||(n={}),n}function _(e){var t=l,n=c.get(t);c.set(n,(0,r.default)(e))}function f(e){var n=t.getClassId(),i=e[n];return $.isPlainObject(i)||(i=e[n]={}),i}t.init=function(){!function(){var e=l,t=c.get(e),n=o(t,"-"),i=new Date;if(n){if(n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()&&n.getDate()===i.getDate())return;c.remove(t)}c.set(e,s(i,"-"))}(),function(){var e=d(),t=f(e),n=t.enterCount;"number"!==$.type(n)&&(n=0);t.enterCount=++n,_(e)}()},t.getClassId=function(){return u.get("class.id")},t.getClassNumber=function(){return u.get("class.number")},t.getClassType=function(){return u.get("class.type")},t.getSerialNumber=function(){return u.get("class.serialNumber")},t.getClassName=function(){return u.get("class.title")},t.getUserCount=function(){return a(u.get("class.userCount"),0)},t.getStartTime=function(e){return a(e,0)},t.getEndTime=function(e){return a(e||u.get("class.endTime"),0)},t.isStarted=function(){return u.get("class.started")},t.inClassTime=function(){return t.isStartTimeReached()&&!t.isEndTimeReached()},t.isStartTimeReached=function(){return t.timeBeforeStartTime()<=0},t.isEndTimeReached=function(){return t.timeBeforeEndTime()<=0},t.timeBeforeStartTime=function(e){e=t.getStartTime(e||u.get("class.startTime"));var n=u.get("class.diffNTP")+$.now();return e-n},t.timeAfterStartTime=function(){var e=t.getStartTime(),n=u.get("class.diffNTP")+$.now();return n>=e?n-e:-1},t.timeBeforeEndTime=function(){var e=t.getEndTime(),n=u.get("class.diffNTP")+$.now();return e>=n?e-n:-1},t.getTimeBeforeEndTime=function(e){return(e=t.getEndTime(e||u.get("class.endTime")))-(u.get("class.diffNTP")+$.now())},t.timeAfterEndTime=function(){var e=t.getEndTime(),n=u.get("class.diffNTP")+$.now();return n>=e?n-e:-1},t.setForbidAll=function(e){u.set("class.forbidAll",e)},t.getForbidAll=function(){return a(u.get("class.forbidAll"))?1:0},t.setForbidSuperGroup=function(e){return u.set("class.forbidSuperGroup",e||-1)},t.getForbidSuperGroup=function(){return u.get("class.forbidSuperGroup")>0},t.setForbidSelfGroup=function(e){return u.set("class.forbidSelfGroup",e||-1)},t.getForbidSelfGroup=function(){return u.get("class.forbidSelfGroup")>0},t.isAllForbid=function(){return!!t.getForbidAll()||t.getForbidSuperGroup()||t.getForbidSelfGroup()},t.setForbidSpeakApply=function(e){u.set("class.forbidSpeakApply",e)},t.getForbidSpeakApply=function(){return a(u.get("class.forbidSpeakApply"))?1:0},t.setForbidMic=function(e){u.set("class.forbidMic",e)},t.getForbidMic=function(){return a(u.get("class.forbidMic"))?1:0},t.getEnableUserInTips=function(){return a(u.get("class.enableUserInTips"))?1:0},t.setEnableUserInTips=function(e){u.set("class.enableUserInTips",e)},t.set=function(e,t){var n=d(),i=f(n);$.isPlainObject(e)?$.extend(i,e):i[e]=t,_(n)},t.get=function(e){return f(d())[e]||""},t.remove=function(e){var t=d(),n=f(t);e in n&&(delete n[e],_(t))},t.isLongTerm=function(){return u.get("class.isLongTerm")},t.getRoomId=function(){return u.get("class.id")},t.getToken=function(){return u.get("token")},t.isParentRoom=function(){return u.get("class.isParentRoom")},t.isGroupRoom=function(){return u.get("class.isGroupLive")>0},t.isNewGroupRoom=function(){return u.get("class.newGroupLive")>0},t.enableGroupPublic=function(){return!!u.get("class.enableGroupUsersPublic")}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(50)("meta"),r=n(10),a=n(16),o=n(14).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(15)(function(){return u(Object.preventExtensions({}))}),l=function(e){o(e,i,{value:{i:"O"+ ++s,w:{}}})},d=e.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,i)){if(!u(e))return"F";if(!t)return"E";l(e)}return e[i].i},getWeak:function(e,t){if(!a(e,i)){if(!u(e))return!0;if(!t)return!1;l(e)}return e[i].w},onFreeze:function(e){return c&&d.NEED&&u(e)&&!a(e,i)&&l(e),e}}},function(e,t,n){var i=n(29),r=n(244),a=n(245),o=n(18),s=n(81),u=n(182),c={},l={};(t=e.exports=function(e,t,n,d,_){var f,p,h,g,E=_?function(){return e}:u(e),v=i(n,d,t?2:1),m=0;if("function"!=typeof E)throw TypeError(e+" is not iterable!");if(a(E)){for(f=s(e.length);f>m;m++)if((g=t?v(o(p=e[m])[0],p[1]):v(e[m]))===c||g===l)return g}else for(h=E.call(e);!(p=h.next()).done;)if((g=r(h,v,p.value,t))===c||g===l)return g}).BREAK=c,t.RETURN=l},function(e,t,n){var i=n(65),r=n(30),a=n(22),o=n(39),s=n(16),u=n(57),c=Object.getOwnPropertyDescriptor;t.f=n(9)?c:function(e,t){if(e=a(e),t=o(t,!0),u)try{return c(e,t)}catch(e){}if(s(e,t))return r(!i.f.call(e,t),e[t])}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(5),a=n(3),o=n(11),s=n(69),u=n(230),c=[],l={},d=1,_=!0,f="";function p(e){var t;return $.each(c,function(n,i){if(e==i.id)return t=i,!1}),t}function h(e){var t,n,i=0;if($.each(c,function(r,a){if(n=i+a.pageList.length,e>=i&&e<n)return t=a,!1;i=n}),t)return{docId:t.id,page:e-i,pptUrl:u.animation?t.pptUrl:null,pageList:t.pageList}}t.PAGE_CHANGE_STATUS_TRIGGER="trigger",t.PAGE_CHANGE_STATUS_RETURN="return",t.init=function(e){t.clear(),l.quality=o.DOC_QUALITY_LOW,l.fit=a(s.get("bjy_doc_image_fit"),e.defaultFitType)},t.clear=function(){c=[]},t.isWhiteboardDoc=function(e){return"0"===e},t.add=function(e){e&&($.isArray(e)||(e=[e]),$.merge(c,e))},t.update=function(e,t){var n=p(e);n&&(n.extra=Yox.object.extend(n.extra,t))},t.remove=function(e){var t=-1;return $.each(c,function(n,i){i.id===e&&(t=n)}),t>=0&&c.splice(t,1)[0]},t.getQuality=function(){return l.quality},t.setQuality=function(e){l.quality=e},t.getFit=function(){return l.fit},t.setFit=function(e){l.fit=e,s.set("bjy_doc_image_fit",e)},t.getWhiteboardPageCount=function(){var e=0;return $.each(t.getWhiteboardList(),function(t,n){e+=n.pageList.length}),e},t.getWhiteboardDocCount=function(){return t.isWhiteboardDoc(c[0]&&c[0].id)?1:0},t.getDocumentCount=function(){var e=0;return $.each(t.getDocumentList(),function(t,n){e+=n.pageList.length}),e},t.all=function(){return c.slice()},t.getWhiteboardList=function(){return c.slice(0,t.getWhiteboardDocCount())},t.getDocumentList=function(){return c.slice(t.getWhiteboardDocCount())},t.getPageInfoByPage=function(e){var n=h(e);return n&&t.getPageInfoByDoc(n.docId,n.page)},t.getDocumentById=p,t.getPageInfoByDoc=function(e,t){var n=p(e);return n&&n.pageList[t]},t.getRemarkInfoByDoc=function(e,t){var n=p(e);return n&&n.remarkInfo&&n.remarkInfo[t]||""},t.getSimplePage=function(e,t){return function(e,t){var n={page:-1};return $.each(c,function(i,r){if(r.id==e)return n.pptUrl=u.animation?r.pptUrl:null,n.page+=t+1,!1;n.page+=r.pageList.length}),n}(e,t)},t.getComplexPage=function(e){return h(e)},t.getPageById=function(e,t){var n=p(e);if(n){var i=n.pageInfo.pageIds;if(Yox.is.array(i)){var r=Yox.array.indexOf(i,t);if(r>-1)return r}}return 0},t.getIdByPage=function(e,n){if(t.isWhiteboardDoc(e)){var i=t.getPageInfoByDoc(e,n);return i?i.pageId:-1}return n},t.getLocalPage=function(e,n){return t.isWhiteboardDoc(e)?t.getPageById(e,n):n},t.getServerPage=function(e,n){return t.isWhiteboardDoc(e)?t.getIdByPage(e,n):n},t.addPage=function(e,n){var i=p(e),a=i.pageInfo;i.pageList.push({width:a.width,height:a.height,url:a.url,pageId:n});var o=a.pageIds;o||(o=[]),o.push(n),a.pageIds=o,a.totalPages=a.totalPages+1,r.trigger(r.PAGE_ADD,{docId:e,pageId:n,page:t.getPageById(e,n)})},t.deletePage=function(e,n){var i=p(e);if(i){var a=i.pageInfo,o=i.pageList,s=t.getPageById(e,n);o.length>1&&s>-1&&(o.splice(s,1),a.pageIds&&a.pageIds.splice(s,1),a.totalPages=a.totalPages-1,r.trigger(r.PAGE_DELETE,{docId:e,pageId:n,page:s}))}},t.getTotalPages=function(){return t.getDocumentCount()+t.getWhiteboardPageCount()},t.setScale=function(e){d=e},t.setScale=function(e){d=e},t.getScale=function(){return d},t.getCanTurningPage=function(){return _},t.setCanTurningPage=function(e){e!=_&&(_=e,r.trigger(r.CAN_TURNING_PAGE_CHANGE,{canTurningPage:e}))},t.getPageChangeStatus=function(){return f},t.setPageChangeStatus=function(e){f=e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(104));void 0===(i=function(e,t){var i=n(3),a=n(276),o=n(277),s=n(26),u=n(7),c=n(69),l=n(11),d=n(148),_="bjy_camera_guid",f="bjy_assist_camera_guid",p="bjy_mic_index",h="bjy_mic_guid",g="bjy_speaker_index",E="bjy_speaker_guid",v="bjy_mic_agc",m="bjy_mic_ec",S="bjy_mic_ns",A="bjy_mic_volume",y="bjy_speaker_volume",T=!1,R=null,I=null,C="bjy_audio_repair",O={};O[l.ROLE_TYPE_TEACHER]=l.VIDEO_QUALITY_MEDIUM,O[l.ROLE_TYPE_ASSISTANT]=l.VIDEO_QUALITY_MEDIUM,O[l.ROLE_TYPE_STUDENT]=l.VIDEO_QUALITY_MEDIUM,O[l.ROLE_TYPE_GUEST]=l.VIDEO_QUALITY_MEDIUM;var b={low:{width:160,height:120,framePerSecond:15,bitrate:50},std:{width:320,height:240,framePerSecond:15,bitrate:150},high:{width:640,height:480,framePerSecond:15,bitrate:300},super:{width:960,height:720,framePerSecond:20,bitrate:600},"720p":{width:1280,height:960,framePerSecond:25,bitrate:1e3},"1080p":{width:1920,height:1440,framePerSecond:25,bitrate:2e3}},L={low:{width:160,height:90,framePerSecond:15,bitrate:50},std:{width:320,height:180,framePerSecond:15,bitrate:150},high:{width:640,height:360,framePerSecond:15,bitrate:300},super:{width:960,height:540,framePerSecond:20,bitrate:600},"720p":{width:1280,height:720,framePerSecond:25,bitrate:1e3},"1080p":{width:1920,height:1080,framePerSecond:25,bitrate:2e3}};function D(){var e,t=u.get("isShuangshi"),n={};return n.micIndex=i(c.get(p),0,"int"),n.micGuid=c.get(h),n.micCss=0,n.micAgc=i(c.get(v),t&&!s.isWebRTC()?0:1,"int"),n.micEc=i(c.get(m),1,"int"),n.micNr=i(c.get(S),0,"int"),n.audioRepair=i(c.get(C),1,"int"),n.micVolume=(0===(e=i(c.get(A),l.MIC_VOLUME_DEFAULT,"int"))&&(e=50),e),n}function N(){var e,t,n={};return n.speakerIndex=i(c.get(g),0,"int"),n.speakerGuid=c.get(E),n.speakerVolume=(e=s.isClient(u.get("user.endType"))?u.get("partner.liveClientDefaultSpeakerVolume",l.SPEAKER_VOLUME_DEFAULT):l.SPEAKER_VOLUME_DEFAULT,0==(t=i(c.get(y),e,"int"))&&(t=e),t),n}function P(e){u.set("media.cameraIndex",e)}function k(e){u.set("media.cameraGuid",e),c.set(_,e)}function w(e){u.set("media.assistCameraIndex",e)}function U(e){u.set("media.assistCameraGuid",e),c.set(f,e)}function M(e){u.set("media.micIndex",e)}function x(e){u.set("media.micGuid",e),c.set(h,e)}function V(e){u.set("media.speakerIndex",e)}function G(e){u.set("media.speakerGuid",e),c.set(E,e)}function B(e,n,i,r,a,o){var s,c,l=i();if(null==l){var d=a();s=function(e,t){if(t===d)return c=t,!1}}else s=function(e,t){if(e.guid===l)return c=t,!1};n=t.filterDeviceList(n),u.set(e,n),Yox.array.each(n,s),null!=c?(o(c),r(n[c].guid)):n.length>0?(o(0),r(n[0].guid)):(o(-1),r(-1))}t.init=function(){var e=u.get("isShuangshi"),t=u.get("user"),n={};n.cameraIndex=i(c.get("bjy_camera_index"),0,"int"),n.cameraGuid=c.get(_),s.canUseDoubleCamera()?(n.assistCameraIndex=i(c.get("bjy_assist_camera_index"),-1,"int"),n.assistCameraGuid=c.get(f)):n.assistCameraIndex=-1;var r=O[t.type];e&&(r=s.isTeacher(t.type)?s.canUse1080pHigh()?l.VIDEO_QUALITY_1080P_HIGH:l.VIDEO_QUALITY_1080P:s.canUse720pHigh()?l.VIDEO_QUALITY_720P_HIGH:l.VIDEO_QUALITY_720P),n.cameraQuality=i(c.get("bjy_camera_quality"),r,"int"),n.assistCameraQuality=i(c.get("bjy_assist_camera_quality"),O[t.type],"int"),n.cameraRatio=i(c.get("bjy_camera_ratio"),-1,"int"),n.cameraRatio<0&&(n.cameraRatio=l.CAMERA_RATIO_16_9),n.assistCameraRatio=i(c.get("bjy_assist_camera_ratio"),l.CAMERA_RATIO_4_3,"int"),$.extend(!0,n,D()),$.extend(!0,n,N()),n.beautifyDenoise=i(c.get("bjy_beautify_denoise"),0,"int"),n.shareTarget=i(c.get("bjy_share_target"),l.SHARE_TARGET_MAIN,"int"),n.cameraCrop=i(c.get("bjy_camera_crop"),1,"int"),n.cameraHorizontalFlip=i(c.get("bjy_camera_horizontal_flip"),0,"int"),n.cameraVerticalFlip=i(c.get("bjy_camera_vertical_flip"),0,"int"),n.usePopUpMediaPlayer=d.smallCourse(),u.set("media",n)},t.getSpeakerVolume=function(){return u.get("media.speakerVolume",l.SPEAKER_VOLUME_DEFAULT)},t.setSpeakerVolume=function(e){e=i(e),u.set("media.speakerVolume",e),c.set(y,e)},t.getMicVolume=function(){return u.get("media.micVolume",l.MIC_VOLUME_DEFAULT)},t.setMicVolume=function(e){e=i(e),u.set("media.micVolume",e),c.set(A,e)},t.getMicScaling=function(){return u.get("media.micScaling")},t.setMicScaling=function(e){e=i(e),u.set("media.micScaling",e)},t.getMicAgc=function(){return u.get("media.micAgc")},t.setMicAgc=function(e){e=0==e?0:1,u.set("media.micAgc",e),c.set(v,e)},t.getMicEc=function(){return u.get("media.micEc")},t.setMicEc=function(e){e=0==e?0:1,u.set("media.micEc",e),c.set(m,e)},t.getMicNr=function(){return u.get("media.micNr")},t.setMicNr=function(e){e=0==e?0:1,u.set("media.micNr",e),c.set(S,e)},t.getMicCss=function(){return 0==u.get("media.micCss")?0:1},t.setMicCss=function(e){e=0==e?0:1,u.set("media.micCss",e),c.set("bjy_mic_css",e)},t.getCameraQuality=function(){return u.get("media.cameraQuality")},t.setCameraQuality=function(e){e=i(e),u.set("media.cameraQuality",e),c.set("bjy_camera_quality",e)},t.getAdjustCameraQuality=function(e,t){return a(e,t,s.canUseSuper(),s.canUse720p(),s.canUse720pHigh(),s.canUse1080p(),s.canUse1080pHigh(),s.canUse4k())},t.downGradeCameraQuality=function(){var e=t.getCameraQuality();if(e!==l.VIDEO_QUALITY_LOW){var n=e-1;8===e&&(n=4),5===e&&(n=8);var i=t.getAdjustCameraQuality(t.getCameraIndex(),n);t.setCameraQuality(i)}},t.getAssistCameraQuality=function(){return u.get("media.assistCameraQuality")},t.setAssistCameraQuality=function(e){e=i(e),u.set("media.assistCameraQuality",e),c.set("bjy_assist_camera_quality",e)},t.downGradeAssistCameraQuality=function(){var e=t.getAssistCameraQuality();if(e!==l.VIDEO_QUALITY_LOW){var n=e-1;8===e&&(n=4),5===e&&(n=8);var i=t.getAdjustCameraQuality(t.getAssistCameraIndex(),n);t.setAssistCameraQuality(i)}},t.getBeautifyDenoise=function(){return u.get("media.beautifyDenoise")},t.setBeautifyDenoise=function(e){e=0==e?0:1,u.set("media.beautifyDenoise",e),c.set("bjy_beautify_denoise",e)},t.filterDeviceList=function(e){return $.grep(e,function(e){return""!==$.trim(e.name)})},t.getCameraList=function(){return u.get("media.cameraList")||[]},t.getAvaliableVirtualCameraList=function(){var e=u.get("workableVirtualCameraMap",{}),t=[];return Yox.object.each(e,function(e,n){t.push(e)}),t},t.getMainCameraList=function(){var e=Yox.object.copy(t.getCameraList()),n=t.getAssistCameraIndex(),i=s.isWebRTC()&&d.smallCourse();return~n&&!i&&e.splice(n,1),e},t.getAssistCameraList=function(){var e=Yox.object.copy(t.getCameraList()),n=t.getCameraIndex(),i=s.isWebRTC()&&d.smallCourse();return~n&&!i&&e.splice(n,1),e},t.setCameraList=function(e){if(B("media.cameraList",e,t.getCameraGuid,k,t.getCameraIndex,P),s.canUseDoubleCamera()){var n=t.getCameraIndex(),i=t.getAssistCameraIndex();i!==n&&e[i]?(w(i),U(e[i].guid)):e.length>1?s.isWebRTC()&&e[i]||Yox.array.each(e,function(e,t){if(t!==n)return w(t),U(e.guid),!1}):(w(-1),U(-1))}var r=t.getAdjustCameraQuality(t.getCameraIndex(),t.getCameraQuality());t.setCameraQuality(r)},t.getMicList=function(){return u.get("media.micList")||[]},t.getMicName=function(){var e,n=t.getMicList();return Yox.array.each(n,function(n,i){if(n.guid==t.getMicGuid())return e=n.name,!1}),e},t.setMicList=function(e){B("media.micList",e,t.getMicGuid,x,t.getMicIndex,M)},t.getSpeakerList=function(){return u.get("media.speakerList")||[]},t.getSpeakerMuteStatus=function(){return u.get("media.speakerMuted",!1)},t.setSpeakerMuteStatus=function(e){return u.set("media.speakerMuted",e)},t.getSpeakerName=function(){var e,n=t.getSpeakerList();return Yox.array.each(n,function(n,i){if(n.guid==t.getSpeakerGuid())return e=n.name,!1}),e},t.setSpeakerList=function(e){B("media.speakerList",e,t.getSpeakerGuid,G,t.getSpeakerIndex,V)},t.getCameraIndex=function(){return u.get("media.cameraIndex")||0},t.setCameraIndex=function(e){var n=t.getCameraList();"number"===$.type(e)&&n[e]&&(P(e),k(n[e].guid))},t.getAssistCameraIndex=function(){return i(u.get("media.assistCameraIndex"),-1,"int")},t.setAssistCameraIndex=function(e){var n=t.getCameraList();"number"===$.type(e)&&(w(e),n[e]?U(n[e].guid):U(-1))},t.getCameraGuid=function(){return u.get("media.cameraGuid")},t.setCameraGuid=function(e){var n;Yox.array.each(t.getCameraList(),function(t,i){if(t.guid===e)return n=i,!1}),null!=n&&(k(e),P(n))},t.getAssistCameraGuid=function(){return u.get("media.assistCameraGuid")},t.setAssistCameraGuid=function(e){var n;Yox.array.each(t.getCameraList(),function(t,i){if(t.guid===e)return n=i,!1}),null!=n?(U(e),w(n)):(U(-1),w(-1))},t.getMicIndex=function(){return u.get("media.micIndex")||0},t.setMicIndex=function(e){var n=t.getMicList();"number"===$.type(e)&&n[e]&&(M(e),x(n[e].guid))},t.getMicGuid=function(){return u.get("media.micGuid")},t.setMicGuid=function(e){var n;Yox.array.each(t.getMicList(),function(t,i){if(t.guid===e)return n=i,!1}),null!=n&&(x(e),M(n))},t.getSpeakerIndex=function(){return u.get("media.speakerIndex")||0},t.setSpeakerIndex=function(e){var n=t.getSpeakerList();"number"===$.type(e)&&n[e]&&(V(e),G(n[e].guid))},t.getSpeakerGuid=function(){return u.get("media.speakerGuid")},t.setSpeakerGuid=function(e){var n;Yox.array.each(t.getSpeakerList(),function(t,i){if(t.guid===e)return n=i,!1}),null!=n&&(G(e),V(n))},t.getAudioRepair=function(){return u.get("media.audioRepair")||1},t.setAudioRepair=function(e){e=i(e),u.set("media.audioRepair",e),c.set(C,e)},t.getDtDefinition=function(){var e=o(u.get("partner.doubleTeacherLiveDefinition"));return(0,r.default)(e).length||(e=L),e},t.getAudioBitrate=function(e){var n=64;if(u.get("isShuangshi")){var i=l.CAMERA_QUALITY_MAP[e],r=t.getDtDefinition()[i];r&&(n=r.audioBitrate)}return n},t.getDefinitions=function(e){e=null==e?l.CAMERA_RATIO_16_9:e;var n=u.get("partner.liveDefinition")||{},i={};return s.isWebRTC()&&d.shuangshi()?i=t.getDtDefinition():e===l.CAMERA_RATIO_16_9?i=n[169]||L:e===l.CAMERA_RATIO_4_3&&(i=n[43]||b),i},t.getCameraConfig=function(e,n,i){var r=(t.getDefinitions(n,i)||{})[l.CAMERA_QUALITY_MAP[e]];if(!r)return{};var a=r.bitrate;return u.get("class.webrtcType")===l.WEBRTC_TYPE_BJY&&BJY&&BJY.browser.chrome&&BJY.browser.version.split(".")[0]>=75&&(a+=t.getAudioBitrate(e)),{cameraWidth:r.width,cameraHeight:r.height,cameraFps:r.framePerSecond,cameraBandwidth:a,cameraKeyframeInterval:r.keyframeInterval||2*r.framePerSecond,cameraCrop:t.getCameraCrop(),cameraHorizontalFlip:t.getCameraHorizontalFlip(),cameraVerticalFlip:t.getCameraVerticalFlip()}},t.getExtraStreamQuality=function(e){e=null==e?t.getCameraQuality():e;var n=u.get("partner.livePushExtraStream")||{super:["std"],"720p":["high"],"1080p":["super"]},i=l.CAMERA_QUALITY_MAP,r=n[i[e]],a=-1;return r&&$.each(i,function(e,t){if(r[0]===t)return a=e,!1}),a},t.getCameraRatio=function(){return u.get("media.cameraRatio")},t.setCameraRatio=function(e){e=i(e),u.set("media.cameraRatio",e),c.set("bjy_camera_ratio",e)},t.getAssistCameraRatio=function(){return u.get("media.assistCameraRatio")},t.setAssistCameraRatio=function(e){e=i(e),u.set("media.assistCameraRatio",e),c.set("bjy_assist_camera_ratio",e)},t.getCameraCrop=function(){return u.get("media.cameraCrop")},t.setCameraCrop=function(e){e=i(e),u.set("media.cameraCrop",e),c.set("bjy_camera_crop",e)},t.getCameraHorizontalFlip=function(){var e=u.get("media.cameraHorizontalFlip");return null==e&&(e=c.get("bjy_camera_horizontal_flip")),e},t.setCameraHorizontalFlip=function(e){u.set("media.cameraHorizontalFlip",e),c.set("bjy_camera_horizontal_flip",e)},t.getCameraVerticalFlip=function(){var e=u.get("media.cameraVerticalFlip");return null==e&&(e=c.get("bjy_camera_vertical_flip")),e},t.setCameraVerticalFlip=function(e){u.set("media.cameraVerticalFlip",e),c.set("bjy_camera_vertical_flip",e)},t.getShareTarget=function(){return u.get("media.shareTarget")},t.setShareTarget=function(e){e=i(e),u.set("media.shareTarget",e),c.set("bjy_share_target",e)},t.getAgoraAssistCameraProfile=function(){},t.getAgoraScreenShareProfile=function(){return u.get("partner.agoraScreenShareProfile")},t.getIsSharingScreenWhenOffline=function(){return T},t.setIsSharingScreenWhenOffline=function(e){T=e},t.getSharingScreenStreamForOffline=function(){return R},t.setSharingScreenStreamForOffline=function(e){R=e},t.getSharingScreenParamsForCef=function(){return I},t.setSharingScreenParamsForCef=function(e){I=e},t.getWebrtcMediaFileStreamConfig=function(){return d.shuangshi()?{frameRate:u.get("partner.liveWebrtcMediaStreamFps",25),bandwidth:u.get("partner.liveWebrtcMediaStreamBitrate",2e3)}:{frameRate:u.get("partner.smallCourseMediaStreamFps",15),bandwidth:u.get("partner.smallCourseMediaStreamBitrate",1e3)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e,t,n,i){var r;return function(){var a=this,o=arguments,s=function(){r=null,n&&!i||e.apply(a,o)},u=n&&!r;clearTimeout(r),r=setTimeout(s,t),u&&e.apply(a,o)}}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i=n(6),r=n(32),a=n(15),o=n(105),s="["+o+"]",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),l=function(e,t,n){var r={},s=a(function(){return!!o[e]()||"​"!="​"[e]()}),u=r[e]=s?t(d):o[e];n&&(r[n]=u),i(i.P+i.F*s,"String",r)},d=l.trim=function(e,t){return e=String(r(e)),1&t&&(e=e.replace(u,"")),2&t&&(e=e.replace(c,"")),e};e.exports=l},function(e,t,n){var i=n(16),r=n(42),a=n(61)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),i(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(){return void 0!==window.WebSocket}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(){var e,t=navigator.plugins;if(t&&t.length>0)e=t["Shockwave Flash"];else if(document.all)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){}return!!e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(){var e=document.createElement("canvas");return!(!e||!e.getContext)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(){return"placeholder"in $('<input type="text" />')[0]}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(){return"oninput"in $('<input type="text" />')[0]}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(7),r=n(11),a=n(132);t.overClassTime=function(){return i.get("class.endTime")&&a.timeAfterEndTime()>=15*r.MINUTE},t.smallCourse=function(){return i.get("class.type")===r.CLASS_TYPE_SMALLCOURSE},t.shuangshi=function(){return i.get("class.type")===r.CLASS_TYPE_SHUANGSHI},t.mediaAssistCamera=function(e){return e===i.get("user.id2")||+e>100},t.mediaFile=function(e){return e===r.MEDIA_TYPE_FILE},t.mediaMainScreenShare=function(e){return e===r.MEDIA_TYPE_MAIN_SCREEN_SHARE},t.mediaAssistScreenShare=function(e){return e===r.MEDIA_TYPE_ASSIST_SCREEN_SHARE},t.mediaPopupScreenShare=function(e){return-1!==i.get("roleListUsePopupScreenShare",[]).indexOf(e&&e.type)},t.mediaPopupMediaPlayer=function(){return i.get("media.usePopUpMediaPlayer",!1)},t.isUserScreenSharing=function(e){return!(!e||!(e.mediaExtMap&&e.mediaExtMap[r.MEDIA_TYPE_MAIN_SCREEN_SHARE]&&e.mediaExtMap[r.MEDIA_TYPE_MAIN_SCREEN_SHARE].videoOn||e.isScreenSharing))},t.isUserAssistScreenSharing=function(e){return!!(e&&e.mediaExtMap&&(e.mediaExtMap[r.MEDIA_TYPE_ASSIST_SCREEN_SHARE]&&e.mediaExtMap[r.MEDIA_TYPE_ASSIST_SCREEN_SHARE].videoOn||e.mediaExtMap[e.id2]&&e.mediaExtMap[e.id2].isScreenSharing))},t.isUserMediaFile=function(e){return!!(e&&e.mediaExtMap&&e.mediaExtMap[r.MEDIA_TYPE_FILE]&&e.mediaExtMap[r.MEDIA_TYPE_FILE].videoOn)},t.isBJYWebRTC=function(){return i.get("class.webrtcType")===r.WEBRTC_TYPE_BJY},t.isAGORAWebRTC=function(){return i.get("class.webrtcType")===r.WEBRTC_TYPE_AGORA}}.call(t,n,t,e))||(e.exports=i)},,,,,,function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";function i(e){$.extend(this,e),this.init()}var r=i.prototype;return r.init=function(){this.list=[]},r.add=function(e){var t=this,n=t.list;if(n.push(e),!$.isFunction(t.waiting)){var i=function(){t.waiting=null,r()},r=function(){if(t.list){var e=n.shift();e&&(t.waiting=i,t.task(e,i))}};r()}},r.size=function(){return this.list.length},r.clear=function(){this.list.length=0},r.dispose=function(){this.list=this.waiting=null},i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(66);function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),i(e,r.key,r)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(58),a=n(192);return function(e,t,n){if(e=a(e)){var i=[r(e.hour),r(e.minute)];return t&&i.push(r(e.second)),i.join(n||":")}return""}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(41),r=n(13)("toStringTag"),a="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),r))?n:a?i(t):"Object"==(o=i(t))&&"function"==typeof t.callee?"Arguments":o}},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(){return BJY.browser.wechat?BJY.Player.flash:BJY.auth.isWebRTC()?BJY.Player.webrtc:"function"==typeof window.cefQuery?BJY.cef:BJY.Player.flash}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(6),r=n(1),a=n(15);e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],o={};o[e]=t(n),i(i.S+i.F*a(function(){n(1)}),"Object",o)}},,function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(59),a=n(60);return function(e,t){var n=Math.max(r(e),r(t));return(e=a(e,n))/(t=a(t,n))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i=n(37);function r(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i}),this.resolve=i(t),this.reject=i(n)}e.exports.f=function(e){return new r(e)}},function(e,t,n){var i=n(54),r=n(32);e.exports=function(e){return function(t,n){var a,o,s=String(r(t)),u=i(n),c=s.length;return u<0||u>=c?e?"":void 0:(a=s.charCodeAt(u))<55296||a>56319||u+1===c||(o=s.charCodeAt(u+1))<56320||o>57343?e?s.charAt(u):a:e?s.slice(u,u+2):o-56320+(a-55296<<10)+65536}}},function(e,t,n){"use strict";var i=n(84),r=n(30),a=n(56),o={};n(17)(o,n(13)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(o,{next:r(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var i=n(14),r=n(18),a=n(40);e.exports=n(9)?Object.defineProperties:function(e,t){r(e);for(var n,o=a(t),s=o.length,u=0;s>u;)i.f(e,n=o[u++],t[n]);return e}},function(e,t,n){"use strict";var i=n(167),r=n(136),a=n(49),o=n(22);e.exports=n(90)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),a.Arguments=a.Array,i("keys"),i("values"),i("entries")},function(e,t){e.exports=function(){}},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var n={};t.PAGE_OPEN="page_open",t.CLIENT_INIT_SUCCESS="client_init_success",t.MASTER_SERVER_CONNECT_SUCCESS="master_server_connect_success",t.SERVER_INFO_FETCH_SUCCESS="server_info_fetch_success",t.ROOM_SERVER_CONNECT_SUCCESS="room_server_connect_success",t.ROOM_SERVER_LOGIN_SUCCESS="room_server_login_success",t.init=function(){var e;n&&(e=n[t.PAGE_OPEN]),n={},e&&(n[t.PAGE_OPEN]=e)},t.add=function(e){n[e]=$.now()},t.get=function(e){return n[e]},t.elapse=function(e,t){var i=n[e],r=n[t];if("number"===$.type(i)&&"number"===$.type(r)&&r>i)return r-i}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=["\n"],r=null,a=n(156),o=n(118);function s(){if(o()){var e=BJY.cef;e&&e.writeCNELog(i.join("\n\n"))}}t.init=function(){var e=BJY.eventEmitter;e.on(e.CLASSROOM_EXIT_START,function(){s()}).on(e.WRITE_CNE_LOG,function(e,n){t.write(n.info)})},t.write=function(e){i.push(a(new Date,!0)+" "+e),r||(r=setTimeout(function(){s(),i=["\n\n"],r=null},6e4))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t,i){var a,o=n(7),s=n(11),u=n(5),c=n(168),l=n(70),d=n(234),_=n(198),f=n(229),p=n(75),h=n(31),g=n(196),E=p.parseQuery(location.search),v=3,m=[],S=[],A=!1;t.request=function(e,n){if(o.get("offline"))m.push({data:e,url:n});else{var i=e||{},r="test"==e.env?o.get("env")+"-":"",a=location.protocol+"//"+r+"click.baijiayun.com/video/info",s=(n=n||a)+(~n.indexOf("?")?"&":"?")+$.param(i),u=new Image,c=S.push(u)-1,l=function(){u=u.onload=u.onerror=null,delete S[c]};u.onload=l,u.onerror=function(){l(),setTimeout(function(){t.request(e,n)},1e3)},u.src=s}};var y={};y[s.END_TYPE_PC_CLIENT]=1,y[s.END_TYPE_PC_BROWSER]=2,y[s.END_TYPE_MOBILE_APPLE]=3,y[s.END_TYPE_MOBILE_ANDROID]=3,y[s.END_TYPE_MOBILE_BROWSER]=4,y[s.END_TYPE_MAC_CLIENT]=5;var T,R,I={ie:1,chrome:2,firefox:3,opera:4,safari:5};function C(){var e,t=o.get("presenterId")||o.get("teacher.id");if(BJY.Player&&(e=BJY.Player.instances[t])&&!e.isPush()&&(e.videoOn||e.audioOn))return e}function O(){if(R){var e={info_type:v},n=C();if(n){e.use_udp=n.linkType!==s.LINK_TYPE_UDP?0:1,e.av_type0=n.videoOn?t.AV_TYPE_VIDEO:t.AV_TYPE_AUDIO,e.watch_number0=n.user.number,e.watch_user_type0=n.user.type;var i=n.getDownlinkServer();if(i){var r=i.originIp?i.originIp:i.ip;e.ls0=r+":"+i.port}}t.send(e)}}t.LINK_TYPE_UP=0,t.LINK_TYPE_DOWN=1,t.AV_TYPE_AUDIO=0,t.AV_TYPE_VIDEO=1,t.AV_TYPE_OFF=2,t.sendToAliyun=function(e){a||(a=BJY.loggerManager.create({prefix:"click",output:{server:!0}})),a(e,{output:{aliServer:!0}})},t.send=function(e){if(!(A||o.get("playback")||o.get("user.status"))){e.env=o.get("env"),e.class_id=o.get("class.id"),e.class_type=o.get("class.type");var n=o.get("user");e.bjy=1,e.user_id=n.id,e.user_number=n.number,e.user_name=n.name,e.user_type=n.type,e.client_ip=n.ip,e.client_type=y[n.endType],e.browser_type=I[g.name],e.platform=f.ios?"ios":f.name,e.fe_version=BJY.version,e.cef_version=o.get("cefApiVersion"),e.app_version=o.get("appVersion");var i=o.get("partner.partnerId");e.partner_id=i||s.GSX_PARTNER_ID,o.get("machineCode")&&(e.device_unique=o.get("machineCode")),e.cdn=0,E.net&&(e.network=E.net.toUpperCase());var r=C();if(r){var u=r.getDownlinkServer();u&&u.ip&&0===u.ip.indexOf("push")&&(e.cdn=1,e.cdn_tag=u.ip.slice(4,6))}e.time=$.now(),$.each(e,function(t,n){null==n&&(e[t]="")}),a||(a=BJY.loggerManager.create({prefix:"click",output:{server:!0}})),a(e),t.request(e)}},t.jsonStringifyReplacer=function(e,t){if(t&&-1==t.constructor.toString().indexOf("native code")){if(t.user){var n=$.extend(!0,{},t.user);return n.webrtcInfo="webrtcInfo was ignored",(0,r.default)({id:t.id,user:n})}return"[user define object]"}return"webrtc_info"===e?"webrtcInfo too long, ignored":t},t.init=function(){var e,n,i,r=function(){var i,a=l.getActiveMasterServer(),u=l.getActiveRoomServer();if(o.get("class.loginTime")){var f=d;o.get("class.uplinkType")===s.LINK_TYPE_UDP&&(f=_),f.getActiveUplinkServer&&(i=f.getActiveUplinkServer())}i||(i={}),setTimeout(function(){t.send({info_type:1,status:e?0:1,user_type:o.get("user.type"),user_name:o.get("user.name"),time_page_open:c.get(c.PAGE_OPEN),time_client_ready:c.get(c.CLIENT_INIT_SUCCESS),time_ms_connect:c.get(c.MASTER_SERVER_CONNECT_SUCCESS),time_ms_res:c.get(c.SERVER_INFO_FETCH_SUCCESS),time_rs_connect:c.get(c.ROOM_SERVER_CONNECT_SUCCESS),time_rs_login:c.get(c.ROOM_SERVER_LOGIN_SUCCESS),time_enter:c.get(c.ROOM_SERVER_LOGIN_SUCCESS),ms:a.ip+":"+a.port,rs:u.ip+":"+u.port,ls:i.ip+":"+i.port,cs:n||""}),r=$.noop},5e3)};(T=new h({task:function(){O(),t.extendTask&&t.extendTask()},interval:30*s.SECOND})).start(),u.on(u.ROOM_SERVER_OFFLINE,function(){i&&clearTimeout(i),t.sendToAliyun({content:"offline"}),i=setTimeout(function(){i=null,"hidden"!==document.visibilityState&&t.send({info_type:10})},3e3)}).on(u.CLASSROOM_CONNECT_SUCCESS,function(n,a){i&&(clearTimeout(i),i=null);for(var s,u=0;s=m[u++];)t.request(s.data,s.url);m=[],a.reconnect||(e=!0,r(),o.watch("class.started",function(e){R=e,O()},!0))}).one(u.CLASSROOM_CONNECT_TIMEOUT,function(){r()}).on(u.CHAT_SERVER_CONNECT_SUCCESS,function(e,t){n=t.server.ip+":"+t.server.port}).on(u.CLASSROOM_EXIT_END,function(){t.send({info_type:2}),T.stop(),A=!0}).on(u.CLASSROOM_CONNECT_FAIL,function(){e&&t.send({info_type:10,reconnect_status:1})})}}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){"use strict";var i,r=n(0)(n(88));void 0===(i=function(e,t,n){return function(e,t,n,i,a,o,s,u,c){var l=BJY.auth,d=BJY.store,_=BJY.config,f=BJY.data.media;"object"===(0,r.default)(e)&&null!=e||(e={});var p=f.getCameraList()[t],h=[];return p&&p.virtual&&(p=d.get("virtualMainCamera")),l.isWebRTC()&&d.get("isShuangshi")||(l.canUseLow()&&h.push({text:e.VIDEO_QUALITY_LOW,value:_.VIDEO_QUALITY_LOW}),l.canUseStd()&&h.push({text:e.VIDEO_QUALITY_MEDIUM,value:_.VIDEO_QUALITY_MEDIUM}),l.canUseHigh()&&h.push({text:e.VIDEO_QUALITY_HIGH,value:_.VIDEO_QUALITY_HIGH}),n&&(c||!p||!1!==p.supportSuper)&&h.push({text:e.VIDEO_QUALITY_SUPER,value:_.VIDEO_QUALITY_SUPER})),i&&(!c&&p&&!1===p.support720p||h.push({text:e.VIDEO_QUALITY_720P,value:_.VIDEO_QUALITY_720P})),a&&(!c&&p&&!1===p.support720pHigh||h.push({text:e.VIDEO_QUALITY_720P_HIGH,value:_.VIDEO_QUALITY_720P_HIGH})),o&&(!c&&p&&!1===p.support1080p||h.push({text:e.VIDEO_QUALITY_1080P,value:_.VIDEO_QUALITY_1080P})),s&&(!c&&p&&!1===p.support1080pHigh||h.push({text:e.VIDEO_QUALITY_1080P_HIGH,value:_.VIDEO_QUALITY_1080P_HIGH})),u&&(!c&&p&&!1===p.support4K||h.push({text:e.VIDEO_QUALITY_4K,value:_.VIDEO_QUALITY_4K})),h}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){e.exports=n(322)},function(e,t,n){var i=n(131);function r(e,t,n,r,a,o,s){try{var u=e[o](s),c=u.value}catch(e){return void n(e)}u.done?t(c):i.resolve(c).then(r,a)}e.exports=function(e){return function(){var t=this,n=arguments;return new i(function(i,a){var o=e.apply(t,n);function s(e){r(o,i,a,s,u,"next",e)}function u(e){r(o,i,a,s,u,"throw",e)}s(void 0)})}}},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(59),a=n(60);return function(e,t){var n=Math.max(r(e),r(t));return((e=a(e,n))+(t=a(t,n)))/Math.pow(10,n)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(59),a=n(60);return function(e,t){var n=Math.max(r(e),r(t));return((e=a(e,n))-(t=a(t,n)))/Math.pow(10,n)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(59),a=n(60);return function(e,t){var n=Math.max(r(e),r(t));e=a(e,n),t=a(t,n);var i=Math.pow(10,n);return e*t/(i*i)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(27);t.WHEEL="cc-wheel",t.init=function(e){var t="."+r(),n="onmousewheel"in document.body?"mousewheel":"DOMMouseScroll";e.data("cc-util-wheel",t).on(n+t,function(t){var n,i=t.originalEvent,r=i.wheelDelta;n=r%120==0?-r/120:r%3==0?-r/3:i.detail%3==0?-i.detail/3:i.delta||0,t.type="cc-wheel",e.trigger(t,{delta:n})})},t.dispose=function(e){var t=e.data("cc-util-wheel");t&&e.removeData("cc-util-wheel").off(t)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return{horizontal:{axis:"x",position:"left",scrollPosition:"scrollLeft",size:"width",minSize:"minWidth",maxSize:"maxWidth",innerSize:"innerWidth",outerSize:"outerWidth",scrollSize:"scrollWidth"},vertical:{axis:"y",position:"top",scrollPosition:"scrollTop",size:"height",minSize:"minHeight",maxSize:"maxHeight",innerSize:"innerHeight",outerSize:"outerHeight",scrollSize:"scrollHeight"}}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i=n(157),r=n(13)("iterator"),a=n(49);e.exports=n(1).getIteratorMethod=function(e){if(null!=e)return e[r]||e["@@iterator"]||a[i(e)]}},function(e,t,n){e.exports=n(184)},function(e,t,n){n(89),n(110),e.exports=n(86).f("iterator")},function(e,t,n){e.exports=n(186)},function(e,t,n){n(187),n(127),n(190),n(191),e.exports=n(1).Symbol},function(e,t,n){"use strict";var i=n(2),r=n(16),a=n(9),o=n(6),s=n(114),u=n(133).KEY,c=n(15),l=n(62),d=n(56),_=n(50),f=n(13),p=n(86),h=n(87),g=n(188),E=n(115),v=n(18),m=n(10),S=n(42),A=n(22),y=n(39),T=n(30),R=n(84),I=n(189),C=n(135),O=n(83),b=n(14),L=n(40),D=C.f,N=b.f,P=I.f,k=i.Symbol,w=i.JSON,U=w&&w.stringify,M=f("_hidden"),x=f("toPrimitive"),V={}.propertyIsEnumerable,G=l("symbol-registry"),B=l("symbols"),H=l("op-symbols"),Y=Object.prototype,F="function"==typeof k&&!!O.f,j=i.QObject,W=!j||!j.prototype||!j.prototype.findChild,K=a&&c(function(){return 7!=R(N({},"a",{get:function(){return N(this,"a",{value:7}).a}})).a})?function(e,t,n){var i=D(Y,t);i&&delete Y[t],N(e,t,n),i&&e!==Y&&N(Y,t,i)}:N,$=function(e){var t=B[e]=R(k.prototype);return t._k=e,t},J=F&&"symbol"==typeof k.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof k},Q=function(e,t,n){return e===Y&&Q(H,t,n),v(e),t=y(t,!0),v(n),r(B,t)?(n.enumerable?(r(e,M)&&e[M][t]&&(e[M][t]=!1),n=R(n,{enumerable:T(0,!1)})):(r(e,M)||N(e,M,T(1,{})),e[M][t]=!0),K(e,t,n)):N(e,t,n)},z=function(e,t){v(e);for(var n,i=g(t=A(t)),r=0,a=i.length;a>r;)Q(e,n=i[r++],t[n]);return e},q=function(e){var t=V.call(this,e=y(e,!0));return!(this===Y&&r(B,e)&&!r(H,e))&&(!(t||!r(this,e)||!r(B,e)||r(this,M)&&this[M][e])||t)},X=function(e,t){if(e=A(e),t=y(t,!0),e!==Y||!r(B,t)||r(H,t)){var n=D(e,t);return!n||!r(B,t)||r(e,M)&&e[M][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=P(A(e)),i=[],a=0;n.length>a;)r(B,t=n[a++])||t==M||t==u||i.push(t);return i},ee=function(e){for(var t,n=e===Y,i=P(n?H:A(e)),a=[],o=0;i.length>o;)!r(B,t=i[o++])||n&&!r(Y,t)||a.push(B[t]);return a};F||(s((k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var e=_(arguments.length>0?arguments[0]:void 0),t=function(n){this===Y&&t.call(H,n),r(this,M)&&r(this[M],e)&&(this[M][e]=!1),K(this,e,T(1,n))};return a&&W&&K(Y,e,{configurable:!0,set:t}),$(e)}).prototype,"toString",function(){return this._k}),C.f=X,b.f=Q,n(126).f=I.f=Z,n(65).f=q,O.f=ee,a&&!n(35)&&s(Y,"propertyIsEnumerable",q,!0),p.f=function(e){return $(f(e))}),o(o.G+o.W+o.F*!F,{Symbol:k});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)f(te[ne++]);for(var ie=L(f.store),re=0;ie.length>re;)h(ie[re++]);o(o.S+o.F*!F,"Symbol",{for:function(e){return r(G,e+="")?G[e]:G[e]=k(e)},keyFor:function(e){if(!J(e))throw TypeError(e+" is not a symbol!");for(var t in G)if(G[t]===e)return t},useSetter:function(){W=!0},useSimple:function(){W=!1}}),o(o.S+o.F*!F,"Object",{create:function(e,t){return void 0===t?R(e):z(R(e),t)},defineProperty:Q,defineProperties:z,getOwnPropertyDescriptor:X,getOwnPropertyNames:Z,getOwnPropertySymbols:ee});var ae=c(function(){O.f(1)});o(o.S+o.F*ae,"Object",{getOwnPropertySymbols:function(e){return O.f(S(e))}}),w&&o(o.S+o.F*(!F||c(function(){var e=k();return"[null]"!=U([e])||"{}"!=U({a:e})||"{}"!=U(Object(e))})),"JSON",{stringify:function(e){for(var t,n,i=[e],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=t=i[1],(m(t)||void 0!==e)&&!J(e))return E(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!J(t))return t}),i[1]=t,U.apply(w,i)}}),k.prototype[x]||n(17)(k.prototype,x,k.prototype.valueOf),d(k,"Symbol"),d(Math,"Math",!0),d(i.JSON,"JSON",!0)},function(e,t,n){var i=n(40),r=n(83),a=n(65);e.exports=function(e){var t=i(e),n=r.f;if(n)for(var o,s=n(e),u=a.f,c=0;s.length>c;)u.call(e,o=s[c++])&&t.push(o);return t}},function(e,t,n){var i=n(22),r=n(126).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?function(e){try{return r(e)}catch(e){return o.slice()}}(e):r(i(e))}},function(e,t,n){n(87)("asyncIterator")},function(e,t,n){n(87)("observable")},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e){if(e)return"number"===$.type(e)&&(e=new Date(e)),{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds()}}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var i=n(17);e.exports=function(e,t,n){for(var r in t)n&&e[r]?e[r]=t[r]:i(e,r,t[r]);return e}},,function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";var i=[["alipay",/alipay/],["wechat",/micromessenger/],["baiduApp",/baiduboxapp/],["baidu",/baidubrowser/],["baidu",/bdbrowser/],["uc",/ucbrowser/],["uc",/ucweb/],["qq",/qqbrowser/],["qqApp",/qq/],["ie",/iemobile[ \/]([\d_.]+)/],["ie",/msie[ \/]([\d_.]+)/],["ie",/trident[ \/]([\d_.]+)/,4],["edge",/edge[ \/]([\d_.]+)/],["chrome",/chrome[ \/]([\d_.]+)/],["firefox",/firefox[ \/]([\d_.]+)/],["opera",/opera(?:.*version)?[ \/]([\d_.]+)/],["safari",/version[ \/]([\d_.]+) safari/],["safari",/safari/]];var r,a,o,s=(r=navigator.userAgent.toLowerCase(),$.each(i,function(e,t){var n=t[1].exec(r);if(n)return a=t[0],(o=n[1])&&(o=o.replace(/_/g,"."),t[2]&&(o=parseInt(o,10)+t[2]+".0")),!1}),{name:a||"",version:o||""});return s.name&&(s[s.name]=!0),s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(168),r=n(70),a=n(7),o=n(11),s=n(5),u=n(55),c=n(231),l=n(233),d=n(401),_=n(79),f=n(403),p={mediaExt:n(404),snippet:n(405),authority:n(406),Klass:n(407),cloudRecord:n(408),doc:n(409),h5Doc:n(410),forbid:n(411),group:n(412),lottery:n(413),media:n(301),notice:n(414),page:n(415),rollCall:n(416),shape:n(417),speak:n(418),survey:n(419),user:n(420),customcast:n(421)},h={messageTypes:{},init:function(){h.socket=_.init({onSend:function(e){h.onSend(e)},onReceive:function(e){h.onReceive(e)},onOpen:function(e){var t=e.server;$.extend(h,t),i.add(i.ROOM_SERVER_CONNECT_SUCCESS),r.setActiveRoomServer(t),s.trigger(s.ROOM_SERVER_CONNECT_SUCCESS,e);var n=o.LOGIN_CONFLICT_KEY;u.get(n)||a.get("offline")||!1===a.get("needCheckUnique",!0)?(h.login(),u.remove(n)):h.login({needCheckUnique:!0})},onClose:function(e){h.endHeartbeat(),s.trigger(s.WEBSOCKET_CLOSE,this),s.trigger(s.ROOM_SERVER_OFFLINE,{type:o.ROOM_SERVER_OFFLINE_BY_SERVER,code:e.code})},onError:function(){s.trigger(s.ROOM_SERVER_CONNECT_FAIL)},onTimeout:function(){s.trigger(s.ROOM_SERVER_CONNECT_TIMEOUT)}});var e=r.getRoomServerList()[0];e.url=c(e),h.connect(e,r.getRoomProxyServerList())},connect:function(e,t){h.socket&&h.socket.connect(e,t)},onSend:function(e){s.trigger(s.WEBSOCKET_SEND,e)},send:function(e){_.send(e)},onReceive:function(e){if(e.message_type){var t=h.messageTypes[e.message_type];t&&t(e),s.trigger(s.WEBSOCKET_RECEIVE,e)}},socketSend:function(e){h.socket.send(e)},close:function(){var e=h.socket;e&&(e.close(),h.socket=null)},addExtension:function(e){$.extend(h.messageTypes,e.messageTypes),$.extend(h,e.methods)}};for(var g in p)h.addExtension(p[g]);return l.init(h,d),l.init(h,f),h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(58),r=n(132),a=n(70),o=n(237);t.uplinkServerList=[],t.downlinkServerList=[],t.activeUplinkServer=null,t.activeDownlinkServer=null,t.init=function(){t.uplinkServerList=a.getUdpUplinkServerList(),t.downlinkServerList=a.getUdpDownlinkServerList()},t.sort=t.fetch=$.noop,t.getUplinkStreamName=function(e,t){return r.getClassId()+"-"+e+i(t,3)+"1"},t.getUplinkAudioMixedStreamName=function(e,t){return r.getClassId()+"-"+e+i(t,3)+"0"},t.getUplinkStreamNamePattern=function(){return/^(\w+)-(\w+)(\d{3})[0|1]$/},t.getDownlinkStreamName=function(e,t){return r.getClassId()+"-"+e+i(t,3)+"1"},t.getDownlinkAudioMixedStreamName=function(e,t){return r.getClassId()+"-"+(+e+2)+i(t,3)+"0"},t.getDownlinkStreamNamePattern=function(){return/^(\w+)-(\w+)(\d{3})[0|1]-([\d.]+):(\d+)$/},t.getActiveUplinkServer=function(){return t.activeUplinkServer||t.uplinkServerList[0]},t.setActiveUplinkServer=function(e){t.activeUplinkServer=e},t.getActiveDownlinkServer=function(){return t.activeDownlinkServer||t.downlinkServerList[0]},t.setActiveDownlinkServer=function(e){t.activeDownlinkServer=e},t.switchUplinkServer=function(e,n){return t.setActiveUplinkServer(o(t.uplinkServerList,e,n)),t.getActiveUplinkServer()},t.switchDownlinkServer=function(e,n){return t.setActiveDownlinkServer(o(t.downlinkServerList,e,n)),t.getActiveDownlinkServer()}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e){if("string"==typeof e){var t=e.split("-");if(t&&t[1])return{lo:"Local",bj:"Beijing",sh:"Shanghai",sz:"Shenzhen",gz:"Guangzhou"}[t[1]]}return null}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t,n){var i=BJY.log,a=BJY.logger,o=BJY.loggerManager;return function(e){var t=a.getLogger(e),n=o.create({prefix:e,output:{aliServer:!0}});return function(){var a=Array.prototype.slice.call(arguments);t.apply(this,a);var o=e+(0,r.default)(a,i.jsonStringifyReplacer);n({content:o})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){n(202),e.exports=n(1).Date.now},function(e,t,n){var i=n(6);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){n(204),e.exports=n(1).parseInt},function(e,t,n){var i=n(6),r=n(205);i(i.G+i.F*(parseInt!=r),{parseInt:r})},function(e,t,n){var i=n(2).parseInt,r=n(141).trim,a=n(105),o=/^[-+]?0[xX]/;e.exports=8!==i(a+"08")||22!==i(a+"0x16")?function(e,t){var n=r(String(e),3);return i(n,t>>>0||(o.test(n)?16:10))}:i},function(e,t,n){var i=n(18),r=n(37),a=n(13)("species");e.exports=function(e,t){var n,o=i(e).constructor;return void 0===o||null==(n=i(o)[a])?t:r(n)}},function(e,t,n){var i,r,a,o=n(29),s=n(280),u=n(130),c=n(48),l=n(2),d=l.process,_=l.setImmediate,f=l.clearImmediate,p=l.MessageChannel,h=l.Dispatch,g=0,E={},v=function(){var e=+this;if(E.hasOwnProperty(e)){var t=E[e];delete E[e],t()}},m=function(e){v.call(e.data)};_&&f||(_=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return E[++g]=function(){s("function"==typeof e?e:Function(e),t)},i(g),g},f=function(e){delete E[e]},"process"==n(41)(d)?i=function(e){d.nextTick(o(v,e,1))}:h&&h.now?i=function(e){h.now(o(v,e,1))}:p?(a=(r=new p).port2,r.port1.onmessage=m,i=o(a.postMessage,a,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(i=function(e){l.postMessage(e+"","*")},l.addEventListener("message",m,!1)):i="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),v.call(e)}}:function(e){setTimeout(o(v,e,1),0)}),e.exports={set:_,clear:f}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var i=n(18),r=n(10),a=n(162);e.exports=function(e,t){if(i(e),r(t)&&t.constructor===e)return t;var n=a.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){e.exports=n(261)},function(e,t,n){n(212),e.exports=n(1).Object.keys},function(e,t,n){var i=n(42),r=n(40);n(159)("keys",function(){return function(e){return r(i(e))}})},,function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e){return e===BJY.config.END_TYPE_PC_CLIENT||e===BJY.config.END_TYPE_MAC_CLIENT}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i=Object.prototype.toString;return function(e,t){var n=[];t=t||[];var r=(e=e||[]).length;if(r>0&&r===t.length){for(;r--;)if("[object Array]"!==i.apply(e[r]))return n;for(var a=0;a<e[0].length;a++){for(var o={},s=0;s<t.length;s++)o[t[s]]=e[s][a];n.push(o)}}return n}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){n(217);var i=n(1).Object;e.exports=function(e,t,n){return i.defineProperty(e,t,n)}},function(e,t,n){var i=n(6);i(i.S+i.F*!n(9),"Object",{defineProperty:n(14).f})},function(e,t,n){n(219),e.exports=n(1).Object.assign},function(e,t,n){var i=n(6);i(i.S+i.F,"Object",{assign:n(220)})},function(e,t,n){"use strict";var i=n(9),r=n(40),a=n(83),o=n(65),s=n(42),u=n(80),c=Object.assign;e.exports=!c||n(15)(function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(e){t[e]=e}),7!=c({},e)[n]||Object.keys(c({},t)).join("")!=i})?function(e,t){for(var n=s(e),c=arguments.length,l=1,d=a.f,_=o.f;c>l;)for(var f,p=u(arguments[l++]),h=d?r(p).concat(d(p)):r(p),g=h.length,E=0;g>E;)f=h[E++],i&&!_.call(p,f)||(n[f]=p[f]);return n}:c},,,,,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var i=n(2),r=n(1),a=n(14),o=n(9),s=n(13)("species");e.exports=function(e){var t="function"==typeof r[e]?r[e]:i[e];o&&t&&!t[s]&&a.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){e.exports=n(259)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";var i=[["iphone",/iphone os ([\d_.]+)/],["ipad",/ipad; cpu os ([\d_.]+)/],["itouch",/itouch; cpu os ([\d_.]+)/],["android",/android ([\d_.]+)/],["wp",/windows phone ([\d_.]+)/],["windows",/windows nt ([\d_.]+)/],["linux",/linux/],["mac",/mac os x ([\d_.]+)/]];var r,a,o,s=(r=navigator.userAgent.toLowerCase(),$.each(i,function(e,t){var n=t[1].exec(r);if(n)return a=t[0],(o=n[1])&&(o=o.replace(/_/g,".")),!1}),{name:a||"",version:o||""});return s.name&&(s[s.name]=!0,{iphone:1,ipad:1,itouch:1}[s.name]&&(s.ios=!0)),s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(7),a=n(120),o=n(4).html;t.init=function(){var e=[];r.get("language")&&e.push(r.get("language")),a.flexbox()?(t.flex=!0,e.push("flex")):e.push("no-flex"),a.animation()?(t.animation=!0,e.push("animation")):e.push("no-animation"),a.boxShadow()?(t.boxShadow=!0,e.push("box-shadow")):e.push("no-box-shadow"),a.flash()&&(t.flash=!0),a.localStorage()&&(t.localStorage=!0),t.canvas=a.canvas(),a.webp().then(function(){t.webp=!0}),o.addClass(e.join(" ")),t.init=$.noop}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i="https:"===location.protocol;return function(e){return i?"wss://"+(e.wssIp||e.ip)+":"+(e.wssPort||e.port):"ws://"+e.ip+":"+e.port}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(196),a=n(169),o=n(69),s="true"===o.get("enable_console_log");function u(e,t,n){var i=[];r.ie||r.edge?i.push(e[0]):i.push("%c"+e[0],"color:"+t+";background-color:"+n+";padding: 2px 4px;"),Yox.array.push(i,Yox.array.toArray(e).slice(1));try{s&&console.log.apply(console,i),a.write("logger: "+Yox.array.toArray(e).join(" "))}catch(e){}}t.primary=function(){u(arguments,"#004085","#cce5ff")},t.secondary=function(){u(arguments,"#464a4e","#e7e8ea")},t.success=function(){u(arguments,"#155724","#d4edda")},t.danger=function(){u(arguments,"#721c24","#f8d7da")},t.warn=function(){u(arguments,"#856404","#fff3cd")},t.info=function(){u(arguments,"#0c5460","#d1ecf1")},t.light=function(){u(arguments,"#818182","#fefefe")},t.dark=function(){u(arguments,"#1b1e21","#d6d8d9")},t.getLogger=function(e){return function(){var n=Array.prototype.slice.call(arguments);n.unshift(e),t.info.apply(this,n)}},t.enable=function(){s=!0,o.set("enable_console_log",!0)},t.disable=function(){s=!1,o.set("enable_console_log",!1)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(36);t.init=function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];e[n]&&r&&(e[n]=i(e,n,r.before,r.after))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(58),r=n(132),a=n(70),o=n(237);t.activeUplinkServer=null,t.activeDownlinkServer=null,t.init=function(){var e=BJY.Player;t.uplinkServerList=[],t.downlinkServerList=[],$.each(a.getLiveServerList(),function(n,i){t.downlinkServerList.push({ip:e&&e.html?e.ignoreHLS?i.pull:i.hls:i.pull,hlsSuffix:i.hlsSuffix,speexToAacSuffix:i.speexToAacSuffix,port:1935,tag:i.tag,mount:"mgclient"}),t.uplinkServerList.push({ip:i.push,hlsSuffix:i.hlsSuffix,speexToAacSuffix:i.speexToAacSuffix,port:1935,tag:i.tag,mount:"mgclient"})})},t.getUplinkStreamName=function(e,t){return r.getClassId()+"-"+e+i(t,3)+"1"},t.getUplinkAudioMixedStreamName=function(e,t){return r.getClassId()+"-"+e+i(t,3)+"0"},t.getUplinkStreamNamePattern=function(){return/^(\w+)-(\w+)(\d{3})[0|1]$/},t.getDownlinkStreamName=function(e,t){return r.getClassId()+"-"+e+i(t,3)+"1"},t.getDownlinkAudioMixedStreamName=function(e,t){return r.getClassId()+"-"+(+e+2)+i(t,3)+"0"},t.getDownlinkWebRTCMixedStreamName=function(){return r.getClassId()+"-webrtc-mixstreams"},t.getDownlinkAudioOnlyStreamName=function(e,t){return r.getClassId()+"-"+(+e+3)+i(t,3)+"1"},t.getDownlinkAudioOnlyMixedStreamName=function(e,t){return r.getClassId()+"-"+(+e+3)+i(t,3)+"0"},t.getDownlinkStreamNamePattern=function(){return/^(\w+)-(\w+)(\d{3})[0|1](?:\?only-audio=1)?$/},t.getActiveUplinkServer=function(){return t.activeUplinkServer||t.uplinkServerList[0]},t.setActiveUplinkServer=function(e){t.activeUplinkServer=e},t.getActiveDownlinkServer=function(){return t.activeDownlinkServer||t.downlinkServerList[0]},t.setActiveDownlinkServer=function(e){t.activeDownlinkServer=e},t.switchUplinkServer=function(e,n){return t.setActiveUplinkServer(o(t.uplinkServerList,e,n)),t.getActiveUplinkServer()},t.switchDownlinkServer=function(e,n){return t.setActiveDownlinkServer(o(t.downlinkServerList,e,n)),t.getActiveDownlinkServer()},t.isWSActiveUplinkCDN=function(){return activeUplinkServer&&"ws"===activeUplinkServer.tag},t.isTCActiveUplinkCDN=function(){return activeUplinkServer&&"tc"===activeUplinkServer.tag},t.isJDActiveUplinkCDN=function(){return activeUplinkServer&&"jd"===activeUplinkServer.tag},t.isALActiveUplinkCDN=function(){return activeUplinkServer&&"al"===activeUplinkServer.tag},t.isWSActiveDownlinkCDN=function(){return activeDownlinkServer&&"ws"===activeDownlinkServer.tag},t.isTCActiveDownlinkCDN=function(){return activeDownlinkServer&&"tc"===activeDownlinkServer.tag},t.isJDActiveDownlinkCDN=function(){return activeDownlinkServer&&"jd"===activeDownlinkServer.tag},t.isALActiveDownlinkCDN=function(){return activeDownlinkServer&&"al"===activeDownlinkServer.tag}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(58),a=n(236);return function(e,t){var n=a(e);return n?[n.year,r(n.month),r(n.date)].join(t||"-"):""}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e){if(e)return"number"===$.type(e)&&(e=new Date(e)),{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),day:e.getDay()}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(275),a=n(402);return function(e,t,n){return n?r(e,n.ip,n.port,n.name):a(e,t)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t,n){var i=0;function a(e){Yox.object.extend(this,e),this.status=i,e.retryCount>0&&(this.retryIndex=0)}var o=a.prototype;return o.isOpen=function(){return 1===this.status},o.isConnecting=function(){return 5===this.status},o.connect=function(e,t){var n=this;if(1!==n.status&&5!==n.status){var r=[e];t&&t.length&&(r=r.concat(t));var a=-1,o=function(){5===n.status&&function(e,t){var i,r=new n.native(e.url),a=function(n){i&&clearTimeout(i),r.onopen=r.onerror=null,t(r,e,n)};r.onopen=function(){a(1)},r.onerror=function(){a(2)},n.timeout>0&&(i=setTimeout(function(){i=null,a(4)},n.timeout))}(r[++a],function(e,o,u){if(5===n.status)if(1===u)n.url=o.url,n.socket=e,n.status=1,e.onmessage=function(e){1===n.status&&n.onReceive(JSON.parse(e.data))},e.onclose=function(e){1===n.status&&(n.connectOnClose?(n.status=i,n.connect(o,t)):n.onClose&&n.onClose(e))},n.retryCount>0&&(n.retryIndex=0),n.onOpen&&n.onOpen({server:o});else if(a===r.length-1){if(n.retryCount>0&&n.retryIndex++<n.retryCount)return a=-1,void s();switch(n.status=u){case 2:n.onError&&n.onError({server:o});break;case 4:n.onTimeout&&n.onTimeout({server:o})}}else s()})},s=function(){n.interval>0?setTimeout(o,n.interval):o()};n.status=5,o()}},o.send=function(e){var t=this.socket;t&&(t.send("string"==typeof e?e:(0,r.default)(e)),this.onSend&&this.onSend(e))},o.close=function(){var e=this.socket;this.socket=null,this.status=3,e&&(e.onmessage=e.onclose=null,e.close())},a}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){var t=n(7);return function(e){t.get("embed")||alert(e)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i;return function(){if(null!=i)return i;var e=BJY.os,t=BJY.config,n=BJY.browser;return i=e.android||e.ios?t.END_TYPE_MOBILE_BROWSER:"function"==typeof window.cefQuery?n.wechat?t.END_TYPE_PC_BROWSER:e.mac?t.END_TYPE_MAC_CLIENT:t.END_TYPE_PC_CLIENT:t.END_TYPE_PC_BROWSER}}.call(t,n,t,e))||(e.exports=i)},,,,function(e,t,n){var i=n(18);e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(t){var a=e.return;throw void 0!==a&&i(a.call(e)),t}}},function(e,t,n){var i=n(49),r=n(13)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[r]===e)}},function(e,t,n){var i=n(13)("iterator"),r=!1;try{var a=[7][i]();a.return=function(){r=!0},Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var a=[7],o=a[i]();o.next=function(){return{done:n=!0}},a[i]=function(){return o},e(a)}catch(e){}return n}},,,,,function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e){null==e&&(e=15);var t=Math.pow(10,e-1),n=Math.pow(10,e)-1;return t+Math.floor(Math.random()*(n-t))}}.call(t,n,t,e))||(e.exports=i)},,,,,,,,function(e,t,n){n(260),e.exports=n(1).Array.isArray},function(e,t,n){var i=n(6);i(i.S,"Array",{isArray:n(115)})},function(e,t,n){n(262),e.exports=n(1).parseFloat},function(e,t,n){var i=n(6),r=n(263);i(i.G+i.F*(parseFloat!=r),{parseFloat:r})},function(e,t,n){var i=n(2).parseFloat,r=n(141).trim;e.exports=1/i(n(105)+"-0")!=-1/0?function(e){var t=r(String(e),3),n=i(t);return 0===n&&"-"==t.charAt(0)?-0:n}:i},,function(e,t,n){"use strict";var i,r=n(0)(n(104));void 0===(i=function(e,t,n){function i(e,t){$.isPlainObject(e)&&$.each((0,r.default)(e),function(n,i){return t(e[i],i)})}function a(e,t,n){if($.isFunction(e))return $.isArray(n)?e.apply(t,n):e.call(t,n)}var o={created:!1,data:function(){return{}},events:{},computed:{},watchers:{},methods:{},beforeCreate:function(){},afterCreate:function(){},beforeDestroy:function(){},afterDestroy:function(){},hook_watchers:{},hook_events:{}};function s(e,t){$.extend(this,o,t),this.init(e)}var u=s.prototype;return u.init=function(e){var t=this;if(!(e instanceof Yox))throw new Error("需要传入yox实例");if(!t.created){t.hook=e;var n={props:{},data:t.data,events:t.events,computed:t.computed,watchers:t.watchers,methods:t.methods,beforeCreate:function(){this.hook=e,t.beforeCreate()},afterCreate:t.afterCreate,beforeDestroy:t.beforeDestroy,afterDestroy:t.afterDestroy};t.instance=new Yox(n),i(t.hook_watchers,function(e,n){if($.isFunction(e)){var i=function(n,i){a(e,t.instance,[n,i])};t.hook_watchers[n]=i,t.hook.watch(n,i,!0)}}),i(t.hook_events,function(e,n){if($.isFunction(e)){var i=function(n,i){a(e,t.instance,[n,i])};t.hook_events[n]=i,t.hook.on(n,i)}}),t.created=!0}},u.dispose=function(){var e=this;e.created&&(i(e.hook_watchers,function(t,n){$.isPlainObject(t)&&$.isFunction(t)&&e.hook.unwatch(n,t)}),i(e.hook_events,function(t,n){$.isPlainObject(t)&&$.isFunction(t)&&e.hook.off(n,t)}),e.created=!1,e.instance.destroy())},s}.call(t,n,t,e))||(e.exports=i)},,,,function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],r={};$.each(i,function(e,t){r[t]=e}),t.list=i,t.map=r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(){return function(e){var t=location.protocol;return 0!==e.indexOf(t)&&(e=0===e.indexOf("http")?0===e.indexOf("https")?t+e.slice(6):t+e.slice(5):t+e,"https:"===t&&(e=e.replace("img.gsxservice.com","imgs.genshuixue.com"))),e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i=BJY.config.SECOND;t.THRESHOLD_VIDEO_BUFFER_LENGTH=30,t.LIVE_SERVER_UPLINK_SWITCH_INTERVAL=8*i,t.LIVE_SERVER_DOWNLINK_SWITCH_INTERVAL=8*i,t.PLAYER_CREATE_TIMEOUT=15*i,t.AV_PUBLISH_TIMEOUT=20*i,t.AV_PLAY_TIMEOUT=10*i,t.AV_RECONNECT_COUNT=10,t.NATIVE_PLAYER_RATIO=.32,t.PLAYER_FIRST_SWITCH_LIMIT=20,t.PLAYER_PLAY_SWITCH_LIMIT=10,t.PLAYER_PLAY_SWITCH_OFFSET=5,t.PLAYER_INSTANCE_KEY_PREFIX_OF_ASSIST="assist",t.PLAYER_RUN_WARN_CODE={lowUplinkAudioBandwidth:0},t.VIRTUAL_CAMERA_LAYOUT_PIP=0,t.VIRTUAL_CAMERA_LAYOUT_SPLICE=1,t.CAMERA_LAYOUT_FULL_CONTAINS="full_contains",t.CAMERA_LAYOUT_TRIPLE="triple",t.CAMERA_LAYOUT_PIP="pip",t.CAMERA_LAYOUT_PIP_TWO="pip_two",t.CAMERA_LAYOUT_FOUR_PALACE="four_palace",t.TRIPLE_LEFT="triple_left",t.TRIPLE_RIGHT="triple_right",t.PALACE_TOP_LEFT="palace_top_left",t.PALACE_TOP_RIGHT="palace_top_right",t.PALACE_BOTTOM_LEFT="palace_bottom_left",t.PALACE_BOTTOM_RIGHT="palace_bottom_right",t.PIP_MAIN="pip_main",t.PIP_SMALL="pip_small",t.PIP_TWO_MAIN="pip_two_main",t.PIP_TWO_SMALL_1="pip_two_small_1",t.PIP_TWO_SMALL_2="pip_two_small_2"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i=n(0);n(66)(t,"__esModule",{value:!0}),t.Sleep=void 0;var r=i(n(119)),a=i(n(123)),o=i(n(155)),s=function(){function e(t){(0,a.default)(this,e),this.timeout=t}return(0,o.default)(e,[{key:"then",value:function(e,t){var n=this,i=(0,r.default)();this._timer=setTimeout(function(){e((0,r.default)()-i),n._timer=null},1e3*this.timeout)}},{key:"stop",value:function(){this._timer&&(clearTimeout(this._timer),this._timer=null)}}]),e}();t.Sleep=s},function(e,t,n){var i=n(348),r=n(349),a=n(353);e.exports=function(e,t){return i(e)||r(e,t)||a()}},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e,t,n,i){var r=BJY.eventEmitter,a={},o={},s=[],u=[],c=[],l=!1,d=!1;Yox.array.each(e,function(e){a[e.guid]=e}),Yox.array.each(t,function(e){o[e.guid]=e}),Yox.object.each(a,function(e){null==o[e.guid]&&s.push(e)}),Yox.object.each(o,function(e){null==a[e.guid]?u.push(e):c.push(a[e.guid])});var _=c;return s.length>0&&(l=!0,n&&r.trigger(n,{deviceList:s}),Yox.array.each(s,function(e){_.push(e)})),u.length>0&&(d=!0,i&&r.trigger(i,{deviceList:u})),Yox.array.each(_,function(e,t){e.index=t}),[_,l,d]}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e,t,n,i){var r;return $.each(e,i?function(e,t){if(t.name===i)return r=t,!1}:function(e,i){if(i.ip===t){if(!n)return r=i,!1;if(i.port==n)return r=i,!1}}),r}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(173);return function(e,t,n,i,a,o,s,u){if(BJY.data.media.getCameraList()[e]){var c=r({},e,n,i,a,o,s,u).map(function(e){return e.value});Yox.array.has(c,t)||(t=c.pop())}return t}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0),a=r(n(104)),o=r(n(88));void 0===(i=function(e,t,n){return function(e){var t={};return"object"===(0,o.default)(e)&&(0,a.default)(e).forEach(function(n){var i=n.replace("dt","");t[i]=e[n]}),t}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){n(127),n(89),n(110),n(279),n(283),n(284),e.exports=n(1).Promise},function(e,t,n){"use strict";var i,r,a,o,s=n(35),u=n(2),c=n(29),l=n(157),d=n(6),_=n(10),f=n(37),p=n(193),h=n(134),g=n(206),E=n(207).set,v=n(281)(),m=n(162),S=n(208),A=n(282),y=n(209),T=u.TypeError,R=u.process,I=R&&R.versions,C=I&&I.v8||"",O=u.Promise,b="process"==l(R),L=function(){},D=r=m.f,N=!!function(){try{var e=O.resolve(1),t=(e.constructor={})[n(13)("species")]=function(e){e(L,L)};return(b||"function"==typeof PromiseRejectionEvent)&&e.then(L)instanceof t&&0!==C.indexOf("6.6")&&-1===A.indexOf("Chrome/66")}catch(e){}}(),P=function(e){var t;return!(!_(e)||"function"!=typeof(t=e.then))&&t},k=function(e,t){if(!e._n){e._n=!0;var n=e._c;v(function(){for(var i=e._v,r=1==e._s,a=0,o=function(t){var n,a,o,s=r?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(r||(2==e._h&&M(e),e._h=1),!0===s?n=i:(l&&l.enter(),n=s(i),l&&(l.exit(),o=!0)),n===t.promise?c(T("Promise-chain cycle")):(a=P(n))?a.call(n,u,c):u(n)):c(i)}catch(e){l&&!o&&l.exit(),c(e)}};n.length>a;)o(n[a++]);e._c=[],e._n=!1,t&&!e._h&&w(e)})}},w=function(e){E.call(u,function(){var t,n,i,r=e._v,a=U(e);if(a&&(t=S(function(){b?R.emit("unhandledRejection",r,e):(n=u.onunhandledrejection)?n({promise:e,reason:r}):(i=u.console)&&i.error&&i.error("Unhandled promise rejection",r)}),e._h=b||U(e)?2:1),e._a=void 0,a&&t.e)throw t.v})},U=function(e){return 1!==e._h&&0===(e._a||e._c).length},M=function(e){E.call(u,function(){var t;b?R.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},x=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),k(t,!0))},V=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw T("Promise can't be resolved itself");(t=P(e))?v(function(){var i={_w:n,_d:!1};try{t.call(e,c(V,i,1),c(x,i,1))}catch(e){x.call(i,e)}}):(n._v=e,n._s=1,k(n,!1))}catch(e){x.call({_w:n,_d:!1},e)}}};N||(O=function(e){p(this,O,"Promise","_h"),f(e),i.call(this);try{e(c(V,this,1),c(x,this,1))}catch(e){x.call(this,e)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(194)(O.prototype,{then:function(e,t){var n=D(g(this,O));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=b?R.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&k(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new i;this.promise=e,this.resolve=c(V,e,1),this.reject=c(x,e,1)},m.f=D=function(e){return e===O||e===o?new a(e):r(e)}),d(d.G+d.W+d.F*!N,{Promise:O}),n(56)(O,"Promise"),n(227)("Promise"),o=n(1).Promise,d(d.S+d.F*!N,"Promise",{reject:function(e){var t=D(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(s||!N),"Promise",{resolve:function(e){return y(s&&this===o?O:this,e)}}),d(d.S+d.F*!(N&&n(246)(function(e){O.all(e).catch(L)})),"Promise",{all:function(e){var t=this,n=D(t),i=n.resolve,r=n.reject,a=S(function(){var n=[],a=0,o=1;h(e,!1,function(e){var s=a++,u=!1;n.push(void 0),o++,t.resolve(e).then(function(e){u||(u=!0,n[s]=e,--o||i(n))},r)}),--o||i(n)});return a.e&&r(a.v),n.promise},race:function(e){var t=this,n=D(t),i=n.reject,r=S(function(){h(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}})},function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var i=n(2),r=n(207).set,a=i.MutationObserver||i.WebKitMutationObserver,o=i.process,s=i.Promise,u="process"==n(41)(o);e.exports=function(){var e,t,n,c=function(){var i,r;for(u&&(i=o.domain)&&i.exit();e;){r=e.fn,e=e.next;try{r()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(u)n=function(){o.nextTick(c)};else if(!a||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);n=function(){l.then(c)}}else n=function(){r.call(i,c)};else{var d=!0,_=document.createTextNode("");new a(c).observe(_,{characterData:!0}),n=function(){_.data=d=!d}}return function(i){var r={fn:i,next:void 0};t&&(t.next=r),e||(e=r,n()),t=r}}},function(e,t,n){var i=n(2).navigator;e.exports=i&&i.userAgent||""},function(e,t,n){"use strict";var i=n(6),r=n(1),a=n(2),o=n(206),s=n(209);i(i.P+i.R,"Promise",{finally:function(e){var t=o(this,r.Promise||a.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:e,n?function(n){return s(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){"use strict";var i=n(6),r=n(162),a=n(208);i(i.S,"Promise",{try:function(e){var t=r.f(this),n=a(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){return function(e){if(e instanceof jQuery||(e=$(e)),!e.length)return{};var t=e.offset(),n=e.outerWidth(),i=e.outerHeight();return{left:t.left,right:t.left+n,top:t.top,bottom:t.top+i,width:n,height:i}}}.call(t,n,t,e))||(e.exports=i)},,,,,function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e){var t=$.Deferred();return setTimeout(function(){e?t.resolve(e()):t.resolve()}),t}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){var i=n(391),r=n(66);e.exports=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=r&&i?i(e,n):{};a.get||a.set?r(t,n,a):t[n]=e[n]}return t.default=e,t}},function(e,t,n){"use strict";n(66)(t,"__esModule",{value:!0}),t.commitSpeak=function(e){i[a.SPEAK][e.number]?i[a.SPEAK][e.number]++:i[a.SPEAK][e.number]=1;t="speak",n=e,Yox.is.array(r[t])&&Yox.array.each(r[t],function(e,t){Yox.is.func(e)&&e(i[a.SPEAK],n)});var t,n},t.state=function(e){return i[e]},t.action=function(e,t){r[e]?r[e].push(t):r[e]=[t]},t.unaction=function(e,t){r[e]&&Yox.array.each(r[e],function(n,i){if(t===n)return r[e].splice(i,1),!1})},t.getStates=function(){return i},t.MUTATION=void 0;var i={speak:{}},r={speak:[]},a={SPEAK:"speak"};t.MUTATION=a},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r,a,o=n(7),s=n(137),u=n(5),c=".classroom_data_shape",l={};function d(e){var t=e.docId,n=e.page;return t+"-"+(n=s.getServerPage(t,n))}function _(e){return t.checkIfInitialized(),r[d(e)]}t.getLoadKey=d,t.checkIfInitialized=function(){r||t.init()},t.init=function(){r={},u.off(c).on(u.RECORD_SHAPE_CLEAN+c,function(){r={},l={}}).on(u.PAGE_DELETE+c,function(e,t){var n=t.docId+"-"+t.pageId;n&&delete r[n]})},t.add=function(e,n,i){var r=t.get(e,n);if($.isArray(r)){var a=i;$.isArray(i)||(a=[i]);var o=Yox.array.toObject(r,"id");a.forEach(function(e){o[e.id]?r.forEach(function(t,n){t.id===e.id&&r.splice(n,1,e)}):r.push(e)})}},t.append=function(e,t,n){},t.remove=function(e,n,i){var r=t.get(e,n);if($.isArray(r)){var a=-1;$.each(r,function(e,t){if(t.id===i)return a=e,!1}),a>=0&&r.splice(a,1)}},t.update=function(e,t,n){var i=_({docId:e,page:t});if($.isArray(i)){$.isArray(n)||(n=[n]);var r=Yox.array.toObject(i,"id");$.each(n,function(e,t){var n=r[t.id];n&&$.extend(n,t)})}},t.get=function(e,t){return _({docId:e,page:t})},t.clear=function(e,n){if(null!=e&&null!=n){var i=t.get(e,n);$.isArray(i)&&(i.length=0)}else r={}},t.load=function(e,n){t.checkIfInitialized();var i={docId:e,page:n},a=d(i),o=r[a]||{},s=$.Deferred(),c=function(e){s.resolve(e)};if(o.done)return o;if($.isArray(o))Yox.nextTick(function(){c(o)});else{r[a]=s;u.on(u.SHAPE_ALL_RES,function e(n,o){if(o.docId===i.docId&&o.page===i.page&&r[a]===s){u.off(u.SHAPE_ALL_RES,e);var l=o.shapeList;r[a]=l,t.add(i.docId,i.page,l),c(l)}}).trigger(u.SHAPE_ALL_REQ,i)}return s},t.loadLayerShape=function(e,n,i){t.checkIfInitialized();var r=$.Deferred();return u.on(u.SHAPE_ALL_RES,function t(a,o){o.docId===e&&o.page===n&&o.layer===i&&(r.resolve(o.shapeList),u.off(u.SHAPE_ALL_RES,t))}).trigger(u.SHAPE_ALL_REQ,{docId:e,page:n,layer:i}),r},t.getLayer=function(){return a||o.get("user.number")},t.setLayer=function(e){e&&(a=e)},t.setShapePreview=function(e,t,n){if(s.getPageInfoByPage(e,t)){var i=d({docId:e,page:t});l[i]=n,u.trigger(u.SHAPE_PREVIEW_CHANGE,{docId:e,page:t,dataUrl:n})}},t.getShapePreview=function(e,t){var n=d({docId:e,page:t});return l[n]},t.getShapePreviewMap=function(){return Yox.object.copy(l)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){return function(e){var t=BJY.config;return{id:e,id2:""+(+e+t.STREAM_ID_ASSISTANT),id3:""+(+e+t.STREAM_ID_MIX_AUDIO),id4:""+(+e+t.STREAM_ID_EXTRA_DEFINITION)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){return function(e,t,n,i){t in e&&(n[i]=e[t])}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){var t=n(7),i=n(11),r=n(26),a=n(138),o=n(121);return function(e){var n=t.get("user"),s=n.publishServer,u=i.CAMERA_QUALITY_MAP,c=e.isAssist?a.getAssistCameraQuality():a.getCameraQuality();e.mediaId=e.mediaId||n.id2,n.mediaExtMap=n.mediaExtMap||{};var l={id:n.id,number:n.number,type:n.type,name:n.name,avatar:n.avatar,status:n.status,end_type:n.endType,session_id:n.sessionId,camera_cover:n.cameraCover};e.isAssist&&(l.session_id=n.sessionId2),n.webrtcInfo&&(l.webrtc_info=o(n.webrtcInfo));var d={message_type:"media_republish_trigger",publish_index:e.isAssist?n.mediaExtMap[e.mediaId]&&n.mediaExtMap[e.mediaId].publishIndex||0:n.publishIndex,publish_server:{ip:s.ip,port:+s.port},user:l,link_type:e.linkType,video_ratio:e.isAssist?a.getAssistCameraRatio():a.getCameraRatio(),definitions:[]};c&&d.definitions.push(u[c]);var _=!0===e.videoOn,f=!0===e.audioOn,p=a.getExtraStreamQuality(c);return _&&(d.video_on=!0),f&&(d.audio_on=!0),"number"===$.type(e.actionType)&&(d.action_type=e.actionType),Yox.is.boolean(e.isScreenSharing)&&(d.is_screen_sharing=e.isScreenSharing?1:0),r.canPublishExtraStream()&&p>-1&&d.definitions.push(u[p]),d.audio_mixed=r.canPublishMixedAudioStream()?1:0,d.support_mute_stream=r.canPublishMuteStream()?1:0,d.support_black_stream=r.canPublishBlackStream()?1:0,d}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){var t=n(7),i=n(11),r=n(26),a=n(138),o=n(95),s=n(121);return function(e){var n=t.get("user"),u=n.publishServer,c=i.CAMERA_QUALITY_MAP,l=e.isAssist?a.getAssistCameraQuality():a.getCameraQuality();e.mediaId=e.mediaId||n.id2,n.mediaExtMap=n.mediaExtMap||{};var d={id:n.id,number:n.number,type:n.type,name:n.name,avatar:n.avatar,status:n.status,end_type:n.endType,session_id:n.sessionId,camera_cover:n.cameraCover};e.isAssist&&(d.session_id=n.sessionId2),n.webrtcInfo&&(d.webrtc_info=s(n.webrtcInfo));var _={publish_index:e.isAssist?n.mediaExtMap[e.mediaId]&&n.mediaExtMap[e.mediaId].publishIndex||0:n.publishIndex,publish_server:{ip:u.ip,port:+u.port},user:d,link_type:e.linkType,video_ratio:e.isAssist?a.getAssistCameraRatio():a.getCameraRatio(),definitions:[]};l&&_.definitions.push(c[l]);var f="boolean"===$.type(e.videoOn),p="boolean"===$.type(e.audioOn),h=a.getExtraStreamQuality(l);return f&&(_.video_on=e.videoOn),p&&(_.audio_on=e.audioOn),"boolean"===$.type(e.skipRelease)?_.skip_release=e.skipRelease?1:0:_.skip_release=0,"number"===$.type(e.actionType)&&(_.action_type=e.actionType),Yox.is.boolean(e.isScreenSharing)&&(_.is_screen_sharing=e.isScreenSharing?1:0),r.canPublishExtraStream()&&h>-1&&_.definitions.push(c[h]),t.get("allowKeepAlive")&&e.actionType!==i.MEDIA_PUBLISH_BY_OFFLINE&&(_.keep_alive=o.isActive()),_.support_mute_stream=r.canPublishMuteStream()?1:0,_.support_black_stream=r.canPublishBlackStream()?1:0,_.audio_mixed=r.canPublishMixedAudioStream()?1:0,_}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){var t=n(11),i=n(26),r=n(7),a=n(5);return function(e,n){(e!==t.LINK_TYPE_UDP||i.canUseUdpPush())&&(a.trigger(a.UPLINK_LINK_TYPE_CHANGE_TRIGGER,{value:e,force:!0}),i.isTeacher()&&r.set("class.canSetLinkType",!!n))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var n=[];function i(e){var t;return $.each(n,function(n,i){if(e===i.id)return t=i,!1}),t}t.init=function(){t.clear()},t.clear=function(){n=[]},t.add=function(e){e&&($.isArray(e)||(e=[e]),$.merge(n,e))},t.remove=function(e){var t=-1;return $.each(n,function(n,i){i.id===e&&(t=n)}),t>=0&&n.splice(t,1)[0]},t.update=function(e,t){var n=i(e);n&&(n.visible=t)},t.all=function(){return n.slice()},t.getDocumentById=i}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(292)(n(293));void 0===(i=function(e,t){var i=n(25),a=n(95),o=n(138),s=n(70),u=n(11),c=n(7),l=n(26),d=n(5),_=n(79),f=n(43),p=n(296),h=n(109),g=n(299),E=n(239),v=n(198),m=n(298),S=n(297),A=n(121);t.messageTypes={media_publish_res:function(e){d.trigger(d.MEDIA_PUBLISH_RES,e)},media_subscribe_res:function(e){d.trigger(d.MEDIA_SUBSCRIBE_RES,e)},media_publish:function(e){return h(e.user_id,function(){var t=f(e.user),n=a.find(t.id),i=e.video_on||e.audio_on;if(!i){if(!n)return;if(t.number===c.get("user.number")&&t.id!==c.get("user.id"))return}i&&!a.isActive(t.id)&&r.commitSpeak(t);var o={};return"boolean"===$.type(e.video_on)&&(o.videoOn=t.videoOn=e.video_on),"boolean"===$.type(e.audio_on)&&(o.audioOn=t.audioOn=e.audio_on),"number"===$.type(e.audio_mixed)&&(o.audioMixed=t.audioMixed=e.audio_mixed),$.isArray(e.definitions)&&(o.definitions=t.definitions=e.definitions.filter(function(e){return e})),"number"===$.type(e.skip_release)&&(o.skipRelease=1===e.skip_release),"number"===$.type(e.support_mute_stream)&&(o.supportMuteStream=t.supportMuteStream=1===e.support_mute_stream),"number"===$.type(e.is_screen_sharing)&&(o.isScreenSharing=t.isScreenSharing=1===e.is_screen_sharing),"number"===$.type(e.support_black_stream)&&(o.supportBlackStream=t.supportBlackStream=1===e.support_black_stream),"number"===$.type(e.action_type)&&(o.actionType=e.action_type),"number"===$.type(e.offset_timestamp)&&(o.offsetTimestamp=e.offset_timestamp),"number"===$.type(e.video_ratio)&&(o.videoRatio=e.video_ratio),p(e,"publish_index",t,"publishIndex"),l.isSelf(t.id)||p(e,"publish_server",t,"publishServer"),p(e,"link_type",t,"linkType"),o.linkType=t.linkType,o.user=a.update(t)||t,a.updateActive(t.id,!!(t.audioOn||t.videoOn||e.keep_alive)),d.trigger(d.MEDIA_PUBLISH,o),!0})},media_publish_mix:function(e){var t=f(e.user);a.add(t),c.set("class.mixStreamUserId",e.video_on||e.audio_on?t.id:""),messageTypes.media_publish(e)},media_republish:function(e){h(e.user_id,function(){var t=f(e.user);if(a.find(t.id)){var n={};!0===e.video_on&&(n.videoOn=t.videoOn=!0),!0===e.audio_on&&(n.audioOn=t.audioOn=!0),"number"===$.type(e.audio_mixed)&&(n.audioMixed=t.audioMixed=e.audio_mixed),$.isArray(e.definitions)&&(n.definitions=t.definitions=e.definitions.filter(function(e){return e}));var i=a.find(t.id);i&&t.publishIndex>i.publishIndex&&(n.switchServer=!0),"number"===$.type(e.support_mute_stream)&&(n.supportMuteStream=t.supportMuteStream=1===e.support_mute_stream),"number"===$.type(e.is_screen_sharing)&&(n.isScreenSharing=t.isScreenSharing=1===e.is_screen_sharing),"number"===$.type(e.support_black_stream)&&(n.supportBlackStream=t.supportBlackStream=1===e.support_black_stream),"number"===$.type(e.action_type)&&(n.actionType=e.action_type),p(e,"publish_index",t,"publishIndex"),l.isSelf(t.id)||p(e,"publish_server",t,"publishServer"),p(e,"link_type",t,"linkType"),n.linkType=t.linkType,n.mediaId=e.media_id,n.user=a.update(t)||t,a.updateActive(t.id,!!(t.audioOn||t.videoOn||e.keep_alive)),d.trigger(d.MEDIA_REPUBLISH,n)}})},media_remote_control:function(e){var t=e.user_id,n=i(e.video_on),r=i(e.audio_on);n&&!o.getCameraList().length&&(n=!1),r&&!o.getMicList().length&&(r=!1),t&&BJY.command.send(t,{name:"media_remote_control_res",params:{user_id:c.get("user.id"),video_on:n,audio_on:r}}),function(e,t,n){var i=function(){d.trigger(d.MEDIA_SWITCH_TRIGGER,{operator:n,videoOn:e,audioOn:t})};if(e||t)c.get("class.speakState")!==u.SPEAK_STATE_FREE&&c.set("class.speakState",u.SPEAK_STATE_FREE),i();else{var r=BJY.Player&&BJY.Player.instances[c.get("user.id")];r&&r.isScreenSharing?d.one(d.SCREEN_SHARE_STOP,function(e,t){i(),c.get("class.isFree")||c.set("class.speakState",u.SPEAK_STATE_LIMIT)}).trigger(d.SCREEN_SHARE_STOP_TRIGGER):(i(),c.get("class.isFree")||c.set("class.speakState",u.SPEAK_STATE_LIMIT))}}(n,r,a.find(t))},media_remote_control_deny:function(e){d.has(d.SPEAK_REMOTE_CONTROL_DENY)?d.trigger(d.SPEAK_REMOTE_CONTROL_DENY,e):E("发言人数已满，请先关闭其他人的音视频。")},media_publish_deny:function(e){d.has(d.MEDIA_PUBLISH_DENY)?d.trigger(d.MEDIA_PUBLISH_DENY,e):E("发言人数已满，请稍后重试")},media_republish_deny:function(e){d.has(d.MEDIA_REPUBLISH_DENY)?d.trigger(d.MEDIA_REPUBLISH_DENY,e):E("发言人数已满，请稍后重试")},media_publish_ext_deny:function(e){d.has(d.MEDIA_PUBLISH_EXT_DENY)?d.trigger(d.MEDIA_PUBLISH_EXT_DENY,e):E("发言人数已满，请稍后重试")},media_republish_ext_deny:function(e){d.has(d.MEDIA_REPUBLISH_EXT_DENY)?d.trigger(d.MEDIA_REPUBLISH_EXT_DENY,e):E("发言人数已满，请稍后重试")},video_resolution_change:function(e){var t=e.user_id,n=a.find(t);n&&(n.videoResolution={width:e.width,height:e.height},n.definitions=e.definitions,d.trigger(d.VIDEO_RESOLUTION_CHANGE,{width:e.width,height:e.height,definitions:e.definitions,userId:t}))},link_type_change:function(e){g(e.link_type,e.teacher_switchable)},foreign_line_switch:function(e){var t=e.uplink_server_list,n=e.downlink_server_list;(t||n)&&(t&&s.setUdpUplinkServerList(t),n&&s.setUdpDownlinkServerList(n),v.init(),t&&c.get("class.uplinkType")===u.LINK_TYPE_UDP&&d.trigger(d.UPLINK_SERVER_NODE_CHANGE_TRIGGER,t[0]),n&&c.get("class.downlinkType")===u.LINK_TYPE_UDP&&d.trigger(d.DOWNLINK_SERVER_NODE_CHANGE_TRIGGER,t[0]))}},t.methods={getUplinkServerInfo:function(e){var t=$.Deferred(),n={message_type:"media_publish_req",route:"master",link_type:e.linkType,definitions:e.definitions,user_number:c.get("user.number"),preferred_cdn:e.preferredCdn||null,special_customer:c.get("partner.specialCustomer",""),udp_foreign_proxy:c.get("partner.liveUdpForeignProxy",0),tcp_foreign_proxy:c.get("partner.liveTcpForeignProxy",0),ms_config:A(c.get("partner.msConfig"))};return e.sessionId&&(n.session_id=e.sessionId),_.send(n),d.one(d.MEDIA_PUBLISH_RES,function(e,n){t.resolve(f(n))}),t},getDownlinkServerInfo:function(e){var t=$.Deferred();return _.send({message_type:"media_subscribe_req",route:"master",is_retry:e.isRetry,link_type:e.linkType,definition:e.definition,session_id:e.sessionId,preferred_cdn:e.preferredCdn,user_number:c.get("user.number")}),d.on(d.MEDIA_SUBSCRIBE_RES,function(n,i){(i=f(i)).sessionId==e.sessionId&&t.resolve(i)}),t},mediaUnpublish:function(e){_.send({message_type:"media_unpublish",route:"master",session_id:e})},publishMedia:function(e){var t=m(e);t.message_type="media_publish_trigger";var n="boolean"===$.type(e.videoOn),i="boolean"===$.type(e.audioOn);(n||i)&&_.send(t)},publishMixAudio:function(e){e.linkType=u.LINK_TYPE_UDP;var t=m(e);if(t.message_type="mixaudio_mute_publish_req",!t.audio_on&&t.audio_mixed&&l.canCloudRecordWhenMuteMic()){var n=a.active();n.length&&(n=n.filter(function(e){return e.user_type!=u.ROLE_TYPE_TEACHER&&e.audioOn})),t.audio_on=!!n.length,_.send(t)}},republishMedia:function(e){var t=S(e);t.message_type="media_republish_trigger";var n=!0===e.videoOn,i=!0===e.audioOn;(n||i)&&_.send(t)},changeResolution:function(e){_.send({message_type:"cloud_record_command_send",command:"change_resolution",value:{width:e.width,height:e.height}})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(7);function a(e){return String(e).replace(/©/g,"&copy;").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var o={};var s=/(?=http[s]?:\/\/|www)[-~!@#$%^&*_+=.:?\/a-z0-9]+/i;function u(e){var t=e;return 0!==t.indexOf("http")&&(t=location.protocol+"//"+t),'<em class="bjy-link" data-href="'+t+'">'+e+"</em>"}var c="img:";var l="emoji:";function d(e){var t=_[e];if(t)return t.url}var _={},f={};t.init=function(){var e=r.get("partner.customExpression");Yox.is.array(e)&&Yox.array.each(e,function(e,t){_[e.key]=e,f[e.name]=e})},t.parseBreakline=function(e){return e.replace(/\n\r?|\r\n?/g,function(){return"<br>"})},t.parseWhitespace=function(e){return e.replace(/ /g,function(e){return"&nbsp;"})},t.decodeWhitespace=function(e){return e.replace(/&nbsp;/g,function(e){return" "})},t.parseLink=function(e,t){return(e=e.replace(/&amp;/g,"&")).replace(s,t||u)},t.encodeHTML=function(e){return e.replace(/<?\/?([^\s]+)( [^>]+)?>?/gi,function(e,t){if(Yox.string.startsWith(e,"<")&&Yox.string.endsWith(e,">")){var n=t.toLowerCase();o[n]||(e=a(e))}else e=a(e);return e})},t.decodeHTML=function(e){return e.replace(/&\w+;|&#(\d+);/gi,function(e,t){var n=String(e).replace(/&copy;/g,"©").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'");return n===e&&(n=isNaN(t)?e:String.fromCharCode(160==t?32:t)),n})},t.isPureText=function(e){return!/^\[([^\]]+)\]$/g.test(e)},t.parseEmoji=function(e,t){return e.replace(/\[([^\]]+)\]/g,function(e,n){var i,r;if(n.indexOf(":")<0)i=n;else if(Yox.string.startsWith(n,l)){var a=(n=n.substr(l.length)).indexOf("|");a>=0&&(i=n.substr(0,a),r=n.substr(a+1))}return i||r?t(i,r||d(i)||function(e){var t=f[e];if(t)return t.url}(i)):e})},t.stringifyEmoji=function(e,t){return t&&(e=l+e+"|"+t),"["+e+"]"},t.getEmojiUrlByKey=d,t.parseImage=function(e,t){return e.replace(/\[([^\]]+)\]/g,function(e,n){return Yox.string.startsWith(n,c)&&(n=n.substr(c.length))?t(n):e})},t.stringifyImage=function(e){return"["+c+e+"]"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(5),a=n(197),o=n(304);t.messageTypes={logout:function(e,t){r.trigger(r.KICK_OUT,t)},client_command_trigger:function(e,t){r.trigger(r.CLIENT_COMMAND_TRIGGER,{name:t.name,params:t.params,from:e})},refresh_browser_trigger:function(e){t.send(e,{name:"refresh_browser"}),sessionStorage.setItem("refreshByHand","1"),location.reload()}},t.send=function(e,t){var n=t.name,i=t.params;t={command_type:n},Yox.object.extend(t,i),a.sendCommand(e,t)},t.init=function(){r.on(r.COMMAND_SEND,function(e,n){t.send(n.to,n)}).on(r.COMMAND_RECEIVE,function(e,n){var i=n.fromId,r=n.command,a=n.toId,o=t.messageTypes[r.command_type];o&&o(i,r,a)}).on(r.KICK_OUT_TRIGGER+".kick_out_trigger",function(e,n){o.getUserForbidAndKickAuth()&&t.send(n.userId,{name:"logout"})}),r.CLIENT_COMMAND&&r.on(r.CLIENT_COMMAND,function(e,n){var i=n.from,r=n.result,a=n.name,o=n.params;t.send(i,{name:"client_command",params:{client_command_result:{result:r,name:a,params:o}}})})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(88));void 0===(i=function(e,t,i){var a=n(26),o=n(7),s=n(11),u=n(305),c=n(5);$.extend(c,n(422)),$.extend(s,n(423));var l="admin_auth",d={},_=[s.AUTH_CONFIG_ITEM_SPEAK,s.AUTH_CONFIG_ITEM_NOTICE,s.AUTH_CONFIG_ITEM_PAINTER,s.AUTH_CONFIG_ITEM_FORBID_AND_KICK,s.AUTH_CONFIG_ITEM_DOCUMENT_CONTROL,s.AUTH_CONFIG_ITEM_DOCUMENT_UPLOAD,s.AUTH_CONFIG_ITEM_CLASS_START_END,s.AUTH_CONFIG_ITEM_CLOUD_RECORD];function f(e){return o.get("user.number")===e}function p(e){return Yox.array.has(_,e)}function h(e,t,n){if(e&&t&&p(t)&&a.isTeacher()){n=n?1:0;var i,r=e.number,_=!1;if(Yox.object.has(d,r)?(i=d[r])[t]!==n&&(i[t]=n,d[r]=i,_=!0):((i={})[t]=n,d[r]=i,_=!0),_&&(u.send(l,d,{all:!1,cache:!0}),f(r))){var h="ADMIN_AUTH_"+t.toUpperCase()+"_CHANGE";c.trigger(c[h],{value:i[t],number:r,fromId:o.get("user.id")}),t===s.AUTH_CONFIG_ITEM_PAINTER&&c.trigger(c.PAINT_AUTH_CHANGE,{canPaint:!!i[t]})}}}function g(e,t){var n="DEFAULT_AUTH_ROLE_";return a.isTeacher(e.type)?n+="TEACHER_":a.isAssistant(e.type)&&(n+="ASSISTANT_"),n+=t.toUpperCase(),s[n]}u.messageTypes[l]=function(e,t,n){if((!a.isTeacher()||n)&&"object"===(0,r.default)(t))for(var i in t){var o=t[i];if("object"===(0,r.default)(o))for(var u in o){if((d[i]&&d[i][u])!==o[u]&&p(u)){if("object"===(0,r.default)(d[i]))d[i][u]=o[u];else{var l={};l[u]=o[u],d[i]=l}var _="ADMIN_AUTH_"+u.toUpperCase()+"_CHANGE";f(i)&&(c.trigger(c[_],{value:o[u],number:i,fromId:e,cache:n}),u===s.AUTH_CONFIG_ITEM_PAINTER&&c.trigger(c.PAINT_AUTH_CHANGE,{canPaint:!!o[u]}))}}}},t.init=function(){o.get("partner.liveAutoAssistantPaintAuth")||(s.DEFAULT_AUTH_ROLE_ASSISTANT_PAINTER=0),o.get("partner.liveAutoAssistantDocumentControlAuth")||(s.DEFAULT_AUTH_ROLE_ASSISTANT_DOCUMENT_CONTROL=0),c.on(c.TEACHER_ADD,function(e,n){n.userList&&$.each(n.userList,function(e,n){t.addUser(n)})}).on(c.ASSISTANT_ADD,function(e,n){n.userList&&$.each(n.userList,function(e,n){t.addUser(n)})}).one(c.USER_ACTIVE_RES,function(e,t){u.get(l)})},t.addUser=function(e){var t=e.number;if(!Yox.object.has(d,t)){var n={};a.isTeacher(e.type)?($.each(_,function(e,t){n[t]=s["DEFAULT_AUTH_ROLE_TEACHER_"+t.toUpperCase()]}),d[t]=n):a.isAssistant(e.type)&&($.each(_,function(e,t){n[t]=s["DEFAULT_AUTH_ROLE_ASSISTANT_"+t.toUpperCase()]}),d[t]=n)}},t.setUserSpeakAuth=function(e,t){h(e,s.AUTH_CONFIG_ITEM_SPEAK,t)},t.getUserSpeakAuth=function(e){e||(e=o.get("user"));var t=d[e.number];return 1===("object"===(0,r.default)(t)&&"number"==typeof t[s.AUTH_CONFIG_ITEM_SPEAK]?t[s.AUTH_CONFIG_ITEM_SPEAK]:g(e,s.AUTH_CONFIG_ITEM_SPEAK))},t.setUserPainterAuth=function(e,t){h(e,s.AUTH_CONFIG_ITEM_PAINTER,t)},t.getUserPainterAuth=function(e){e||(e=o.get("user"));var t=d[e.number];return 1===("object"===(0,r.default)(t)&&"number"==typeof t[s.AUTH_CONFIG_ITEM_PAINTER]?t[s.AUTH_CONFIG_ITEM_PAINTER]:g(e,s.AUTH_CONFIG_ITEM_PAINTER))},t.setUserDocumentContolAuth=function(e,t){h(e,s.AUTH_CONFIG_ITEM_DOCUMENT_CONTROL,t)},t.getUserDocumentControlAuth=function(e){e||(e=o.get("user"));var t=d[e.number];return 1===("object"===(0,r.default)(t)&&"number"==typeof t[s.AUTH_CONFIG_ITEM_DOCUMENT_CONTROL]?t[s.AUTH_CONFIG_ITEM_DOCUMENT_CONTROL]:g(e,s.AUTH_CONFIG_ITEM_DOCUMENT_CONTROL))},t.setUserDocumentUploadAuth=function(e,t){h(e,s.AUTH_CONFIG_ITEM_DOCUMENT_UPLOAD,t)},t.getUserDocumentUploadAuth=function(e){e||(e=o.get("user"));var t=d[e.number];return 1===("object"===(0,r.default)(t)&&"number"==typeof t[s.AUTH_CONFIG_ITEM_DOCUMENT_UPLOAD]?t[s.AUTH_CONFIG_ITEM_DOCUMENT_UPLOAD]:g(e,s.AUTH_CONFIG_ITEM_DOCUMENT_UPLOAD))},t.setUserNoticeAuth=function(e,t){h(e,s.AUTH_CONFIG_ITEM_NOTICE,t)},t.getUserNoticeAuth=function(e){e||(e=o.get("user"));var t=d[e.number];return 1===("object"===(0,r.default)(t)&&"number"==typeof t[s.AUTH_CONFIG_ITEM_NOTICE]?t[s.AUTH_CONFIG_ITEM_NOTICE]:g(e,s.AUTH_CONFIG_ITEM_NOTICE))},t.setUserForbidAndKickAuth=function(e,t){h(e,s.AUTH_CONFIG_ITEM_FORBID_AND_KICK,t)},t.getUserForbidAndKickAuth=function(e){e||(e=o.get("user"));var t=d[e.number];return 1===("object"===(0,r.default)(t)&&"number"==typeof t[s.AUTH_CONFIG_ITEM_FORBID_AND_KICK]?t[s.AUTH_CONFIG_ITEM_FORBID_AND_KICK]:g(e,s.AUTH_CONFIG_ITEM_FORBID_AND_KICK))},t.setUserClassStartEndAuth=function(e,t){h(e,s.AUTH_CONFIG_ITEM_CLASS_START_END,t)},t.getUserClassStartEndAuth=function(e){e||(e=o.get("user"));var t=d[e.number];return 1===("object"===(0,r.default)(t)&&"number"==typeof t[s.AUTH_CONFIG_ITEM_CLASS_START_END]?t[s.AUTH_CONFIG_ITEM_CLASS_START_END]:g(e,s.AUTH_CONFIG_ITEM_CLASS_START_END))},t.setUserCloudRecordAuth=function(e,t){h(e,s.AUTH_CONFIG_ITEM_CLOUD_RECORD,t)},t.getUserCloudRecordAuth=function(e){e||(e=o.get("user"));var t=d[e.number];return 1===("object"===(0,r.default)(t)&&"number"==typeof t[s.AUTH_CONFIG_ITEM_CLOUD_RECORD]?t[s.AUTH_CONFIG_ITEM_CLOUD_RECORD]:g(e,s.AUTH_CONFIG_ITEM_CLOUD_RECORD))},t.setUserAuth=function(e,t,n){h(e,t,n)},t.getUserAuth=function(e,t){e||(e=o.get("user"));var n=d[e.number];return 1===("object"===(0,r.default)(n)&&"number"==typeof n[t]?n[t]:g(e,t))},t.getAdminAuthAll=function(){return $.extend(!0,{},d)},t.getUserAuthAll=function(e){if(e)return $.extend(!0,{},d[e.number])}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(25),r=n(5),a=n(197),o=n(132),s=n(7),u=n(11),c=(n(26),!1);r.on(r.ROOM_SERVER_OFFLINE,function(){c=!0}),t.messageTypes={cloud_record:function(e,t,n){var i=t.status;if(n&&(!i&&c&&s.get("record.autoCloudRecord")&&s.get("class.started")&&r.trigger(r.CLOUD_RECORD_START_TRIGGER),c=!1),i===u.CLOUD_RECORD_ACTIVATED)r.trigger(r.CLOUD_RECORD_START,{operator:t.operator,cache:n});else if(i===u.CLOUD_RECORD_DEACTIVATED){"pause"==t.trigger?r.trigger(r.CLOUD_RECORD_PAUSE,{operator:t.operator,cache:n}):r.trigger(r.CLOUD_RECORD_END,{operator:t.operator,cache:n})}},forbid_all_change:function(e,t,n){var i=o.getForbidAll(),a=+t.forbidAll;i!==a&&(o.setForbidAll(a),r.trigger(r.MESSAGE_SEND_FORBID_ALL_CHANGE,{forbidAll:!!a,cache:n}))},enable_user_in_tips_change:function(e,t,n){if(t){var i=o.getEnableUserInTips(),a=+t.enableUserInTips;i!==a&&(o.setEnableUserInTips(a),r.trigger(r.ENABLE_USER_IN_TIPS_CHANGE,{enableUserInTips:a,cache:n}))}},forbid_raise_hand_change:function(e,t,n){var i=o.getForbidSpeakApply(),a=t.forbid?1:0;i!==a&&(o.setForbidSpeakApply(a),r.trigger(r.SPEAK_APPLY_FORBID_ALL_CHANGE,{forbidAll:1===a,cache:n}))},forbid_mic_change:function(e,t,n){var i=o.getForbidMic(),a=t.forbid?1:0;i!==a&&(o.setForbidMic(a),r.trigger(r.MIC_FORBID_ALL_CHANGE,{forbid:1===a,cache:n}))},share_desktop:function(e,t,n){var i=t.sharing?r.SCREEN_SHARE_START_BROADCAST:r.SCREEN_SHARE_STOP_BROADCAST;r.trigger(i,{fromId:e,fromCache:n})},mute_all_mic:function(e,t){r.trigger(r.MUTE_ALL_MIC,{mute:t.mute,fromId:e})},start_enroll:function(e,t){r.trigger(r.START_ENROLL,{enrollId:t.enrollId,subject:t.subject})},classroom_real_start_time:function(e,t,n){var i=t&&t.start_time?t.start_time:s.get("class.startTimeTs",0);s.set("class.realStartTime",i),r.trigger(r.CLASSROOM_REAL_START_TIME,{startTime:i,cache:n})}},t.send=function(e,t,n,i){a.sendBroadcast({key:e,value:t,options:n,route:i})},t.get=function(e){a.getCachedBroadcast({key:e})},t.init=function(){r.on(r.BROADCAST_RECEIVE,function(e,n){var i=n.fromId,r=t.messageTypes[n.key];r&&r(i,n.value)}).on(r.BROADCAST_CACHE_RES,function(e,n){var i=n.fromId,r=t.messageTypes[n.key];r&&r(i,n.value,!0)}).on(r.BROADCAST_SEND,function(e,n){var r=n.name;r&&t.send(r,n.params,{cache:i(n.cache,!1),all:i(n.all,!0)},n.route)}).on(r.CLOUD_RECORD_START_SEND,function(){t.send("cloud_record",{status:1,is_sdk:!0,record_student_media:s.get("partner.recordStudentMedia"),operator:s.get("user.type"),class_info:{webrtc_type:s.get("class.webrtcType"),record_signal:s.get("class.recordSignal")}},{cache:!0})}).on(r.CLOUD_RECORD_END_SEND,function(e,n){t.send("cloud_record",{status:0,is_sdk:!0,record_student_media:s.get("partner.recordStudentMedia"),operator:s.get("user.type"),trigger:n.trigger},{cache:!0})}).on(r.MUTE_ALL_MIC_TRIGGER,function(e,n){t.send("mute_all_mic",{mute:n.mute})})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t){var i=n(7),a=n(11),o=n(303),s=n(5),u=n(55),c=n(235),l=n(156),d={},_="bjy_runtime_info",f=1728e5,p="MasterServer连接超时-",h="MasterServer连接失败-",g="MasterServer连接成功-",E="WebRTCServer连接成功-",v="WebRTCServer连接超时-",m="RoomServer，服务器超员，拒绝进入",S="RoomServer，被踢出教室，拒绝进入",A="RoomServer，重复登陆，拒绝进入",y="RoomServer登录成功",T="RoomServer掉线，原因：客户端断网",R="RoomServer掉线，原因：服务器断开WebSocket，code: ",I="尝试连接教室",C="连接教室成功",O="连接教室失败",b="连接教室超时",L="离开教室，原因：",D="登录冲突",N="发送心跳信息",P={local_log_req:function(e){o.send(e,{name:"local_log_res",params:{local_log:d}})}};function k(e){var t=new Date,n=c(t),a=l(t,!0);n in d||(d[n]={}),d[n][+t]=a+"-"+i.get("class.id")+"-"+i.get("user.id","")+"-"+e,u.set(_,(0,r.default)(d))}$.extend(o.messageTypes,P),t.log=function(){k((0,r.default)(arguments))},t.init=function(){!function(){var e=new Date;try{d=JSON.parse(u.get(_))}catch(e){}$.each(d,function(t){var n=new Date(t+"T00:00:00");e-n>f&&delete d[t]}),u.set(_,(0,r.default)(d))}();var e=[];s.on(s.MASTER_SERVER_CONNECT_TIMEOUT,function(e,t){var n=t&&t.server&&t.server.url||"";k(p+n)}).on(s.MASTER_SERVER_CONNECT_FAIL,function(e,t){var n=t&&t.server&&t.server.url||"";k(h+n)}).on(s.MASTER_SERVER_CONNECT_SUCCESS,function(e,t){var n=t&&t.server&&t.server.url||"";k(g+n)}).on(s.ROOM_SERVER_LOGIN_OVERFLOW,function(){k(m)}).on(s.ROOM_SERVER_LOGIN_KICKED_OUT,function(){k(S)}).on(s.ROOM_SERVER_LOGIN_CONFLICT,function(){k(A)}).on(s.ROOM_SERVER_LOGIN_SUCCESS,function(){k(y)}).on(s.ROOM_SERVER_OFFLINE,function(e,t){var n=T;t&&t.type===a.ROOM_SERVER_OFFLINE_BY_SERVER&&(n=R+(t.code||"unknow")),k(n)}).on(s.CLASSROOM_CONNECT_TRIGGER,function(){k(I)}).on(s.CLASSROOM_CONNECT_SUCCESS,function(){k(C)}).on(s.CLASSROOM_CONNECT_FAIL,function(){k(O)}).on(s.CLASSROOM_CONNECT_TIMEOUT,function(){k(b)}).on(s.CLASSROOM_EXIT_TRIGGER,function(e,t){k(L+(t&&t.type?t.type:"unknow"))}).on(s.WEBRTC_SERVER_CONNECT_TIMEOUT,function(e,t){var n="wss://"+BJY.data.server.getWebrtcSignalUri();k(v+n)}).on(s.WEBRTC_SERVER_CONNECT_SUCCESS,function(e,t){var n="wss://"+BJY.data.server.getWebrtcSignalUri();k(E+n)}).on(s.SEND_HEARTBEAT,function(){var t=new Date,n=l(t,!0),r={};e.length>=15&&e.shift(),r[+t]=n+"-"+i.get("class.id")+"-"+i.get("user.id","")+"-"+N,e.push(r)}).on(s.LOGIN_CONFLICT,function(){k(D)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(67);return function(){return i({english:n(427),chineseLive:n(428),chineseClassroom:n(429)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(10);e.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(111);return BJY.VolumeSlider={template:n(358),propTypes:{mainIcon:{type:"string",value:""},value:{type:"number",value:100},min:{type:"number",value:0},max:{type:"number",value:100},volumeVisible:{type:"boolean",value:!1},usable:{type:"boolean",value:!0},onChange:{type:"function"},onIconClick:{type:"function"},skin:{type:"string",value:"light"},orientation:{type:"string",value:"vertical"}},computed:{icon:function(){var e=this.get("value"),t=this.get("min"),n=this.get("max")-t;return this.get("usable")?e<n/3?"low":e<2*n/3?"medium":"high":"mute"},volume:function(){var e=this.get("value");return this.transValueToVolume(e)}},watchers:{value:function(e){this.slider.set("value",this.transValueToVolume(e))}},methods:{onIconClick:function(){var e=this.get("onIconClick");e&&e()},onKeydown:function(){},transValueToVolume:function(e){var t=this.get("max");return t>100?Math.floor(e/(t/100)):e},transVolumeToValue:function(e){return Math.ceil(e*this.get("max")/100)}},afterMount:function(){var e=this,t=$(e.$el).find(".bjy-volume-number");e.slider=new r({mainElement:$(e.$el),value:e.transValueToVolume(e.get("value")),minValue:e.get("min"),maxValue:e.transValueToVolume(e.get("max")),step:1,orientation:e.get("orientation"),reverse:"vertical"===e.get("orientation"),thumbSelector:".bjy-thumb",trackSelector:".bjy-track",barSelector:".bjy-bar",draggingClass:"bjy-dragging",slideAnimation:function(n){n.thumbElement.css(n.thumbStyle),n.barElement.css(n.barStyle),"vertical"===e.get("orientation")?t.css({top:n.thumbStyle.top-8}):t.css({left:n.thumbStyle.left-14})},watchSync:{value:function(t){var n=e.get("onChange");n&&n(e.transVolumeToValue(t))}}})},beforeDestroy:function(){this.slider.dispose()},create:function(e){var t=e.value,n=e.min||0,i=e.max||100;return new Yox($.extend({el:e.element[0],replace:!1!==e.replace,props:{value:t,min:n,max:i,skin:e.skin,onChange:function(t){e.onChange&&e.onChange(t)},onIconClick:e.onIconClick}},BJY.VolumeSlider))}}}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,function(e,t,n){"use strict";var i;void 0===(i=function(){return function(e){var t={};try{t=JSON.parse(e)}catch(e){}return t}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=function(e){"use strict";var t,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function u(e,t,n,i){var r=t&&t.prototype instanceof h?t:h,a=Object.create(r.prototype),o=new O(i||[]);return a._invoke=function(e,t,n){var i=l;return function(r,a){if(i===_)throw new Error("Generator is already running");if(i===f){if("throw"===r)throw a;return L()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=R(o,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===l)throw i=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=_;var u=c(e,t,n);if("normal"===u.type){if(i=n.done?f:d,u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=f,n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var l="suspendedStart",d="suspendedYield",_="executing",f="completed",p={};function h(){}function g(){}function E(){}var v={};v[a]=function(){return this};var m=Object.getPrototypeOf,S=m&&m(m(b([])));S&&S!==n&&i.call(S,a)&&(v=S);var A=E.prototype=h.prototype=Object.create(v);function y(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function T(e){var t;this._invoke=function(n,r){function a(){return new Promise(function(t,a){!function t(n,r,a,o){var s=c(e[n],e,r);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&i.call(l,"__await")?Promise.resolve(l.__await).then(function(e){t("next",e,a,o)},function(e){t("throw",e,a,o)}):Promise.resolve(l).then(function(e){u.value=e,a(u)},function(e){return t("throw",e,a,o)})}o(s.arg)}(n,r,t,a)})}return t=t?t.then(a,a):a()}}function R(e,n){var i=e.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,R(e,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=c(i,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,p;var a=r.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function b(e){if(e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:L}}function L(){return{value:t,done:!0}}return g.prototype=A.constructor=E,E.constructor=g,E[s]=g.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(A),e},e.awrap=function(e){return{__await:e}},y(T.prototype),T.prototype[o]=function(){return this},e.AsyncIterator=T,e.async=function(t,n,i,r){var a=new T(u(t,n,i,r));return e.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},y(A),A[s]="Generator",A[a]=function(){return this},A.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=b,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return s.type="throw",s.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var u=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;C(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:b(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=i}catch(e){Function("r","regeneratorRuntime = r")(i)}},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t){return $.isNumeric(e)||(e=0),+e.toFixed(t)}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){(function(t){var n;e.exports=function e(t,i,r){function a(s,u){if(!i[s]){if(!t[s]){if(!u&&"function"==typeof n&&n)return n(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[s]={exports:{}};t[s][0].call(l.exports,function(e){return a(t[s][1][e]||e)},l,l.exports,e,t,i,r)}return i[s].exports}for(var o="function"==typeof n&&n,s=0;s<r.length;s++)a(r[s]);return a}({1:[function(e,n,i){(function(t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
!function(e,t){"object"==typeof i&&void 0!==n?n.exports=t():e.ES6Promise=t()}(this,function(){"use strict";function n(e){return"function"==typeof e}var i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=0,o=void 0,s=void 0,u=function(e,t){h[a]=e,h[a+1]=t,2===(a+=2)&&(s?s(g):A())},c="undefined"!=typeof window?window:void 0,l=c||{},d=l.MutationObserver||l.WebKitMutationObserver,_="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(g,1)}}var h=new Array(1e3);function g(){for(var e=0;e<a;e+=2)(0,h[e])(h[e+1]),h[e]=void 0,h[e+1]=void 0;a=0}var E,v,m,S,A=void 0;function y(e,t){var n=this,i=new this.constructor(I);void 0===i[R]&&V(i);var r=n._state;if(r){var a=arguments[r-1];u(function(){return M(r,i,a,n._result)})}else w(n,i,e,t);return i}function T(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(I);return D(t,e),t}_?A=function(){return t.nextTick(g)}:d?(v=0,m=new d(g),S=document.createTextNode(""),m.observe(S,{characterData:!0}),A=function(){S.data=v=++v%2}):f?((E=new MessageChannel).port1.onmessage=g,A=function(){return E.port2.postMessage(0)}):A=void 0===c&&"function"==typeof e?function(){try{var e=Function("return this")().require("vertx");return void 0!==(o=e.runOnLoop||e.runOnContext)?function(){o(g)}:p()}catch(e){return p()}}():p();var R=Math.random().toString(36).substring(2);function I(){}var C=void 0,O=1,b=2;function L(e,t,i){t.constructor===e.constructor&&i===y&&t.constructor.resolve===T?function(e,t){t._state===O?P(e,t._result):t._state===b?k(e,t._result):w(t,void 0,function(t){return D(e,t)},function(t){return k(e,t)})}(e,t):void 0===i?P(e,t):n(i)?function(e,t,n){u(function(e){var i=!1,r=function(e,t,n,i){try{e.call(t,n,i)}catch(e){return e}}(n,t,function(n){i||(i=!0,t!==n?D(e,n):P(e,n))},function(t){i||(i=!0,k(e,t))},e._label);!i&&r&&(i=!0,k(e,r))},e)}(e,t,i):P(e,t)}function D(e,t){if(e===t)k(e,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=t),null===i||"object"!==r&&"function"!==r)P(e,t);else{var n=void 0;try{n=t.then}catch(t){return void k(e,t)}L(e,t,n)}var i,r}function N(e){e._onerror&&e._onerror(e._result),U(e)}function P(e,t){e._state===C&&(e._result=t,e._state=O,0!==e._subscribers.length&&u(U,e))}function k(e,t){e._state===C&&(e._state=b,e._result=t,u(N,e))}function w(e,t,n,i){var r=e._subscribers,a=r.length;e._onerror=null,r[a]=t,r[a+O]=n,r[a+b]=i,0===a&&e._state&&u(U,e)}function U(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,r=void 0,a=e._result,o=0;o<t.length;o+=3)i=t[o],r=t[o+n],i?M(n,i,r,a):r(a);e._subscribers.length=0}}function M(e,t,i,r){var a=n(i),o=void 0,s=void 0,u=!0;if(a){try{o=i(r)}catch(e){u=!1,s=e}if(t===o)return void k(t,new TypeError("A promises callback cannot return that same promise."))}else o=r;t._state!==C||(a&&u?D(t,o):!1===u?k(t,s):e===O?P(t,o):e===b&&k(t,o))}var x=0;function V(e){e[R]=x++,e._state=void 0,e._result=void 0,e._subscribers=[]}var G=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(I),this.promise[R]||V(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&P(this.promise,this._result))):k(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===C&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===T){var r=void 0,a=void 0,o=!1;try{r=e.then}catch(e){o=!0,a=e}if(r===y&&e._state!==C)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===B){var s=new n(I);o?k(s,a):L(s,e,r),this._willSettleAt(s,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},e.prototype._settledAt=function(e,t,n){var i=this.promise;i._state===C&&(this._remaining--,e===b?k(i,n):this._result[t]=n),0===this._remaining&&P(i,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;w(e,void 0,function(e){return n._settledAt(O,t,e)},function(e){return n._settledAt(b,t,e)})},e}(),B=function(){function e(t){this[R]=x++,this._result=this._state=void 0,this._subscribers=[],I!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){D(e,t)},function(t){k(e,t)})}catch(t){k(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return n(e)?this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})}):this.then(e,e)},e}();return B.prototype.then=y,B.all=function(e){return new G(this,e).promise},B.race=function(e){var t=this;return i(e)?new t(function(n,i){for(var r=e.length,a=0;a<r;a++)t.resolve(e[a]).then(n,i)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},B.resolve=T,B.reject=function(e){var t=new this(I);return k(t,e),t},B._setScheduler=function(e){s=e},B._setAsap=function(e){u=e},B._asap=u,B.polyfill=function(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=B},B.Promise=B,B})}).call(this,e("_process"),void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],2:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function a(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,s,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(o(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(a(n))for(s=Array.prototype.slice.call(arguments,1),i=(c=n.slice()).length,u=0;u<i;u++)c[u].apply(this,s);return!0},i.prototype.addListener=function(e,t){var n;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(n=o(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){if(!r(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var n,i,o,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(n=this._events[e]).length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=o;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],3:[function(e,t,n){var i,r,a=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(e){if(i===setTimeout)return setTimeout(e,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(e){i=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,l=[],d=!1,_=-1;function f(){d&&c&&(d=!1,c.length?l=c.concat(l):_=-1,l.length&&p())}function p(){if(!d){var e=u(f);d=!0;for(var t=l.length;t;){for(c=l,l=[];++_<t;)c&&c[_].run();_=-1,t=l.length}c=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function g(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new h(e,t)),1!==l.length||d||u(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],4:[function(e,t,n){var i=arguments[3],r=arguments[4],a=arguments[5],o=JSON.stringify;t.exports=function(e,t){for(var n,s=Object.keys(a),u=0,c=s.length;u<c;u++){var l=s[u],d=a[l].exports;if(d===e||d&&d.default===e){n=l;break}}if(!n){n=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var _={};for(u=0,c=s.length;u<c;u++)_[l=s[u]]=l;r[n]=["function(require,module,exports){"+e+"(self); }",_]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[n]=n,r[f]=["function(require,module,exports){var f = require("+o(n)+");(f.default ? f.default : f)(self);}",p];var h={};!function e(t){for(var n in h[t]=!0,r[t][1]){var i=r[t][1][n];h[i]||e(i)}}(f);var g="("+i+")({"+Object.keys(h).map(function(e){return o(e)+":["+r[e][0]+","+o(r[e][1])+"]"}).join(",")+"},{},["+o(f)+"])",E=window.URL||window.webkitURL||window.mozURL||window.msURL,v=new Blob([g],{type:"text/javascript"});if(t&&t.bare)return v;var m=E.createObjectURL(v),S=new Worker(m);return S.objectURL=m,S}},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createDefaultConfig=function(){return Object.assign({},i)};var i=n.defaultConfig={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0,videoStateMonitorInterval:1e3,enableDurationMonitor:!1,maxDurationGap:1.5,decreaseDurationStep:.4,enableVideoFrozenMonitor:!1,frozenTimesThreshold:5,enableConstVideoViewSize:!1,constVideoViewWidth:1920,constVideoViewHeight:1080}},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=e("../io/io-controller.js"),o=(i=a)&&i.__esModule?i:{default:i},s=e("../config.js"),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"supportMSEH264Playback",value:function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"supportNetworkStreamIO",value:function(){var e=new o.default({},(0,s.createDefaultConfig)()),t=e.loaderType;return e.destroy(),"fetch-stream-loader"==t||"xhr-moz-chunked-loader"==t}},{key:"getNetworkLoaderTypeName",value:function(){var e=new o.default({},(0,s.createDefaultConfig)()),t=e.loaderType;return e.destroy(),t}},{key:"supportNativeMediaPlayback",value:function(t){null==e.videoElement&&(e.videoElement=window.document.createElement("video"));var n=e.videoElement.canPlayType(t);return"probably"===n||"maybe"==n}},{key:"getFeatureList",value:function(){var t={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return t.mseFlvPlayback=e.supportMSEH264Playback(),t.networkStreamIO=e.supportNetworkStreamIO(),t.networkLoaderName=e.getNetworkLoaderTypeName(),t.mseLiveFlvPlayback=t.mseFlvPlayback&&t.networkStreamIO,t.nativeMP4H264Playback=e.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),t.nativeWebmVP8Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),t.nativeWebmVP9Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp9"'),t}}]),e}();n.default=u},{"../config.js":5,"../io/io-controller.js":23}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return i(e,[{key:"isComplete",value:function(){var e=!1===this.hasAudio||!0===this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,t=!1===this.hasVideo||!0===this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&null!=this.duration&&null!=this.metadata&&null!=this.hasKeyframesIndex&&e&&t}},{key:"isSeekable",value:function(){return!0===this.hasKeyframesIndex}},{key:"getNearestKeyframe",value:function(e){if(null==this.keyframesIndex)return null;var t=this.keyframesIndex,n=this._search(t.times,e);return{index:n,milliseconds:t.times[n],fileposition:t.filepositions[n]}}},{key:"_search",value:function(e,t){var n=0,i=e.length-1,r=0,a=0,o=i;for(t<e[0]&&(n=0,a=o+1);a<=o;){if((r=a+Math.floor((o-a)/2))===i||t>=e[r]&&t<e[r+1]){n=r;break}e[r]<t?a=r+1:o=r-1}return n}}]),e}();n.default=r},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.SampleInfo=function e(t,n,i,a,o){r(this,e),this.dts=t,this.pts=n,this.duration=i,this.originalDts=a,this.isSyncPoint=o,this.fileposition=null},n.MediaSegmentInfo=function(){function e(){r(this,e),this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return i(e,[{key:"appendSyncPoint",value:function(e){e.isSyncPoint=!0,this.syncPoints.push(e)}}]),e}(),n.IDRSampleList=function(){function e(){r(this,e),this._list=[]}return i(e,[{key:"clear",value:function(){this._list=[]}},{key:"appendArray",value:function(e){var t=this._list;0!==e.length&&(t.length>0&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))}},{key:"getLastSyncPointBeforeDts",value:function(e){if(0==this._list.length)return null;var t=this._list,n=0,i=t.length-1,r=0,a=0,o=i;for(e<t[0].dts&&(n=0,a=o+1);a<=o;){if((r=a+Math.floor((o-a)/2))===i||e>=t[r].dts&&e<t[r+1].dts){n=r;break}t[r].dts<e?a=r+1:o=r-1}return this._list[n]}}]),e}(),n.MediaSegmentInfoList=function(){function e(t){r(this,e),this._type=t,this._list=[],this._lastAppendLocation=-1}return i(e,[{key:"isEmpty",value:function(){return 0===this._list.length}},{key:"clear",value:function(){this._list=[],this._lastAppendLocation=-1}},{key:"_searchNearestSegmentBefore",value:function(e){var t=this._list;if(0===t.length)return-2;var n=t.length-1,i=0,r=0,a=n,o=0;if(e<t[0].originalBeginDts)return o=-1;for(;r<=a;){if((i=r+Math.floor((a-r)/2))===n||e>t[i].lastSample.originalDts&&e<t[i+1].originalBeginDts){o=i;break}t[i].originalBeginDts<e?r=i+1:a=i-1}return o}},{key:"_searchNearestSegmentAfter",value:function(e){return this._searchNearestSegmentBefore(e)+1}},{key:"append",value:function(e){var t=this._list,n=e,i=this._lastAppendLocation,r=0;-1!==i&&i<t.length&&n.originalBeginDts>=t[i].lastSample.originalDts&&(i===t.length-1||i<t.length-1&&n.originalBeginDts<t[i+1].originalBeginDts)?r=i+1:t.length>0&&(r=this._searchNearestSegmentBefore(n.originalBeginDts)+1),this._lastAppendLocation=r,this._list.splice(r,0,n)}},{key:"getLastSegmentBefore",value:function(e){var t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null}},{key:"getLastSampleBefore",value:function(e){var t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null}},{key:"getLastSyncPointBefore",value:function(e){for(var t=this._searchNearestSegmentBefore(e),n=this._list[t].syncPoints;0===n.length&&t>0;)t--,n=this._list[t].syncPoints;return n.length>0?n[n.length-1]:null}},{key:"type",get:function(){return this._type}},{key:"length",get:function(){return this._list.length}}]),e}()},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=l(e("events")),a=l(e("../utils/logger.js")),o=l(e("../utils/browser.js")),s=l(e("./mse-events.js")),u=e("./media-segment-info.js"),c=e("../utils/exception.js");function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TAG="MSEController",this._config=t,this._emitter=new r.default,this._config.isLive&&null==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new u.IDRSampleList,this.SECONDS_PER_SAMPLE=1/48e3}return i(e,[{key:"destroy",value:function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null}},{key:"on",value:function(e,t){this._emitter.addListener(e,t)}},{key:"off",value:function(e,t){this._emitter.removeListener(e,t)}},{key:"attachMediaElement",value:function(e){if(this._mediaSource)throw new c.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=e,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),e.src=this._mediaSourceObjectURL}},{key:"detachMediaElement",value:function(){if(this._mediaSource){var e=this._mediaSource;for(var t in this._sourceBuffers){var n=this._pendingSegments[t];n.splice(0,n.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var i=this._sourceBuffers[t];if(i){if("closed"!==e.readyState){try{e.removeSourceBuffer(i)}catch(e){a.default.e(this.TAG,e.message)}i.removeEventListener("error",this.e.onSourceBufferError),i.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if("open"===e.readyState)try{e.endOfStream()}catch(e){a.default.e(this.TAG,e.message)}e.removeEventListener("sourceopen",this.e.onSourceOpen),e.removeEventListener("sourceended",this.e.onSourceEnded),e.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)}},{key:"checkMediaSource",value:function(e){return!(!this._mediaSource||"open"!==this._mediaSource.readyState)}},{key:"appendInitSegment",value:function(e,t){if(!this.checkMediaSource("appendInitSegment"))return this._pendingSourceBufferInit.push(e),void this._pendingSegments[e.type].push(e);var n=e,i=""+n.container;n.codec&&n.codec.length>0&&(i+=";codecs="+n.codec);var r=!1;if(a.default.v(this.TAG,"Received Initialization Segment, mimeType: "+i),this._lastInitSegments[n.type]=n,i!==this._mimeTypes[n.type]){if(this._mimeTypes[n.type])a.default.v(this.TAG,"Notice: "+n.type+" mimeType changed, origin: "+this._mimeTypes[n.type]+", target: "+i);else{r=!0;try{var u=this._sourceBuffers[n.type]=this._mediaSource.addSourceBuffer(i);u.addEventListener("error",this.e.onSourceBufferError),u.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(e){return a.default.e(this.TAG,e.message),void this._emitter.emit(s.default.ERROR,{code:e.code,msg:e.message})}}this._mimeTypes[n.type]=i}t||this._pendingSegments[n.type].push(n),r||this._sourceBuffers[n.type]&&!this._sourceBuffers[n.type].updating&&this._doAppendSegments(),o.default.safari&&"audio/mpeg"===n.container&&n.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=n.mediaDuration/1e3,this._updateMediaSourceDuration())}},{key:"appendMediaSegment",value:function(e){if(this.checkMediaSource("appendMediaSegment")){var t=e;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var n=this._sourceBuffers[t.type];!n||n.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()}}},{key:"seek",value:function(e){if(this.checkMediaSource("seek"))for(var t in this._sourceBuffers)if(this._sourceBuffers[t]){var n=this._sourceBuffers[t];if("open"===this._mediaSource.readyState)try{n.abort()}catch(e){a.default.e(this.TAG,e.message)}this._idrList.clear();var i=this._pendingSegments[t];if(i.splice(0,i.length),"closed"!==this._mediaSource.readyState){for(var r=0;r<n.buffered.length;r++){var s=n.buffered.start(r),u=n.buffered.end(r);this._pendingRemoveRanges[t].push({start:s,end:u})}if(n.updating||this._doRemoveRanges("seek"),o.default.safari){var c=this._lastInitSegments[t];c&&(this._pendingSegments[t].push(c),n.updating||this._doAppendSegments())}}}}},{key:"endOfStream",value:function(){var e=this._mediaSource,t=this._sourceBuffers;e&&"open"===e.readyState?t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,e.endOfStream()):e&&"closed"===e.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)}},{key:"getNearestKeyframe",value:function(e){return this._idrList.getLastSyncPointBeforeDts(e)}},{key:"_needCleanupSourceBuffer",value:function(){if(!this._config.autoCleanupSourceBuffer)return!1;if(!this.checkMediaSource("_needCleanupSourceBuffer"))return!1;var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var n=this._sourceBuffers[t];if(n){var i=n.buffered;if(i.length>=1&&e-i.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1}},{key:"_doCleanupSourceBuffer",value:function(){var e=this._mediaElement.currentTime;if(this.checkMediaSource("_doCleanupSourceBuffer"))for(var t in this._sourceBuffers){var n=this._sourceBuffers[t];if(n){for(var i=n.buffered,r=!1,a=0;a<i.length;a++){var o=i.start(a),s=i.end(a);if(o<=e&&e<s+3){if(e-o>=this._config.autoCleanupMaxBackwardDuration){r=!0;var u=e-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:o,end:u})}}else s<e&&(r=!0,this._pendingRemoveRanges[t].push({start:o,end:s}))}r&&!n.updating&&this._doRemoveRanges("_doCleanupSourceBuffer")}}}},{key:"_updateMediaSourceDuration",value:function(){if(this.checkMediaSource("_updateMediaSourceDuration")){var e=this._sourceBuffers;if(0!==this._mediaElement.readyState&&"open"===this._mediaSource.readyState&&!(e.video&&e.video.updating||e.audio&&e.audio.updating)){var t=this._mediaSource.duration,n=this._pendingMediaDuration;n>0&&(isNaN(t)||n>t)&&(a.default.v(this.TAG,"Update MediaSource duration from "+t+" to "+n),this._mediaSource.duration=n),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}}}},{key:"_doRemoveRanges",value:function(e){if(this.checkMediaSource("_doRemoveRanges"))for(var t in this._pendingRemoveRanges)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating)for(var n=this._sourceBuffers[t],i=this._pendingRemoveRanges[t];i.length&&!n.updating;){var r=i.shift();n.remove(r.start,r.end)}}},{key:"readInt",value:function(e){for(var t=e.charCodeAt(0),n=1;n<e.length;++n)t<<=8,t+=e.charCodeAt(n);return t}},{key:"parseGaplessData",value:function(e){var t=String.fromCharCode.apply(null,new Uint8Array(e.slice(0,4096))),n=0,i=0,r=0,a=t.indexOf("iTunSMPB");if(-1!==a){var o=a+34;n=parseInt(t.substr(o,8),16);var s=o+9;i=parseInt(t.substr(s,8),16);var u=s+9;r=parseInt(t.substr(u,16),16)}var c=t.indexOf("Xing");if(-1===c&&(c=t.indexOf("Info")),-1!==c){var l=c+8;if(r=1152*this.readInt(t.substr(l,4)),-1===(c=t.indexOf("LAME"))&&(c=t.indexOf("Lavf")),-1!==c){var d=c+21,_=this.readInt(t.substr(d,3));n=_>>12,i=4095&_}r-=n+i}return console.log(r+" -- "+n+" -- "+i),{audioDuration:r*this.SECONDS_PER_SAMPLE,frontPaddingDuration:n*this.SECONDS_PER_SAMPLE,endPaddingDuration:i*this.SECONDS_PER_SAMPLE}}},{key:"_doAppendSegments",value:function(){if(this.checkMediaSource("_doAppendSegments")){var e=this._pendingSegments;for(var t in e)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating&&e[t].length>0){var n=e[t].shift();if(n.timestampOffset){var i=this._sourceBuffers[t].timestampOffset,r=n.timestampOffset/1e3;Math.abs(i-r)>.1&&(a.default.v(this.TAG,"Update MPEG audio timestampOffset from "+i+" to "+r),this._sourceBuffers[t].timestampOffset=r),delete n.timestampOffset}if(!n.data||0===n.data.byteLength)continue;try{this._sourceBuffers[t].appendBuffer(n.data),this._isBufferFull=!1,"video"===t&&n.hasOwnProperty("info")&&this._idrList.appendArray(n.info.syncPoints)}catch(e){this._pendingSegments[t].unshift(n),22===e.code?(this._isBufferFull||this._emitter.emit(s.default.BUFFER_FULL),this._isBufferFull=!0):(a.default.e(this.TAG,e.message),this._emitter.emit(s.default.ERROR,{code:e.code,msg:e.message}))}}}}},{key:"_onSourceOpen",value:function(){if(a.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var e=this._pendingSourceBufferInit;e.length;){var t=e.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(s.default.SOURCE_OPEN)}},{key:"_onSourceEnded",value:function(){a.default.v(this.TAG,"MediaSource onSourceEnded"),this._emitter.emit(s.default.SOURCE_END)}},{key:"_onSourceClose",value:function(){a.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose)),this._emitter.emit(s.default.SOURCE_CLOSE)}},{key:"_hasPendingSegments",value:function(){var e=this._pendingSegments;return e.video.length>0||e.audio.length>0}},{key:"_hasPendingRemoveRanges",value:function(){var e=this._pendingRemoveRanges;return e.video.length>0||e.audio.length>0}},{key:"_onSourceBufferUpdateEnd",value:function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges("_onSourceBufferUpdateEnd"):this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(s.default.UPDATE_END)}},{key:"_onSourceBufferError",value:function(e){a.default.e(this.TAG,"SourceBuffer Error: "+e)}}]),e}();n.default=d},{"../utils/browser.js":39,"../utils/exception.js":40,"../utils/logger.js":41,"./media-segment-info.js":8,"./mse-events.js":10,events:2}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full",SOURCE_END:"source_end",SOURCE_CLOSE:"source_close"}},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=d(e("events")),a=d(e("../utils/logger.js")),o=d(e("../utils/logging-control.js")),s=d(e("./transmuxing-controller.js")),u=d(e("./transmuxing-events.js")),c=d(e("./transmuxing-worker.js")),l=d(e("./media-info.js"));function d(e){return e&&e.__esModule?e:{default:e}}var _=function(){function t(n,i){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.TAG="Transmuxer",this._emitter=new r.default,i.enableWorker&&"undefined"!=typeof Worker)try{var l=e("webworkify");this._worker=l(c.default),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[n,i]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},o.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:o.default.getConfig()})}catch(e){a.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new s.default(n,i)}else this._controller=new s.default(n,i);if(this._controller){var d=this._controller;d.on(u.default.IO_ERROR,this._onIOError.bind(this)),d.on(u.default.DEMUX_ERROR,this._onDemuxError.bind(this)),d.on(u.default.INIT_SEGMENT,this._onInitSegment.bind(this)),d.on(u.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),d.on(u.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),d.on(u.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),d.on(u.default.MEDIA_INFO,this._onMediaInfo.bind(this)),d.on(u.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),d.on(u.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),d.on(u.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),d.on(u.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this)),d.on(u.default.VIDEO_RESOLUTION_CHANGED,this._onVideoResolutionChanged.bind(this))}}return i(t,[{key:"destroy",value:function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),o.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null}},{key:"on",value:function(e,t){this._emitter.addListener(e,t)}},{key:"off",value:function(e,t){this._emitter.removeListener(e,t)}},{key:"hasWorker",value:function(){return null!=this._worker}},{key:"open",value:function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()}},{key:"close",value:function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()}},{key:"seek",value:function(e){this._worker?this._worker.postMessage({cmd:"seek",param:e}):this._controller.seek(e)}},{key:"pause",value:function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()}},{key:"resume",value:function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()}},{key:"_onInitSegment",value:function(e,t){var n=this;Promise.resolve().then(function(){null!=n._emitter&&n._emitter.emit(u.default.INIT_SEGMENT,e,t)})}},{key:"_onMediaSegment",value:function(e,t){var n=this;Promise.resolve().then(function(){null!=n._emitter&&n._emitter.emit(u.default.MEDIA_SEGMENT,e,t)})}},{key:"_onLoadingComplete",value:function(){var e=this;Promise.resolve().then(function(){e._emitter.emit(u.default.LOADING_COMPLETE)})}},{key:"_onRecoveredEarlyEof",value:function(){var e=this;Promise.resolve().then(function(){e._emitter.emit(u.default.RECOVERED_EARLY_EOF)})}},{key:"_onMediaInfo",value:function(e){var t=this;Promise.resolve().then(function(){null!=t._emitter&&t._emitter.emit(u.default.MEDIA_INFO,e)})}},{key:"_onMetaDataArrived",value:function(e){var t=this;Promise.resolve().then(function(){null!=t._emitter&&t._emitter.emit(u.default.METADATA_ARRIVED,e)})}},{key:"_onScriptDataArrived",value:function(e){var t=this;Promise.resolve().then(function(){null!=t._emitter&&t._emitter.emit(u.default.SCRIPTDATA_ARRIVED,e)})}},{key:"_onStatisticsInfo",value:function(e){var t=this;Promise.resolve().then(function(){t._emitter.emit(u.default.STATISTICS_INFO,e)})}},{key:"_onIOError",value:function(e,t){var n=this;Promise.resolve().then(function(){null!=n._emitter&&n._emitter.emit(u.default.IO_ERROR,e,t)})}},{key:"_onDemuxError",value:function(e,t){var n=this;Promise.resolve().then(function(){null!=n._emitter&&n._emitter.emit(u.default.DEMUX_ERROR,e,t)})}},{key:"_onRecommendSeekpoint",value:function(e){var t=this;Promise.resolve().then(function(){t._emitter.emit(u.default.RECOMMEND_SEEKPOINT,e)})}},{key:"_onLoggingConfigChanged",value:function(e){this._worker&&this._worker.postMessage({cmd:"logging_config",param:e})}},{key:"_onVideoResolutionChanged",value:function(e){var t=this;Promise.resolve().then(function(){null!=t._emitter&&t._emitter.emit(u.default.VIDEO_RESOLUTION_CHANGED,e)})}},{key:"_onWorkerMessage",value:function(e){var t=e.data,n=t.data;if("destroyed"===t.msg||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(t.msg){case u.default.INIT_SEGMENT:case u.default.MEDIA_SEGMENT:this._emitter.emit(t.msg,n.type,n.data);break;case u.default.LOADING_COMPLETE:case u.default.RECOVERED_EARLY_EOF:this._emitter.emit(t.msg);break;case u.default.MEDIA_INFO:Object.setPrototypeOf(n,l.default.prototype),this._emitter.emit(t.msg,n);break;case u.default.METADATA_ARRIVED:case u.default.SCRIPTDATA_ARRIVED:case u.default.STATISTICS_INFO:this._emitter.emit(t.msg,n);break;case u.default.IO_ERROR:case u.default.DEMUX_ERROR:this._emitter.emit(t.msg,n.type,n.info);break;case u.default.RECOMMEND_SEEKPOINT:this._emitter.emit(t.msg,n);break;case"logcat_callback":a.default.emitter.emit("log",n.type,n.logcat)}}}]),t}();n.default=_},{"../utils/logger.js":41,"../utils/logging-control.js":42,"./media-info.js":7,"./transmuxing-controller.js":12,"./transmuxing-events.js":13,"./transmuxing-worker.js":14,events:2,webworkify:4}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=f(e("events")),a=f(e("../utils/logger.js")),o=f(e("../utils/browser.js")),s=f(e("./media-info.js")),u=f(e("../demux/flv-demuxer.js")),c=f(e("../remux/mp4-remuxer.js")),l=f(e("../demux/demux-errors.js")),d=f(e("../io/io-controller.js")),_=f(e("./transmuxing-events.js"));function f(e){return e&&e.__esModule?e:{default:e}}e("../io/loader.js");var p=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TAG="TransmuxingController",this._emitter=new r.default,this._config=n,t.segments||(t.segments=[{duration:t.duration,filesize:t.filesize,url:t.url}]),"boolean"!=typeof t.cors&&(t.cors=!0),"boolean"!=typeof t.withCredentials&&(t.withCredentials=!1),this._mediaDataSource=t,this._currentSegmentIndex=0;var i=0;this._mediaDataSource.segments.forEach(function(e){e.timestampBase=i,i+=e.duration,e.cors=t.cors,e.withCredentials=t.withCredentials,n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy)}),isNaN(i)||this._mediaDataSource.duration===i||(this._mediaDataSource.duration=i),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return i(e,[{key:"destroy",value:function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null}},{key:"on",value:function(e,t){this._emitter.addListener(e,t)}},{key:"off",value:function(e,t){this._emitter.removeListener(e,t)}},{key:"start",value:function(){this._loadSegment(0),this._enableStatisticsReporter()}},{key:"_loadSegment",value:function(e,t){this._currentSegmentIndex=e;var n=this._mediaDataSource.segments[e],i=this._ioctl=new d.default(n,this._config,e);i.onError=this._onIOException.bind(this),i.onSeeked=this._onIOSeeked.bind(this),i.onComplete=this._onIOComplete.bind(this),i.onRedirect=this._onIORedirect.bind(this),i.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),t?this._demuxer.bindDataSource(this._ioctl):i.onDataArrival=this._onInitChunkArrival.bind(this),i.open(t)}},{key:"stop",value:function(){this._internalAbort(),this._disableStatisticsReporter()}},{key:"_internalAbort",value:function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)}},{key:"pause",value:function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())}},{key:"resume",value:function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())}},{key:"seek",value:function(e){if(null!=this._mediaInfo&&this._mediaInfo.isSeekable()){var t=this._searchSegmentIndexContains(e);if(t===this._currentSegmentIndex){var n=this._mediaInfo.segments[t];if(null==n)this._pendingSeekTime=e;else{var i=n.getNearestKeyframe(e);this._remuxer.seek(i.milliseconds),this._ioctl.seek(i.fileposition),this._pendingResolveSeekPoint=i.milliseconds}}else{var r=this._mediaInfo.segments[t];if(null==r)this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(t);else{var a=r.getNearestKeyframe(e);this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[t].timestampBase,this._loadSegment(t,a.fileposition),this._pendingResolveSeekPoint=a.milliseconds,this._reportSegmentMediaInfo(t)}}this._enableStatisticsReporter()}}},{key:"_searchSegmentIndexContains",value:function(e){for(var t=this._mediaDataSource.segments,n=t.length-1,i=0;i<t.length;i++)if(e<t[i].timestampBase){n=i-1;break}return n}},{key:"_onInitChunkArrival",value:function(e,t){var n=this,i=null,r=0;if(t>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,r=this._demuxer.parseChunks(e,t);else if((i=u.default.probe(e)).match){this._demuxer=new u.default(i,this._config),this._remuxer||(this._remuxer=new c.default(this._config));var o=this._mediaDataSource;null==o.duration||isNaN(o.duration)||(this._demuxer.overridedDuration=o.duration),"boolean"==typeof o.hasAudio&&(this._demuxer.overridedHasAudio=o.hasAudio),"boolean"==typeof o.hasVideo&&(this._demuxer.overridedHasVideo=o.hasVideo),this._demuxer.timestampBase=o.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._demuxer.onVideoResolutionChanged=this._onVideoResolutionChanged.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),r=this._demuxer.parseChunks(e,t)}else i=null,a.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){n._internalAbort()}),this._emitter.emit(_.default.DEMUX_ERROR,l.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),r=0;return r}},{key:"_onMediaInfo",value:function(e){var t=this;null==this._mediaInfo&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,s.default.prototype));var n=Object.assign({},e);Object.setPrototypeOf(n,s.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=n,this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then(function(){var e=t._pendingSeekTime;t._pendingSeekTime=null,t.seek(e)})}},{key:"_onMetaDataArrived",value:function(e){this._emitter.emit(_.default.METADATA_ARRIVED,e)}},{key:"_onScriptDataArrived",value:function(e){this._emitter.emit(_.default.SCRIPTDATA_ARRIVED,e)}},{key:"_onIOSeeked",value:function(){this._remuxer.insertDiscontinuity()}},{key:"_onIOComplete",value:function(e){var t=e+1;t<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(t)):(this._remuxer.flushStashedSamples(),this._emitter.emit(_.default.LOADING_COMPLETE),this._disableStatisticsReporter())}},{key:"_onIORedirect",value:function(e){var t=this._ioctl.extraData;this._mediaDataSource.segments[t].redirectedURL=e}},{key:"_onIORecoveredEarlyEof",value:function(){this._emitter.emit(_.default.RECOVERED_EARLY_EOF)}},{key:"_onIOException",value:function(e,t){a.default.e(this.TAG,"IOException: type = "+e+", code = "+t.code+", msg = "+t.msg),this._emitter.emit(_.default.IO_ERROR,e,t),this._disableStatisticsReporter()}},{key:"_onDemuxException",value:function(e,t){a.default.e(this.TAG,"DemuxException: type = "+e+", info = "+t),this._emitter.emit(_.default.DEMUX_ERROR,e,t)}},{key:"_onRemuxerInitSegmentArrival",value:function(e,t){this._emitter.emit(_.default.INIT_SEGMENT,e,t)}},{key:"_onRemuxerMediaSegmentArrival",value:function(e,t){if(null==this._pendingSeekTime&&(this._emitter.emit(_.default.MEDIA_SEGMENT,e,t),null!=this._pendingResolveSeekPoint&&"video"===e)){var n=t.info.syncPoints,i=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,o.default.safari&&n.length>0&&n[0].originalDts===i&&(i=n[0].pts),this._emitter.emit(_.default.RECOMMEND_SEEKPOINT,i)}}},{key:"_enableStatisticsReporter",value:function(){null==this._statisticsReporter&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))}},{key:"_disableStatisticsReporter",value:function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}},{key:"_reportSegmentMediaInfo",value:function(e){var t=this._mediaInfo.segments[e],n=Object.assign({},t);n.duration=this._mediaInfo.duration,n.segmentCount=this._mediaInfo.segmentCount,delete n.segments,delete n.keyframesIndex,this._emitter.emit(_.default.MEDIA_INFO,n)}},{key:"_reportStatisticsInfo",value:function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._demuxer&&this._demuxer._bpsInfo&&(e.bps_video=this._demuxer._bpsInfo.bps_video,e.bps_audio=this._demuxer._bpsInfo.bps_audio),this._emitter.emit(_.default.STATISTICS_INFO,e)}},{key:"_onVideoResolutionChanged",value:function(e){this._emitter.emit(_.default.VIDEO_RESOLUTION_CHANGED,e)}}]),e}();n.default=p},{"../demux/demux-errors.js":16,"../demux/flv-demuxer.js":18,"../io/io-controller.js":23,"../io/loader.js":24,"../remux/mp4-remuxer.js":38,"../utils/browser.js":39,"../utils/logger.js":41,"./media-info.js":7,"./transmuxing-events.js":13,events:2}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint",VIDEO_RESOLUTION_CHANGED:"video_resolution_changed"}},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),s(e("../utils/logger.js"));var i=s(e("../utils/logging-control.js")),r=s(e("../utils/polyfill.js")),a=s(e("./transmuxing-controller.js")),o=s(e("./transmuxing-events.js"));function s(e){return e&&e.__esModule?e:{default:e}}n.default=function(e){var t=null,n=function(t,n){e.postMessage({msg:"logcat_callback",data:{type:t,logcat:n}})}.bind(this);r.default.install(),e.addEventListener("message",function(r){switch(r.data.cmd){case"init":(t=new a.default(r.data.param[0],r.data.param[1])).on(o.default.IO_ERROR,function(t,n){e.postMessage({msg:o.default.IO_ERROR,data:{type:t,info:n}})}.bind(this)),t.on(o.default.DEMUX_ERROR,function(t,n){e.postMessage({msg:o.default.DEMUX_ERROR,data:{type:t,info:n}})}.bind(this)),t.on(o.default.INIT_SEGMENT,function(t,n){var i={msg:o.default.INIT_SEGMENT,data:{type:t,data:n}};e.postMessage(i,[n.data])}.bind(this)),t.on(o.default.MEDIA_SEGMENT,function(t,n){var i={msg:o.default.MEDIA_SEGMENT,data:{type:t,data:n}};e.postMessage(i,[n.data])}.bind(this)),t.on(o.default.LOADING_COMPLETE,function(){var t={msg:o.default.LOADING_COMPLETE};e.postMessage(t)}.bind(this)),t.on(o.default.RECOVERED_EARLY_EOF,function(){var t={msg:o.default.RECOVERED_EARLY_EOF};e.postMessage(t)}.bind(this)),t.on(o.default.MEDIA_INFO,function(t){var n={msg:o.default.MEDIA_INFO,data:t};e.postMessage(n)}.bind(this)),t.on(o.default.METADATA_ARRIVED,function(t){var n={msg:o.default.METADATA_ARRIVED,data:t};e.postMessage(n)}.bind(this)),t.on(o.default.SCRIPTDATA_ARRIVED,function(t){var n={msg:o.default.SCRIPTDATA_ARRIVED,data:t};e.postMessage(n)}.bind(this)),t.on(o.default.STATISTICS_INFO,function(t){var n={msg:o.default.STATISTICS_INFO,data:t};e.postMessage(n)}.bind(this)),t.on(o.default.RECOMMEND_SEEKPOINT,function(t){e.postMessage({msg:o.default.RECOMMEND_SEEKPOINT,data:t})}.bind(this)),t.on(o.default.VIDEO_RESOLUTION_CHANGED,function(t){var n={msg:o.default.VIDEO_RESOLUTION_CHANGED,data:t};e.postMessage(n)}.bind(this));break;case"destroy":t&&(t.destroy(),t=null),e.postMessage({msg:"destroyed"});break;case"start":t.start();break;case"stop":t.stop();break;case"seek":t.seek(r.data.param);break;case"pause":t.pause();break;case"resume":t.resume();break;case"logging_config":var s=r.data.param;i.default.applyConfig(s),!0===s.enableCallback?i.default.addLogListener(n):i.default.removeLogListener(n)}})}},{"../utils/logger.js":41,"../utils/logging-control.js":42,"../utils/polyfill.js":43,"./transmuxing-controller.js":12,"./transmuxing-events.js":13}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=s(e("../utils/logger.js")),a=s(e("../utils/utf8-conv.js")),o=e("../utils/exception.js");function s(e){return e&&e.__esModule?e:{default:e}}var u,c=(u=new ArrayBuffer(2),new DataView(u).setInt16(0,256,!0),256===new Int16Array(u)[0]),l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"parseScriptData",value:function(t,n,i){var a={};try{var o=e.parseValue(t,n,i),s=e.parseValue(t,n+o.size,i-o.size);a[o.data]=s.data}catch(e){r.default.e("AMF",e.toString())}return a}},{key:"parseObject",value:function(t,n,i){if(i<3)throw new o.IllegalStateException("Data not enough when parse ScriptDataObject");var r=e.parseString(t,n,i),a=e.parseValue(t,n+r.size,i-r.size),s=a.objectEnd;return{data:{name:r.data,value:a.data},size:r.size+a.size,objectEnd:s}}},{key:"parseVariable",value:function(t,n,i){return e.parseObject(t,n,i)}},{key:"parseString",value:function(e,t,n){if(n<2)throw new o.IllegalStateException("Data not enough when parse String");var i=new DataView(e,t,n).getUint16(0,!c);return{data:i>0?(0,a.default)(new Uint8Array(e,t+2,i)):"",size:2+i}}},{key:"parseLongString",value:function(e,t,n){if(n<4)throw new o.IllegalStateException("Data not enough when parse LongString");var i=new DataView(e,t,n).getUint32(0,!c);return{data:i>0?(0,a.default)(new Uint8Array(e,t+4,i)):"",size:4+i}}},{key:"parseDate",value:function(e,t,n){if(n<10)throw new o.IllegalStateException("Data size invalid when parse Date");var i=new DataView(e,t,n),r=i.getFloat64(0,!c),a=i.getInt16(8,!c);return{data:new Date(r+=60*a*1e3),size:10}}},{key:"parseValue",value:function(t,n,i){if(i<1)throw new o.IllegalStateException("Data not enough when parse Value");var a=new DataView(t,n,i),s=1,u=a.getUint8(0),l=void 0,d=!1;try{switch(u){case 0:l=a.getFloat64(1,!c),s+=8;break;case 1:l=!!a.getUint8(1),s+=1;break;case 2:var _=e.parseString(t,n+1,i-1);l=_.data,s+=_.size;break;case 3:l={};var f=0;for(9==(16777215&a.getUint32(i-4,!c))&&(f=3);s<i-4;){var p=e.parseObject(t,n+s,i-s-f);if(p.objectEnd)break;l[p.data.name]=p.data.value,s+=p.size}s<=i-3&&9==(16777215&a.getUint32(s-1,!c))&&(s+=3);break;case 8:l={},s+=4;var h=0;for(9==(16777215&a.getUint32(i-4,!c))&&(h=3);s<i-8;){var g=e.parseVariable(t,n+s,i-s-h);if(g.objectEnd)break;l[g.data.name]=g.data.value,s+=g.size}s<=i-3&&9==(16777215&a.getUint32(s-1,!c))&&(s+=3);break;case 9:l=void 0,s=1,d=!0;break;case 10:l=[];var E=a.getUint32(1,!c);s+=4;for(var v=0;v<E;v++){var m=e.parseValue(t,n+s,i-s);l.push(m.data),s+=m.size}break;case 11:var S=e.parseDate(t,n+1,i-1);l=S.data,s+=S.size;break;case 12:var A=e.parseString(t,n+1,i-1);l=A.data,s+=A.size;break;default:s=i,r.default.w("AMF","Unsupported AMF value type "+u)}}catch(e){r.default.e("AMF",e.toString())}return{data:l,size:s,objectEnd:d}}}]),e}();n.default=l},{"../utils/exception.js":40,"../utils/logger.js":41,"../utils/utf8-conv.js":44}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},{}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=e("../utils/exception.js"),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TAG="ExpGolomb",this._buffer=t,this._buffer_index=0,this._total_bytes=t.byteLength,this._total_bits=8*t.byteLength,this._current_word=0,this._current_word_bits_left=0}return i(e,[{key:"destroy",value:function(){this._buffer=null}},{key:"_fillCurrentWord",value:function(){var e=this._total_bytes-this._buffer_index;if(e<=0)throw new r.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var t=Math.min(4,e),n=new Uint8Array(4);n.set(this._buffer.subarray(this._buffer_index,this._buffer_index+t)),this._current_word=new DataView(n.buffer).getUint32(0,!1),this._buffer_index+=t,this._current_word_bits_left=8*t}},{key:"readBits",value:function(e){if(e>32)throw new r.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(e<=this._current_word_bits_left){var t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}var n=this._current_word_bits_left?this._current_word:0;n>>>=32-this._current_word_bits_left;var i=e-this._current_word_bits_left;this._fillCurrentWord();var a=Math.min(i,this._current_word_bits_left),o=this._current_word>>>32-a;return this._current_word<<=a,this._current_word_bits_left-=a,n=n<<a|o}},{key:"readBool",value:function(){return 1===this.readBits(1)}},{key:"readByte",value:function(){return this.readBits(8)}},{key:"_skipLeadingZero",value:function(){var e=void 0;for(e=0;e<this._current_word_bits_left;e++)if(0!=(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()}},{key:"readUEG",value:function(){var e=this._skipLeadingZero();return this.readBits(e+1)-1}},{key:"readSEG",value:function(){var e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)}}]),e}();n.default=a},{"../utils/exception.js":40}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=d(e("../utils/logger.js")),o=d(e("./amf-parser.js")),s=d(e("./sps-parser.js")),u=d(e("./demux-errors.js")),c=d(e("../core/media-info.js")),l=e("../utils/exception.js");function d(e){return e&&e.__esModule?e:{default:e}}var _=function(){function e(t,n){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TAG="FLVDemuxer",this._config=n,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._onVideoResolutionChanged=null,this._dataOffset=t.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=t.hasAudioTrack,this._hasVideo=t.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new c.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._lastVideoDimension={width:-1,height:-1,profile:"",level:""},this._bpsCalculator=null,this._bpsInfo={lastVideoBytes:0,lastAudioBytes:0,bps_video:0,bps_audio:0},this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=(i=new ArrayBuffer(2),new DataView(i).setInt16(0,256,!0),256===new Int16Array(i)[0])}return r(e,[{key:"destroy",value:function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._lastVideoDimension=null,this._bpsCalculator&&(self.clearInterval(this._bpsCalculator),this._bpsCalculator=null,this._bpsInfo=null)}},{key:"bindDataSource",value:function(e){return e.onDataArrival=this.parseChunks.bind(this),this}},{key:"resetMediaInfo",value:function(){this._mediaInfo=new c.default}},{key:"_isInitialMetadataDispatched",value:function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched}},{key:"_calculateRealtimeBitrate",value:function(){this._bpsInfo&&(this._bpsInfo.bps_video=8*this._bpsInfo.lastVideoBytes/1024,this._bpsInfo.bps_audio=8*this._bpsInfo.lastAudioBytes/1024,this._bpsInfo.lastVideoBytes=this._bpsInfo.lastAudioBytes=0)}},{key:"parseChunks",value:function(t,n){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new l.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var i=0,r=this._littleEndian;if(0===n){if(!(t.byteLength>13))return 0;i=e.probe(t).dataOffset}this._bpsCalculator||(this._bpsCalculator=self.setInterval(this._calculateRealtimeBitrate.bind(this),1e3)),this._firstParse&&(this._firstParse=!1,n+i!==this._dataOffset&&a.default.w(this.TAG,"First time parsing but chunk byteStart invalid!"),0!==new DataView(t,i).getUint32(0,!r)&&a.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),i+=4);for(var o=0,s=0;i<t.byteLength;){this._dispatch=!0;var u=new DataView(t,i);if(i+11+4>t.byteLength)break;var c=u.getUint8(0),d=16777215&u.getUint32(0,!r);if(i+11+d+4>t.byteLength)break;if(8===c||9===c||18===c){var _=u.getUint8(4),f=u.getUint8(5),p=u.getUint8(6)|f<<8|_<<16|u.getUint8(7)<<24;0!=(16777215&u.getUint32(7,!r))&&a.default.w(this.TAG,"Meet tag which has StreamID != 0!");var h=i+11;switch(c){case 8:this._parseAudioData(t,h,d,p),s+=d;break;case 9:this._parseVideoData(t,h,d,p,n+i),o+=d;break;case 18:this._parseScriptData(t,h,d)}var g=u.getUint32(11+d,!r);g!==11+d&&a.default.w(this.TAG,"Invalid PrevTagSize "+g),i+=11+d+4}else a.default.w(this.TAG,"Unsupported tag type "+c+", skipped"),i+=11+d+4}return this._bpsInfo&&(this._bpsInfo.lastAudioBytes+=s,this._bpsInfo.lastVideoBytes+=o),this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),i}},{key:"_parseScriptData",value:function(e,t,n){var r=o.default.parseScriptData(e,t,n);if(r.hasOwnProperty("onMetaData")){if(null==r.onMetaData||"object"!==i(r.onMetaData))return void a.default.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&a.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=r;var s=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},s)),"boolean"==typeof s.hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=s.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),"boolean"==typeof s.hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=s.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),"number"==typeof s.audiodatarate&&(this._mediaInfo.audioDataRate=s.audiodatarate),"number"==typeof s.videodatarate&&(this._mediaInfo.videoDataRate=s.videodatarate),"number"==typeof s.width&&(this._mediaInfo.width=s.width),"number"==typeof s.height&&(this._mediaInfo.height=s.height),"number"==typeof s.duration){if(!this._durationOverrided){var u=Math.floor(s.duration*this._timescale);this._duration=u,this._mediaInfo.duration=u}}else this._mediaInfo.duration=0;if("number"==typeof s.framerate){var c=Math.floor(1e3*s.framerate);if(c>0){var l=c/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=l,this._referenceFrameRate.fps_num=c,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=l}}if("object"===i(s.keyframes)){this._mediaInfo.hasKeyframesIndex=!0;var d=s.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(d),s.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=s,a.default.v(this.TAG,"Parsed onMetaData, hasAudio:"+this._mediaInfo.hasAudio+", hasVideo:"+this._mediaInfo.hasVideo+", video demension:"+this._mediaInfo.width+"x"+this._mediaInfo.height+"@"+this._mediaInfo.fps+" fps, hasKeyframesIndex="+this._mediaInfo.hasKeyframesIndex+", video_bitrate="+this._mediaInfo.videoDataRate+", audio_bitrate="+this._mediaInfo.audioDataRate),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(r).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},r))}},{key:"_parseKeyframesIndex",value:function(e){for(var t=[],n=[],i=1;i<e.times.length;i++){var r=this._timestampBase+Math.floor(1e3*e.times[i]);t.push(r),n.push(e.filepositions[i])}return{times:t,filepositions:n}}},{key:"_parseAudioData",value:function(e,t,n,i){if(n<=1)a.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(!0!==this._hasAudioFlagOverrided||!1!==this._hasAudio){this._littleEndian;var r=new DataView(e,t,n).getUint8(0),o=r>>>4;if(2===o||10===o){var s=0,c=(12&r)>>>2;if(c>=0&&c<=4){s=this._flvSoundRateTable[c];var l=1&r,d=this._audioMetadata,_=this._audioTrack;if(d||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(d=this._audioMetadata={}).type="audio",d.id=_.id,d.timescale=this._timescale,d.duration=this._duration,d.audioSampleRate=s,d.channelCount=0===l?1:2),10===o){var f=this._parseAACAudioData(e,t+1,n-1);if(null==f)return;if(0===f.packetType){d.config&&a.default.w(this.TAG,"Found another AudioSpecificConfig!");var p=f.data;if(a.default.v(this.TAG,"old {channel:"+d.channelCount+", codec:"+d.codec+", sample rate:"+d.audioSampleRate+", orignal codec:"+p.originalCodec+", config:"+d.config+"}"),a.default.v(this.TAG,"new {channel:"+p.channelCount+", codec:"+p.codec+", sample rate:"+p.samplingRate+", orignal codec:"+p.originalCodec+", config:"+p.config+"}"),d.channelCount===p.channelCount&&d.audioSampleRate===p.samplingRate&&d.codec===p.codec&&d.originalCodec===p.originalCodec)return void a.default.w(this.TAG,"audio specific config do not changed, discard it.");d.audioSampleRate=p.samplingRate,d.channelCount=p.channelCount,d.codec=p.codec,d.originalCodec=p.originalCodec,d.config=p.config,d.refSampleDuration=1024/d.audioSampleRate*d.timescale,this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",d);var h=this._mediaInfo;h.audioCodec=d.originalCodec,h.audioSampleRate=d.audioSampleRate,h.audioChannelCount=d.channelCount,h.hasVideo?null!=h.videoCodec&&(h.mimeType='video/x-flv; codecs="'+h.videoCodec+","+h.audioCodec+'"'):h.mimeType='video/x-flv; codecs="'+h.audioCodec+'"',h.isComplete()&&this._onMediaInfo(h)}else if(1===f.packetType){var g=this._timestampBase+i,E={unit:f.data,length:f.data.byteLength,dts:g,pts:g};_.samples.push(E),_.length+=f.data.length}else a.default.e(this.TAG,"Flv: Unsupported AAC data type "+f.packetType)}else if(2===o){if(!d.codec){var v=this._parseMP3AudioData(e,t+1,n-1,!0);if(null==v)return;d.audioSampleRate=v.samplingRate,d.channelCount=v.channelCount,d.codec=v.codec,d.originalCodec=v.originalCodec,d.refSampleDuration=1152/d.audioSampleRate*d.timescale,a.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",d);var m=this._mediaInfo;m.audioCodec=d.codec,m.audioSampleRate=d.audioSampleRate,m.audioChannelCount=d.channelCount,m.audioDataRate=v.bitRate,m.hasVideo?null!=m.videoCodec&&(m.mimeType='video/x-flv; codecs="'+m.videoCodec+","+m.audioCodec+'"'):m.mimeType='video/x-flv; codecs="'+m.audioCodec+'"',m.isComplete()&&this._onMediaInfo(m)}var S=this._parseMP3AudioData(e,t+1,n-1,!1);if(null==S)return;var A=this._timestampBase+i,y={unit:S,length:S.byteLength,dts:A,pts:A};_.samples.push(y),_.length+=S.length}}else this._onError(u.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+c)}else this._onError(u.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+o)}}},{key:"_parseAACAudioData",value:function(e,t,n){if(!(n<=1)){var i={},r=new Uint8Array(e,t,n);return i.packetType=r[0],0===r[0]?i.data=this._parseAACAudioSpecificConfig(e,t+1,n-1):i.data=r.subarray(1),i}a.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")}},{key:"_parseAACAudioSpecificConfig",value:function(e,t,n){var i,r,a=new Uint8Array(e,t,n),o=null,s=0,c=null;if(s=i=a[0]>>>3,(r=(7&a[0])<<1|a[1]>>>7)<0||r>=this._mpegSamplingRates.length)this._onError(u.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var l=this._mpegSamplingRates[r],d=(120&a[1])>>>3;if(!(d<0||d>=8)){5===s&&(c=(7&a[1])<<1|a[2]>>>7,a[2]);var _=self.navigator.userAgent.toLowerCase();return-1!==_.indexOf("firefox")?r>=6?(s=5,o=new Array(4),c=r-3):(s=2,o=new Array(2),c=r):-1!==_.indexOf("android")?(s=2,o=new Array(2),c=r):(s=5,c=r,o=new Array(4),r>=6?c=r-3:1===d&&(s=2,o=new Array(2),c=r)),o[0]=s<<3,o[0]|=(15&r)>>>1,o[1]=(15&r)<<7,o[1]|=(15&d)<<3,5===s&&(o[1]|=(15&c)>>>1,o[2]=(1&c)<<7,o[2]|=8,o[3]=0),{config:o,samplingRate:l,channelCount:d,codec:"mp4a.40."+s,originalCodec:"mp4a.40."+i}}this._onError(u.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}}},{key:"_parseMP3AudioData",value:function(e,t,n,i){if(!(n<4)){this._littleEndian;var r=new Uint8Array(e,t,n),o=null;if(i){if(255!==r[0])return;var s=r[1]>>>3&3,u=(6&r[1])>>1,c=(240&r[2])>>>4,l=(12&r[2])>>>2,d=3!=(r[3]>>>6&3)?2:1,_=0,f=0;switch(s){case 0:_=this._mpegAudioV25SampleRateTable[l];break;case 2:_=this._mpegAudioV20SampleRateTable[l];break;case 3:_=this._mpegAudioV10SampleRateTable[l]}switch(u){case 1:c<this._mpegAudioL3BitRateTable.length&&(f=this._mpegAudioL3BitRateTable[c]);break;case 2:c<this._mpegAudioL2BitRateTable.length&&(f=this._mpegAudioL2BitRateTable[c]);break;case 3:c<this._mpegAudioL1BitRateTable.length&&(f=this._mpegAudioL1BitRateTable[c])}o={bitRate:f,samplingRate:_,channelCount:d,codec:"mp3",originalCodec:"mp3"}}else o=r;return o}a.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")}},{key:"_parseVideoData",value:function(e,t,n,i,r){if(n<=1)a.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(!0!==this._hasVideoFlagOverrided||!1!==this._hasVideo){var o=new Uint8Array(e,t,n)[0],s=(240&o)>>>4,c=15&o;7===c?this._parseAVCVideoPacket(e,t+1,n-1,i,r,s):this._onError(u.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+c)}}},{key:"_parseAVCVideoPacket",value:function(e,t,n,i,r,o){if(n<4)a.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var s=this._littleEndian,c=new DataView(e,t,n),l=c.getUint8(0),d=(16777215&c.getUint32(0,!s))<<8>>8;if(0===l)this._parseAVCDecoderConfigurationRecord(e,t+4,n-4);else if(1===l)this._parseAVCVideoData(e,t+4,n-4,i,r,o,d);else if(2!==l)return void this._onError(u.default.FORMAT_ERROR,"Flv: Invalid video packet type "+l)}}},{key:"_parseAVCDecoderConfigurationRecord",value:function(e,t,n){if(n<7)a.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var i=this._videoMetadata,r=this._videoTrack,o=this._littleEndian,c=new DataView(e,t,n),l=!1;i?void 0!==i.avcc&&(l=!0,a.default.w(this.TAG,"--== Found another AVCDecoderConfigurationRecord! ==-")):(!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(i=this._videoMetadata={}).type="video",i.id=r.id,i.timescale=this._timescale,i.duration=this._duration);var d=c.getUint8(0),_=c.getUint8(1);if(c.getUint8(2),c.getUint8(3),1===d&&0!==_)if(this._naluLengthSize=1+(3&c.getUint8(4)),3===this._naluLengthSize||4===this._naluLengthSize){var f=31&c.getUint8(5);if(0!==f){f>1&&a.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+f);for(var p=!0,h=6,g=0;g<f;g++){var E=c.getUint16(h,!o);if(h+=2,0!==E){var v=new Uint8Array(e,t+h,E);h+=E;var m=s.default.parseSPS(v);if(0===g){if(a.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord, sps:{codec_size: "+m.codec_size.width+"x"+m.codec_size.height+", present_size: "+ +m.present_size.width+"x"+m.present_size.height+", profile: "+m.profile_string+", level: "+m.level_string+", fps: {"+m.frame_rate.fps_den+","+m.frame_rate.fps_num+","+m.frame_rate.fps+","+m.frame_rate.fixed+"}, sar_ratio: "+m.sar_ratio.width+"x"+m.sar_ratio.height+"}"),p=m.codec_size.width>=m.codec_size.height,l&&this._lastVideoDimension){if(this._lastVideoDimension.width!=m.codec_size.width||this._lastVideoDimension.height!=m.codec_size.height){this._lastVideoDimension.width=m.codec_size.width,this._lastVideoDimension.height=m.codec_size.height,this._lastVideoDimension.profile=m.profile_string,this._lastVideoDimension.level=m.level_string;var S={};S.width=m.codec_size.width,S.height=m.codec_size.height,this._onVideoResolutionChanged(S)}else if(this._lastVideoDimension.profile==m.profile_string&&this._lastVideoDimension.level==m.level_string)return void a.default.w(this.TAG,"video config does not changed. discard reset.")}else this._lastVideoDimension.width=m.codec_size.width,this._lastVideoDimension.height=m.codec_size.height,this._lastVideoDimension.profile=m.profile_string,this._lastVideoDimension.level=m.level_string;i.codecWidth=m.codec_size.width,i.codecHeight=m.codec_size.height,i.presentWidth=m.present_size.width,i.presentHeight=m.present_size.height,i.profile=m.profile_string,i.level=m.level_string,i.bitDepth=m.bit_depth,i.chromaFormat=m.chroma_format,i.sarRatio=m.sar_ratio,i.frameRate=m.frame_rate,!1!==m.frame_rate.fixed&&0!==m.frame_rate.fps_num&&0!==m.frame_rate.fps_den||(i.frameRate=this._referenceFrameRate);var A=i.frameRate.fps_den,y=i.frameRate.fps_num;i.refSampleDuration=i.timescale*(A/y);for(var T=v.subarray(1,4),R="avc1.",I=0;I<3;I++){var C=T[I].toString(16);C.length<2&&(C="0"+C),R+=C}i.codec=R;var O=this._mediaInfo;O.width=i.codecWidth,O.height=i.codecHeight,O.fps=i.frameRate.fps,O.profile=i.profile,O.level=i.level,O.refFrames=m.ref_frames,O.chromaFormat=m.chroma_format_string,O.sarNum=i.sarRatio.width,O.sarDen=i.sarRatio.height,O.videoCodec=R,O.hasAudio?null!=O.audioCodec&&(O.mimeType='video/x-flv; codecs="'+O.videoCodec+","+O.audioCodec+'"'):O.mimeType='video/x-flv; codecs="'+O.videoCodec+'"',O.isComplete()&&this._onMediaInfo(O)}}}var b=c.getUint8(h);if(0!==b){b>1&&a.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+b),h++;for(var L=0;L<b;L++){var D=c.getUint16(h,!o);h+=2,0!==D&&(h+=D)}i.avcc=new Uint8Array(n),i.avcc.set(new Uint8Array(e,t,n),0),a.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord done, "+i.codecWidth+"x"+i.codecHeight+"@"+i.frameRate.fps+" fps, profile="+i.profile+", level="+i.level),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._config.enableConstVideoViewSize&&(a.default.w(this.TAG,"--== const video view size enabled, use {"+this._config.constVideoViewWidth+"x"+this._config.constVideoViewHeight+"} ==--"),i.codecWidth=p?this._config.constVideoViewWidth:this._config.constVideoViewHeight,i.codecHeight=p?this._config.constVideoViewHeight:this._config.constVideoViewWidth),this._onTrackMetadata("video",i)}else this._onError(u.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(u.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(u.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(u.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}}},{key:"_parseAVCVideoData",value:function(e,t,n,i,r,o,s){for(var u=this._littleEndian,c=new DataView(e,t,n),l=[],d=0,_=0,f=this._naluLengthSize,p=this._timestampBase+i,h=1===o;_<n;){if(_+4>=n){a.default.w(this.TAG,"Malformed Nalu near timestamp "+p+", offset = "+_+", dataSize = "+n);break}var g=c.getUint32(_,!u);if(3===f&&(g>>>=8),g>n-f)return void a.default.w(this.TAG,"Malformed Nalus near timestamp "+p+", NaluSize > DataSize!");var E=31&c.getUint8(_+f);5===E&&(h=!0);var v=new Uint8Array(e,t+_,f+g),m={type:E,data:v};l.push(m),d+=v.byteLength,_+=f+g}if(l.length){var S=this._videoTrack,A={units:l,length:d,isKeyframe:h,dts:p,cts:s,pts:p+s};h&&(A.fileposition=r),S.samples.push(A),S.length+=d}}},{key:"onTrackMetadata",get:function(){return this._onTrackMetadata},set:function(e){this._onTrackMetadata=e}},{key:"onMediaInfo",get:function(){return this._onMediaInfo},set:function(e){this._onMediaInfo=e}},{key:"onMetaDataArrived",get:function(){return this._onMetaDataArrived},set:function(e){this._onMetaDataArrived=e}},{key:"onScriptDataArrived",get:function(){return this._onScriptDataArrived},set:function(e){this._onScriptDataArrived=e}},{key:"onError",get:function(){return this._onError},set:function(e){this._onError=e}},{key:"onDataAvailable",get:function(){return this._onDataAvailable},set:function(e){this._onDataAvailable=e}},{key:"timestampBase",get:function(){return this._timestampBase},set:function(e){this._timestampBase=e}},{key:"overridedDuration",get:function(){return this._duration},set:function(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo.duration=e}},{key:"overridedHasAudio",set:function(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo.hasAudio=e}},{key:"overridedHasVideo",set:function(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo.hasVideo=e}},{key:"onVideoResolutionChanged",get:function(){return this._onVideoResolutionChanged},set:function(e){this._onVideoResolutionChanged=e}}],[{key:"probe",value:function(e){var t=new Uint8Array(e),n={match:!1};if(70!==t[0]||76!==t[1]||86!==t[2]||1!==t[3])return n;var i,r,a=(4&t[4])>>>2!=0,o=0!=(1&t[4]),s=(i=t)[r=5]<<24|i[r+1]<<16|i[r+2]<<8|i[r+3];return s<9?n:{match:!0,consumed:s,dataOffset:s,hasAudioTrack:a,hasVideoTrack:o}}}]),e}();n.default=_},{"../core/media-info.js":7,"../utils/exception.js":40,"../utils/logger.js":41,"./amf-parser.js":15,"./demux-errors.js":16,"./sps-parser.js":19}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=e("./exp-golomb.js"),o=(i=a)&&i.__esModule?i:{default:i},s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"_ebsp2rbsp",value:function(e){for(var t=e,n=t.byteLength,i=new Uint8Array(n),r=0,a=0;a<n;a++)a>=2&&3===t[a]&&0===t[a-1]&&0===t[a-2]||(i[r]=t[a],r++);return new Uint8Array(i.buffer,0,r)}},{key:"parseSPS",value:function(t){var n=e._ebsp2rbsp(t),i=new o.default(n);i.readByte();var r=i.readByte();i.readByte();var a=i.readByte();i.readUEG();var s=e.getProfileString(r),u=e.getLevelString(a),c=1,l=420,d=8;if((100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r||138===r||144===r)&&(3===(c=i.readUEG())&&i.readBits(1),c<=3&&(l=[0,420,422,444][c]),d=i.readUEG()+8,i.readUEG(),i.readBits(1),i.readBool()))for(var _=3!==c?8:12,f=0;f<_;f++)i.readBool()&&(f<6?e._skipScalingList(i,16):e._skipScalingList(i,64));i.readUEG();var p=i.readUEG();if(0===p)i.readUEG();else if(1===p){i.readBits(1),i.readSEG(),i.readSEG();for(var h=i.readUEG(),g=0;g<h;g++)i.readSEG()}var E=i.readUEG();i.readBits(1);var v=i.readUEG(),m=i.readUEG(),S=i.readBits(1);0===S&&i.readBits(1),i.readBits(1);var A=0,y=0,T=0,R=0;i.readBool()&&(A=i.readUEG(),y=i.readUEG(),T=i.readUEG(),R=i.readUEG());var I=1,C=1,O=0,b=!0,L=0,D=0;if(i.readBool()){if(i.readBool()){var N=i.readByte();N>0&&N<16?(I=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][N-1],C=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][N-1]):255===N&&(I=i.readByte()<<8|i.readByte(),C=i.readByte()<<8|i.readByte())}if(i.readBool()&&i.readBool(),i.readBool()&&(i.readBits(4),i.readBool()&&i.readBits(24)),i.readBool()&&(i.readUEG(),i.readUEG()),i.readBool()){var P=i.readBits(32),k=i.readBits(32);b=i.readBool(),O=(L=k)/(D=2*P)}}var w=1;1===I&&1===C||(w=I/C);var U=0,M=0;0===c?(U=1,M=2-S):(U=3===c?1:2,M=(1===c?2:1)*(2-S));var x=16*(v+1),V=16*(m+1)*(2-S);x-=(A+y)*U,V-=(T+R)*M;var G=Math.ceil(x*w);return i.destroy(),i=null,{profile_string:s,level_string:u,bit_depth:d,ref_frames:E,chroma_format:l,chroma_format_string:e.getChromaFormatString(l),frame_rate:{fixed:b,fps:O,fps_den:D,fps_num:L},sar_ratio:{width:I,height:C},codec_size:{width:x,height:V},present_size:{width:G,height:V}}}},{key:"_skipScalingList",value:function(e,t){for(var n=8,i=8,r=0;r<t;r++)0!==i&&(i=(n+e.readSEG()+256)%256),n=0===i?n:i}},{key:"getProfileString",value:function(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}},{key:"getLevelString",value:function(e){return(e/10).toFixed(1)}},{key:"getChromaFormatString",value:function(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}}]),e}();n.default=s},{"./exp-golomb.js":17}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=f(e("./utils/polyfill.js")),a=f(e("./core/features.js")),o=e("./io/loader.js"),s=f(e("./player/flv-player.js")),u=f(e("./player/native-player.js")),c=f(e("./player/player-events.js")),l=e("./player/player-errors.js"),d=f(e("./utils/logging-control.js")),_=e("./utils/exception.js");function f(e){return e&&e.__esModule?e:{default:e}}r.default.install();var p={createPlayer:function(e,t){var n=e;if(null==n||"object"!==(void 0===n?"undefined":i(n)))throw new _.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!n.hasOwnProperty("type"))throw new _.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(n.type){case"flv":return new s.default(n,t);default:return new u.default(n,t)}},isSupported:function(){return a.default.supportMSEH264Playback()},getFeatureList:function(){return a.default.getFeatureList()}};p.BaseLoader=o.BaseLoader,p.LoaderStatus=o.LoaderStatus,p.LoaderErrors=o.LoaderErrors,p.Events=c.default,p.ErrorTypes=l.ErrorTypes,p.ErrorDetails=l.ErrorDetails,p.FlvPlayer=s.default,p.NativePlayer=u.default,p.LoggingControl=d.default,Object.defineProperty(p,"version",{enumerable:!0,get:function(){return"2.0.3"}}),n.default=p},{"./core/features.js":6,"./io/loader.js":24,"./player/flv-player.js":32,"./player/native-player.js":33,"./player/player-errors.js":34,"./player/player-events.js":35,"./utils/exception.js":40,"./utils/logging-control.js":42,"./utils/polyfill.js":43}],21:[function(e,t,n){"use strict";t.exports=e("./flv.js").default},{"./flv.js":20}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=(u(e("../utils/logger.js")),u(e("../utils/browser.js"))),o=e("./loader.js"),s=e("../utils/exception.js");function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"fetch-stream-loader"));return i.TAG="FetchStreamLoader",i._seekHandler=e,i._config=n,i._needStash=!0,i._requestAbort=!1,i._contentLength=null,i._receivedLength=0,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.BaseLoader),r(t,null,[{key:"isSupported",value:function(){try{var e=a.default.msedge&&a.default.version.minor>=15048,t=!a.default.msedge||e;return self.fetch&&self.ReadableStream&&t}catch(e){return!1}}}]),r(t,[{key:"destroy",value:function(){this.isWorking()&&this.abort(),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"open",value:function(e,t){var n=this;this._dataSource=e,this._range=t;var r=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(r=e.redirectedURL);var a=this._seekHandler.getConfig(r,t),u=new self.Headers;if("object"===i(a.headers)){var c=a.headers;for(var l in c)c.hasOwnProperty(l)&&u.append(l,c[l])}var d={method:"GET",headers:u,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"===i(this._config.headers))for(var _ in this._config.headers)u.append(_,this._config.headers[_]);!1===e.cors&&(d.mode="same-origin"),e.withCredentials&&(d.credentials="include"),e.referrerPolicy&&(d.referrerPolicy=e.referrerPolicy),this._status=o.LoaderStatus.kConnecting,self.fetch(a.url,d).then(function(e){if(n._requestAbort)return n._requestAbort=!1,void(n._status=o.LoaderStatus.kIdle);if(e.ok&&e.status>=200&&e.status<=299){if(e.url!==a.url&&n._onURLRedirect){var t=n._seekHandler.removeURLParameters(e.url);n._onURLRedirect(t)}var i=e.headers.get("Content-Length");return null!=i&&(n._contentLength=parseInt(i),0!==n._contentLength&&n._onContentLengthKnown&&n._onContentLengthKnown(n._contentLength)),n._pump.call(n,e.body.getReader())}if(n._status=o.LoaderStatus.kError,!n._onError)throw new s.RuntimeException("FetchStreamLoader: Http code invalid, "+e.status+" "+e.statusText);n._onError(o.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:e.status,msg:e.statusText})}).catch(function(e){if(n._status=o.LoaderStatus.kError,!n._onError)throw e;n._onError(o.LoaderErrors.EXCEPTION,{code:-1,msg:e.message})})}},{key:"abort",value:function(){this._requestAbort=!0}},{key:"_pump",value:function(e){var t=this;return e.read().then(function(n){if(n.done)if(null!==t._contentLength&&t._receivedLength<t._contentLength){t._status=o.LoaderStatus.kError;var i=o.LoaderErrors.EARLY_EOF,r={code:-1,msg:"Fetch stream meet Early-EOF"};if(!t._onError)throw new s.RuntimeException(r.msg);t._onError(i,r)}else t._status=o.LoaderStatus.kComplete,t._onComplete&&t._onComplete(t._range.from,t._range.from+t._receivedLength-1);else{if(!0===t._requestAbort)return t._requestAbort=!1,t._status=o.LoaderStatus.kComplete,e.cancel();t._status=o.LoaderStatus.kBuffering;var a=n.value.buffer,u=t._range.from+t._receivedLength;t._receivedLength+=a.byteLength,t._onDataArrival&&t._onDataArrival(a,u,t._receivedLength),t._pump(e)}}).catch(function(e){if(11!==e.code||!a.default.msedge){t._status=o.LoaderStatus.kError;var n=0,i=null;if(19!==e.code&&"network error"!==e.message||!(null===t._contentLength||null!==t._contentLength&&t._receivedLength<t._contentLength)?(n=o.LoaderErrors.EXCEPTION,i={code:e.code,msg:e.message}):(n=o.LoaderErrors.EARLY_EOF,i={code:e.code,msg:"Fetch stream meet Early-EOF"}),!t._onError)throw new s.RuntimeException(i.msg);t._onError(n,i)}})}}]),t}();n.default=c},{"../utils/browser.js":39,"../utils/exception.js":40,"../utils/logger.js":41,"./loader.js":24}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=p(e("../utils/logger.js")),a=p(e("./speed-sampler.js")),o=e("./loader.js"),s=p(e("./fetch-stream-loader.js")),u=p(e("./xhr-moz-chunked-loader.js")),c=(p(e("./xhr-msstream-loader.js")),p(e("./xhr-range-loader.js"))),l=p(e("./websocket-loader.js")),d=p(e("./range-seek-handler.js")),_=p(e("./param-seek-handler.js")),f=e("../utils/exception.js");function p(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TAG="IOController",this._config=n,this._extraData=i,this._stashInitialSize=393216,null!=n.stashInitialSize&&n.stashInitialSize>0&&(this._stashInitialSize=n.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,!1===n.enableStashBuffer&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=t,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(t.url),this._refTotalLength=t.filesize?t.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new a.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return i(e,[{key:"destroy",value:function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null}},{key:"isWorking",value:function(){return this._loader&&this._loader.isWorking()&&!this._paused}},{key:"isPaused",value:function(){return this._paused}},{key:"_selectSeekHandler",value:function(){var e=this._config;if("range"===e.seekType)this._seekHandler=new d.default(this._config.rangeLoadZeroStart);else if("param"===e.seekType){var t=e.seekParamStart||"bstart",n=e.seekParamEnd||"bend";this._seekHandler=new _.default(t,n)}else{if("custom"!==e.seekType)throw new f.InvalidArgumentException("Invalid seekType in config: "+e.seekType);if("function"!=typeof e.customSeekHandler)throw new f.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}}},{key:"_selectLoader",value:function(){if(null!=this._config.customLoader)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=l.default;else if(s.default.isSupported())this._loaderClass=s.default;else if(u.default.isSupported())this._loaderClass=u.default;else{if(!c.default.isSupported())throw new f.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=c.default}}},{key:"_createLoader",value:function(){this._loader=new this._loaderClass(this._seekHandler,this._config),!1===this._loader.needStashBuffer&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)}},{key:"open",value:function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))}},{key:"abort",value:function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)}},{key:"pause",value:function(){this.isWorking()&&(this._loader.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)}},{key:"resume",value:function(){if(this._paused){this._paused=!1;var e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}}},{key:"seek",value:function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)}},{key:"_internalSeek",value:function(e,t){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(t),this._loader.destroy(),this._loader=null;var n={from:e,to:-1};this._currentRange={from:n.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,n),this._onSeeked&&this._onSeeked()}},{key:"updateUrl",value:function(e){if(!e||"string"!=typeof e||0===e.length)throw new f.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=e}},{key:"_expandBuffer",value:function(e){for(var t=this._stashSize;t+1048576<e;)t*=2;if((t+=1048576)!==this._bufferSize){var n=new ArrayBuffer(t);if(this._stashUsed>0){var i=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(n,0,t).set(i,0)}this._stashBuffer=n,this._bufferSize=t}}},{key:"_normalizeSpeed",value:function(e){var t=this._speedNormalizeList,n=t.length-1,i=0,r=0,a=n;if(e<t[0])return t[0];for(;r<=a;){if((i=r+Math.floor((a-r)/2))===n||e>=t[i]&&e<t[i+1])return t[i];t[i]<e?r=i+1:a=i-1}}},{key:"_adjustStashSize",value:function(e){var t=0;(t=this._config.isLive?e:e<512?e:e>=512&&e<=1024?Math.floor(1.5*e):2*e)>8192&&(t=8192);var n=1024*t+1048576;this._bufferSize<n&&this._expandBuffer(n),this._stashSize=1024*t}},{key:"_dispatchChunks",value:function(e,t){return this._currentRange.to=t+e.byteLength-1,this._onDataArrival(e,t)}},{key:"_onURLRedirect",value:function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)}},{key:"_onContentLengthKnown",value:function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)}},{key:"_onLoaderChunkArrival",value:function(e,t,n){if(!this._onDataArrival)throw new f.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);var i=this._speedSampler.lastSecondKBps;if(0!==i){var r=this._normalizeSpeed(i);this._speedNormalized!==r&&(this._speedNormalized=r,this._adjustStashSize(r))}if(this._enableStash)if(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=t),this._stashUsed+e.byteLength<=this._stashSize)new Uint8Array(this._stashBuffer,0,this._stashSize).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;else{var a=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var o=this._stashBuffer.slice(0,this._stashUsed),s=this._dispatchChunks(o,this._stashByteStart);if(s<o.byteLength){if(s>0){var u=new Uint8Array(o,s);a.set(u,0),this._stashUsed=u.byteLength,this._stashByteStart+=s}}else this._stashUsed=0,this._stashByteStart+=s;this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),a=new Uint8Array(this._stashBuffer,0,this._bufferSize)),a.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{var c=this._dispatchChunks(e,t);if(c<e.byteLength){var l=e.byteLength-c;l>this._bufferSize&&(this._expandBuffer(l),a=new Uint8Array(this._stashBuffer,0,this._bufferSize)),a.set(new Uint8Array(e,c),0),this._stashUsed+=l,this._stashByteStart=t+c}}}else if(0===this._stashUsed){var d=this._dispatchChunks(e,t);if(d<e.byteLength){var _=e.byteLength-d;_>this._bufferSize&&this._expandBuffer(_),new Uint8Array(this._stashBuffer,0,this._bufferSize).set(new Uint8Array(e,d),0),this._stashUsed+=_,this._stashByteStart=t+d}}else{this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength);var p=new Uint8Array(this._stashBuffer,0,this._bufferSize);p.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;var h=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(h<this._stashUsed&&h>0){var g=new Uint8Array(this._stashBuffer,h);p.set(g,0)}this._stashUsed-=h,this._stashByteStart+=h}}}},{key:"_flushStashBuffer",value:function(e){if(this._stashUsed>0){var t=this._stashBuffer.slice(0,this._stashUsed),n=this._dispatchChunks(t,this._stashByteStart),i=t.byteLength-n;if(n<t.byteLength){if(!e){if(n>0){var a=new Uint8Array(this._stashBuffer,0,this._bufferSize),o=new Uint8Array(t,n);a.set(o,0),this._stashUsed=o.byteLength,this._stashByteStart+=n}return 0}r.default.w(this.TAG,i+" bytes unconsumed data remain when flush buffer, dropped")}return this._stashUsed=0,this._stashByteStart=0,i}return 0}},{key:"_onLoaderComplete",value:function(e,t){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)}},{key:"_onLoaderError",value:function(e,t){switch(r.default.e(this.TAG,"Loader error, code = "+t.code+", msg = "+t.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=o.LoaderErrors.UNRECOVERABLE_EARLY_EOF),e){case o.LoaderErrors.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var n=this._currentRange.to+1;return void(n<this._totalLength&&(r.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(n,!1)))}e=o.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break;case o.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case o.LoaderErrors.CONNECTING_TIMEOUT:case o.LoaderErrors.HTTP_STATUS_CODE_INVALID:case o.LoaderErrors.EXCEPTION:}if(!this._onError)throw new f.RuntimeException("IOException: "+t.msg);this._onError(e,t)}},{key:"status",get:function(){return this._loader.status}},{key:"extraData",get:function(){return this._extraData},set:function(e){this._extraData=e}},{key:"onDataArrival",get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e}},{key:"onSeeked",get:function(){return this._onSeeked},set:function(e){this._onSeeked=e}},{key:"onError",get:function(){return this._onError},set:function(e){this._onError=e}},{key:"onComplete",get:function(){return this._onComplete},set:function(e){this._onComplete=e}},{key:"onRedirect",get:function(){return this._onRedirect},set:function(e){this._onRedirect=e}},{key:"onRecoveredEarlyEof",get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e}},{key:"currentURL",get:function(){return this._dataSource.url}},{key:"hasRedirect",get:function(){return null!=this._redirectedURL||null!=this._dataSource.redirectedURL}},{key:"currentRedirectedURL",get:function(){return this._redirectedURL||this._dataSource.redirectedURL}},{key:"currentSpeed",get:function(){return this._loaderClass===c.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps}},{key:"loaderType",get:function(){return this._loader.type}}]),e}();n.default=h},{"../utils/exception.js":40,"../utils/logger.js":41,"./fetch-stream-loader.js":22,"./loader.js":24,"./param-seek-handler.js":25,"./range-seek-handler.js":26,"./speed-sampler.js":27,"./websocket-loader.js":28,"./xhr-moz-chunked-loader.js":29,"./xhr-msstream-loader.js":30,"./xhr-range-loader.js":31}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BaseLoader=n.LoaderErrors=n.LoaderStatus=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=e("../utils/exception.js"),a=n.LoaderStatus={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4};n.LoaderErrors={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},n.BaseLoader=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._type=t||"undefined",this._status=a.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return i(e,[{key:"destroy",value:function(){this._status=a.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}},{key:"isWorking",value:function(){return this._status===a.kConnecting||this._status===a.kBuffering}},{key:"open",value:function(e,t){throw new r.NotImplementedException("Unimplemented abstract function!")}},{key:"abort",value:function(){throw new r.NotImplementedException("Unimplemented abstract function!")}},{key:"type",get:function(){return this._type}},{key:"status",get:function(){return this._status}},{key:"needStashBuffer",get:function(){return this._needStash}},{key:"onContentLengthKnown",get:function(){return this._onContentLengthKnown},set:function(e){this._onContentLengthKnown=e}},{key:"onURLRedirect",get:function(){return this._onURLRedirect},set:function(e){this._onURLRedirect=e}},{key:"onDataArrival",get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e}},{key:"onError",get:function(){return this._onError},set:function(e){this._onError=e}},{key:"onComplete",get:function(){return this._onComplete},set:function(e){this._onComplete=e}}]),e}()},{"../utils/exception.js":40}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._startName=t,this._endName=n}return i(e,[{key:"getConfig",value:function(e,t){var n=e;if(0!==t.from||-1!==t.to){var i=!0;-1===n.indexOf("?")&&(n+="?",i=!1),i&&(n+="&"),n+=this._startName+"="+t.from.toString(),-1!==t.to&&(n+="&"+this._endName+"="+t.to.toString())}return{url:n,headers:{}}}},{key:"removeURLParameters",value:function(e){var t=e.split("?")[0],n=void 0,i=e.indexOf("?");-1!==i&&(n=e.substring(i+1));var r="";if(null!=n&&n.length>0)for(var a=n.split("&"),o=0;o<a.length;o++){var s=a[o].split("="),u=o>0;s[0]!==this._startName&&s[0]!==this._endName&&(u&&(r+="&"),r+=a[o])}return 0===r.length?t:t+"?"+r}}]),e}();n.default=r},{}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._zeroStart=t||!1}return i(e,[{key:"getConfig",value:function(e,t){var n={};if(0!==t.from||-1!==t.to){var i=void 0;i=-1!==t.to?"bytes="+t.from.toString()+"-"+t.to.toString():"bytes="+t.from.toString()+"-",n.Range=i}else this._zeroStart&&(n.Range="bytes=0-");return{url:e,headers:n}}},{key:"removeURLParameters",value:function(e){return e}}]),e}();n.default=r},{}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return i(e,[{key:"reset",value:function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0}},{key:"addBytes",value:function(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())}},{key:"currentKBps",get:function(){this.addBytes(0);var e=(this._now()-this._lastCheckpoint)/1e3;return 0==e&&(e=1),this._intervalBytes/e/1024}},{key:"lastSecondKBps",get:function(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0}},{key:"averageKBps",get:function(){var e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024}}]),e}();n.default=r},{}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=e("../utils/logger.js"),o=((i=a)&&i.__esModule,e("./loader.js")),s=e("../utils/exception.js"),u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"websocket-loader"));return e.TAG="WebSocketLoader",e._needStash=!0,e._ws=null,e._requestAbort=!1,e._receivedLength=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.BaseLoader),r(t,null,[{key:"isSupported",value:function(){try{return void 0!==self.WebSocket}catch(e){return!1}}}]),r(t,[{key:"destroy",value:function(){this._ws&&this.abort(),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"open",value:function(e){try{var t=this._ws=new self.WebSocket(e.url);t.binaryType="arraybuffer",t.onopen=this._onWebSocketOpen.bind(this),t.onclose=this._onWebSocketClose.bind(this),t.onmessage=this._onWebSocketMessage.bind(this),t.onerror=this._onWebSocketError.bind(this),this._status=o.LoaderStatus.kConnecting}catch(e){this._status=o.LoaderStatus.kError;var n={code:e.code,msg:e.message};if(!this._onError)throw new s.RuntimeException(n.msg);this._onError(o.LoaderErrors.EXCEPTION,n)}}},{key:"abort",value:function(){var e=this._ws;!e||0!==e.readyState&&1!==e.readyState||(this._requestAbort=!0,e.close()),this._ws=null,this._status=o.LoaderStatus.kComplete}},{key:"_onWebSocketOpen",value:function(e){this._status=o.LoaderStatus.kBuffering}},{key:"_onWebSocketClose",value:function(e){!0!==this._requestAbort?(this._status=o.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1}},{key:"_onWebSocketMessage",value:function(e){var t=this;if(e.data instanceof ArrayBuffer)this._dispatchArrayBuffer(e.data);else if(e.data instanceof Blob){var n=new FileReader;n.onload=function(){t._dispatchArrayBuffer(n.result)},n.readAsArrayBuffer(e.data)}else{this._status=o.LoaderStatus.kError;var i={code:-1,msg:"Unsupported WebSocket message type: "+e.data.constructor.name};if(!this._onError)throw new s.RuntimeException(i.msg);this._onError(o.LoaderErrors.EXCEPTION,i)}}},{key:"_dispatchArrayBuffer",value:function(e){var t=e,n=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,n,this._receivedLength)}},{key:"_onWebSocketError",value:function(e){this._status=o.LoaderStatus.kError;var t={code:e.code,msg:e.message};if(!this._onError)throw new s.RuntimeException(t.msg);this._onError(o.LoaderErrors.EXCEPTION,t)}}]),t}();n.default=u},{"../utils/exception.js":40,"../utils/logger.js":41,"./loader.js":24}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("../utils/logger.js"),s=(i=o)&&i.__esModule?i:{default:i},u=e("./loader.js"),c=e("../utils/exception.js"),l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"xhr-moz-chunked-loader"));return i.TAG="MozChunkedLoader",i._seekHandler=e,i._config=n,i._needStash=!0,i._xhr=null,i._requestAbort=!1,i._contentLength=null,i._receivedLength=0,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.BaseLoader),a(t,null,[{key:"isSupported",value:function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(e){return s.default.w("MozChunkedLoader",e.message),!1}}}]),a(t,[{key:"destroy",value:function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"open",value:function(e,t){this._dataSource=e,this._range=t;var n=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(n=e.redirectedURL);var i=this._seekHandler.getConfig(n,t);this._requestURL=i.url;var a=this._xhr=new XMLHttpRequest;if(a.open("GET",i.url,!0),a.responseType="moz-chunked-arraybuffer",a.onreadystatechange=this._onReadyStateChange.bind(this),a.onprogress=this._onProgress.bind(this),a.onloadend=this._onLoadEnd.bind(this),a.onerror=this._onXhrError.bind(this),e.withCredentials&&(a.withCredentials=!0),"object"===r(i.headers)){var o=i.headers;for(var s in o)o.hasOwnProperty(s)&&a.setRequestHeader(s,o[s])}if("object"===r(this._config.headers)){var c=this._config.headers;for(var l in c)c.hasOwnProperty(l)&&a.setRequestHeader(l,c[l])}this._status=u.LoaderStatus.kConnecting,a.send()}},{key:"abort",value:function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=u.LoaderStatus.kComplete}},{key:"_onReadyStateChange",value:function(e){var t=e.target;if(2===t.readyState){if(null!=t.responseURL&&t.responseURL!==this._requestURL&&this._onURLRedirect){var n=this._seekHandler.removeURLParameters(t.responseURL);this._onURLRedirect(n)}if(0!==t.status&&(t.status<200||t.status>299)){if(this._status=u.LoaderStatus.kError,!this._onError)throw new c.RuntimeException("MozChunkedLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(u.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else this._status=u.LoaderStatus.kBuffering}}},{key:"_onProgress",value:function(e){if(this._status!==u.LoaderStatus.kError){null===this._contentLength&&null!==e.total&&0!==e.total&&(this._contentLength=e.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var t=e.target.response,n=this._range.from+this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,n,this._receivedLength)}}},{key:"_onLoadEnd",value:function(e){!0!==this._requestAbort?this._status!==u.LoaderStatus.kError&&(this._status=u.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1}},{key:"_onXhrError",value:function(e){this._status=u.LoaderStatus.kError;var t=0,n=null;if(this._contentLength&&e.loaded<this._contentLength?(t=u.LoaderErrors.EARLY_EOF,n={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(t=u.LoaderErrors.EXCEPTION,n={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new c.RuntimeException(n.msg);this._onError(t,n)}}]),t}();n.default=l},{"../utils/exception.js":40,"../utils/logger.js":41,"./loader.js":24}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("../utils/logger.js"),s=(i=o)&&i.__esModule?i:{default:i},u=e("./loader.js"),c=e("../utils/exception.js"),l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"xhr-msstream-loader"));return i.TAG="MSStreamLoader",i._seekHandler=e,i._config=n,i._needStash=!0,i._xhr=null,i._reader=null,i._totalRange=null,i._currentRange=null,i._currentRequestURL=null,i._currentRedirectedURL=null,i._contentLength=null,i._receivedLength=0,i._bufferLimit=16777216,i._lastTimeBufferSize=0,i._isReconnecting=!1,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.BaseLoader),a(t,null,[{key:"isSupported",value:function(){try{if(void 0===self.MSStream||void 0===self.MSStreamReader)return!1;var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="ms-stream","ms-stream"===e.responseType}catch(e){return s.default.w("MSStreamLoader",e.message),!1}}}]),a(t,[{key:"destroy",value:function(){this.isWorking()&&this.abort(),this._reader&&(this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr=null),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"open",value:function(e,t){this._internalOpen(e,t,!1)}},{key:"_internalOpen",value:function(e,t,n){this._dataSource=e,n?this._currentRange=t:this._totalRange=t;var i=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?i=this._currentRedirectedURL:null!=e.redirectedURL&&(i=e.redirectedURL));var a=this._seekHandler.getConfig(i,t);this._currentRequestURL=a.url;var o=this._reader=new self.MSStreamReader;o.onprogress=this._msrOnProgress.bind(this),o.onload=this._msrOnLoad.bind(this),o.onerror=this._msrOnError.bind(this);var s=this._xhr=new XMLHttpRequest;if(s.open("GET",a.url,!0),s.responseType="ms-stream",s.onreadystatechange=this._xhrOnReadyStateChange.bind(this),s.onerror=this._xhrOnError.bind(this),e.withCredentials&&(s.withCredentials=!0),"object"===r(a.headers)){var c=a.headers;for(var l in c)c.hasOwnProperty(l)&&s.setRequestHeader(l,c[l])}if("object"===r(this._config.headers)){var d=this._config.headers;for(var _ in d)d.hasOwnProperty(_)&&s.setRequestHeader(_,d[_])}this._isReconnecting?this._isReconnecting=!1:this._status=u.LoaderStatus.kConnecting,s.send()}},{key:"abort",value:function(){this._internalAbort(),this._status=u.LoaderStatus.kComplete}},{key:"_internalAbort",value:function(){this._reader&&(1===this._reader.readyState&&this._reader.abort(),this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.abort(),this._xhr.onreadystatechange=null,this._xhr=null)}},{key:"_xhrOnReadyStateChange",value:function(e){var t=e.target;if(2===t.readyState)if(t.status>=200&&t.status<=299){if(this._status=u.LoaderStatus.kBuffering,null!=t.responseURL){var n=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&n!==this._currentRedirectedURL&&(this._currentRedirectedURL=n,this._onURLRedirect&&this._onURLRedirect(n))}var i=t.getResponseHeader("Content-Length");if(null!=i&&null==this._contentLength){var r=parseInt(i);r>0&&(this._contentLength=r,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength))}}else{if(this._status=u.LoaderStatus.kError,!this._onError)throw new c.RuntimeException("MSStreamLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(u.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else if(3===t.readyState&&t.status>=200&&t.status<=299){this._status=u.LoaderStatus.kBuffering;var a=t.response;this._reader.readAsArrayBuffer(a)}}},{key:"_xhrOnError",value:function(e){this._status=u.LoaderStatus.kError;var t=u.LoaderErrors.EXCEPTION,n={code:-1,msg:e.constructor.name+" "+e.type};if(!this._onError)throw new c.RuntimeException(n.msg);this._onError(t,n)}},{key:"_msrOnProgress",value:function(e){var t=e.target.result;if(null!=t){var n=t.slice(this._lastTimeBufferSize);this._lastTimeBufferSize=t.byteLength;var i=this._totalRange.from+this._receivedLength;this._receivedLength+=n.byteLength,this._onDataArrival&&this._onDataArrival(n,i,this._receivedLength),t.byteLength>=this._bufferLimit&&(s.default.v(this.TAG,"MSStream buffer exceeded max size near "+(i+n.byteLength)+", reconnecting..."),this._doReconnectIfNeeded())}else this._doReconnectIfNeeded()}},{key:"_doReconnectIfNeeded",value:function(){if(null==this._contentLength||this._receivedLength<this._contentLength){this._isReconnecting=!0,this._lastTimeBufferSize=0,this._internalAbort();var e={from:this._totalRange.from+this._receivedLength,to:-1};this._internalOpen(this._dataSource,e,!0)}}},{key:"_msrOnLoad",value:function(e){this._status=u.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._totalRange.from,this._totalRange.from+this._receivedLength-1)}},{key:"_msrOnError",value:function(e){this._status=u.LoaderStatus.kError;var t=0,n=null;if(this._contentLength&&this._receivedLength<this._contentLength?(t=u.LoaderErrors.EARLY_EOF,n={code:-1,msg:"MSStream meet Early-Eof"}):(t=u.LoaderErrors.EARLY_EOF,n={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new c.RuntimeException(n.msg);this._onError(t,n)}}]),t}();n.default=l},{"../utils/exception.js":40,"../utils/logger.js":41,"./loader.js":24}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=c(e("../utils/logger.js")),o=c(e("./speed-sampler.js")),s=e("./loader.js"),u=e("../utils/exception.js");function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"xhr-range-loader"));return i.TAG="RangeLoader",i._seekHandler=e,i._config=n,i._needStash=!1,i._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],i._currentChunkSizeKB=384,i._currentSpeedNormalized=0,i._zeroSpeedChunkCount=0,i._xhr=null,i._speedSampler=new o.default,i._requestAbort=!1,i._waitForTotalLength=!1,i._totalLengthReceived=!1,i._currentRequestURL=null,i._currentRedirectedURL=null,i._currentRequestRange=null,i._totalLength=null,i._contentLength=null,i._receivedLength=0,i._lastTimeLoaded=0,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.BaseLoader),r(t,null,[{key:"isSupported",value:function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="arraybuffer","arraybuffer"===e.responseType}catch(e){return a.default.w("RangeLoader",e.message),!1}}}]),r(t,[{key:"destroy",value:function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"open",value:function(e,t){this._dataSource=e,this._range=t,this._status=s.LoaderStatus.kConnecting;var n=!1;null!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(n=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||n?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))}},{key:"_openSubRange",value:function(){var e=1024*this._currentChunkSizeKB,t=this._range.from+this._receivedLength,n=t+e;null!=this._contentLength&&n-this._range.from>=this._contentLength&&(n=this._range.from+this._contentLength-1),this._currentRequestRange={from:t,to:n},this._internalOpen(this._dataSource,this._currentRequestRange)}},{key:"_internalOpen",value:function(e,t){this._lastTimeLoaded=0;var n=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?n=this._currentRedirectedURL:null!=e.redirectedURL&&(n=e.redirectedURL));var r=this._seekHandler.getConfig(n,t);this._currentRequestURL=r.url;var a=this._xhr=new XMLHttpRequest;if(a.open("GET",r.url,!0),a.responseType="arraybuffer",a.onreadystatechange=this._onReadyStateChange.bind(this),a.onprogress=this._onProgress.bind(this),a.onload=this._onLoad.bind(this),a.onerror=this._onXhrError.bind(this),e.withCredentials&&(a.withCredentials=!0),"object"===i(r.headers)){var o=r.headers;for(var s in o)o.hasOwnProperty(s)&&a.setRequestHeader(s,o[s])}if("object"===i(this._config.headers)){var u=this._config.headers;for(var c in u)u.hasOwnProperty(c)&&a.setRequestHeader(c,u[c])}a.send()}},{key:"abort",value:function(){this._requestAbort=!0,this._internalAbort(),this._status=s.LoaderStatus.kComplete}},{key:"_internalAbort",value:function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)}},{key:"_onReadyStateChange",value:function(e){var t=e.target;if(2===t.readyState){if(null!=t.responseURL){var n=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&n!==this._currentRedirectedURL&&(this._currentRedirectedURL=n,this._onURLRedirect&&this._onURLRedirect(n))}if(t.status>=200&&t.status<=299){if(this._waitForTotalLength)return;this._status=s.LoaderStatus.kBuffering}else{if(this._status=s.LoaderStatus.kError,!this._onError)throw new u.RuntimeException("RangeLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(s.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}}}},{key:"_onProgress",value:function(e){if(this._status!==s.LoaderStatus.kError){if(null===this._contentLength){var t=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,t=!0;var n=e.total;this._internalAbort(),null!=n&0!==n&&(this._totalLength=n)}if(-1===this._range.to?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,t)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var i=e.loaded-this._lastTimeLoaded;this._lastTimeLoaded=e.loaded,this._speedSampler.addBytes(i)}}},{key:"_normalizeSpeed",value:function(e){var t=this._chunkSizeKBList,n=t.length-1,i=0,r=0,a=n;if(e<t[0])return t[0];for(;r<=a;){if((i=r+Math.floor((a-r)/2))===n||e>=t[i]&&e<t[i+1])return t[i];t[i]<e?r=i+1:a=i-1}}},{key:"_onLoad",value:function(e){if(this._status!==s.LoaderStatus.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var t=this._speedSampler.lastSecondKBps;if(0===t&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(t=this._speedSampler.currentKBps)),0!==t){var n=this._normalizeSpeed(t);this._currentSpeedNormalized!==n&&(this._currentSpeedNormalized=n,this._currentChunkSizeKB=n)}var i=e.target.response,r=this._range.from+this._receivedLength;this._receivedLength+=i.byteLength;var a=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():a=!0,this._onDataArrival&&this._onDataArrival(i,r,this._receivedLength),a&&(this._status=s.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}}},{key:"_onXhrError",value:function(e){this._status=s.LoaderStatus.kError;var t=0,n=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(t=s.LoaderErrors.EARLY_EOF,n={code:-1,msg:"RangeLoader meet Early-Eof"}):(t=s.LoaderErrors.EXCEPTION,n={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new u.RuntimeException(n.msg);this._onError(t,n)}},{key:"currentSpeed",get:function(){return this._speedSampler.lastSecondKBps}}]),t}();n.default=l},{"../utils/exception.js":40,"../utils/logger.js":41,"./loader.js":24,"./speed-sampler.js":27}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=g(e("events")),o=g(e("../utils/logger.js")),s=g(e("../utils/browser.js")),u=g(e("./player-events.js")),c=g(e("../core/transmuxer.js")),l=g(e("../core/transmuxing-events.js")),d=g(e("../core/mse-controller.js")),_=g(e("../core/mse-events.js")),f=e("./player-errors.js"),p=e("../config.js"),h=e("../utils/exception.js");function g(e){return e&&e.__esModule?e:{default:e}}var E=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new a.default,this._config=(0,p.createDefaultConfig)(),"object"===(void 0===n?"undefined":i(n))&&Object.assign(this._config,n),"flv"!==t.type.toLowerCase())throw new h.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");!0===t.isLive&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=t,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var r=s.default.chrome&&(s.default.version.major<50||50===s.default.version.major&&s.default.version.build<2661);this._alwaysSeekKeyframe=!!(r||s.default.msedge||s.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1),this._videoStateMonitorInterval=this._config.videoStateMonitorInterval,this._enableDurationMonitor=this._config.enableDurationMonitor,this._maxDurationGap=this._config.maxDurationGap,this._decreaseDurationStep=this._config.decreaseDurationStep,this._durationMonitor=null,this._enableVideoFrozenMonitor=this._config.enableVideoFrozenMonitor,this._frozenTimesThreshold=this._config.frozenTimesThreshold,this._forzenTimes=0,this._lastDecodedFrames=0}return r(e,[{key:"destroy",value:function(){null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter&&(this._emitter.removeAllListeners(),this._emitter=null)}},{key:"on",value:function(e,t){var n=this;e===u.default.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then(function(){n._emitter.emit(u.default.MEDIA_INFO,n.mediaInfo)}):e===u.default.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then(function(){n._emitter.emit(u.default.STATISTICS_INFO,n.statisticsInfo)}),this._emitter.addListener(e,t)}},{key:"off",value:function(e,t){this._emitter.removeListener(e,t)}},{key:"attachMediaElement",value:function(e){var t=this;if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),e.addEventListener("seeking",this.e.onvSeeking),e.addEventListener("canplay",this.e.onvCanPlay),e.addEventListener("stalled",this.e.onvStalled),e.addEventListener("progress",this.e.onvProgress),this._msectl=new d.default(this._config),this._msectl.on(_.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(_.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(_.default.SOURCE_OPEN,function(){t._mseSourceOpened=!0,t._hasPendingLoad&&(t._hasPendingLoad=!1,t.load())}),this._msectl.on(_.default.SOURCE_END,function(){t._emitter.emit(u.default.MEDIA_SOURCE_ENDED)}),this._msectl.on(_.default.SOURCE_CLOSE,function(){t._emitter.emit(u.default.MEDIA_SOURCE_CLOSE)}),this._msectl.on(_.default.ERROR,function(e){t._emitter.emit(u.default.ERROR,f.ErrorTypes.MEDIA_ERROR,f.ErrorDetails.MEDIA_MSE_ERROR,e)}),this._msectl.attachMediaElement(e),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}}},{key:"detachMediaElement",value:function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)}},{key:"load",value:function(){var e=this;if(!this._mediaElement)throw new h.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new h.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");this._hasPendingLoad||(this._config.deferLoadAfterSourceOpen&&!1===this._mseSourceOpened?this._hasPendingLoad=!0:(this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._enableDurationMonitor&&null==this._durationMonitor&&(this._durationMonitor=self.setInterval(this._doDurationMonitor.bind(this),this._videoStateMonitorInterval),this._forzenTimes=0,this._lastDecodedFrames=0),this._transmuxer=new c.default(this._mediaDataSource,this._config),this._transmuxer.on(l.default.INIT_SEGMENT,function(t,n){e._msectl.appendInitSegment(n)}),this._transmuxer.on(l.default.MEDIA_SEGMENT,function(t,n){if(e._msectl.appendMediaSegment(n),e._config.lazyLoad&&!e._config.isLive){var i=e._mediaElement.currentTime;n.info.endDts>=1e3*(i+e._config.lazyLoadMaxDuration)&&null==e._progressChecker&&(o.default.v(e.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),e._suspendTransmuxer())}}),this._transmuxer.on(l.default.LOADING_COMPLETE,function(){e._msectl.endOfStream(),e._emitter.emit(u.default.LOADING_COMPLETE)}),this._transmuxer.on(l.default.RECOVERED_EARLY_EOF,function(){e._emitter.emit(u.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(l.default.IO_ERROR,function(t,n){e._emitter.emit(u.default.ERROR,f.ErrorTypes.NETWORK_ERROR,t,n)}),this._transmuxer.on(l.default.DEMUX_ERROR,function(t,n){e._emitter.emit(u.default.ERROR,f.ErrorTypes.MEDIA_ERROR,t,{code:-1,msg:n})}),this._transmuxer.on(l.default.MEDIA_INFO,function(t){e._mediaInfo=t,e._emitter.emit(u.default.MEDIA_INFO,Object.assign({},t))}),this._transmuxer.on(l.default.METADATA_ARRIVED,function(t){e._emitter.emit(u.default.METADATA_ARRIVED,t)}),this._transmuxer.on(l.default.SCRIPTDATA_ARRIVED,function(t){e._emitter.emit(u.default.SCRIPTDATA_ARRIVED,t)}),this._transmuxer.on(l.default.STATISTICS_INFO,function(t){e._statisticsInfo=e._fillStatisticsInfo(t),e._emitter.emit(u.default.STATISTICS_INFO,Object.assign({},e._statisticsInfo))}),this._transmuxer.on(l.default.RECOMMEND_SEEKPOINT,function(t){e._mediaElement&&!e._config.accurateSeek&&(e._requestSetTime=!0,e._mediaElement.currentTime=t/1e3)}),this._transmuxer.on(l.default.VIDEO_RESOLUTION_CHANGED,function(t){e._emitter.emit(u.default.VIDEO_RESOLUTION_CHANGED,t)}),this._transmuxer.open()))}},{key:"unload",value:function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null),this._durationMonitor&&(self.clearInterval(this._durationMonitor),this._durationMonitor=null),this._forzenTimes=0,this._lastDecodedFrames=0}},{key:"play",value:function(){return this._mediaElement.play()}},{key:"pause",value:function(){this._mediaElement.pause()}},{key:"_fillStatisticsInfo",value:function(e){if(e.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,n=0,i=0;if(this._mediaElement.getVideoPlaybackQuality){var r=this._mediaElement.getVideoPlaybackQuality();n=r.totalVideoFrames,i=r.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(n=this._mediaElement.webkitDecodedFrameCount,i=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=n,e.droppedFrames=i),e}},{key:"enableVideoStateMonitor",value:function(e){this._enableDurationMonitor=e,this._enableVideoFrozenMonitor=e}},{key:"_doDurationMonitor",value:function(){if(this._enableDurationMonitor){var e=this._mediaElement.buffered,t=this._mediaElement.currentTime,n=this._mediaElement.paused;if(null!=e&&0!=e.length){var i=e.end(0),r=i-t;if(!n&&r>this._maxDurationGap){var a=i-this._decreaseDurationStep;o.default.w(this.TAG,"large duration {"+r+"}, reduce "+this._decreaseDurationStep+" and set to "+a),this._mediaElement.currentTime=a,this._requestSetTime=!0}if(this._enableVideoFrozenMonitor){var s=0;if(this._mediaElement.getVideoPlaybackQuality)s=this._mediaElement.getVideoPlaybackQuality().totalVideoFrames;else{if(null==this._mediaElement.webkitDecodedFrameCount)return;s=this._mediaElement.webkitDecodedFrameCount}0!=this._lastDecodedFrames&&(this._lastDecodedFrames==s?this._forzenTimes++:this._forzenTimes=0),this._lastDecodedFrames=s,this._forzenTimes>=this._frozenTimesThreshold&&(o.default.w(this.TAG,"Report video frozen event"),this._emitter.emit(u.default.VIDEO_FROZEN),this._forzenTimes=0)}}}}},{key:"_onmseUpdateEnd",value:function(){if(this._config.lazyLoad&&!this._config.isLive){for(var e=this._mediaElement.buffered,t=this._mediaElement.currentTime,n=0,i=0;i<e.length;i++){var r=e.start(i),a=e.end(i);if(r<=t&&t<a){n=a;break}}n>=t+this._config.lazyLoadMaxDuration&&null==this._progressChecker&&(o.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}}},{key:"_onmseBufferFull",value:function(){o.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),null==this._progressChecker&&this._suspendTransmuxer(),this._emitter.emit(u.default.MS_BUFFER_FULL)}},{key:"_suspendTransmuxer",value:function(){this._transmuxer&&(this._transmuxer.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))}},{key:"_checkProgressAndResume",value:function(){for(var e=this._mediaElement.currentTime,t=this._mediaElement.buffered,n=!1,i=0;i<t.length;i++){var r=t.start(i),a=t.end(i);if(e>=r&&e<a){e>=a-this._config.lazyLoadRecoverDuration&&(n=!0);break}}n&&(window.clearInterval(this._progressChecker),this._progressChecker=null,n&&(o.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))}},{key:"_isTimepointBuffered",value:function(e){for(var t=this._mediaElement.buffered,n=0;n<t.length;n++){var i=t.start(n),r=t.end(n);if(e>=i&&e<r)return!0}return!1}},{key:"_internalSeek",value:function(e){var t=this._isTimepointBuffered(e),n=!1,i=0;if(e<1&&this._mediaElement.buffered.length>0){var r=this._mediaElement.buffered.start(0);(r<1&&e<r||s.default.safari)&&(n=!0,i=s.default.safari?.1:r)}if(n)this._requestSetTime=!0,this._mediaElement.currentTime=i;else if(t){if(this._alwaysSeekKeyframe){var a=this._msectl.getNearestKeyframe(Math.floor(1e3*e));this._requestSetTime=!0,this._mediaElement.currentTime=null!=a?a.dts/1e3:e}else this._requestSetTime=!0,this._mediaElement.currentTime=e;null!=this._progressChecker&&this._checkProgressAndResume()}else null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e)}},{key:"_checkAndApplyUnbufferedSeekpoint",value:function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var e=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(e)||(null!=this._progressChecker&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}},{key:"_checkAndResumeStuckPlayback",value:function(e){var t=this._mediaElement;if(e||!this._receivedCanPlay||t.readyState<2){var n=t.buffered;n.length>0&&t.currentTime<n.start(0)&&(o.default.w(this.TAG,"Playback seems stuck at "+t.currentTime+", seek to "+n.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=n.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)}},{key:"_onvLoadedMetadata",value:function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)}},{key:"_onvSeeking",value:function(e){var t=this._mediaElement.currentTime,n=this._mediaElement.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(t<1&&n.length>0){var i=n.start(0);if(i<1&&t<i||s.default.safari)return this._requestSetTime=!0,void(this._mediaElement.currentTime=s.default.safari?.1:i)}if(this._isTimepointBuffered(t)){if(this._alwaysSeekKeyframe){var r=this._msectl.getNearestKeyframe(Math.floor(1e3*t));null!=r&&(this._requestSetTime=!0,this._mediaElement.currentTime=r.dts/1e3)}null!=this._progressChecker&&this._checkProgressAndResume()}else this._seekpointRecord={seekPoint:t,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}}},{key:"_onvCanPlay",value:function(e){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)}},{key:"_onvStalled",value:function(e){this._checkAndResumeStuckPlayback(!0)}},{key:"_onvProgress",value:function(e){this._checkAndResumeStuckPlayback()}},{key:"type",get:function(){return this._type}},{key:"buffered",get:function(){return this._mediaElement.buffered}},{key:"duration",get:function(){return this._mediaElement.duration}},{key:"volume",get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e}},{key:"muted",get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e}},{key:"currentTime",get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._internalSeek(e):this._pendingSeekTime=e}},{key:"mediaInfo",get:function(){return Object.assign({},this._mediaInfo)}},{key:"statisticsInfo",get:function(){return null==this._statisticsInfo&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)}}]),e}();n.default=E},{"../config.js":5,"../core/mse-controller.js":9,"../core/mse-events.js":10,"../core/transmuxer.js":11,"../core/transmuxing-events.js":13,"../utils/browser.js":39,"../utils/exception.js":40,"../utils/logger.js":41,"./player-errors.js":34,"./player-events.js":35,events:2}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=c(e("events")),o=c(e("./player-events.js")),s=e("../config.js"),u=e("../utils/exception.js");function c(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new a.default,this._config=(0,s.createDefaultConfig)(),"object"===(void 0===n?"undefined":i(n))&&Object.assign(this._config,n),"flv"===t.type.toLowerCase())throw new u.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(t.hasOwnProperty("segments"))throw new u.InvalidArgumentException("NativePlayer("+t.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=t,this._mediaElement=null}return r(e,[{key:"destroy",value:function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null}},{key:"on",value:function(e,t){var n=this;e===o.default.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then(function(){n._emitter.emit(o.default.MEDIA_INFO,n.mediaInfo)}):e===o.default.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then(function(){n._emitter.emit(o.default.STATISTICS_INFO,n.statisticsInfo)}),this._emitter.addListener(e,t)}},{key:"off",value:function(e,t){this._emitter.removeListener(e,t)}},{key:"attachMediaElement",value:function(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}}},{key:"detachMediaElement",value:function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}},{key:"load",value:function(){if(!this._mediaElement)throw new u.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)}},{key:"unload",value:function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}},{key:"play",value:function(){return this._mediaElement.play()}},{key:"pause",value:function(){this._mediaElement.pause()}},{key:"_onvLoadedMetadata",value:function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(o.default.MEDIA_INFO,this.mediaInfo)}},{key:"_reportStatisticsInfo",value:function(){this._emitter.emit(o.default.STATISTICS_INFO,this.statisticsInfo)}},{key:"type",get:function(){return this._type}},{key:"buffered",get:function(){return this._mediaElement.buffered}},{key:"duration",get:function(){return this._mediaElement.duration}},{key:"volume",get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e}},{key:"muted",get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e}},{key:"currentTime",get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e}},{key:"mediaInfo",get:function(){var e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e}},{key:"statisticsInfo",get:function(){var e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,n=0,i=0;if(this._mediaElement.getVideoPlaybackQuality){var r=this._mediaElement.getVideoPlaybackQuality();n=r.totalVideoFrames,i=r.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(n=this._mediaElement.webkitDecodedFrameCount,i=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=n,e.droppedFrames=i),e}}]),e}();n.default=l},{"../config.js":5,"../utils/exception.js":40,"./player-events.js":35,events:2}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorDetails=n.ErrorTypes=void 0;var i,r=e("../io/loader.js"),a=e("../demux/demux-errors.js"),o=(i=a)&&i.__esModule?i:{default:i};n.ErrorTypes={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},n.ErrorDetails={NETWORK_EXCEPTION:r.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:r.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:r.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:r.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:o.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:o.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:o.default.CODEC_UNSUPPORTED}},{"../demux/demux-errors.js":16,"../io/loader.js":24}],35:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",VIDEO_RESOLUTION_CHANGED:"video_resolution_changed",MEDIA_SOURCE_ENDED:"media_source_ended",MEDIA_SOURCE_CLOSE:"media_source_close",VIDEO_FROZEN:"video_decoded_frame_frozen",MS_BUFFER_FULL:"media_source_buffer_full"}},{}],36:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"getSilentFrame",value:function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),e}();n.default=r},{}],37:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"init",value:function(){for(var t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=e.constants={};n.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),n.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),n.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSC=n.STCO=n.STTS,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),n.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}},{key:"box",value:function(e){for(var t=8,n=null,i=Array.prototype.slice.call(arguments,1),r=i.length,a=0;a<r;a++)t+=i[a].byteLength;(n=new Uint8Array(t))[0]=t>>>24&255,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n.set(e,4);for(var o=8,s=0;s<r;s++)n.set(i[s],o),o+=i[s].byteLength;return n}},{key:"generateInitSegment",value:function(t){var n=e.box(e.types.ftyp,e.constants.FTYP),i=e.moov(t),r=new Uint8Array(n.byteLength+i.byteLength);return r.set(n,0),r.set(i,n.byteLength),r}},{key:"moov",value:function(t){var n=e.mvhd(t.timescale,t.duration),i=e.trak(t),r=e.mvex(t);return e.box(e.types.moov,n,i,r)}},{key:"mvhd",value:function(t,n){return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}},{key:"trak",value:function(t){return e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"tkhd",value:function(t){var n=t.id,i=t.duration,r=t.presentWidth,a=t.presentHeight;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>>8&255,255&r,0,0,a>>>8&255,255&a,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t),e.hdlr(t),e.minf(t))}},{key:"mdhd",value:function(t){var n=t.timescale,i=t.duration;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i>>>24&255,i>>>16&255,i>>>8&255,255&i,85,196,0,0]))}},{key:"hdlr",value:function(t){var n=null;return n="audio"===t.type?e.constants.HDLR_AUDIO:e.constants.HDLR_VIDEO,e.box(e.types.hdlr,n)}},{key:"minf",value:function(t){var n=null;return n="audio"===t.type?e.box(e.types.smhd,e.constants.SMHD):e.box(e.types.vmhd,e.constants.VMHD),e.box(e.types.minf,n,e.dinf(),e.stbl(t))}},{key:"dinf",value:function(){return e.box(e.types.dinf,e.box(e.types.dref,e.constants.DREF))}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.constants.STTS),e.box(e.types.stsc,e.constants.STSC),e.box(e.types.stsz,e.constants.STSZ),e.box(e.types.stco,e.constants.STCO))}},{key:"stsd",value:function(t){return"audio"===t.type?"mp3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp3(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp4a(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.avc1(t))}},{key:"mp3",value:function(t){var n=t.channelCount,i=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return e.box(e.types[".mp3"],r)}},{key:"mp4a",value:function(t){var n=t.channelCount,i=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return e.box(e.types.mp4a,r,e.esds(t))}},{key:"esds",value:function(t){var n=t.config||[],i=n.length,r=new Uint8Array([0,0,0,0,3,23+i,0,1,0,4,15+i,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([i]).concat(n).concat([6,1,2]));return e.box(e.types.esds,r)}},{key:"avc1",value:function(t){var n=t.avcc,i=t.codecWidth,r=t.codecHeight,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>>8&255,255&i,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.avc1,a,e.box(e.types.avcC,n))}},{key:"mvex",value:function(t){return e.box(e.types.mvex,e.trex(t))}},{key:"trex",value:function(t){var n=t.id,i=new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return e.box(e.types.trex,i)}},{key:"moof",value:function(t,n){return e.box(e.types.moof,e.mfhd(t.sequenceNumber),e.traf(t,n))}},{key:"mfhd",value:function(t){var n=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return e.box(e.types.mfhd,n)}},{key:"traf",value:function(t,n){var i=t.id,r=e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i])),a=e.box(e.types.tfdt,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n])),o=e.sdtp(t),s=e.trun(t,o.byteLength+16+16+8+16+8+8);return e.box(e.types.traf,r,a,s,o)}},{key:"sdtp",value:function(t){for(var n=t.samples||[],i=n.length,r=new Uint8Array(4+i),a=0;a<i;a++){var o=n[a].flags;r[a+4]=o.isLeading<<6|o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy}return e.box(e.types.sdtp,r)}},{key:"trun",value:function(t,n){var i=t.samples||[],r=i.length,a=12+16*r,o=new Uint8Array(a);n+=8+a,o.set([0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0);for(var s=0;s<r;s++){var u=i[s].duration,c=i[s].size,l=i[s].flags,d=i[s].cts;o.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,c>>>24&255,c>>>16&255,c>>>8&255,255&c,l.isLeading<<2|l.dependsOn,l.isDependedOn<<6|l.hasRedundancy<<4|l.isNonSync,0,0,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*s)}return e.box(e.types.trun,o)}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}}]),e}();r.init(),n.default=r},{}],38:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=l(e("../utils/logger.js")),a=l(e("./mp4-generator.js")),o=l(e("./aac-silent.js")),s=l(e("../utils/browser.js")),u=e("../core/media-segment-info.js"),c=e("../utils/exception.js");function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TAG="MP4Remuxer",this._config=t,this._isLive=!0===t.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new u.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new u.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!s.default.chrome||!(s.default.version.major<50||50===s.default.version.major&&s.default.version.build<2661)),this._fillSilentAfterSeek=s.default.msedge||s.default.msie,this._mp3UseMpegAudio=!s.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return i(e,[{key:"destroy",value:function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null}},{key:"bindDataSource",value:function(e){return e.onDataAvailable=this.remux.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this}},{key:"insertDiscontinuity",value:function(){this._audioNextDts=this._videoNextDts=void 0}},{key:"seek",value:function(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()}},{key:"remux",value:function(e,t){if(!this._onMediaSegment)throw new c.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(e,t),this._remuxVideo(t),this._remuxAudio(e)}},{key:"_onTrackMetadataReceived",value:function(e,t){var n=null,i="mp4",r=t.codec;if("audio"===e)this._audioMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(i="mpeg",r="",n=new Uint8Array):n=a.default.generateInitSegment(t);else{if("video"!==e)return;this._videoMeta=t,n=a.default.generateInitSegment(t)}if(!this._onInitSegment)throw new c.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(e,{type:e,data:n.buffer,codec:r,container:e+"/"+i,mediaDuration:t.duration})}},{key:"_calculateDtsBase",value:function(e,t){this._dtsBaseInited||(e.samples&&e.samples.length&&(this._audioDtsBase=e.samples[0].dts),t.samples&&t.samples.length&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)}},{key:"flushStashedSamples",value:function(){var e=this._videoStashedLastSample,t=this._audioStashedLastSample,n={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(n.samples.push(e),n.length=e.length);var i={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(i.samples.push(t),i.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(n,!0),this._remuxAudio(i,!0)}},{key:"_remuxAudio",value:function(e,t){if(null!=this._audioMeta){var n,i=e,c=i.samples,l=void 0,d=-1,_=this._audioMeta.refSampleDuration,f="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,p=this._dtsBaseInited&&void 0===this._audioNextDts,h=!1;if(c&&0!==c.length&&(1!==c.length||t)){var g=0,E=null,v=0;f?(g=0,v=i.length):(g=8,v=8+i.length);var m=null;if(c.length>1&&(v-=(m=c.pop()).length),null!=this._audioStashedLastSample){var S=this._audioStashedLastSample;this._audioStashedLastSample=null,c.unshift(S),v+=S.length}null!=m&&(this._audioStashedLastSample=m);var A=c[0].dts-this._dtsBase;if(this._audioNextDts)l=A-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())l=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(h=!0);else{var y=this._audioSegmentInfoList.getLastSampleBefore(A);if(null!=y){var T=A-(y.originalDts+y.duration);T<=3&&(T=0),l=A-(y.dts+y.duration+T)}else l=0}if(h){var R=A-l,I=this._videoSegmentInfoList.getLastSegmentBefore(A);if(null!=I&&I.beginDts<R){var C=o.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(C){var O=I.beginDts,b=R-I.beginDts;r.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+O+", duration: "+b),c.unshift({unit:C,dts:O,pts:O}),v+=C.byteLength}}else h=!1}for(var L=[],D=0;D<c.length;D++){var N=c[D],P=N.unit,k=N.dts-this._dtsBase,w=k,U=!1,M=null,x=0;if(!(k<-.001)){if("mp3"!==this._audioMeta.codec){var V=k;if(this._audioNextDts&&(V=this._audioNextDts),(l=k-V)<=-3*_){r.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+k+" ms ,curRefDts: "+V+" ms)  due to dtsCorrection: "+l+" ms overlap.");continue}if(l>=3*_&&this._fillAudioTimestampGap&&!s.default.safari){U=!0;var G=Math.floor(l/_);r.default.w(this.TAG,"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\noriginalDts: "+k+" ms, curRefDts: "+V+" ms, dtsCorrection: "+Math.round(l)+" ms, generate: "+G+" frames"),w=Math.floor(V),x=Math.floor(V+_)-w;var B=o.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);null==B&&(r.default.w(this.TAG,"Unable to generate silent frame for "+this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame"),B=P),M=[];for(var H=0;H<G;H++){V+=_;var Y=Math.floor(V),F=Math.floor(V+_)-Y,j={dts:Y,pts:Y,cts:0,unit:B,size:B.byteLength,duration:F,originalDts:k,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};M.push(j),v+=P.byteLength}this._audioNextDts=V+_}else w=Math.floor(V),x=Math.floor(V+_)-w,this._audioNextDts=V+_}else w=k-l,x=D!==c.length-1?c[D+1].dts-this._dtsBase-l-w:null!=m?m.dts-this._dtsBase-l-w:L.length>=1?L[L.length-1].duration:Math.floor(_),this._audioNextDts=w+x;-1===d&&(d=w),L.push({dts:w,pts:w,cts:0,unit:N.unit,size:N.unit.byteLength,duration:x,originalDts:k,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),U&&L.push.apply(L,M)}}if(0===L.length)return i.samples=[],void(i.length=0);f?E=new Uint8Array(v):((E=new Uint8Array(v))[0]=v>>>24&255,E[1]=v>>>16&255,E[2]=v>>>8&255,E[3]=255&v,E.set(a.default.types.mdat,4));for(var W=0;W<L.length;W++){var K=L[W].unit;E.set(K,g),g+=K.byteLength}var $=L[L.length-1];n=$.dts+$.duration;var J=new u.MediaSegmentInfo;J.beginDts=d,J.endDts=n,J.beginPts=d,J.endPts=n,J.originalBeginDts=L[0].originalDts,J.originalEndDts=$.originalDts+$.duration,J.firstSample=new u.SampleInfo(L[0].dts,L[0].pts,L[0].duration,L[0].originalDts,!1),J.lastSample=new u.SampleInfo($.dts,$.pts,$.duration,$.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(J),i.samples=L,i.sequenceNumber++;var Q=null;Q=f?new Uint8Array:a.default.moof(i,d),i.samples=[],i.length=0;var z={type:"audio",data:this._mergeBoxes(Q,E).buffer,sampleCount:L.length,info:J};f&&p&&(z.timestampOffset=d),this._onMediaSegment("audio",z)}}}},{key:"_remuxVideo",value:function(e,t){if(null!=this._videoMeta){var n,i,r=e,o=r.samples,s=void 0,c=-1,l=-1;if(o&&0!==o.length&&(1!==o.length||t)){var d=8,_=null,f=8+e.length,p=null;if(o.length>1&&(f-=(p=o.pop()).length),null!=this._videoStashedLastSample){var h=this._videoStashedLastSample;this._videoStashedLastSample=null,o.unshift(h),f+=h.length}null!=p&&(this._videoStashedLastSample=p);var g=o[0].dts-this._dtsBase;if(this._videoNextDts)s=g-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())s=0;else{var E=this._videoSegmentInfoList.getLastSampleBefore(g);if(null!=E){var v=g-(E.originalDts+E.duration);v<=3&&(v=0),s=g-(E.dts+E.duration+v)}else s=0}for(var m=new u.MediaSegmentInfo,S=[],A=0;A<o.length;A++){var y=o[A],T=y.dts-this._dtsBase,R=y.isKeyframe,I=T-s,C=y.cts,O=I+C;-1===c&&(c=I,l=O);var b=0;if(b=A!==o.length-1?o[A+1].dts-this._dtsBase-s-I:null!=p?p.dts-this._dtsBase-s-I:S.length>=1?S[S.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),R){var L=new u.SampleInfo(I,O,b,y.dts,!0);L.fileposition=y.fileposition,m.appendSyncPoint(L)}S.push({dts:I,pts:O,cts:C,units:y.units,size:y.length,isKeyframe:R,duration:b,originalDts:T,flags:{isLeading:0,dependsOn:R?2:1,isDependedOn:R?1:0,hasRedundancy:0,isNonSync:R?0:1}})}(_=new Uint8Array(f))[0]=f>>>24&255,_[1]=f>>>16&255,_[2]=f>>>8&255,_[3]=255&f,_.set(a.default.types.mdat,4);for(var D=0;D<S.length;D++)for(var N=S[D].units;N.length;){var P=N.shift().data;_.set(P,d),d+=P.byteLength}var k=S[S.length-1];if(n=k.dts+k.duration,i=k.pts+k.duration,this._videoNextDts=n,m.beginDts=c,m.endDts=n,m.beginPts=l,m.endPts=i,m.originalBeginDts=S[0].originalDts,m.originalEndDts=k.originalDts+k.duration,m.firstSample=new u.SampleInfo(S[0].dts,S[0].pts,S[0].duration,S[0].originalDts,S[0].isKeyframe),m.lastSample=new u.SampleInfo(k.dts,k.pts,k.duration,k.originalDts,k.isKeyframe),this._isLive||this._videoSegmentInfoList.append(m),r.samples=S,r.sequenceNumber++,this._forceFirstIDR){var w=S[0].flags;w.dependsOn=2,w.isNonSync=0}var U=a.default.moof(r,c);r.samples=[],r.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(U,_).buffer,sampleCount:S.length,info:m})}}}},{key:"_mergeBoxes",value:function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(e,0),n.set(t,e.byteLength),n}},{key:"onInitSegment",get:function(){return this._onInitSegment},set:function(e){this._onInitSegment=e}},{key:"onMediaSegment",get:function(){return this._onMediaSegment},set:function(e){this._onMediaSegment=e}}]),e}();n.default=d},{"../core/media-segment-info.js":8,"../utils/browser.js":39,"../utils/exception.js":40,"../utils/logger.js":41,"./aac-silent.js":36,"./mp4-generator.js":37}],39:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={};!function(){var e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],n=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],r={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:n[0]||""},a={};if(r.browser){a[r.browser]=!0;var o=r.majorVersion.split(".");a.version={major:parseInt(r.majorVersion,10),string:r.version},o.length>1&&(a.version.minor=parseInt(o[1],10)),o.length>2&&(a.version.build=parseInt(o[2],10))}for(var s in r.platform&&(a[r.platform]=!0),(a.chrome||a.opr||a.safari)&&(a.webkit=!0),(a.rv||a.iemobile)&&(a.rv&&delete a.rv,r.browser="msie",a.msie=!0),a.edge&&(delete a.edge,r.browser="msedge",a.msedge=!0),a.opr&&(r.browser="opera",a.opera=!0),a.safari&&a.android&&(r.browser="android",a.android=!0),a.name=r.browser,a.platform=r.platform,i)i.hasOwnProperty(s)&&delete i[s];Object.assign(i,a)}(),n.default=i},{}],40:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=n.RuntimeException=function(){function e(t){o(this,e),this._message=t}return i(e,[{key:"toString",value:function(){return this.name+": "+this.message}},{key:"name",get:function(){return"RuntimeException"}},{key:"message",get:function(){return this._message}}]),e}();n.IllegalStateException=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,s),i(t,[{key:"name",get:function(){return"IllegalStateException"}}]),t}(),n.InvalidArgumentException=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,s),i(t,[{key:"name",get:function(){return"InvalidArgumentException"}}]),t}(),n.NotImplementedException=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,s),i(t,[{key:"name",get:function(){return"NotImplementedException"}}]),t}()},{}],41:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=e("events"),o=(i=a)&&i.__esModule?i:{default:i},s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"e",value:function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","error",i),e.ENABLE_ERROR&&(console.error?console.error(i):console.warn?console.warn(i):console.log(i))}},{key:"i",value:function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","info",i),e.ENABLE_INFO&&(console.info?console.info(i):console.log(i))}},{key:"w",value:function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","warn",i),e.ENABLE_WARN&&(console.warn?console.warn(i):console.log(i))}},{key:"d",value:function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","debug",i),e.ENABLE_DEBUG&&(console.debug?console.debug(i):console.log(i))}},{key:"v",value:function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","verbose",i),e.ENABLE_VERBOSE&&console.log(i)}}]),e}();s.GLOBAL_TAG="flv.js",s.FORCE_GLOBAL_TAG=!1,s.ENABLE_ERROR=!0,s.ENABLE_INFO=!0,s.ENABLE_WARN=!0,s.ENABLE_DEBUG=!0,s.ENABLE_VERBOSE=!0,s.ENABLE_CALLBACK=!1,s.emitter=new o.default,n.default=s},{events:2}],42:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=o(e("events")),a=o(e("./logger.js"));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"getConfig",value:function(){return{globalTag:a.default.GLOBAL_TAG,forceGlobalTag:a.default.FORCE_GLOBAL_TAG,enableVerbose:a.default.ENABLE_VERBOSE,enableDebug:a.default.ENABLE_DEBUG,enableInfo:a.default.ENABLE_INFO,enableWarn:a.default.ENABLE_WARN,enableError:a.default.ENABLE_ERROR,enableCallback:a.default.ENABLE_CALLBACK}}},{key:"applyConfig",value:function(e){a.default.GLOBAL_TAG=e.globalTag,a.default.FORCE_GLOBAL_TAG=e.forceGlobalTag,a.default.ENABLE_VERBOSE=e.enableVerbose,a.default.ENABLE_DEBUG=e.enableDebug,a.default.ENABLE_INFO=e.enableInfo,a.default.ENABLE_WARN=e.enableWarn,a.default.ENABLE_ERROR=e.enableError,a.default.ENABLE_CALLBACK=e.enableCallback}},{key:"_notifyChange",value:function(){var t=e.emitter;if(t.listenerCount("change")>0){var n=e.getConfig();t.emit("change",n)}}},{key:"registerListener",value:function(t){e.emitter.addListener("change",t)}},{key:"removeListener",value:function(t){e.emitter.removeListener("change",t)}},{key:"addLogListener",value:function(t){a.default.emitter.addListener("log",t),a.default.emitter.listenerCount("log")>0&&(a.default.ENABLE_CALLBACK=!0,e._notifyChange())}},{key:"removeLogListener",value:function(t){a.default.emitter.removeListener("log",t),0===a.default.emitter.listenerCount("log")&&(a.default.ENABLE_CALLBACK=!1,e._notifyChange())}},{key:"forceGlobalTag",get:function(){return a.default.FORCE_GLOBAL_TAG},set:function(t){a.default.FORCE_GLOBAL_TAG=t,e._notifyChange()}},{key:"globalTag",get:function(){return a.default.GLOBAL_TAG},set:function(t){a.default.GLOBAL_TAG=t,e._notifyChange()}},{key:"enableAll",get:function(){return a.default.ENABLE_VERBOSE&&a.default.ENABLE_DEBUG&&a.default.ENABLE_INFO&&a.default.ENABLE_WARN&&a.default.ENABLE_ERROR},set:function(t){a.default.ENABLE_VERBOSE=t,a.default.ENABLE_DEBUG=t,a.default.ENABLE_INFO=t,a.default.ENABLE_WARN=t,a.default.ENABLE_ERROR=t,e._notifyChange()}},{key:"enableDebug",get:function(){return a.default.ENABLE_DEBUG},set:function(t){a.default.ENABLE_DEBUG=t,e._notifyChange()}},{key:"enableVerbose",get:function(){return a.default.ENABLE_VERBOSE},set:function(t){a.default.ENABLE_VERBOSE=t,e._notifyChange()}},{key:"enableInfo",get:function(){return a.default.ENABLE_INFO},set:function(t){a.default.ENABLE_INFO=t,e._notifyChange()}},{key:"enableWarn",get:function(){return a.default.ENABLE_WARN},set:function(t){a.default.ENABLE_WARN=t,e._notifyChange()}},{key:"enableError",get:function(){return a.default.ENABLE_ERROR},set:function(t){a.default.ENABLE_ERROR=t,e._notifyChange()}}]),e}();s.emitter=new r.default,n.default=s},{"./logger.js":41,events:2}],43:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,null,[{key:"install",value:function(){Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Object.assign=Object.assign||function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t},"function"!=typeof self.Promise&&e("es6-promise").polyfill()}}]),t}();r.install(),n.default=r},{"es6-promise":1}],44:[function(e,t,n){"use strict";function i(e,t,n){var i=e;if(t+n<i.length){for(;n--;)if(128!=(192&i[++t]))return!1;return!0}return!1}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){for(var t=[],n=e,r=0,a=e.length;r<a;)if(n[r]<128)t.push(String.fromCharCode(n[r])),++r;else{if(n[r]<192);else if(n[r]<224){if(i(n,r,1)){var o=(31&n[r])<<6|63&n[r+1];if(o>=128){t.push(String.fromCharCode(65535&o)),r+=2;continue}}}else if(n[r]<240){if(i(n,r,2)){var s=(15&n[r])<<12|(63&n[r+1])<<6|63&n[r+2];if(s>=2048&&55296!=(63488&s)){t.push(String.fromCharCode(65535&s)),r+=3;continue}}}else if(n[r]<248&&i(n,r,3)){var u=(7&n[r])<<18|(63&n[r+1])<<12|(63&n[r+2])<<6|63&n[r+3];if(u>65536&&u<1114112){u-=65536,t.push(String.fromCharCode(u>>>10|55296)),t.push(String.fromCharCode(1023&u|56320)),r+=4;continue}}t.push(String.fromCharCode(65533)),++r}return t.join("")}},{}]},{},[21])(21)}).call(this,n(226))},function(e,t,n){"use strict";var i;void 0===(i=function(e){return function(e){return"string"!==$.type(e)&&(e=""+e),e.indexOf("_")>=0?(e=e.replace(/_/g,"-"),$.camelCase(e)):e}}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){e.exports=n(587)},,,,,,,,,function(e,t,n){"use strict";var i;void 0===(i=function(){var e=n(75),t=n(270),i=n(345);return function(n){var r=n.url;if(!n.force&&!BJY.isAlicloudImage(r))return r;var a=(r=t(r)).split(".").pop();"gif"===a&&(a="jpg");var o=Math.floor(100*(n.quality||1)),s=n.width,u=n.height;return s=Math.floor(s),u=Math.floor(u),e.mixin(function(e,t,n,r,a,o,s){var u=t||n,c=a?"m_lfit":"m_mfit",l="";return s&&s.text&&(s=$.extend({rotate:20,size:50,opacity:5,fill:1},s),l="/watermark,text_"+i.encodeURI(s.text)+",size_"+s.size+",t_"+s.opacity+",rotate_"+s.rotate+",fill_"+s.fill),{"x-oss-process":"image/"+(u?"resize,limit_0,"+c+",":"")+(t?"w_"+t+(n?",":"/"):"")+(n?"h_"+n+"/":"")+"quality,q_"+r+"/format,"+(o?"webp":e.toLowerCase())+l}}(a,s,u,o,n.noCrop,n.hasWebp,n.watermark),r)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i=BJY.auth,r=BJY.server.room,a=BJY.config,o=BJY.store;function s(e){$.extend(this,e)}s.prototype={constructor:s,publishAV:function(e,t){var n=this,r=$.Deferred(),s=e.getServer();return t==a.MEDIA_PUBLISH_BY_CHANGE_SERVER?l(s.getActiveUplinkServer()):e.getDynamicUplinkServer().then(function(e){l(e)}),r;function l(t){var a=e.user,l=e.uplinkServer=a.publishServer={ip:t.ip,port:t.port};e.isAssist?a.sessionId2=t.sessionId:a.sessionId=t.sessionId;var d=e.publishStreamName=s.getUplinkStreamName(e.id,e.getUserPublishIndex());n.extension._publishAV(e,{streamName:d,publishIp:l.ip,publishPort:l.port,protocolType:o.get("partner.liveProtocolType")||"rtmp",pushHLS:i.canPushHLS()?u:c}),r.resolve()}},publishAVClose:function(e,t){var n=e.publishStreamName;n&&(e.serverShutDown||t===a.MEDIA_PUBLISH_BY_CHANGE_SERVER||r.mediaUnpublish(e.isAssist?o.get("user.sessionId2"):o.get("user.sessionId")),this.extension._publishAVClose(e,{streamName:n}))},publishAVRelease:function(e,t){var n=e.publishStreamName;n&&(e.serverShutDown||t===a.MEDIA_PUBLISH_BY_CHANGE_SERVER||r.mediaUnpublish(e.isAssist?o.get("user.sessionId2"):o.get("user.sessionId")),e.publishStreamName=null,this.extension._publishAVRelease(e,{streamName:n}))},playAV:function(e,t){var n=this,r=e.user,o=e.getServer(),s=t.actionType,u=function(a){var s;s=i.isWebRTC()&&!i.canSupportWebRTC()?e.playStreamName=o.getDownlinkWebRTCMixedStreamName():e.playStreamName=o.getDownlinkStreamName(e.isPlayingExtraStream?r.id4:e.id,e.getUserPublishIndex());var u=t.audioOnly;n.extension._playAV(e,{streamName:s,identifier:e.isAssist?r.id2:e.isPlayingExtraStream?r.id4:r.id,playIp:a.ip,playPort:a.port,audioOnly:u,mount:a.mount||"mgclient",url:a.ip})},c=function(e){};function l(){s==a.REPLAY_BY_CHANGE_SERVER?u(e.getDownlinkServer()):e.getDynamicDownlinkServer(e).then(u,c)}l()},playAVClose:function(e){var t=e.playStreamName;t&&this.extension._playAVClose(e,{streamName:t})},playAVRelease:function(e){var t=e.playStreamName;t&&(e.playStreamName=null,this.extension._playAVRelease(e,{streamName:t}))}};var u=1,c=2;return BJY.Player.CombineMode=s,s}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";return function(e,t,n){var i=!1;if($.isNumeric(e)&&$.isNumeric(t)&&$.isNumeric(n))i=!0;else if(1===arguments.length)$.isPlainObject(e)&&(i=!0,n=e.date,t=e.month,e=e.year);else if(2===arguments.length&&"string"===$.type(e)){i=!0;var r=e.split(t||"-");e=r[0],t=r[1],n=r[2]}if(i&&4===String(e).length&&t>=1&&t<=12&&n>=1&&n<=31)return new Date(e,t-1,n)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){return function(e){return"string"!==$.type(e)&&(e=""+e),e=e.replace(/([A-Z])/g,"_$1").toLowerCase()}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(269).map;return function(e){var t,n=e.points;if(Yox.is.string(n)){if(2==e.encodeType){for(var r=[],a=0,o=n.length;a<o;a+=4)r.push((t=n.substr(a,4),{x:(64*i[t.charAt(0)]+i[t.charAt(1)])/4095,y:(64*i[t.charAt(2)]+i[t.charAt(3)])/4095}));return r}return JSON.parse(n)}return n}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var n=String.fromCharCode,i=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,r=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?n(192|t>>>6)+n(128|63&t):n(224|t>>>12&15)+n(128|t>>>6&63)+n(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return n(240|t>>>18&7)+n(128|t>>>12&63)+n(128|t>>>6&63)+n(128|63&t)},a=function(e){return btoa(function(e){return e.replace(i,r)}(e))};t.encodeURI=function(e){return a(String(e)).replace(/[+\/]/g,function(e){return"+"===e?"-":"_"}).replace(/=/g,"")}}.call(t,n,t,e))||(e.exports=i)},,,function(e,t,n){var i=n(228);e.exports=function(e){if(i(e))return e}},function(e,t,n){var i=n(350);e.exports=function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var s,u=i(e);!(r=(s=u.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}return n}},function(e,t,n){e.exports=n(351)},function(e,t,n){n(110),n(89),e.exports=n(352)},function(e,t,n){var i=n(18),r=n(182);e.exports=n(1).getIterator=function(e){var t=r(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return i(t.call(e))}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,n){"use strict";var i,r=n(0),a=r(n(8)),o=r(n(128)),s=r(n(117));void 0===(i=function(e,t,n){var i,r=BJY.store,u=BJY.config,c=BJY.storage,l=BJY.auth,d=BJY.data.media,_=BJY.eventEmitter,f=u.STORAGE_KEY_COMPOSED_VIRTUAL_CAMERAS,p=u.STORAGE_KEY_HIDDEN_VIRTUAL_CAMERAS,h={},g={},E=r.get("workableVirtualCameraMap",{});t.filterCameraList=function(e,n){for(var a=r.get("virtualCameraKey"),o=e.length-1;o>=0;o--){var c=e[o],l=c.name;if(l===u.VIRTUAL_CAMERA_NAME)i=c,e.splice(o,1);else if(-1!==l.indexOf(a)){var d=l.split(a)[1],_=(0,s.default)(d.replace(/[^0-9]/gi,""));n&&(c.virtual=!0),c.channelIndex=_,h[_]=c,g[_]?n&&(E[_]=c):e.splice(o,1)}}return e=t.updateCameraList(e),r.set("workableVirtualCameraMap",E),r.set("virtualMainCamera",i),e},t.updateCameraList=function(e){var t=c.get(f),n=c.get(p);if(l.isWebRTC()){var i=[];if(t&&(t=JSON.parse(t)))for(var s=function(n){var r=t[n];if(-1===e.findIndex(function(e){return e.guid===r.guid})){var a=r.composeCameraInfo,s=!0;Yox.object.each(a,function(e,t){var n=e.channelIndex;E[n]?(0,o.default)(a[t],E[n]):s=!1}),s&&i.push(r)}},u=0;u<t.length;u++)s(u);n&&(n=JSON.parse(n))&&Yox.array.each(n,function(t){if(E[t]){var n=e.findIndex(function(e){return e.channelIndex===t});-1!==n&&e.splice(n,1)}}),e=e.concat(i)}return e.forEach(function(e,t){e.index=t}),l.isWebRTC()&&(t&&c.set(f,(0,a.default)(t)),n&&(c.set(p,(0,a.default)(n)),r.set("hiddenVirtualCameraChannelList",n))),e},_.on(_.VIRTUAL_CHANNEL_SIGNAL_NOTIFY,function(e,n){if(r.get("supportVirtualCamera")&&n.channel){var i=n.channel,a=n.enable,o=d.getCameraList(),s=h[i];if(s){if(a)o.push(s),E[i]=s;else{var u=o.findIndex(function(e){return e.guid===s.guid});-1!==u&&o.splice(u,1),E[i]=""}o=t.updateCameraList(o),d.setCameraList(o),_.trigger(_.VIDEO_DEVICE_DETECT,{cameraList:o})}else a&&(g[i]=!0)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i=n(0);n(66)(t,"__esModule",{value:!0}),t.SessionManager=void 0;var r=i(n(174)),a=i(n(104)),o=i(n(131)),s=i(n(175)),u=i(n(117)),c=i(n(123)),l=i(n(155)),d=i(n(581)),_=i(n(583)),f=i(n(590)),p=n(595),h=n(272),g=BJY.store,E=BJY.server.webrtc,v=n(200),m=0,S=3,A=0,y=function(e){function t(e,n,i){var r;return(0,c.default)(this,t),(r=(0,d.default)(this,(0,_.default)(t).call(this)))._session=null,r._playerId=null,r._zeroFpsInputCount=0,r._publisherStore={},r._subscriberStore={},r.status=A,r.isReconnecting=!1,r.channel=e,r.isAssist=n,r.logger=v("session-"+(i||"")+":"),r}var n,i,p,y,T,R,I,C,O,b,L,D,N;return(0,f.default)(t,e),(0,l.default)(t,[{key:"getSessionId",value:function(){return(0,u.default)(this.isAssist?g.get("user.id2"):g.get("user.id"))}},{key:"updateChannel",value:function(e){this.channel=e}},{key:"createSession",value:(N=(0,s.default)(r.default.mark(function e(){var t=this;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(BJY.Player.SignalServer&&1!==this.status){e.next=2;break}return e.abrupt("return");case 2:if(2!==this.status){e.next=4;break}return e.abrupt("return",this._session);case 4:return this.status=1,this.sessionId=this.getSessionId(),e.prev=6,e.next=9,BJY.Player.SignalServer.joinSession({area:E.getActiveUplinkArea()||E.getActiveDownlinkArea(),channel:this.channel,userId:this.sessionId});case 9:return this._session=e.sent,this._session.on("publisher",function(e){var n=e.userId;t.logger(n+" published"),n!==t._playerId&&t.trigger("addPublisher",{playerId:n})}),this._session.on("unpublish",function(e){t.logger(e+" unpublished"),t.trigger("removePublisher",{playerId:e}),t.trigger("cleanStream",{playerId:e}),t._subscriberStore[e]&&1===t._subscriberStore[e].status&&(t._subscriberStore[e].status=2)}),this._session.on("quit",function(){t.logger("session disconnected"),t._session&&t._session.removeAllListeners(),t._session=null,t.trigger("sessionDisconnect"),t.reconnectByUser?(t.logger("rejoin by renew sessionId"),o.default.resolve().then(function(){t.isReconnecting=!0,t.createSession()})):3!==t.status&&o.default.resolve().then(function(){t.isReconnecting=!0,t.createSession()}),t.status=A}),this._session.on("rtcat-stats",function(e,n){if(n===t._playerId){var i=e.video.fpsInput,r=e.video.packetsLossRate,o=e.audio.packetsLossRate,s=8*e.video.kBpsSent,c=8*e.audio.kBpsSent,l=0;e.net&&e.net.rtt&&(l=(0,u.default)(e.net.rtt)),t.trigger("uplinkStats",{playerId:n,uplinkVideoLossRate:r,uplinkAudioLossRate:o,uplinkVideoBandwidth:s,uplinkAudioBandwidth:c,rtt:l}),0===i?t._zeroFpsInputCount+=1:t._zeroFpsInputCount=0,10===t._zeroFpsInputCount&&(0!==(0,a.default)(t._publisherStore).length&&(t.logger("republish because too much zero fps input"),t.trigger("republish",{playerId:n})),t._zeroFpsInputCount=0)}else{var d=e.video.packetsLossRate,_=e.audio.packetsLossRate,f=8*e.video.kBpsReceived,p=8*e.audio.kBpsReceived;t.trigger("downlinkStats",{playerId:n,downlinkVideoLossRate:d,downlinkAudioLossRate:_,downlinkVideoBandwidth:f,downlinkAudioBandwidth:p})}}),this._session.on("rtcat-event",function(e,n){switch(e.code){case RTCat.EventCode.REPUBLISH_START:t.logger("republish_start",n);break;case RTCat.EventCode.REPUBLISH_ERROR:t.logger("republish_error",n);break;case RTCat.EventCode.REPUBLISH_END:t.logger("republish_end",n);break;case RTCat.EventCode.RESUBSCRIBE_START:t.logger("resubscribe start",n);break;case RTCat.EventCode.RESUBSCRIBE_ERROR:t.logger("resubscribe error",n);break;case RTCat.EventCode.RESUBSCRIBE_END:t.logger("resubscribe end",n);break;case RTCat.EventCode.RTC_CONNECTED:t.logger("rtc connect",n);break;case RTCat.EventCode.RTC_FAILED:t.logger("rtc failed",n)}}),this.isReconnecting?(this.logger("session reconnected"),this._playerId=null,this.logger("republish after session reconnected",this.sessionId),0!==(0,a.default)(this._publisherStore).length&&(this.logger("republish after session reconnected",this._publisherStore.playerId),this.trigger("republish",{playerId:this._publisherStore.playerId,player:this._publisherStore.player})),this.trigger("reconnect")):this.logger("session join success"),this.status=2,this.reconnectByUser=!1,e.abrupt("return",this._session);case 21:return e.prev=21,e.t0=e.catch(6),this.status=A,this.logger(e.t0),e.next=27,this.reconnectSession();case 27:return e.abrupt("return",e.sent);case 28:case"end":return e.stop()}},e,this,[[6,21]])})),function(){return N.apply(this,arguments)})},{key:"reconnectSession",value:(D=(0,s.default)(r.default.mark(function e(){return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isConnected()){e.next=11;break}return this.logger("reconnecting session..."),this._session&&this._session.quit(),this.isReconnecting=!0,e.next=6,new h.Sleep(5);case 6:return e.next=8,this.createSession();case 8:return e.abrupt("return",e.sent);case 11:return e.abrupt("return",this._session);case 12:case"end":return e.stop()}},e,this)})),function(){return D.apply(this,arguments)})},{key:"isConnected",value:function(){return 2===this.status}},{key:"_publishAV",value:(L=(0,s.default)(r.default.mark(function e(t){var n,i,a,o,u,c,l,d;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.player,i=t.playerId,a=t.stream,o=t.audioBandwidth,u=t.bandwidth,c=t.firPeriod,l=this,d=function(){var e=(0,s.default)(r.default.mark(function e(){var t,s,_;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!l._session||!l.isConnected()||l.sessionId==i){e.next=6;break}throw l.reconnectByUser=!0,l._session.quit(),new Error("old session");case 6:if(!l._session||!l.isConnected()){e.next=25;break}return l.trigger("addStream",{playerId:i,stream:a}),e.prev=8,e.next=11,l._session.publish(a,{server:null,video:{bandwidth:u,firPeriod:c,codec:g.get("partner.webrtcCodec","vp8")},audio:{bandwidth:o}});case 11:t=e.sent,l._playerId=i,s=t.server,l.logger("published in",s),l.trigger("published",{playerId:i}),s&&(_={name:s},n.serverInfo.uplinkServer=n.user.publishServer=_,E.setActiveUplinkServer(_)),e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(8),l.logger(e.t0),e.t0;case 23:e.next=42;break;case 25:if(!(l.publishStreamTryCount<5)){e.next=39;break}return e.next=28,new h.Sleep(1);case 28:return l.publishStreamTryCount++,e.prev=29,e.next=32,d();case 32:e.next=37;break;case 34:throw e.prev=34,e.t1=e.catch(29),e.t1;case 37:e.next=42;break;case 39:throw l.logger("clean stream in publish"),l.trigger("cleanStream",{playerId:i}),new Error("publish timeout ".concat(i));case 42:case"end":return e.stop()}},e,null,[[8,19],[29,34]])}));return function(){return e.apply(this,arguments)}}(),e.prev=3,e.next=6,d();case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),e.t0;case 11:case"end":return e.stop()}},e,this,[[3,8]])})),function(e){return L.apply(this,arguments)})},{key:"publishAV",value:(b=(0,s.default)(r.default.mark(function e(){var t,n,i,a,o,s,u,c,l,d,_=arguments;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=_.length>0&&void 0!==_[0]?_[0]:{},n=t.player,i=t.playerId,a=t.stream,o=t.audioBandwidth,s=void 0===o?64:o,u=t.bandwidth,c=void 0===u?1e3:u,l=t.firPeriod,d=void 0===l?1e3:l,this.logger("publish av",_),!a){e.next=15;break}return this._publisherStore={player:n,playerId:i},this.publishStreamTryCount=0,e.prev=5,e.next=8,this._publishAV({player:n,playerId:i,stream:a,audioBandwidth:s,bandwidth:c,firPeriod:d});case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(5),e.t0;case 13:e.next=16;break;case 15:throw new Error("no stream");case 16:case"end":return e.stop()}},e,this,[[5,10]])})),function(){return b.apply(this,arguments)})},{key:"publishAVClose",value:(O=(0,s.default)(r.default.mark(function e(t){var n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.playerId,this._publisherStore={},this._playerId!==n){e.next=19;break}if(this.logger("unpublish",this._playerId),!this._session){e.next=18;break}return e.prev=5,e.next=8,this._session.unpublish();case 8:this._playerId=null,this.trigger("unpublished",{playerId:n}),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(5),this.logger("publishAVClose fail",e.t0),new Error("publishAVClose fail ".concat(n));case 16:e.next=19;break;case 18:throw new Error("session is not joined");case 19:case"end":return e.stop()}},e,this,[[5,12]])})),function(e){return O.apply(this,arguments)})},{key:"attachVideo",value:function(e){return!(!this.isConnected()||!e.__avStream)&&(this.logger("attach video",e.id),this._session.changeMedia({video:!0}),!0)}},{key:"detachVideo",value:function(e){return!(!this.isConnected()||!e.__avStream)&&(this.logger("detach video",e.id),this._session.changeMedia({video:!1}),!1)}},{key:"muteVideo",value:function(e){this.isConnected()&&e.__avStream&&(this.logger("mute video",e.id),this._session.changeMedia({video:!1}))}},{key:"unmuteVideo",value:function(e){this.isConnected()&&e.__avStream&&(this.logger("unmute video",e.id),this._session.changeMedia({video:!0}))}},{key:"attachAudio",value:function(e){return!(!this.isConnected()||!e.__avStream)&&(this.logger("attach audio",e.id),this._session.changeMedia({audio:!0}),!0)}},{key:"detachAudio",value:function(e){return!(!this.isConnected()||!e.__avStream)&&(this.logger("detach audio",e.id),this._session.changeMedia({audio:!1}),!0)}},{key:"subMute",value:(C=(0,s.default)(r.default.mark(function e(t,n){return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isConnected()){e.next=10;break}return this.logger("session manager submute called",n),e.prev=2,e.next=5,this._session.mutePeer(t,n);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),this.logger("submute error",e.t0&&e.t0.message);case 10:case"end":return e.stop()}},e,this,[[2,7]])})),function(e,t){return C.apply(this,arguments)})},{key:"disconnect",value:(I=(0,s.default)(r.default.mark(function e(){return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status=3,!this._session){e.next=18;break}if(this.logger("session manager disconnect triggered"),0===(0,a.default)(this._publisherStore).length){e.next=16;break}return e.prev=4,e.next=7,this.publishAVClose({playerId:this._publisherStore.playerId});case 7:this._session.quit(),this._subscriberStore={},e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),this.logger(e.t0);case 14:e.next=18;break;case 16:this._session.quit(),this._subscriberStore={};case 18:case"end":return e.stop()}},e,this,[[4,11]])})),function(){return I.apply(this,arguments)})},{key:"_subscribe",value:(R=(0,s.default)(r.default.mark(function e(t){var n,i,a,o;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.player,i=t.playerId,a=this,o=function(){var e=(0,s.default)(r.default.mark(function e(){var t,s,u;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a._subscriberStore[i]&&1===a._subscriberStore[i].status&&a.subscribeStreamRetryCount<3)){e.next=14;break}return e.next=3,new h.Sleep(1);case 3:return a.subscribeStreamRetryCount++,e.prev=4,e.next=7,o();case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),e.t0;case 12:e.next=36;break;case 14:if(!a._subscriberStore[i]||1!==a._subscriberStore[i].status){e.next=19;break}throw a.logger("cancel subscribe for now because unscribing"),new Error("cancel subscribe for now because unscribing");case 19:return a._subscriberStore[i]={playerId:i,status:m},a.logger("".concat(a._playerId," subscribe ").concat(i)),e.prev=21,e.next=24,a._session.subscribe({userId:i,userNumber:n.user.number},{server:null});case 24:t=e.sent,s=t.server,a.logger("subscribed in",s),a._subscriberStore[i].status=S,s&&(u={name:s},n.serverInfo.downlinkServer=u,E.setActiveDownlinkServer(u)),a.trigger("addStream",{playerId:i,stream:t.stream}),e.next=36;break;case 32:throw e.prev=32,e.t1=e.catch(21),a.logger("subscribe",i,"error:",event),e.t1;case 36:case"end":return e.stop()}},e,null,[[4,9],[21,32]])}));return function(){return e.apply(this,arguments)}}(),e.prev=3,e.next=6,o();case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),e.t0;case 11:case"end":return e.stop()}},e,this,[[3,8]])})),function(e){return R.apply(this,arguments)})},{key:"subscribe",value:(T=(0,s.default)(r.default.mark(function e(t){var n,i;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.player,i=t.playerId,this.subscribeStreamRetryCount=0,e.prev=2,e.next=5,this._subscribe({player:n,playerId:i});case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(2),e.t0;case 10:case"end":return e.stop()}},e,this,[[2,7]])})),function(e){return T.apply(this,arguments)})},{key:"unsubscribe",value:(y=(0,s.default)(r.default.mark(function e(t){var n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.playerId,!this._subscriberStore[n]||![m,S].includes(this._subscriberStore[n].status)){e.next=17;break}return this.logger("unsubscribe called for",n),this._subscriberStore[n].status=1,e.prev=4,e.next=7,this._session.unsubscribe(n);case 7:this.trigger("cleanStream",{playerId:n}),this._subscriberStore[n].status=2,e.next=17;break;case 11:throw e.prev=11,e.t0=e.catch(4),this.logger(e.t0&&e.t0.msg),this.trigger("cleanStream",{playerId:n}),this._subscriberStore[n].status=2,e.t0;case 17:case"end":return e.stop()}},e,this,[[4,11]])})),function(e){return y.apply(this,arguments)})},{key:"switcArea",value:(p=(0,s.default)(r.default.mark(function e(t){return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._session||!this.isConnected()){e.next=5;break}return this.logger("switch area to "+t),e.abrupt("return",this._session.switchArea(t));case 5:throw new Error("no session");case 6:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"switchUplinkServer",value:(i=(0,s.default)(r.default.mark(function e(t){return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._session&&this.isConnected()&&this._publisherStore.playerId)){e.next=10;break}return this.logger("switch uplink server to "+t.name),e.prev=2,e.next=5,this._session.switchUpServer(t.name);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),this.logger(e.t0);case 10:case"end":return e.stop()}},e,this,[[2,7]])})),function(e){return i.apply(this,arguments)})},{key:"switchDownlinkServer",value:(n=(0,s.default)(r.default.mark(function e(t,n){return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._session||!this.isConnected()){e.next=12;break}if(!t.isWebRTCMixPull()){e.next=3;break}return e.abrupt("return");case 3:return this.logger("switch downlink server to "+n.name+": "+t.id),e.prev=4,e.next=7,this._session.switchDownServer({userId:t.id,userNumber:t.user.number},n.name);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),this.logger(e.t0);case 12:case"end":return e.stop()}},e,this,[[4,9]])})),function(e,t){return n.apply(this,arguments)})}]),t}(p.Emitter);t.SessionManager=y},function(e,t,n){"use strict";var i=n(0);n(66)(t,"__esModule",{value:!0}),t.StreamManager=void 0;var r=i(n(174)),a=i(n(175)),o=i(n(123)),s=i(n(155)),u=BJY.auth,c=BJY.store,l=BJY.data.media,d=function(){function e(){(0,o.default)(this,e),this.fps=15,this.audioContext=null;try{"audioContext"in RTCat?this.audioContext=RTCat.audioContext:this.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch(e){}}var t,n,i;return(0,s.default)(e,[{key:"getGainSupported",value:function(){return!!this.audioContext&&l.getCameraList().length}},{key:"constructV3Opts",value:function(e){var t={type:RTCat.StreamType.MediaDevice},n=e.size;switch(n||(n=c.get("isShuangshi")?{width:1280,height:720}:{width:320,height:180}),e.type){case"av":t.video={constraints:{deviceId:{exact:e.cameraId},width:n.width,height:n.height,frameRate:e.fps||this.fps}},t.audio={deviceId:e.microphoneId,enableAutoGainControl:!1,enableEchoCancellation:u.enableEchoCancellation()};break;case"video":t.audio={remove:!0},t.video={constraints:{deviceId:{exact:e.cameraId},width:n.width,height:n.height,frameRate:e.fps||this.fps}};break;case"audio":t.video={remove:!0},t.audio={deviceId:e.microphoneId,enableAutoGainControl:!1,enableEchoCancellation:u.enableEchoCancellation()}}return t}},{key:"createAVStream",value:(i=(0,a.default)(r.default.mark(function e(t){var n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.type&&"noDevice"!==t.type){e.next=2;break}return e.abrupt("return");case 2:return n=this.constructV3Opts(t),e.prev=3,e.next=6,RTCat.createStream(n);case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),e.t0;case 12:case"end":return e.stop()}},e,this,[[3,9]])})),function(e){return i.apply(this,arguments)})},{key:"createScreenStream",value:(n=(0,a.default)(r.default.mark(function e(){var t;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={type:RTCat.StreamType.Screen},e.prev=1,e.next=4,RTCat.createStream(t);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),e.t0;case 10:case"end":return e.stop()}},e,null,[[1,7]])})),function(){return n.apply(this,arguments)})},{key:"createHTMLMediaStream",value:(t=(0,a.default)(r.default.mark(function e(t){var n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.videoElement){e.next=3;break}throw new Error("videoElement required");case 3:return e.prev=3,e.next=6,RTCat.createStream({type:RTCat.StreamType.HtmlElement,external:{element:n}});case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),e.t0;case 12:case"end":return e.stop()}},e,null,[[3,9]])})),function(e){return t.apply(this,arguments)})},{key:"resumeAudioContext",value:function(){return this.audioContext.resume()}}]),e}();t.StreamManager=d},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e){var t=BJY.config,n=BJY.store,i=n.get("class.id"),r=n.get("class.webrtcType",t.WEBRTC_TYPE_BJY);if(r===t.WEBRTC_TYPE_BJY)switch(e){case t.PLAYER_TYPE.MAIN_CAMERA:return i;case t.PLAYER_TYPE.ASSIST_CAMERA:return i+"assist";case t.PLAYER_TYPE.MEDIA_FILE:return i+"file";case t.PLAYER_TYPE.MAIN_SCREEN_SHARE:return i+"screen";case t.PLAYER_TYPE.ASSIST_SCREEN_SHARE:return i+"screen2";default:return i}else if(r===t.WEBRTC_TYPE_AGORA)return i}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bjy-volume-slider" data-skin="{{skin}}" data-horizontal="{{orientation === \'horizontal\' ? 1 : 0}}"><div class="bjy-wrapper"><div class="bjy-track"><div class="bjy-bar"></div><div class="bjy-thumb"></div>{{#if volumeVisible}}<div class="bjy-volume-number bjy-tooltip {{orientation === \'vertical\' ? \'bjy-right\' : \'bjy-bottom\'}} bjy-light"><span>{{volume}}</span></div>{{/if}}</div></div>{{#if mainIcon}}<div class="bjy-icon-container" on-click="onIconClick()" lazy="500"><i class="{{mainIcon}}" data-icon="{{icon}}"></i></div>{{/if}}</div>'},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i;void 0===(i=function(e,t){return function(){return BJY.getLanguage({english:n(498),chineseLive:n(499),chineseClassroom:n(500)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.auth,a=BJY.store,o=(BJY.data.media,BJY.eventEmitter),s=n(501),u=n(3),c=n(502);return{template:n(503),propTypes:{user:{type:"object"},hasWatermark:{type:"boolean",value:!0},parent:{type:"object"}},data:function(){return{watermarkUrl:null,videoResolution:this.get("user").videoResolution}},filters:{compressWatermark:function(e){var t=this.get("watermarkStyle");return BJY.compressImage({url:this.get("watermarkUrl"),width:t.width*e,height:t.height*e})},formatWatermarkStyle:function(){var e=[],t=this.get("watermarkStyle");return t?(Yox.object.each(t,function(t,n){e.push(n+":"+t+("number"===$.type(t)?"px":""))}),e.join(";")):""}},computed:{isSelf:function(){return r.isSelfByNumber(this.get("user.number"))},isPresenter:function(){return r.isPresenter(this.get("user.id"))}},methods:{updateWatermark:function(){var e=this;if(e.$el&&e.get("watermarkUrl")){var t=$(e.get("parent").$el).find(".bjy-video-player"),n=e.get("videoResolution"),i=t.width(),r=t.height(),a=0,o=0,u=0,c=0,l=i,d=r;if(n){var _=n.width/n.height;(d=l/_)>r&&(l=(d=r)*_),l<i&&(c=o=(i-l)/2),d<r&&(a=u=(r-d)/2)}var f=Math.max(80,l/8),p=Math.max(40,d/8),h=e.get("watermarkWidth"),g=e.get("watermarkHeight"),E=h/g;h>f&&(h=f,g=f/E),g>p&&(g=p,h=p*E);var v={width:h,height:g};switch(e.get("watermarkPosition")){case s.WATERMARK_POSITION_LEFT_TOP:v.top=a+10,v.left=c+10;break;case s.WATERMARK_POSITION_RIGHT_TOP:v.top=a+10,v.right=c+10;break;case s.WATERMARK_POSITION_RIGHT_BOTTOM:v.bottom=Math.max(45,u),v.right=o+10;break;case s.WATERMARK_POSITION_LEFT_BOTTOM:v.bottom=Math.max(45,u),v.left=o+10;break;default:v.display="none"}e.set({watermarkUrl:e.get("watermarkUrl"),watermarkStyle:v})}}},afterMount:function(){var e=this;e.container=$(e.$el);var t=e.namespace=".defaultplayer-watermark"+Math.random(),n=a.get("partner.liveWatermark.url");!a.get("class.isMockLive")&&e.get("hasWatermark")||(n=null),n&&(c(n,function(t,i){e.$el&&(e.set({watermarkUrl:n,watermarkWidth:t,watermarkHeight:i,watermarkPosition:u(a.get("partner.liveWatermark.pos"))}),e.updateWatermark())}),o.on(o.VIDEO_RESOLUTION_CHANGE+t,function(t,n){n.userId===e.get("user.id")&&e.set("videoResolution",n)}).on(o.WINDOW_RESIZE+t,function(){e.updateWatermark()}))},beforeDestroy:function(){this.namespace&&o.off(this.namespace)}}}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,function(e,t,n){"use strict";var i,r=n(292),a=n(0),o=a(n(88)),s=a(n(8)),u=r(n(293));void 0===(i=function(e,t){var i=n(229),r=n(196),a=n(75),c=n(73),l=n(4),d=n(47),_=n(3),f=n(52),p=n(394);n(395);var h=n(7),g=n(230),E=n(69),v=n(400),m=n(170),S=n(26),A=n(302),y=n(232),T=n(11),R=n(303),I=n(424),C=n(425),O=n(306),b=n(426),L=n(305),D=n(430),N=n(5),P=n(432),k=n(137),w=n(300),U=n(168),M=n(95),x=n(433),V=n(434),G=n(435),B=n(132),H=n(294),Y=n(138),F=n(70),j=n(436),W=n(437),K=n(438),J=n(197),Q=n(440),z=n(234),q=n(198),X=n(442),Z=n(443),ee=n(214),te=n(444),ne=n(67),ie=n(251),re=n(338),ae=n(270),oe=n(445),se=n(446),ue=n(43),ce=n(121),le=n(240),de=n(447),_e=n(448),fe=n(158),pe=n(449),he=n(122),ge=n(53),Ee=n(304),ve=n(169),me=n(450),Se=n(148),Ae=a.parseQuery(location.search);function ye(){var e;e="orientation"in window?orientation%180!=0:W.getDeviceWidth()>W.getDeviceHeight(),h.set("landscape",e)}function Te(e){var t=e.partner;t?(t=ue(t),Yox.is.boolean(BJY.isLive)||(BJY.isLive=1===t.industryType),e.partner=t):e.partner={};var n=e.parentData;n&&(Ce(n.class),n.parentClass=Yox.object.copy(n.class),n.class=Yox.object.copy(e.class));var i=e.user;if(S.isNameMobileNumber()&&(i.name=de(i.name)),"0"==i.number){var r;if(e.randomUserNumber)r="9"+ie(9);else{(r=c.get("bjy_user_number"))||(r="9"+ie(9),c.set("bjy_user_number",r,{expires:24}))}i.number=r}Yox.is.boolean(e.exitOnConnectFail)||(e.exitOnConnectFail=!0);var a=e.user.endType,o=e.class.forbiddenEndTypes;o&&Yox.array.has(o,a,!1)?N.trigger(N.UNSUPPORTED_END_TYPE):h.set(e)}function Re(){return"9"+(""+Math.random()).substr(11)}function Ie(e){var t=e.env;return t="production"===t?"":t+"-",f(BJY.apiOrigin,location.protocol+"//"+t+"api.baijiayun.com")}function Ce(e){e.id=f(e.id),e.hasMoreUser=!0,e.startTime=p(e.startTime,0),e.endTime=p(e.endTime,0),e.mediaType=_(e.mediaType,T.MEDIA_TYPE_VIDEO),e.playBuffer=_(e.playBuffer,0),e.speakState=_(e.speakState,T.SPEAK_STATE_FREE),e.liveAudioCodec=_(e.liveAudioCodec,T.AUDIO_CODEC_AAC),e.recordSignal=_(e.recordSignal,0)}t.init=function(e){if(e.language=he(),e.privateDomainPrefix){var n=e.env;n=n&&"production"!==n?n+"-":"",BJY.apiOrigin=location.protocol+"//"+e.privateDomainPrefix+"."+n+"at.baijiayun.com"}var i=$.Deferred();U.add(U.PAGE_OPEN),e.env||(e.env="production"),ve.init(),e.playback||I.init(e.env);var r=e.user;r.type=_(r.type),r.group=_(r.group,T.NONE_GROUP_ID),r.status=_(r.status,T.USER_STATUS_ONLINE),r.number=f(r.number),r.actualName||(r.actualName=r.name),r.endType=le(),r.webrtcSupport=S.canSupportWebRTC()?1:0,e.class?Ce(e.class):e.class={},e.playback&&(e.class.hasMoreUser=!1),e.userState={},e.class&&e.class.webrtcType>0&&(e.webrtcMixUser={id:"webrtcMixUser",type:2,number:"webrtcMixUser000",name:"webrtcMixUser",videoOn:!1,audioOn:!1,avatar:"https://img.baijiayun.com/0bjcloud/live/avatar/v2/teacherv3.png"});var a=function(){i.resolve(),function(){var e;g.init(),E.init(),l.window.on("unload",function(){t.dispose("unload")}).on("resize",d(function(){N.trigger(N.WINDOW_RESIZE)},BJY.windowResizeInterval||200)).on("orientationchange",ye).on("offline",function(){!1===h.get("offline")&&N.trigger(N.ROOM_SERVER_OFFLINE,{type:T.ROOM_SERVER_OFFLINE_BY_BROWSER})}),ye(),"0"==h.get("user.number")&&("0"==Ae.user_number_cache?e=Re():(e=c.get("bjy_user_number"))||(e=Re(),c.set("bjy_user_number",e,{expires:24})),h.set("user.number",e));A.init(),F.init(),B.init(),k.init({defaultFitType:h.get("partner.livePptDisplayType",T.DOC_FIT_WIDTH)}),m.init(),R.init(),C.init(),O.init(),b.init(),L.init(),D.init(),v.init(),Z(),S.isAdmin()&&Ee.init(),BJY.userSpeak&&BJY.userSpeak.init();var n=ee(h.get("user.endType")),i=S.isWebRTC();n&&!i?N.one(N.CLIENT_INIT_SUCCESS,Y.init):Y.init()}(),function(){var e,n,i=0,r=!1,a=!1,o=0,u=!1,c=!1,l=0,d=0,f=!1,p=!1,g=0,E=0,v=function(){e&&(clearTimeout(e),e=null)},m=function(){N.trigger(N.MEDIA_SWITCH_TRIGGER,{videoOn:!1,audioOn:!1,actionType:T.MEDIA_PUBLISH_BY_OFFLINE}),N.trigger(N.ASSIST_MEDIA_SWITCH_TRIGGER,{videoOn:!1,audioOn:!1,actionType:T.MEDIA_PUBLISH_BY_OFFLINE})},A=function(e){r=!1,N.trigger(N.CLASSROOM_CONNECT_TIMEOUT),o++<T.CLASSROOM_TRY_ENTER_COUNT?setTimeout(function(){null,c||N.trigger(N.CLASSROOM_CONNECT_TRIGGER,{reconnect:l>0,isClassSwitching:h.get("isClassSwitching")})},T.SERVER_CONNECT_DELAY):N.trigger(N.CLASSROOM_CONNECT_FAIL,{description:"master server connect fail"})};h.watch("class.started",function(e){e&&h.set({"user.prevVideoOn":null,"user.prevAudioOn":null})}),N.trigger(N.BIND_BASE_EVENT_START),N.on(N.CLASSROOM_CONNECT_DEBUG,function(e){var t=K.socket||{},n=J.socket||{},i=Q.socket||{},_={url:location.href,msUrl:t.url,msStatus:t.status,rsUrl:n.url,rsStatus:n.status,csUrl:i.url,csStatus:i.status,msConnecting:r,msConnected:a,msTriedCount:o,rsConnecting:u,rsConnected:c,rsConnectedCount:l,rsTriedCount:d,csConnecting:f,csConnected:p,csConnectedCount:g,csTriedCount:E,serverInfo:K.serverInfo};alert((0,s.default)(_))}).on(N.SERVER_INFO_FETCH_SUCCESS,function(t){t.isPrevented||(r=!1,a=!0,z.init(),q.init(),S.isWebRTC()&&X.init(),l||N.trigger(N.LINK_TYPE_INIT),v(),u=!0,c=!1,J.init(),e=setTimeout(function(){K.close(),J.close(),Q.close(),u=!1,e=null,N.trigger(N.CLASSROOM_CONNECT_TIMEOUT),d++<T.CLASSROOM_TRY_ENTER_COUNT?e=setTimeout(function(){e=null,c||N.trigger(N.CLASSROOM_CONNECT_TRIGGER,{reconnect:l>0,isClassSwitching:h.get("isClassSwitching")})},T.SERVER_CONNECT_DELAY):N.trigger(N.CLASSROOM_CONNECT_FAIL,{description:"room server connect fail"})},T.CLASSROOM_CONNECT_TIMEOUT))}).one(N.UPLINK_LINK_TYPE_CHANGE,function(){var e=h.get("user"),t=h.get("class.uplinkType"),n=t===T.LINK_TYPE_UDP?q:z;if(e.linkType=t,e.publishServer=n.getActiveUplinkServer(),e.publishIndex=0,S.canUseDoubleCamera()){var i=h.get("user.id2");e.mediaExtMap=e.mediaExtMap||{};var r=e.mediaExtMap[i];r?r.publishIndex=0:e.mediaExtMap[i]={publishIndex:0}}M.add(e),N.on(N.SERVER_INFO_FETCH_SUCCESS,function(){M.add(h.get("user"))});var a=h.get("teacher");a&&M.add(a),N.on(N.UPLINK_LINK_TYPE_CHANGE,function(){h.get("user.linkType",h.get("class.uplinkType"))})}).on(N.ROOM_SERVER_LOGIN_SUCCESS,function(){var e=l>0;c=!0,u=!1,l++,v(),h.set("offline",!1),h.set("switchLogin",!1);var t=function(){H.init(),e||h.get("isClassSwitching")?N.trigger(N.CLASSROOM_CONNECT_SUCCESS,{reconnect:e,isClassSwitching:h.get("isClassSwitching")}):(N.trigger(N.VIEW_RENDER_TRIGGER),setTimeout(function(){N.trigger(N.CLASSROOM_CONNECT_SUCCESS,{}),N.trigger(N.WINDOW_RESIZE)},500),N.trigger(N.USER_COUNT_CHANGE,{userCount:h.get("userCount",0)}),N.trigger(N.TOTAL_USER_COUNT_CHANGE,{totalUserCount:h.get("totalUserCount",0)}))};h.get("embed")?t():N.one(N.USER_ACTIVE_RES,t).trigger(N.USER_ACTIVE_REQ),N.trigger(N.CHAT_SERVER_CONNECT_TRIGGER)}).on(N.ROOM_SERVER_OFFLINE,function(){h.get("embed")||h.get("offline")||h.get("loginConflict")||(h.set("offline",!0),J.close(),c=!1,setTimeout(function(){c||N.trigger(N.CLASSROOM_CONNECT_TRIGGER,{reconnect:l>0,offline:!0})},T.SERVER_CONNECT_DELAY))}).on(N.CLASSROOM_CONNECT_TRIGGER,function(e,t){if(!e.isPrevented&&!r){if(v(),t.offline||t.reconnect&&c){var n=h.get("user"),o=h.get("presenterId");h.set({"user.prevVideoOn":n.videoOn,"user.prevAudioOn":n.audioOn}),m(),$.each(M.all(),function(e,t){M.remove(t.id),t.id==o&&h.set({presenterId:null,presenter:null})}),h.set({"class.userCount":M.all().length,"class.hasMoreUser":!0}),K.close(),J.close(),Q.close()}if(r=!0,a=!1,U.init(),t.isClassSwitching){var s=h.get("parentData.token"),u=h.get("token");if(s){h.set("parentData.token",u),h.set("token",s),h.get("class.id")===h.get("parentData.class.id")?h.set("class",h.get("parentData.parentClass")):h.set("class",h.get("parentData.class"));var l=h.get("parentData.user.group",T.NONE_GROUP_ID);h.set("parentData.user.group",h.get("user.group")),h.set("user.group",l);var d=h.get("parentData.user.type");h.set("parentData.user.type",h.get("user.type")),h.set("user.type",d),h.set({"user.prevVideoOn":!1,"user.prevAudioOn":!1}),S.isWebRTC()?K.init():Yox.nextTick(function(){N.trigger(N.SERVER_INFO_FETCH_SUCCESS)})}}else K.init();0===i&&N.trigger(N.CLASSROOM_CONNECT_START,t),i++}}).on(N.SERVER_INFO_FETCH_FAIL,A).on(N.MASTER_SERVER_CONNECT_TIMEOUT,A).on(N.MASTER_SERVER_CONNECT_FAIL,A).on(N.ROOM_SERVER_LOGIN_OVERFLOW,v).on(N.ROOM_SERVER_LOGIN_KICKED_OUT,v).on(N.ROOM_SERVER_LOGIN_CONFLICT,v).on(N.CLASSROOM_CONNECT_START,function(){h.set({"user.videoOn":null,"user.audioOn":null,"user.assistVideoOn":null})}).on(N.CLASSROOM_CONNECT_SUCCESS,function(e,t){J.getCachedBroadcast({key:"forbid_all_change"}),J.getCachedBroadcast({key:"forbid_raise_hand_change"}),J.getCachedBroadcast({key:"forbid_mic_change"}),J.getCachedBroadcast({key:"enable_user_in_tips_change"}),J.send({message_type:"get_forbid_list"}),J.send({message_type:"message_send_forbid_all_req",group:h.get("user.group",0)}),h.get("partner.disableLiveGrantStudentBrush")||N.trigger(N.SWITCH_STUDENT_PAINT_TRIGGER),N.trigger(N.SWITCH_STUDENT_AUTH_TRIGGER),B.isNewGroupRoom()&&N.trigger(N.USER_MORE_REQ,{group:0}),N.trigger(N.USER_MORE_REQ),N.trigger(N.BLOCKED_USER_LIST_REQ),N.trigger(N.USER_STATE_REQ,{number:h.get("user.number")}),N.trigger(N.CLASSROOM_CONNECT_END,t),t&&t.isClassSwitching&&N.trigger(N.DOC_ALL_REQ),N.trigger(N.GROUP_INFO_REQ)}).on(N.CLASSROOM_CONNECT_FAIL,function(){N.trigger(N.CLASSROOM_CONNECT_END,{reconnect:l>0,isClassSwitching:h.get("isClassSwitching")}),h.get("exitOnConnectFail")&&t.dispose("connectFail")}).on(N.CLASSROOM_CONNECT_END,function(e,t){i=o=d=E=0,t&&t.isClassSwitching&&h.set("isClassSwitching",!1)}).on(N.CHAT_SERVER_CONNECT_TRIGGER,function(){f||h.get("noChat")||(n&&clearTimeout(n),g&&Q.close(),Q.init(),f=!0,p=!1,n=setTimeout(function(){Q.close(),f=!1,n=null,E++<T.CLASSROOM_TRY_ENTER_COUNT&&(n=setTimeout(function(){c&&!p&&N.trigger(N.CHAT_SERVER_CONNECT_TRIGGER)},T.SERVER_CONNECT_DELAY))},T.CHAT_SERVER_CONNECT_TIMEOUT))}).on(N.CHAT_SERVER_LOGIN_SUCCESS,function(){p=!0,f=!1,g++,E=0,n&&(clearTimeout(n),n=null)}).on(N.CHAT_SERVER_OFFLINE,function(){p=!1,setTimeout(function(){p||N.trigger(N.CHAT_SERVER_CONNECT_TRIGGER)},T.SERVER_CONNECT_DELAY)}).on(N.CLASSROOM_EXIT_TRIGGER,function(e,t){if(!e.isPrevented){N.trigger(N.CLASSROOM_EXIT_START,t);try{m(),J.logout(),K.close(),J.close(),Q.close(),a=c=p=!1}catch(e){}N.trigger(N.CLASSROOM_EXIT_END,t),h.get("keepEventOnExit")||N.off()}}).on(N.LOGIN_CONFLICT,function(e,n){t.dispose("loginConflict")}).on(N.MIXAUDIO_MUTE_PUBLISH_TRIGGER,function(e,t){J.publishMixAudio(t)}).on(N.VIDEO_RESOLUTION_CHANGE_TRIGGER,function(e,t){J.send({message_type:"video_resolution_change_trigger",width:t.width,height:t.height,definitions:t.definitions})}).on(N.VIRTUAL_USER_NUMBER_SET_TRIGGER,function(e,t){J.send({message_type:"set_virtual_user_number_trigger",number:t.value+"",group:h.get("user.group",0)})}).on(N.GET_VIRTUAL_USER_NUMBER_REQ,function(e,t){J.send({message_type:"get_virtual_user_number_req",group:h.get("user.group",0)})}).on(N.MESSAGE_SEND_FORBID_ALL_CHANGE_TRIGGER,function(e,t){L.send("forbid_all_change",{forbidAll:t.value},{cache:!0})}).on(N.SPEAK_APPLY_FORBID_ALL_CHANGE_TRIGGER,function(e,t){L.send("forbid_raise_hand_change",{forbid:t.value},{cache:!0})}).on(N.ENABLE_USER_IN_TIPS_CHANGE_TRIGGER,function(e,t){L.send("enable_user_in_tips_change",{enableUserInTips:t.value},{cache:!0})}).on(N.MIC_FORBID_ALL_CHANGE_TRIGGER,function(e,t){var n=t.value;if(L.send("forbid_mic_change",{forbid:n},{cache:!0}),n)for(var i=M.group().studentList,r=i.length;r--;){var a=i[r];a.audioOn&&N.trigger(N.MEDIA_REMOTE_CONTROL_TRIGGER,{user:a,videoOn:!!a.videoOn,audioOn:!1})}}).on(N.WINDOW_RESIZE,ye).on(N.TRACE_LOG,function(e,t){J.trace(t)}).on(N.USER_ACTIVE_REQ,function(e,t){J.send({message_type:"user_active_req"})}).on(N.USER_ACTIVE_RES,function(e,t){var n=t.userList;n.length>0&&($.each(n,function(e,t){t.mediaExt?(t.mediaExtMap={},$.each(t.mediaExt,function(e,n){t.mediaExtMap[n.id]=n})):t.mediaExtMap={}}),M.add(n,!0),$.each(n,function(e,t){var n=t.type;S.isTeacher(n)&&h.set("class.hasTeacher",!0),S.isAssistant(n)&&h.set("class.hasAssistant",!0);var i={user:t,linkType:t.linkType};t.videoOn&&(i.videoOn=!0),t.audioOn&&(i.audioOn=!0),1==t.supportMuteStream&&(i.supportMuteStream=!0),1==t.supportBlackStream&&(i.supportBlackStream=!0),N.trigger(N.MEDIA_PUBLISH,i),t.mediaExt&&$.each(t.mediaExt,function(e,n){(t=$.extend(!0,{},t)).videoOn=n.videoOn,t.audioOn=!!n.audioOn,(t.videoOn||t.audioOn)&&N.trigger(N.ASSIST_MEDIA_PUBLISH,{user:t,linkType:t.linkType,videoOn:n.videoOn,audioOn:n.audioOn,mediaId:n.id,isScreenSharing:n.isScreenSharing})})}))}).on(N.USER_ACTIVE_ADD_TRIGGER,function(e,t){var n=t.user;n.status!==T.USER_STATUS_HIDDEN&&J.send({message_type:"user_active_add_trigger",user:n})}).on(N.USER_ACTIVE_REMOVE_TRIGGER,function(e,t){J.send({message_type:"user_active_remove_trigger",user:t.user})}).on(N.USER_IN,function(e,t){var n=t.user;M.add(n);var i=n.type;S.isTeacher(i)&&h.set("class.hasTeacher",!0),S.isAssistant(i)&&h.set("class.hasAssistant",!0)}).on(N.USER_OUT,function(e,t){var n=t.user;M.remove(n.id);var i=n.type;S.isTeacher(i)&&h.set("class.hasTeacher",!1),M.hasAssistant()||h.set("class.hasAssistant",!1)}).on(N.USER_MORE_REQ,function(e,t){if(h.get("class.hasMoreUser")||null!=t.group){var n={message_type:"user_more_req",count:t&&t.count||T.MORE_USER_COUNT};null!=t.group&&(n.group=t.group),J.send(n)}}).on(N.USER_MORE_RES,function(e,t){B.isNewGroupRoom()&&null!=t.group&&M.updateGroupInfo(t.group,{hasMore:t.hasMore}),null==t.group&&h.set("class.hasMoreUser",t.hasMore);var n=t.userList;n.length>0&&M.add(n)}).on(N.USER_COUNT_CHANGE,function(e,t){if(h.set({"class.totalUserCount":t.accumulativeUserCount,"class.userCount":t.userCount}),N.trigger(N.TOTAL_USER_COUNT_CHANGE,{totalUserCount:t.accumulativeUserCount}),t.groupCount){var n=0;Yox.object.each(t.groupCount,function(e,t){M.getGroupInfoById(t)&&(M.updateGroupInfo(t,{count:e}),n+=e)}),h.set("class.allGroupUserCount",n)}}).on(N.BLOCKED_USER_LIST_REQ,function(e,t){J.send({message_type:"blocked_user_list_req"})}).on(N.BLOCKED_USER_LIST_RES,function(e,t){var n=t.blockedUserList;n.length>0&&V.add(n)}).on(N.USER_UNBLOCK_TRIGGER,function(e,t){J.send({message_type:"blocked_user_free_trigger",user_number:t.number})}).on(N.USER_UNBLOCK,function(e,t){V.remove(t.number)}).on(N.ALL_USERS_UNBLOCK_TRIGGER,function(){J.send({message_type:"blocked_user_free_all_trigger"})}).on(N.ALL_USERS_UNBLOCK,function(){V.removeAll()}).on(N.USER_BLOCKED,function(e,t){var n=t.blockedUser;V.add(n)}).on(N.USER_UPDATE_TRIGGER,function(e,t){J.send({message_type:"user_update_trigger",user_number:h.get("user.number"),user:{camera_cover:t.cameraCover}})}).on(N.USER_UPDATE_RES,function(e,t){var n=$.extend({},M.findByNumber(t.userNumber),t.user);M.update(n)}).on(N.MESSAGE_SEND,function(e,t){if(S.canSendMessage()||t.to&&t.to!==T.MESSAGE_TO_ALL){var n=t.content;if($.inArray(n,T.MESSAGE_DEBUG)<0){var i,r=h.get("user"),a=t.channel,o="message_send";t.to&&t.to!==T.MESSAGE_TO_ALL&&(o="message_whisper_send",i=M.find(t.to));var s={message_type:o,content:n,channel:a,to:t.to||T.MESSAGE_TO_ALL,from:{id:r.id,number:r.number,type:r.type,name:r.name,avatar:r.avatar,status:r.status,end_type:r.endType,group:r.group,webrtc_support:r.webrtcSupport}};t.data&&(s.data=t.data),i&&(s.to_num=i.number,s.to_user={id:i.id,number:i.number,type:i.type,name:i.name,avatar:i.avatar,status:i.status,end_type:i.endType,webrtc_support:r.webrtcSupport}),Q.send(s),$.isFunction(t.callback)&&N.one(N.MESSAGE_RECEIVE,function(e,t){t.from.id==r.id&&t.content===n&&t.channel===a&&t.callback()})}}}).on(N.MESSAGE_PULL_REQ,function(e,t){Q.send({message_type:"message_pull_req",channel:t.channel,next:_(t.next,-1),count:t.count||10})}).on(N.DOC_ALL_REQ,function(e,t){J.send({message_type:"doc_all_req"})}).on(N.DOC_ALL_RES,function(e,t){h.get("playback")||k.clear();var n=t.docList;Yox.array.each(n,function(e,t){"board"===e.name&&k.clear()}),k.add(t.docList)}).on(N.DOC_ADD_TRIGGER,function(e,t){var n=t.doc;J.send({message_type:"doc_add_trigger",doc:{id:n.id,ext:n.ext,name:n.name,number:n.number,ppt_url:n.pptUrl,page_list:n.pageList,page_info:n.pageInfo,remark_info:n.remarkInfo,extra:{visible:0}}})}).on(N.DOC_ADD,function(e,t){k.add(t.doc)}).on(N.DOC_UPDATE_TRIGGER,function(e,t){var n={};$.each(t.extra,function(e,t){"scale"===e&&(t+=""),n[e.replace(/([A-Z])/g,"_$1").toLowerCase()]=t}),J.send({message_type:"doc_update_trigger",doc_id:t.docId,extra:n})}).on(N.DOC_UPDATE,function(e,t){k.update(t.docId,t.extra)}).on(N.START_PROCESSING_CLOUD_RECORD,function(e,t){J.startCloudRecord()}).on(N.DOC_REMOVE_TRIGGER,function(e,t){J.send({message_type:"doc_del_trigger",doc_id:t.docId})}).on(N.DOC_REMOVE,function(e,t){t.fromId===h.get("user.id")&&N.trigger(N.PAGE_CHANGE_TRIGGER,{docId:"0",page:0,toServer:Ee.getUserDocumentUploadAuth()})}).on(N.PAGE_ADD_TRIGGER,function(e,t){J.send({message_type:"page_add_trigger",doc_id:t.docId})}).on(N.PAGE_DELETE_TRIGGER,function(e,t){J.send({message_type:"page_del_trigger",doc_id:t.docId,page_id:t.pageId})}).on(N.SHAPE_ALL_REQ,function(e,t){J.send({message_type:"shape_all_req",doc_id:t.docId,page:k.getServerPage(t.docId,t.page),layer:t.layer})}).on(N.SHAPE_APPEND_TRIGGER,function(e,t){var n=h.get("user"),i=t.shape;i.points=_e(i),i.userName=n.name,i.userNumber=n.number,i.userId=n.id,J.send({message_type:"shape_append_trigger",doc_id:t.docId,page:k.getServerPage(t.docId,t.page),layer:t.layer,shape:i})}).on(N.SHAPE_APPEND,function(e,t){H.append(t.docId,t.page,t.shape)}).on(N.SHAPE_ADD_TRIGGER,function(e,t){var n=t.shape;n.points=_e(n),J.send({message_type:"shape_add_trigger",doc_id:t.docId,page:k.getServerPage(t.docId,t.page),layer:t.layer,shape:n})}).on(N.SHAPE_ADD,function(e,t){H.add(t.docId,t.page,t.shape)}).on(N.SHAPE_REMOVE_TRIGGER,function(e,t){J.send({message_type:"shape_del_trigger",doc_id:t.docId,page:k.getServerPage(t.docId,t.page),layer:t.layer,shape_id:t.shapeId?t.shapeId:""})}).on(N.SHAPE_REMOVE,function(e,t){var n=t.docId,i=t.page,r=t.shapeId;""===r?H.clear(n,i):$.each(r.split(","),function(e,t){t&&H.remove(n,i,t)})}).on(N.SHAPE_UPDATE_TRIGGER,function(e,t){var n=t.shapeList;$.each(n,function(e,t){t.points=_e(t)}),J.send({message_type:"shape_update_trigger",doc_id:t.docId,page:k.getServerPage(t.docId,t.page),layer:t.layer,shape_list:n})}).on(N.SHAPE_UPDATE,function(e,t){H.update(t.docId,t.page,t.shapeList)}).on(N.PAGE_CHANGE_TRIGGER,function(e,t){if(S.canPage()){var n=t.docId,i=t.page,r=t.step||0;if(S.canServerPage()||t.toServer){var a={message_type:"page_change_trigger",doc_id:n,page:i,step:r};k.isWhiteboardDoc(n)&&(a.page=0,a.page_id=k.getIdByPage(n,i)),t.event&&(a.event=t.event),J.send(a)}else N.trigger(N.CLIENT_PAGE_CHANGE,{docId:n,page:i,step:r})}}).on(N.CLASS_START_TRIGGER,function(){if(Ee.getUserClassStartEndAuth()){var e={message_type:"class_start_trigger",camera_ratio:Y.getCameraRatio(),camera_quality:Y.getCameraQuality(),large_class_definition:h.get("partner.largeClassDefinition")};S.parentSwitchClass()&&(e.route="master"),J.send(e),J.sendBroadcast({key:"classroom_real_start_time",value:{start_time:h.get("class.diffNTP")+$.now()},options:{cache:!0,all:!0}})}}).on(N.CLASS_START,function(){h.set("class.started",!0)}).on(N.CLASS_END_TRIGGER,function(e,t){if(Ee.getUserClassStartEndAuth()){var n={message_type:"class_end_trigger",kick_out_all:t&&t.kickOutAll,close_room:t&&t.closeRoom};S.parentSwitchClass()&&(n.route="master"),J.send(n)}}).on(N.CLASS_END,function(){h.set("class.started",!1),V.removeAll()}).on(N.TEACHER_ADD,function(){h.set("teacher.in",!0)}).on(N.TEACHER_REMOVE,function(){h.get("playback")||h.set({"teacher.in":!1,"teacher.videoOn":!1,"teacher.audioOn":!1})}).on(N.SPEAK_APPLY_REQ_TRIGGER,function(){var e=h.get("user");J.send({message_type:"speak_apply_req",from:{id:e.id,number:e.number,type:e.type,name:e.name,avatar:e.avatar,status:e.status,group:e.group||0,end_type:e.endType}})}).on(N.SPEAK_APPLY_RES_TRIGGER,function(e,t){var n=t.user;J.send({message_type:"speak_apply_res",speak_state:t.speakState,user:{id:n.id,number:n.number,type:n.type,name:n.name,avatar:n.avatar,status:n.status,group:n.group||0,end_type:n.endType}})}).on(N.MEDIA_PUBLISH_TRIGGER,function(e,t){J.publishMedia(t)}).on(N.PRESENTER_CHANGE_TRIGGER,function(e,t){S.canChangePresenter()&&J.send({message_type:"presenter_change_trigger",presenter_id:t.presenterId})}).on(N.ASSIST_MEDIA_PUBLISH_TRIGGER,function(e,t){J.publishAssistMedia(t)}).on(N.MEDIA_REPUBLISH_TRIGGER,function(e,t){J.republishMedia(t)}).on(N.ASSIST_MEDIA_REPUBLISH_TRIGGER,function(e,t){J.republishAssistMedia(t)}).on(N.MEDIA_REMOTE_CONTROL_TRIGGER,function(e,t){var n=t.user;J.send({message_type:"media_remote_control_trigger",video_on:t.videoOn,audio_on:t.audioOn,speak_state:t.speakState,user:{id:n.id,number:n.number,type:n.type,name:n.name,avatar:n.avatar,status:n.status,group:n.group||0,end_type:n.endType}})}).on(N.USER_SEARCH_REQ,function(e,t){J.send({message_type:"user_search_req",field:t.field,query:t.query})}).on(N.NOTICE_REQ,function(e,t){J.send({message_type:"notice_req",group:h.get("user.group",0)})}).on(N.NOTICE_CHANGE_TRIGGER,function(e,t){Ee.getUserNoticeAuth()&&J.send({message_type:"notice_change_trigger",content:t.content,link:t.link,group:t.group,ext_class:t.extClass})}).on(N.STICKY_NOTICE_REQ,function(e,t){J.send({message_type:"notice_req",is_sticky:!0})}).on(N.STICKY_NOTICE_CHANGE_TRIGGER,function(e,t){Ee.getUserNoticeAuth()&&J.send({message_type:"notice_change_trigger",content:t.content,link:t.link,is_sticky:!0})}).on(N.USER_STATE_REQ,function(e,t){J.send({message_type:"user_state_req",user_number:t.number})}).on(N.USER_STATE_RES,function(e,t){var n=h.get("user"),i=t.userState,r=!1;n.number===t.userNumber&&(r=!0,h.set("userState",$.extend({},h.get("userState"),i)));var a=i.forbidSendMessage;a&&a.duration>0&&N.trigger(N.MESSAGE_SEND_FORBID,{from:M.findByNumber(a.from.number),to:M.findByNumber(t.userNumber),forbidSelf:r,duration:a.duration})}).on(N.MESSAGE_SEND_FORBID_TRIGGER,function(e,t){if(Ee.getUserForbidAndKickAuth()){var n=h.get("user"),i=M.findByNumber(t.to.number);i||(i=t.to),J.send({message_type:"message_send_forbid_trigger",from:{id:n.id,number:n.number,type:n.type,name:n.name,avatar:n.avatar,group:n.group,status:n.status,end_type:n.endType},to:{id:i.id,number:i.number,type:i.type,name:i.name,avatar:i.avatar,group:i.group,status:i.status,end_type:i.endType},duration:t.duration})}}).on(N.MESSAGE_SEND_FORBID,function(e,t){var n=t.from,i=t.to,r=t.duration;M.add([n,i]),r>0?x.add(i):x.remove(i.number),i&&S.isSelfByNumber(i.number)&&(h.get("userState").forbidSendMessage={from:n,duration:r})}).on(N.FORBID_USER_ALL_LIST_RES,function(e,t){x.add(t.userList)}).on(N.MESSAGE_SEND_FORBID_ALL_TRIGGER,function(e,t){if(Ee.getUserForbidAndKickAuth()){var n=h.get("user");J.send({message_type:"message_send_forbid_all_trigger",from:{id:n.id,number:n.number,type:n.type,name:n.name,avatar:n.avatar,group:n.group,end_type:n.endType},group:n.group,duration:t.duration})}}).on(N.MESSAGE_SEND_FORBID_ALL,function(e,t){var n=t.from,i=t.duration,r=t.group;null==r&&(r=n.group||0),0===r?B.setForbidSuperGroup(i):r===h.get("user.group")&&B.setForbidSelfGroup(i)}).on(N.MESSAGE_SEND_FORBID_ALL_RES,function(e,t){var n=t.duration||-1,i=t.superDuration||-1;B.setForbidSuperGroup(i),B.setForbidSelfGroup(n)}).on(N.MY_GIFT_REQ,function(e,t){J.send({message_type:"my_gift_req"})}).on(N.GIFT_SEND,function(e,t){var n=h.get("user"),i=t.to,r=t.gift;J.send({message_type:"gift_send",from:{id:n.id,number:n.number,type:n.type,name:n.name,avatar:n.avatar,status:n.status,end_type:n.endType},to:{id:i.id,number:i.number,type:i.type,name:i.name,avatar:i.avatar,status:i.status,end_type:i.endType},gift:{type:r.type,amount:r.amount}})}).on(N.CALL_CUSTOM_SERVICE_TRIGGER,function(e,t){J.send({message_type:"call_service_req",number:t.number,user_number:t.userNumber})}).on(N.SURVEY_PREV_REQ,function(e,t){var n=h.get("user");J.send({message_type:"survey_prev_req",number:n.number})}).on(N.SURVEY_QUESTION_SEND,function(e,t){var n=Yox.object.copy(t,!0);$.each(n.optionList,function(e,t){t.is_answer=t.isAnswer,delete t.isAnswer}),J.send({message_type:"survey_send",survey_list:{order:n.order,question:n.question,answer_count:n.answerCount,option_list:n.optionList}})}).on(N.SURVEY_QUESTION_DELETE,function(e,t){J.send({message_type:"survey_del_req",order:t.order})}).on(N.SURVEY_QUESTION_MODIFY,function(e,t){var n=Yox.object.copy(t,!0);$.each(n.optionList,function(e,t){t.is_answer=t.isAnswer,delete t.isAnswer}),J.send({message_type:"survey_modify_req",survey_list:{order:n.order,question:n.question,option_list:n.optionList}})}).on(N.SURVEY_QUESTION_END,function(e,t){J.send({message_type:"survey_close_req"})}).on(N.SURVEY_QUESTION_CLEAR,function(){J.send({message_type:"survey_clear_req"})}).on(N.SURVEY_ANSWER_SEND,function(e,t){var n=h.get("user");J.send({message_type:"survey_answer_send",survey_list:{order:t.order,answer:t.answer,result:t.result,username:n.name,number:n.number}})}).on(N.LOTTERY_SEND,function(e,t){J.send({message_type:"lottery_send",lottery_number:t.lotteryNumber,lottery_name:t.lotteryName})}).on(N.LOTTERY_DRAW_REQ,function(){J.send({message_type:"lottery_draw_req"})}).on(N.LOTTERY_RESULT_REQ,function(){J.send({message_type:"lottery_result_req"})}).on(N.LOTTERY_COMPLETE_REQ,function(){J.send({message_type:"lottery_complete_req"})}).on(N.STUDENT_LIST_REQ,function(e,t){var n={message_type:"student_list_req"};t.all&&(n.all=!0),J.send(n)}).on(N.BLOCK_TASK_CREATE,function(e,t){J.send({message_type:"block_task_create",room_no:B.getClassId(),student:t.studentNumber})}).on(N.ROLL_CALL_TRIGGER,function(e,t){J.send({message_type:"roll_call_trigger",duration:_(t.duration)})}).on(N.ROLL_CALL_RES,function(){J.send({message_type:"roll_call_res"})}).on(N.ROLL_CALL_FINISH,function(){J.send({message_type:"roll_call_finish",group_id:h.get("user.group",0)})}).on(N.SPEAK_INVITE_REQ_TRIGGER,function(e,t){J.send({message_type:"speak_invite_req",to:t.to,invite:t.invite})}).on(N.SPEAK_INVITE_RES_TRIGGER,function(e,t){t.force||J.send({message_type:"speak_invite_res",confirm:t.confirm})}).on(N.CLASS_SWITCH_TRIGGER,function(e,t){var n={message_type:"class_switch_trigger"};t.isParentClass&&(n.target_class_id=h.get("subRoomId"),n.group_id=h.get("user.group")),J.send(n)}).on(N.CLASS_SWITCH,function(e,t){if(!t||!t.targetClassId||t.targetClassId===h.get("subRoomId")){var n=function(){var e=h.get("parentData.enterUrl")||h.get("subRoomData.enterUrl");return e&&(window.location.href=e),!1};if(S.isStudent())if(h.get("classSwitchType")===T.CLASS_SWITCH_TYPE_RELOAD)n();else{if(!h.get("parentData"))return;l=0,h.set("isClassSwitching",!0),setTimeout(function(){N.trigger(N.CLASSROOM_CONNECT_TRIGGER,{reconnect:!0,isClassSwitching:!0})},1e3*Math.floor(2*Math.random()+2))}else n()}}).on(N.SWITCH_STUDENT_PAINT_TRIGGER,function(e,t){var n={message_type:"student_paint_switch_trigger"};t&&t.studentPaintAuth?(n.cache=!0,n.student_paint_auth=t.studentPaintAuth):n.cache=!1,J.send(n)}).on(N.SWITCH_STUDENT_AUTH_TRIGGER,function(e,t){var n={message_type:"student_auth_switch_trigger"},i={ppt:t.studentDocumentControlAuth||h.get("class.studentDocumentControlAuth")||[],screen_share:t.studentScreenShareAuth||h.get("class.studentScreenShareAuth")||[],assist_camera:t.studentAssistCameraAuth||h.get("class.studentAssistCameraAuth")||[]};t.studentDocumentControlAuth||t.studentScreenShareAuth||t.studentAssistCameraAuth?(n.cache=!0,n.student_auth=i):n.cache=!1,J.send(n)}).on(N.SWITCH_STUDENT_PAINT,function(e,t){var n=S.canStudentPaintByNumber();if(h.set("class.studentPaintAuth",t.studentPaintAuth||[]),S.isStudent()){var i=S.canStudentPaintByNumber();n!==i&&N.trigger(N.PAINT_AUTH_CHANGE,{canPaint:i,fromTeacher:!0,cache:t.cache})}}).on(N.SWITCH_STUDENT_AUTH,function(e,t){var n=S.canStudentDocumentControlByNumber(),i=S.canStudentScreenShareByNumber(),r=S.canStudentAssistCameraByNumber();if(h.set("class.studentDocumentControlAuth",t.studentAuth.ppt||[]),h.set("class.studentScreenShareAuth",t.studentAuth.screen_share||[]),h.set("class.studentAssistCameraAuth",t.studentAuth.assist_camera||[]),S.isStudent()){var a=S.canStudentDocumentControlByNumber(),o=S.canStudentScreenShareByNumber(),s=S.canStudentAssistCameraByNumber();n!==a&&N.trigger(N.PAGE_AUTH_CHANGE,{canPage:a,fromTeacher:!0,cache:t.cache}),i!==o&&N.trigger(N.SCREEN_SHARE_AUTH_CHANGE,{canScreenShare:o,fromTeacher:!0,cache:t.cache}),r!==s&&N.trigger(N.ASSIST_CAMERA_AUTH_CHANGE,{canUseAssistCamera:s,fromTeacher:!0,cache:t.cache})}}).on(N.MESSAGE_TRANSLATE_SEND,function(e,t){Q.send({message_type:"message_translate_send",content:t.content,from:t.from||"zh",to:t.to||"en",class_id:h.get("class.id"),user_id:h.get("user.id")})}).on(N.MESSAGE_REVOKE_REQ,function(e,t){Q.send({message_type:"message_revoke_req",id:t.id,from_uid:t.fromId,class_id:h.get("class.id"),user_id:h.get("user.id")})}).on(N.PLAY_MEDIA_BROADCAST_TRIGGER,function(e,t){L.send("play_media",{playing:t.playing,id:t.id},{all:!0,cache:!0})}).on(N.EXTRA_STREAM_TERMINATE_BROADCAST_TRIGGER,function(e,t){L.send("terminate_extra_stream",{type:t.type},{all:!0})}).on(N.USER_FUZZY_QUERY_REQ,function(e,t){J.send({message_type:"user_fuzzy_query_req",sname:t.search})}).on(N.START_ENROLL_TRIGGER,function(e,t){L.send("start_enroll",{all:!0,enrollId:t.enrollId,subject:t.subject})}).on(N.GROUP_INFO_REQ,function(e,t){J.send({message_type:"group_info_req"})}).on(N.GROUP_INFO,function(e,t){M.addGroupInfo(t.groups)}).on(N.GROUP_INFO_UPDATE_TRIGGER,function(e,t){J.send({message_type:"group_info_update_trigger",groups:ce(t.groups)||[]})}).on(N.GROUP_INFO_UPDATE,function(e,t){t.groups&&t.groups.forEach(function(e){var t=e.id;if(e.cacheGroup){var n={};null!=e.name&&(n.name=e.name),null!=e.color&&(n.color=e.color),M.updateGroupInfo(t,n)}else M.removeGroupInfo(t)})}).on(N.GROUP_MEMBER_UPDATE_TRIGGER,function(e,t){J.send({message_type:"group_member_update_trigger",groups:ce(t.groups)||[]})}).on(N.GROUP_MEMBER_UPDATE,function(e,t){t.groups&&t.groups.forEach(function(e){e.membersAdded&&e.membersAdded.forEach(function(t){var n=Yox.object.copy(M.findByNumber(t.userNumber));n&&(n.group=e.id,M.update(n,"hack_mobile"))})})}).on(N.PARENT_ROOM_QUIZ_REQ,function(e,t){J.send({message_type:"parent_room_quiz_req"})}),h.get("playback")||N.on(N.USER_ADD,function(){h.increase("class.userCount")}).on(N.USER_REMOVE,function(){h.decrease("class.userCount",1,1)});var y=function(e,t){N.trigger(N.MAX_PAGE_CHANGE,{page:e,step:t})};if(S.isAdmin()){var R=function(){y(k.getTotalPages()-1)};N.on(N.DOC_ADD,R).on(N.DOC_REMOVE,R).on(N.DOC_ALL_RES,R).on(N.PAGE_ADD,R).on(N.PAGE_DELETE,R)}else N.on(N.SERVER_PAGE_CHANGE,function(e,t){y(k.getSimplePage(t.docId,t.page).page,t.step)});var I=S.canPaint(),C=S.canPage();N.on(N.MEDIA_PUBLISH,function(e,t){if(S.isSelf(t.user.id)&&(I!==S.canPaint()&&(I=!I,N.trigger(N.PAINT_AUTH_CHANGE,{canPaint:I})),C!==S.canPage()&&(C=!C,N.trigger(N.PAGE_AUTH_CHANGE,{canPage:C}),!C&&(G.getClientPage()!==G.getServerPage()||G.getClientStep()!==G.getServerStep())))){var n=k.getComplexPage(G.getServerPage());N.trigger(N.CLIENT_PAGE_CHANGE,{docId:n.docId,page:n.page,step:G.getServerStep()})}})}(),"debug"===Ae.log&&Yox.object.each(N,function(e){N.on(e,function(e,t){console.group("event dispatch: "+e.type),console.log(t),console.groupEnd()})}),e.playback||N.trigger(N.CLASSROOM_CONNECT_TRIGGER,{reconnect:!1})};if(e.sign){var u=0;!function t(){(function(e){var t=e.user;return $.ajax({url:Ie(e)+"/web/room/enterinfo",data:{room_id:e.class.id,user_number:t.number,user_name:t.name,user_avatar:t.avatar,user_role:t.type,sign:e.sign,render:"jsonp"},dataType:"jsonp"})})(e).then(function(t){var n=t.data,i=function(){if(n){if(e.partner=n.partner_config,e.class){var t=n.class_data;t&&(e.class.liveAudioCodec=t.live_audio_codec,e.class.forbiddenEndTypes=t.forbidden_end_types,e.class.isGroupLive=t.is_group_live,e.class.newGroupLive=t.new_group_live)}var i=n.parent_room_enter_info;if(i){var r={};r.user=i.user_data,r.class=i.class_data,r.token=r.user.token,r.class.id=r.class.room_id;var o={};o.avatar=r.user.user_avatar,o.number=r.user.user_number,o.name=r.user.user_number,o.type=r.user.user_role,o.group=r.user.group_id,r.user=o,e.parentId=r.class.room_id,r=ue(r);var s=_(r.class.type);r.class.type=s;var u=_(r.user.type);S.isTeacher(u)||S.isAssistant(u)?r.class.speakState=T.SPEAK_STATE_FREE:r.class.speakState=T.SPEAK_STATE_LIMIT,e.parentData=r}n.token&&(e.token=n.token),Te(e),N.trigger(N.INTERFACE_FETCH_SUCCESS),a()}};if(n){if(1!=n.is_encrypt)return void i();if("function"===!(0,o.default)(window.cefQuery))return void alert("不支持的终端类型");if(!window.bjyAppVersion||window.bjyAppVersion<"6.8.4")return void alert("请先升级客户端");BJY.cef.decodeData({encodedData:n.encrypt_data,key:n.room_id}).then(function(e){n=e,i()})}t.msg&&(I.setLogTypeDataServerFail(e),N.has(N.INTERFACE_FETCH_FAIL)?N.trigger(N.INTERFACE_FETCH_FAIL,{msg:t.msg}):alert(t.msg))},function(n){u<3?(u++,t()):(I.setLogTypeDataServerFail(e),N.has(N.INTERFACE_FETCH_FAIL)?N.trigger(N.INTERFACE_FETCH_FAIL,{msg:n.msg}):alert(n.msg))})}()}else e.partner||e.playback||"test"===e.env?Yox.nextTick(function(){Te(e),a()}):alert("缺少 partner 信息，请务必传入 sign");return i},t.dispose=function(e){N.trigger(N.CLASSROOM_EXIT_TRIGGER,{type:e})},t.os=i,t.browser=r,t.api=v,t.log=m,t.auth=S,t.store=h,t.config=T,t.parser=A,t.logger=y,t.support=g,t.storage=E,t.command=R,t.broadcast=L,t.eventEmitter=N,t.printScreen=P,t.createSWF=te,t.getLanguage=ne,t.compressImage=re,t.adjustProtocol=ae,t.removeProtocol=oe,t.isAlicloudImage=se,t.camelCaseObject=ue,t.underScoreCaseObject=ce,t.getExtension=fe,t.getDevicesAuth=pe,t.getAjaxUrl=ge,t.diskLog=ve,t.blockLog=I,t.states=u,t.data={doc:k,h5Doc:w,mark:U,user:M,forbidUser:x,blockedUser:V,page:G,class:B,shape:H,media:Y,server:F,emotion:j,browser:W,adminAuth:Ee},t.server={master:K,room:J,chat:Q,live:z,liveUdp:q,webrtc:X},t.query=Ae,t.is=Se,t.PopupPlayerInstances={},t.fullscreen=D,t.version="0.71.0",t.loggerManager=me,t.components={},window.BJY=t}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){e.exports=n(392)},function(e,t,n){n(393);var i=n(1).Object;e.exports=function(e,t){return i.getOwnPropertyDescriptor(e,t)}},function(e,t,n){var i=n(22),r=n(135).f;n(159)("getOwnPropertyDescriptor",function(){return function(e,t){return r(i(e),t)}})},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(3),a=/(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})/;return function(e,t){var n=r(e);if("number"!==$.type(n)&&"string"===$.type(e)){var i=e.match(a);if(i){var o=new Date(i[1],i[2]-1,i[3]);o.setHours(i[4]),o.setMinutes(i[5]),o.setSeconds(i[6]),n=o.getTime()}}return"number"===$.type(n)?n:t}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(396),a=n(19);r.dom.specialEvents.outside={on:function(e,t){r.dom.on(document,"click",t.onOutside=function(n){a(e,n.originalEvent.target)||(n.type="outside",t(n))})},off:function(e,t){t.onOutside&&(r.dom.off(document,"click",t.onOutside),t.onOutside=null)}},r.directive("modelhtml",function(e){var t=e.el,n=e.node.value,i=e.instance,a=function(e,r){i.set(n,t.innerHTML)},o=function(e){if(t.innerHTML=e,window.getSelection&&!1!==t.getAttribute("contenteditable")&&null!=t.getAttribute("contenteditable")){t.focus();var n=window.getSelection();n.selectAllChildren(t),n.collapseToEnd()}};return r.dom.on(t,"input",a),i.watch(n,o),function(){r.dom.off(t,"input",a),i.unwatch(n,o)}})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){(function(t){e.exports=function(){"use strict";Object.keys||(Object.keys=function(e){var t=[];for(var n in e)Te(t,n);return t}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s*|\s*$/g,"")}),Array.prototype.map||(Array.isArray=function(e){return U(e,"array")},Array.prototype.indexOf=function(e){var t=-1;return ve(this,function(n,i){if(n===e)return t=i,r}),t},Array.prototype.map=function(e){var t=[];return ve(this,function(n,i){t.push(e(n,i))}),t},Array.prototype.filter=function(e){var t=[];return ve(this,function(n,i){e(n,i)&&t.push(n)}),t});var e=function(e,t){e.prototype=et({},t.prototype,e.prototype)},n=function(e,t){return e},i=!0,r=!1,a=null,o=void 0,s="true",u="key",c="ref",l="tag",d="slot",_="this",f="type",p="text",h="expr",g="name",E="value",v="index",m="length",S="children",A="function",y="template",T="component",R="keypath",I="staticKeypath",C="absoluteKeypath",O=".",b="..",L=_,D="undefined"!=typeof window?window:a,N="undefined"!=typeof document?document:a;function P(){}var k=function(e){return e!==o},w=Object.prototype.toString;function U(e,t){return"numeric"===t?Y(e):w.call(e).toLowerCase()==="[object "+t+"]"}function M(e){return e&&typeof e===A}function x(e){return e&&Array.isArray(e)}function V(e){return e&&"object"==typeof e}function G(e){return"string"==typeof e}function B(e){return"number"==typeof e}function H(e){return"boolean"==typeof e}function Y(e){return B(e)||G(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function F(e){return G(e)||B(e)||H(e)||e==a}var j={is:U,func:M,array:x,object:V,string:G,number:B,boolean:H,numeric:Y,primitive:F},W=function(e,t,n){if(M(e))return x(n)?e.apply(t,n):e.call(t,n)},K=function(){function e(e){e[f]?(this[f]=e[f],this.originalEvent=e):this[f]=e}return e.prototype.prevent=function(){if(!this.isPrevented){var e=this.originalEvent;e&&(M(e.prevent)?e.prevent():M(e.preventDefault)&&e.preventDefault()),this.isPrevented=i}return this},e.prototype.stop=function(){if(!this.isStoped){var e=this.originalEvent;e&&(M(e.stop)?e.stop():M(e.stopPropagation)&&e.stopPropagation()),this.isStoped=i}return this},e}();function $(e,t){return e.charAt(t||0)}function J(e,t){return e.charCodeAt(t||0)}K.is=function(e){return e instanceof K};var Q="",z=".",q=J(z),X=(J("#"),"-"),Z=(J(X),J("="),"/"),ee=J(Z),te=",",ne=J(te),ie=":",re=J(ie),ae=(J(";"),J("'")),oe=J('"'),se=J("("),ue=J(")"),ce=J("["),le=J("]"),de=J("{"),_e=J("}"),fe=(J("<"),J(">"),J("?")),pe=J("\t"),he="\n",ge=(J(he)," "),Ee=J(ge);function ve(e,t,n){var i=e[m];if(i)if(n)for(var a=i-1;a>=0&&t(e[a],a)!==r;a--);else for(var o=0;o<i&&t(e[o],o)!==r;o++);}function me(e,t){return e.join(t)}function Se(e,t){e[e[m]]=t}function Ae(e,t){e.unshift(t)}function ye(e,t,n){x(t)?ve(t,function(t){n(e,t)}):n(e,t)}function Te(e,t){ye(e,t,Se)}function Re(e,t){ye(e,t,Ae)}function Ie(e){return x(e)?e:W([].slice,e)}function Ce(e,t,n){var i={},r=3===arguments[m];return ve(e,function(e,a){i[t?e[t]:e]=r?n:e}),i}function Oe(e,t,n){if(n!==r)return e.indexOf(t);for(var i=0,a=e[m];i<a;i++)if(e[i]==t)return i;return-1}function be(e,t,n){return Oe(e,t,n)>=0}function Le(e){return e[e[m]-1]}function De(e){return e.pop()}function Ne(e,t,n){var a=0;return ve(e,function(i,o){(n===r?i==t:i===t)&&(e.splice(o,1),a++)},i),a}function Pe(e){return!x(e)||0===e[m]}var ke={each:ve,join:me,push:Te,unshift:Re,toArray:Ie,toObject:Ce,indexOf:Oe,has:be,last:Le,pop:De,remove:Ne,falsy:Pe};function we(e){return Ge(e,X)?e.replace(/-([a-z])/gi,function(e,t){return t.toUpperCase()}):e}function Ue(e){return Ye(e)?Q:e.trim()}function Me(e,t,n){return B(n)?e.slice(t,n):e.slice(t)}function xe(e,t,n){return B(n)?e.indexOf(t,n):e.indexOf(t)}function Ve(e,t,n){return B(n)?e.lastIndexOf(t,n):e.lastIndexOf(t)}function Ge(e,t){return xe(e,t)>=0}function Be(e,t){return 0===xe(e,t)}function He(e,t){var n=e[m]-t[m];return n>=0&&Ve(e,t)===n}function Ye(e){return!G(e)||e===Q}var Fe={camelCase:we,trim:Ue,slice:Me,indexOf:xe,lastIndexOf:Ve,has:Ge,startsWith:Be,endsWith:He,falsy:Ye};function je(e,t){return e===t?t[m]:Be(e,t+=O)?t[m]:r}function We(e,t){if(Ye(e))t(e,i);else for(var n=0,r=0;i;){if(!((r=xe(e,O,n))>0)){t(Me(e,n),i);break}t(Me(e,n,r)),n=r+1}}function Ke(e,t){var n,i=B(e)||G(e)?e:Q;if((n=B(t))||G(t)){if(i===Q)return t;if(n||t!==Q)return i+O+t}return i}function $e(e){return Object.keys(e)}function Je(e,t){return e[m]-t[m]}function Qe(e,t){return t[m]-e[m]}function ze(e,t){return $e(e).sort(t?Qe:Je)}function qe(e,t){ve($e(e),function(n){return t(e[n],n)})}function Xe(e,t){return e.hasOwnProperty(t)}function Ze(e){qe(e,function(t,n){delete e[n]})}function et(e,t,n,i){return ve([t,n,i],function(t){V(t)&&qe(t,function(t,n){e[n]=t})}),e}function tt(e,t){var n=e;return x(e)?t?(n=[],ve(e,function(e,i){n[i]=tt(e,t)})):n=e.slice():V(e)&&(n={},qe(e,function(e,i){n[i]=t?tt(e,t):e})),n}function nt(e,t){if(e!=a&&Xe(e,t)){var n=e[t];return V(n)&&n.get&&(n=n.get()),{value:n}}}function it(e,t){return Xe(e,t)?nt(e,t):(We(t,function(t,n){if(e=nt(e,t),!n){if(!e)return r;e=e[E]}}),e)}function rt(e,t,n,i){We(t,function(t,a){if(a)e[t]=n;else if(e[t])e=e[t];else{if(i===r)return r;e=e[t]={}}})}var at={keys:$e,sort:ze,each:qe,has:Xe,clear:Ze,extend:et,copy:tt,get:it,set:rt},ot="space",st="namespace",ut="listeners",ct=function(){function e(e){this[st]=e,this[ut]={}}return e.prototype.fire=function(e,t,n){var a=this,o=a[st],s=a[ut],u=dt(e,o),c=u[g],l=u[ot],d=s[c],_=i;if(d){var f=x(t)?t[0]:t,p=K.is(f);ve(tt(d),function(e){if(!(!be(d,e)||l&&e[ot]&&l!==e[ot])){p&&(f.listener=e.func);var i=W(e.func,k(n)?n:e.context,t);return e.count=e.count>0?e.count+1:1,e.count===e.max&&a.off(c,e),p&&(i===r?f.prevent().stop():f.isStoped&&(i=r)),i===r?_=r:void 0}})}return _},e.prototype.has=function(e,t){var n=this[st],a=this[ut],o=dt(e,n),s=o[g],u=o[ot],c=i,l=function(e){return ve(e,function(e,n){if(!(u&&u!==e[ot]||t&&t!==e.func))return c=r}),c};if(s){var d=a[s];d&&l(d)}else u&&qe(a,l);return!c},e}();function lt(e){return function(t,n){var i=this[st],r=this[ut],a=function(t,n){if(M(t)&&(t={func:t}),V(t)&&M(t.func)){e&&et(t,e);var a=dt(n,i),o=a[g];t[ot]=a[ot],Te(r[o]||(r[o]=[]),t)}};V(t)?qe(t,a):G(t)&&a(n,t)}}function dt(e,t){var n={};if(n[g]=e,n[ot]=Q,t){var i=xe(e,z);i>=0&&(n[g]=Me(e,0,i),n[ot]=Me(e,i+1))}return n}et(ct.prototype,{on:lt(),once:lt({max:1}),off:function(e,t){var n=this[ut];if(e){var r=dt(e,this[st]),a=r[g],o=r[ot],s=function(e,r){if(V(t)){var a=Oe(e,t);a>=0&&e.splice(a,1)}else ve(e,function(n,i){o&&o!==n[ot]||t&&t!==n.func||e.splice(i,1)},i);e[m]||delete n[r]};a?n[a]&&s(n[a],a):o&&qe(n,s)}else this[ut]={}}});var _t=function(e,t){return e!=a&&e.toString?e.toString():1===arguments[m]?Q:t},ft="undefined"!=typeof console?console:a,pt=/yox/.test(_t(P));function ht(){if(D){var e=D.DEBUG;if(H(e))return e}return pt}function gt(e){ft&&ht()&&ft.warn("[Yox warn]: "+e)}function Et(e){ft&&ft.error("[Yox error]: "+e)}function vt(e){throw new Error("[Yox fatal]: "+e)}var mt={log:function(e){ft&&ht()&&ft.log("[Yox log]: "+e)},warn:gt,error:Et,fatal:vt},St=typeof t===A?t:typeof MessageChannel===A?function(e){var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(1)}:setTimeout,At=[];function yt(e,t){At[m]||St(It),ke[e](At,t)}function Tt(e){yt("push",e)}function Rt(e){yt("unshift",e)}function It(){var e=At;At=[],ve(e,function(e){e()})}function Ct(e,t){var n=e.props;if(!e[T]&&n){var i=this,r=t&&t.props;qe(n,function(t,n){r&&t===r[n]||i.setProp(e.el,n,t)})}}function Ot(e,t,n){var i=e.directives,r=e.instance,a=i[t],o={el:e.el,node:a,instance:r,directives:i,attrs:e.attrs||{}};e[T]&&(o[T]=n[T](e.data.id));var s=r.directive(a[g]),u=s&&s(o);if(M(u))return u}function bt(e,t){var n=e.directives,i=t&&t.directives;if(n||i){n=n||{},i=i||{};var r,a=this,o=e.data,s=o.unbinds;qe(n,function(t,n){var o;if(Xe(i,n)){var u=i[n];t[E]===u[E]&&t[R]===u[R]||(s&&s[n]&&(s[n](),delete s[n]),o=Ot(e,n,a))}else o=Ot(e,n,a);o&&((r||(r={}))[n]=o)}),qe(i,function(e,t){!Xe(n,t)&&s&&s[t]&&(s[t](),delete s[t])}),r&&(s?et(s,r):o.unbinds=r)}}var Lt="#if",Dt="else",Nt="else if",Pt="#each",kt="#partial",wt=">",Ut="...",Mt=/^!\s/,xt="$keypath",Vt="$slot_",Gt="o-",Bt="on-",Ht="model",Yt="event",Ft="binding",jt="beforeCreate",Wt="afterCreate";function Kt(e,t,n){t&&((e.$refs||(e.$refs={}))[t]=n,e.$flags[t]=i)}function $t(e,t){t&&!e.$flags[t]&&delete e.$refs[t]}var Jt="!",Qt="create",zt="update",qt="postpatch",Xt="destroy",Zt=[{create:function(e){var t=e.el;e[T]&&(t=this[T](e.data.id)),Kt(e.instance,e[c],t)},postpatch:function(e,t){var n=e.el,i=e.attrs,r=e.model,a=e.instance,o=e[c];if(e[T]){if(n=this[T](e.data.id),i){var s=n.$model;r&&s&&!Xe(i,s)&&(i[s]=a.get(r)),n.set(n.checkPropTypes(i))}n.set(e.slots)}t&&t[c]!==o&&($t(a,t[c]),Kt(a,o,n))},destroy:function(e){$t(e.instance,e[c])}},{create:function(e){var t=e.el,n=e.attrs,i=this;!e[T]&&n&&qe(n,function(e,n){i.setAttr(t,n,e)})},update:function(e,t){var n=e.el,i=e.attrs,r=t.attrs,a=this;e[T]||!i&&!r||(r=r||{},qe(i=i||{},function(e,t){Xe(r,t)&&e===r[t]||a.setAttr(n,t,e)}),qe(r,function(e,t){Xe(i,t)||a.removeAttr(n,t)}))}},{create:Ct,update:function(e,t){var n=e.props,i=t.props,r=this;!e[T]&&i&&qe(i,function(t,i){n&&Xe(n,i)||r.setProp(e.el,i,Q)})},postpatch:Ct},{create:bt,update:bt,destroy:function(e){var t=e.data.unbinds;t&&qe(t,function(e,n){e(),delete t[n]})}}],en=new ct;function tn(e,t){return e[u]===t[u]&&e[l]===t[l]}function nn(e,t,n){for(var i,r={};t<=n;)i=e[t][u],k(i)&&(r[i]=t),t++;return r}function rn(e){return{tag:Jt,text:_t(e)}}function an(e){return{text:_t(e)}}function on(e,t,n,i,r,a,s,u,c,l,d){return{tag:e,attrs:t,props:n,directives:i,children:r,slots:a,model:s,ref:u,key:c,instance:l,text:o,hooks:d}}function sn(e){return e&&Xe(e,p)}function un(e){return sn(e)&&!Xe(e,l)}ve([Qt,zt,qt,Xt],function(e){ve(Zt,function(t){en.on(e,t[e])})}),Zt=a;var cn=0;function ln(e){var t=function(t,i){var r=t,a=r.el,o=r.tag,s=r.component,u=r.children,c=r.text,_=r.instance,f=++cn;return t.data={id:f},Ye(o)?t.el=e.createText(c):o===Jt?t.el=e.createComment(c):(a=t.el=e.createElement(s?"i":o),s?(e[T](f,t),_[T](o,function(n){n||vt('"'+o+'" '+T+" is not found."),(t=e[T](f))&&o===t[l]&&(s=(t.parent||_).create(n,t,a),(a=s.$el)||vt('"'+o+'" '+T+" must have a root element."),t.el=a,e[T](f,s),d(t),en.fire(Qt,t,e))})):(x(u)?n(a,u,0,u[m]-1):G(c)&&e.append(a,e.createText(c)),en.fire(Qt,t,e)),a)},n=function(e,n,i,r,a){for(var o;i<=r;)o=n[i],t(o)&&c(e,o,a),i++},r=function(e,t,n,i){for(var r;n<=i;)(r=t[n])&&o(e,r),n++},o=function(t,n){var i=n.el;n[l]?_(n,function(){s(n)||e.remove(t,i)}):i&&e.remove(t,i)},s=function(t){t.el;var n=t[S],r=t[T];if(r){var o=t.data.id;if(r=e[T](o),t.parent!==t.instance)return;if(r.set)return en.fire(Xt,t,e),e[T](o,a),r.destroy(),i;e[T](o,a)}else n&&ve(n,function(e){s(e)});en.fire(Xt,t,e)},c=function(t,n,i){var r=n.el,o=e.parent(r);e.before(t,r,i?i.el:a),o||d(n)},d=function(e){var t=e.el,n=e.hooks,i=e.data,r=e.instance;n&&(i.leaving&&i.leaving(),W(n.enter,r,[t,P]))},_=function(e,t){var n=e.el,i=e.hooks,r=e.data,o=e.instance;i?(r.leaving=function(){t&&(t(),t=a)},W(i.leave,o,[n,r.leaving])):t()},f=function(i,s){if(i!==s){var l=i.el,d=i[T];if(s.el=l,s.data=i.data,tn(i,s)){if(d){var _=s.data.id;if(!(d=e[T](_)).set)return void e[T](_,s)}var h=[s,i];en.fire(zt,h,e);var g=s[p],E=s[S],v=i[p],A=i[S];G(g)?g!==v&&e[p](l,g):E&&A?E!==A&&function(i,o,s){for(var l,d,_,p=0,h=o[m]-1,g=o[p],E=o[h],v=0,S=s[m]-1,A=s[v],y=s[S];p<=h&&v<=S;)g?E?tn(g,A)?(f(g,A),g=o[++p],A=s[++v]):tn(E,y)?(f(E,y),E=o[--h],y=s[--S]):tn(g,y)?(f(g,y),e.before(i,g.el,e.next(E.el)),g=o[++p],y=s[--S]):tn(E,A)?(f(E,A),e.before(i,E.el,g.el),E=o[--h],A=s[++v]):(l||(l=nn(o,p,h)),B(d=l[A[u]])?(_=o[d],f(_,A),o[d]=a):t(A)&&(_=A),_&&c(i,_,g),A=s[++v]):E=o[--h]:g=o[++p];p>h?n(i,s,v,S,s[S+1]):v>S&&r(i,o,p,h)}(l,A,E):E?(G(v)&&e[p](l,Q),n(l,E,0,E[m]-1)):A?r(l,A,0,A[m]-1):G(v)&&e[p](l,Q),en.fire(qt,h,e)}else{var y=e.parent(l);t(s)&&y&&(c(y,s,i),o(y,i))}}};return function(t,n){return f(e.isElement(t)?{el:t,tag:e[l](t),data:{}}:t,n),n}}var dn={createCommentVnode:rn,createTextVnode:an,createElementVnode:on,createComponentVnode:function(e,t,n,r,a,o,s,u,c,l,d){var _=on(e,t,n,r,a,o,s,u,c,l,d);return _[T]=i,_},isVnode:sn,isTextVnode:un,init:ln},_n={};_n["+"]=_n["-"]=_n["!"]=_n["~"]=_n["!!"]=i;var fn=ze(_n,i),pn={};pn["=>"]=pn["->"]=1,pn["||"]=2,pn["&&"]=3,pn["=="]=pn["!="]=pn["==="]=pn["!=="]=4,pn["<"]=pn["<="]=pn[">"]=pn[">="]=5,pn["+"]=pn["-"]=6,pn["*"]=pn["/"]=pn["%"]=7;var hn=ze(pn,i),gn=1,En=2,vn=3,mn=4,Sn=5,An=6,yn=7,Tn=8,Rn=9,In={"+":function(e){return+e},"-":function(e){return-e},"!":function(e){return!e},"~":function(e){return~e},"!!":function(e){return!!e}},Cn={"||":function(e,t){return e||t},"&&":function(e,t){return e&&t},"===":function(e,t){return e===t},"!==":function(e,t){return e!==t},"==":function(e,t){return e==t},"!=":function(e,t){return e!=t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"=>":function(e,t){return e>t?function(n){for(var i=e,r=0;i>=t;i--)n(i,r++)}:function(n){for(var i=e,r=0;i<=t;i++)n(i,r++)}},"->":function(e,t){return e>t?function(n){for(var i=e,r=0;i>t;i--)n(i,r++)}:function(n){for(var i=e,r=0;i<t;i++)n(i,r++)}}},On=function(e,t){this[f]=e,this.raw=Ue(t)},bn=function(t){function i(e,i){var r=n(this,t.call(this,yn,e));return r.elements=i,r}return e(i,t),i}(On),Ln=function(t){function i(e,i,r){var a=n(this,t.call(this,Tn,e));return a.keys=i,a.values=r,a}return e(i,t),i}(On),Dn=function(t){function i(e,i,r,a){var o=n(this,t.call(this,Sn,e));return o.left=i,o.operator=r,o.right=a,o}return e(i,t),i}(On),Nn=function(t){function i(e,i,r){var a=n(this,t.call(this,Rn,e));return a.callee=i,a.args=r,a}return e(i,t),i}(On),Pn=function(t){function i(e,i,r,a){var o=n(this,t.call(this,An,e));return o.test=i,o.yes=r,o.no=a,o}return e(i,t),i}(On),kn={};kn[L]="$this",kn[b]="$parent";var wn=function(t){function i(e,i){var a=n(this,t.call(this,En,e));return Xe(kn,i)&&(i=kn[i],a.lookup=r),a[g]=a[I]=i,a}return e(i,t),i}(On),Un=function(t){function i(e,i){var r=n(this,t.call(this,gn,e));return r[E]=i,r}return e(i,t),i}(On),Mn=function(t){function i(e,i,a){var o=n(this,t.call(this,vn,e)),s=[];Te(s,i[f]===vn?i.props:i),Te(s,a);var u=s[0].raw;u!==L&&u!==b||(o.lookup=r),o.props=s;var c=i[I];return k(c)&&a[f]===gn&&(o[I]=c?c+O+a[E]:a[E]),o}return e(i,t),i}(On),xn=function(t){function i(e,i,r){var a=n(this,t.call(this,mn,e));return a.operator=i,a.arg=r,a}return e(i,t),i}(On),Vn={};Vn[s]=i,Vn.false=r,Vn.null=a,Vn[void 0]=o;var Gn={};function Bn(e){return e>=48&&e<=57}function Hn(e){return 36===e||95===e||e>=97&&e<=122||e>=65&&e<=90}function Yn(e){return Hn(e)||Bn(e)}function Fn(e){if(Gn[e])return Gn[e];var t,n=e[m],o=0,s=function(){vt("Failed to compile expression: "+he+e)},u=function(){return J(e,o)},c=function(t,n){return e.substring(t,n==a?o:n)},l=function(){for(;(t=u())&&(t===Ee||t===pe);)o++},d=function(){do{o++}while(Bn(u()))},_=function(){o++,Bn(u())?d():s()},p=function(e){var t,n=o;if(function(){do{o++}while(Yn(u()))}(),t=c(n))return e&&Xe(Vn,t)?new Un(t,Vn[t]):new wn(t,t);s()},h=function(e){var i=[];for(o++;o<n;){if((t=u())===e)return o++,i;t===ne?o++:Te(i,I())}s()},v=function(t){l();var n,i=Me(e,o);if(ve(t,function(e){if(Be(i,e))return n=e,r}),n)return o+=n[m],n},S=function(e,r){var a,s=o,l=p(i);for(r&&(l=new Mn(c(e),r,new Un(l.raw,l[g])));o<n;){if((t=u())===se)return a=h(ue),new Nn(c(s),l,a);if(t===q)o++,a=p(),l=new Mn(c(s),l,new Un(a.raw,a[g]));else{if(t!==ce)break;a=I(le),l=new Mn(c(s),l,a)}}return l},A=function(e){u()===q?_():(d(),u()===q&&_());var t=c(e);return new Un(t,parseFloat(t))},y=function(e,n){var i;if(o++,(t=u())===ee?(o++,i=new wn(L,L)):t===q&&(o++,u()===ee&&(o++,i=new wn(b,b))),i){if(n&&(i=new Mn(c(e),n,new Un(i.raw,i[g]))),(t=u())===q)return y(e,i);if(Hn(t))return S(e,i)}s()},T=function(){l(),t=u();var i,r=o;if(t===ae||t===oe)return function(){var t=u();for(o++;o<n;)if(J(e,++o-1)===t)return;s()}(),i=Me(c(r),1,-1),new Un(i,i);if(Bn(t))return A(r);if(t===q)return Bn(J(e,o+1))?A(r):y(r);if(t===ce)return i=h(le),new bn(c(r),i);if(t===de)return i=function(){var e=[],i=[],r=e;for(o++;o<n;){if((t=u())===_e)return o++,e[m]!==i[m]&&s(),{keys:e.map(function(e){return e[f]===En?e[g]:e[f]===gn?e[E]:void s()}),values:i};t===re?(r=i,o++):t===ne?(r=e,o++):Te(r,I())}s()}(),new Ln(c(r),i.keys,i.values);if(t===se)return I(ue);if(Hn(t))return S();var a=v(fn);if(a)return i=T(),new xn(c(r),a,i);s()},R=function(){for(var e,t,n=[o,T(),o];e=v(hn);)(t=n[m])>7&&pn[e]<n[t-4]&&n.splice(t-7,6,new Dn(c(n[t-8],n[t-1]),n[t-7],n[t-5],n[t-2])),Te(n,e),Te(n,pn[e]),Te(n,o),Te(n,T()),Te(n,o);for(;i;)if((t=n[m])>8&&n[t-4]>n[t-9])n.splice(t-7,6,new Dn(c(n[t-8],n[t-1]),n[t-7],n[t-5],n[t-2]));else{if(!(t>7))return n[1];n.splice(1,6,new Dn(c(n[0],n[7]),n[1],n[3],n[6]))}},I=function(e){e&&o++;var t=o,n=R();if(l(),u()===fe){o++;var i=R();if(l(),u()===re){o++;var r=R();return l(),new Pn(c(t),n,i,r)}s()}return e&&(u()===e?o++:s()),n};return Gn[e]=I()}var jn={};function Wn(e,t,n){return jn[e[f]](e,t,n)}jn[gn]=function(e){return e[E]},jn[En]=function(e,t){return t(e[g],e)},jn[vn]=function(e,t,n){var i=e[I];return i||(i=Q,ve(e.props,function(e,r){var a=e[f],o=Q;a!==gn?r>0?o=Wn(e,t,n):a===En&&(o=e[g]):o=e[E],i=Ke(i,o)})),t(i,e)},jn[mn]=function(e,t,n){return In[e.operator](Wn(e.arg,t,n))},jn[Sn]=function(e,t,n){return Cn[e.operator](Wn(e.left,t,n),Wn(e.right,t,n))},jn[An]=function(e,t,n){return Wn(e.test,t,n)?Wn(e.yes,t,n):Wn(e.no,t,n)},jn[yn]=function(e,t,n){return e.elements.map(function(e){return Wn(e,t,n)})},jn[Tn]=function(e,t,n){var i={};return ve(e.keys,function(r,a){i[r]=Wn(e.values[a],t,n)}),i},jn[Rn]=function(e,t,n){var i=e.args;return i&&(i=i.map(function(e){return Wn(e,t,n)})),W(Wn(e.callee,t,n),n,i)};var Kn=function(e){return JSON.stringify(e)},$n=1,Jn=2,Qn=3,zn=4,qn=5,Xn=6,Zn=7,ei=8,ti=9,ni=10,ii=11,ri=12,ai={},oi={},si={},ui={},ci={},li={},di={};function _i(e){if(e){var t=$e(e);if(t[m]){var n=[];if(ve(t,function(t){var i=e[t];G(i)?i=Kn(i):x(i)?t===S?(i=fi(i,"x"))&&(i=gi(i)):i=fi(i):V(i)&&(i=_i(i)),i!=a&&Te(n,t+":"+i)}),n[m])return"{"+me(n,te)+"}"}}}function fi(e,t){if(e&&e[m]){var n=e.map(function(e){return e.stringify?e.stringify():G(e)?Kn(e):V(e)?_i(e):e});return t?hi(t,n):"["+me(n,te)+"]"}}function pi(e){if(e)return hi("o",Kn(e))}function hi(e,t){return e+"("+(x(t)?me(t,te):t)+")"}function gi(e){return A+"(){"+(e||Q)+"}"}ai[qn]=ai[Xn]=oi[Xn]=oi[Zn]=si[$n]=si[Jn]=si[zn]=ui[Qn]=ui[ni]=ui[ri]=ui[ii]=ci.lazy=ci[Ht]=i,li.if=qn,li.each=ei,li.partial=ti,qe(li,function(e,t){di[e]=t});var Ei=function(){function e(e){this[f]=e}return e.prototype.stringify=function(){return _i(this)},e}(),vi=function(t){function i(e){var i=n(this,t.call(this,Jn));return i[g]=e,i}return e(i,t),i}(Ei),mi=function(t){function i(e,i){var r=n(this,t.call(this,zn));return r[g]=e,i&&(r.modifier=i),r}return e(i,t),i}(Ei),Si=function(t){function i(e,i){var r=n(this,t.call(this,ei));return r[h]=e,i&&(r[v]=i),r}return e(i,t),i.prototype.stringify=function(){var e=fi(this[S],"x");if(e){var t=[Kn(this[h]),gi(e)];return this[v]&&Te(t,Kn(this[v])),gi(hi("e",t))}},i}(Ei),Ai=function(t){function i(e,i){var r=n(this,t.call(this,$n));return r[l]=e,i&&(r[T]=i),r}return e(i,t),i.prototype.stringify=function(){var e=this,t=e.tag,n=e.divider,i=e.component,r=e.props,a=e.slot,o=e.name,s=e.key,u=e.ref,c=e.transition,l=[],_=[],f=[];e[S]&&ve(e[S],function(e,t){Te(t<n?_:f,e)});var p=function(e,t){e=fi(e,t||"x"),Re(l,e?gi(e):"undefined")};if(t===y){if(a&&f[m])return p(f),p(a),hi("a",l)}else{if(t!==d)return s&&p(s),(c||l[m])&&p(c),(u||l[m])&&p(u),(r&&r[m]||l[m])&&p(r,"z"),(_[m]||l[m])&&p(_,"y"),(f[m]||l[m])&&p(f),Re(l,Kn(t)),Re(l,i?1:0),hi("c",l);if(o)return p(o),hi("b",l)}},i}(Ei),yi=function(t){function i(){return n(this,t.call(this,Zn))}return e(i,t),i}(Ei),Ti=function(t){function i(e,i){var r=n(this,t.call(this,Xn));return r[h]=e,r}return e(i,t),i}(Ei),Ri=function(t){function i(e,i){var r=n(this,t.call(this,ii));return r[h]=e,r.safe=i,r}return e(i,t),i.prototype.stringify=function(){return pi(this[h])},i}(Ei),Ii=function(t){function i(e){var i=n(this,t.call(this,qn));return i[h]=e,i}return e(i,t),i.prototype.stringify=function(){var e=this.stump,t=function(n){var i=pi(n[h]),r=fi(n[S],"x"),a=n.next;if(a?a=t(a):e&&(a="x(m())"),i){if(r)return a?i+"?"+r+":"+a:i+"&&"+r;if(a)return"!"+i+"&&"+a}else if(r)return r},n=t(this);if(n)return gi(n)},i}(Ei),Ci=function(t){function i(e){var i=n(this,t.call(this,ni));return i[g]=e,i}return e(i,t),i.prototype.stringify=function(){return hi("i",Kn(this[g]))},i}(Ei),Oi=function(t){function i(e){var i=n(this,t.call(this,ti));return i[g]=e,i}return e(i,t),i.prototype.stringify=function(){return hi("p",[Kn(this[g]),gi(fi(this[S],"x"))])},i}(Ei),bi=function(t){function i(e){var i=n(this,t.call(this,ri));return i[h]=e,i}return e(i,t),i.prototype.stringify=function(){return hi("s",Kn(this[h]))},i}(Ei),Li=function(t){function i(e){var i=n(this,t.call(this,Qn));return i[p]=e,i}return e(i,t),i.prototype.stringify=function(){return Kn(this[p])},i}(Ei),Di=/(\{?\{\{)\s*([^\}]+?)\s*(\}\}\}?)/,Ni=/<(\/)?([a-z][-a-z0-9]*)/i,Pi=/^\s*(\/)?>/,ki=/^\s*([-:\w]+)(?:=(['"]))?/,wi=/^[A-Z]|-/,Ui=["area","base","embed","track","source","param","input",d,"col","img","br","hr"],Mi={};function xi(e,t){return Ue(Me(e,t[m]))}var Vi=D&&D.SVGElement?"textContent":"innerText",Gi="invalid";function Bi(e,t,n){var r,s,u,c={},l=Q,d=[l,c],v=[],A=function(e){s=e,Te(v,e)},y=function(e){s=e,De(v)},R=[],b=function(e,t){(s.attrs||(s.attrs={}))[e]=t},L=function(e,t,n){return(s.directives||(s.directives={}))[Ke(e,t)]={name:e,modifier:t,value:n,keypath:l,keypathStack:d}},D=function(e){var t=s[S],i=s.lastChild;sn(e)?(e[T]&&(e.parent=n),Te(t,e),i&&(s.lastChild=a)):un(i)?i[p]+=_t(e):Te(t,s.lastChild=an(e))},N=function(e,t){if(t[m]){var n=u.slots||(u.slots={});n[e]?Te(n[e],t):n[e]=t}},P=function(e){if(k(e))if(M(e))e();else{var t,n=e[g],r=e[h];e[f]===Jn?(Xe(e,E)?t=e[E]:r?(t=$(r,r[I]),r[I]&&L(Ft,n,r[C])):t=e[S]?U(e[S]):s[T]?i:n,b(n,t)):(n===Ht?($(r,r[I]),t=r[C],s.model=t):Xe(e,E)?t=e[E]:Xe(e,S)&&(t=U(e[S])),L(n,e.modifier,t)[h]=r)}},w=function(e){k(e)&&(M(e)?e():r?r[r[m]]=e:s[S]?x(e)?ve(e,D):D(e):P(e))},U=function(e){r=[],e();var t=r[m]>1?me(r,""):r[0];return r=a,t},G=function(){ve(arguments,w)},B=function(){ve(arguments,P)},H=function(){ve(arguments,function(e){var t=e[g],n=e[E];if(V(n)){var r=n;n=$(r,r[I]),r[I]&&(L(Ft,t,r[C]).prop=i)}(s.props||(s.props={}))[t]=n})},Y=function(e,t){if(u&&(e=U(e))){var n=s,i=[];A({children:i}),t(),N(Vt+e,i),y(n)}},F=function(e){if(e=U(e)){var n=t(Vt+e);return x(n)&&1===n[m]?n[0]:n}},j=function(e,t,i,r,a,c,l,d){var _,f=s,p=u;A({component:e}),e&&function(e){u=e,Te(R,e)}(s),d&&(d=U(d)),l&&(l=U(l)),c&&(c=U(c)),r&&r(),a&&a(),i&&(_=s[S]=[],i(),e&&(N(Vt+S,_),_=o));var h=dn[e?"createComponentVnode":"createElementVnode"](t,s.attrs,s.props,s.directives,_,s.slots,s.model,c,d,n,n.transition(l));return y(f),e&&function(e){u=e,De(R)}(p),h},W=rn,K=function(e,t,n){var i=$(e),r=e[C],a=r||Ke(l,e.raw),o=function(e,i){var o=c,s=l,u=d;c={},l=Ke(a,i),Te(d=tt(d),l),Te(d,c),c[xt]=l,r||(c[_]=e),n&&(c[n]=i),t(),c=o,l=s,d=u};x(i)?ve(i,o):V(i)?qe(i,o):M(i)&&i(o)},$=function(e,n){return t(e,d,n)},J=function(e){var t,n=e[I];if(!s[S]&&(t=$(e,n))&&V(t)){var i=e[C];qe(t,function(e,t){b(t,e),k(n)&&L(Ft,t,i?i+O+t:t)})}},z={},q=function(e,t){z[e]=t},X=function(e){var t=s;if(A({}),z[e])s[S]=[],z[e]();else{var i=n.importPartial(e);i&&(s[S]=i.map(Z))}if(s[S]){var r=s[S];return y(t),r}vt('"'+e+'" partial is not found.')},Z=function(e){return e(Y,F,j,K,X,W,$,q,J,G,B,H)};return c[xt]=l,Z(e)}var Hi=function(e,t){return Y(e)?+e:1===arguments[m]?0:t},Yi=0,Fi={};function ji(e,t){var n=Fi[t];return n||(n=t.replace(/\./g,"\\.").replace(/\*\*/g,"([.\\w]+?)").replace(/\*/g,"(\\w+)"),n=Fi[t]=new RegExp("^"+n+"$")),n.test(e)}function Wi(e){return Ge(e,"*")}function Ki(e,t){var n={};return ve(e,function(e){var i=je(t,e);if(i!==r)return n[g]=e,n.prop=Me(t,i),r}),n}var $i=function(){function e(e,t){var n=this;n.id=++Yi,n[R]=e,n.observer=t,n.deps=[],n.update=function(i,a,o){var s=n[E],u=n.changes||(n.changes={});Xe(u,a)||(u[a]=i),t.onChange(i,a),t.onChange(s,e);var c=function(){var t=n.get();if(t!==s)return o(t,s,e),r};qe(t.computed,function(t){if(t[R]!==e){var n=t.deps;if(be(n,e))return c();for(var i=0,r=n[m];i<r;i++)if(je(n[i],e))return c()}})}}return e.prototype.get=function(e){var t=this[E];if(this.cache===r)t=this[E]=this.getter();else if(e||this.isDirty()){var n=Ji.computed;Ji.computed=this,t=this[E]=this.getter(),Ji.computed=n,this.changes=a}return t},e.prototype.hasDep=function(e){return be(this.deps,e)},e.prototype.addDep=function(e){this.hasDep(e)||(Te(this.deps,e),this.observer.watch(e,this.update,r,this))},e.prototype.removeDep=function(e){this.hasDep(e)&&(Ne(this.deps,e),this.observer.unwatch(e,this.update))},e.prototype.clearDep=function(){var e=this;ve(e.deps,function(t){e.removeDep(t)},i)},e.prototype.isDirty=function(){var e=this.observer,t=this.changes;if(t)for(var n in t)if(t[n]!==e.get(n))return i;return!k(t)},e}(),Ji=function(){function e(e){var t=this;t.data=e.data||{},t.context=e.context||t,t.emitter=new ct,t.asyncEmitter=new ct,e.computed&&qe(e.computed,function(e,n){t.addComputed(n,e)})}return e.prototype.onChange=function(e,t){var n=this,r=Be(t,"$")?n.$changes||(n.$changes={}):n.changes||(n.changes={});Xe(r,t)||(r[t]=e),n.pending||(n.pending=i,n.nextTick(function(){if(n.pending){var e=n.changes,t=n.$changes,i=n.asyncEmitter;n.pending=n.changes=n.$changes=a;var r=$e(i.listeners),o=function(e,t){var a=n.get(t);if(a!==e){var o=[a,e,t];i.fire(t,o),ve(r,function(e){Wi(e)&&ji(t,e)&&i.fire(e,o)})}};t&&qe(t,o),e&&qe(e,o)}}))},e.prototype.get=function(t,n){if(G(t)&&!Wi(t)){var i;if(t===Q)return this.data;e.computed&&e.computed.addDep(t);var r=this.computed,o=this.reversedComputedKeys;if(r){var s=r[t];if(s)return s.get();var u=Ki(o,t),c=u[g],l=u.prop;if(c&&l){if(Xe(s=this.computed[c].get(),l))return s[l];s!=a&&(i=it(s,l))}}return i||(i=it(this.data,t)),i?i[E]:n}},e.prototype.set=function(e,t){var n=this,i=n.emitter,r=$e(i.listeners),s=[],u=function(e,t,n,i){if(t!==n){if(ve(e,function(e){ji(i,e)&&s.push(e,n,i)}),Be(i,"$"))return;var r=G(t),a=G(n);r||a?u(e,r?t[m]:o,a?n[m]:o,Ke(i,m)):(r=V(t),a=V(n),r||a?(c=r&&t,d=function(t,n,r){u(e,t,n,Ke(i,r))},(l=a&&n)?_=$e(c?et({},l,c):l):c&&(_=$e(c)),_&&ve(_,function(e){d(c?c[e]:o,l?l[e]:o,e)})):function(e,t,n){if(e||t){var i=e?e[m]:0,r=t?t[m]:0;n(e?i:o,t?r:o,m);for(var a=0,s=Math.max(i,r);a<s;a++)n(e?e[a]:o,t?t[a]:o,a)}}(x(t)&&t,x(n)&&n,function(t,n,r){u(e,t,n,Ke(i,r))}))}var c,l,d,_},c=function(e,t){if(e==a)return e;var n=it(e,t);return n?n[E]:void 0},l=function(e,t,n){var i=[];ve(r,function(r){if(Wi(r))ji(n,r)?s.push(r,t,n):Te(i,r);else{var a=je(r,n);if(a){var o,u;if(r===n)o=e,u=t;else{var l=Me(r,a);o=c(e,l),u=c(t,l)}o!==u&&s.push(r,u,r)}}}),i[m]&&u(i,e,t,n)},d=function(e,t){var i=n.get(t);if(e!==i){l(e,i,t);var r=n.computed,a=n.reversedComputedKeys;if(r){var o=r[t];if(o)return void(o.set&&o.set(e));var s=Ki(a,t),u=s[g],c=s.prop;if(u&&c)return void(F(o=r[u].get())||rt(o,c,e))}rt(n.data,t,e)}};G(e)?d(t,e):V(e)&&qe(e,d);for(var _=0;_<s[m];_+=3)i.fire(s[_],[s[_+1],s[_+2],l])},e.prototype.addComputed=function(t,n){var r,o,s,u=this,c=i;if(M(n)?r=n:V(n)&&(H(n.cache)&&(c=n.cache),M(n.get)&&(r=n.get),M(n.set)&&(o=n.set),n.deps&&(s=n.deps)),r||o){var l=new $i(t,u);if(r){var d=x(s)&&s[m]>0;d&&ve(s,function(e){l.addDep(e)}),l.cache=c,l.getter=function(){return c&&(d?e.computed=a:l.clearDep()),W(r,u.context)}}return o&&(l.set=function(e){o.call(u.context,e)}),u.computed||(u.computed={}),u.computed[t]=l,u.reversedComputedKeys=ze(u.computed,i),l}},e.prototype.toggle=function(e){var t=!this.get(e);return this.set(e,t),t},e.prototype.increase=function(e,t,n){var i=Hi(this.get(e),0)+(Y(t)?t:1);return(!Y(n)||i<=n)&&this.set(e,i),i},e.prototype.decrease=function(e,t,n){var i=Hi(this.get(e),0)-(Y(t)?t:1);return(!Y(n)||i>=n)&&this.set(e,i),i},e.prototype.insert=function(e,t,n){var a=this.get(e),o=(a=x(a)?tt(a):[])[m];if(n===i||n===o)a.push(t);else if(n===r||0===n)a.unshift(t);else{if(!(n>0&&n<o))return;a.splice(n,0,t)}return this.set(e,a),i},e.prototype.removeAt=function(e,t){var n=this.get(e);if(x(n)&&t>=0&&t<n[m])return(n=tt(n)).splice(t,1),this.set(e,n),i},e.prototype.remove=function(e,t){var n=this.get(e);if(x(n)&&Ne(n=tt(n),t))return this.set(e,n),i},e.prototype.nextTick=function(e){if(M(e)){var t=this;Tt(function(){t.data&&e()})}},e.prototype.nextRun=function(){It()},e.prototype.destroy=function(){this.emitter.off(),this.asyncEmitter.off(),Ze(this)},e}();function Qi(e){var t=function(t,n,i,r,a){var s,u=t.context;a||(s=function(e,n){t.onChange(e,n)},i.link=s,t.asyncEmitter[e](n,{func:i,context:u})),t.emitter[e](n,{func:s||i,context:a||t}),r&&W(i,u,[t.get(n),o,n])};return function(e,n,r,a){var o=this;G(e)?t(o,e,n,r,a):(n===i&&(r=n),qe(e,function(e,n){var i=e,s=r;V(e)&&(i=e.watcher,H(e.sync)&&(s=e.sync)),t(o,n,i,s,a)}))}}et(Ji.prototype,{watch:Qi("on"),watchOnce:Qi("once"),unwatch:function(e,t){var n=this.emitter,i=this.asyncEmitter;G(e)?(n.off(e,t.link||t),i.off(e,t)):V(e)&&qe(e,function(e,t){n.off(t,e.link||e),i.off(t,e)})}});var zi=/<[^>]+>/,qi=/^[#.][-\w+]+$/,Xi={for:"htmlFor"};Xi[E]=E,Xi.class="className",Xi.style="style.cssText",Xi.nohref="noHref",Xi.noshade="noShade",Xi.noresize="noResize",Xi.readonly="readOnly",Xi.defaultchecked="defaultChecked",Xi.defaultmuted="defaultMuted",Xi.defaultselected="defaultSelected";var Zi=Ce("svg,g,defs,desc,metadata,symbol,use,image,path,rect,circle,line,ellipse,polyline,polygon,text,tspan,tref,textpath,marker,pattern,clippath,mask,filter,cursor,view,animate,font,font-face,glyph,missing-glyph,foreignObject".split(te)),er={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};function tr(e,t,n){rt(e,t,n,r)}function nr(e,t){tr(e,t,G(e[t])?Q:a)}function ir(e,t){e.appendChild(t)}var rr={},ar={createElement:function(e){return Zi[e]?N.createElementNS(er.svg,e):N.createElement(e)},createText:function(e){return N.createTextNode(e||Q)},createComment:function(e){return N.createComment(e||Q)},createEvent:function(e){return e},isElement:function(e){return 1===e.nodeType},setProp:tr,removeProp:nr,setAttr:function(e,t,n){var r=Xi[t],o=H(e[r||t]);if(o?n=n===i||n===s||n===t:n==a&&(n=Q),r||o)tr(e,r||t,n);else{if(Ge(t,ie)){var u=t.split(ie),c=er[u[0]];if(c)return void e.setAttributeNS(c,u[1],n)}e.setAttribute(t,n)}},removeAttr:function(e,t){if(Xi[t])nr(e,Xi[t]);else if(H(e[t]))nr(e,t);else{if(Ge(t,ie)){var n=t.split(ie),i=er[n[0]];if(i)return void e.removeAttributeNS(i,n[1])}e.removeAttribute(t)}},before:function(e,t,n){n?e.insertBefore(t,n):ir(e,t)},append:ir,replace:function(e,t,n){e.replaceChild(t,n)},remove:function(e,t){e.removeChild(t)},parent:function(e){return e.parentNode},next:function(e){return e.nextSibling},tag:function(e){var t=e.tagName;return Ye(t)?Q:t.toLowerCase()},children:function(e){return e.childNodes},text:function(e,t){return t==a?e.nodeValue:e.nodeValue=t},html:function(e,t){return t==a?e.innerHTML:e.innerHTML=t},find:function(e,t){return(t||N).querySelector(e)},on:function(e,t,n){e.addEventListener(t,n,r)},off:function(e,t,n){e.removeEventListener(t,n,r)},addClass:function(e,t){var n=e.classList;n?n.add(t):be(n=e.className.split(ge),t)||(Te(n,t),e.className=me(n,ge))},removeClass:function(e,t){var n=e.classList;n?n.remove(t):be(n=e.className.split(ge),t)&&(Ne(n,t),e.className=me(n,ge))},component:function(e,t){return k(t)?rr[e]=t:rr[e]}},or="click",sr="input",ur="change",cr="propertychange",lr=function(){function e(e,t){et(this,e),this.currentTarget=t,this.target=e.srcElement||t,this.originalEvent=e}return e.prototype.preventDefault=function(){this.originalEvent.returnValue=r},e.prototype.stopPropagation=function(){this.originalEvent.cancelBubble=i},e}();function dr(e){return"INPUT"===e.tagName&&("radio"===e[f]||"checkbox"===e[f])}function _r(e,t,n){t===sr?function(e,t){t.$listener=function(e){e.propertyName===E&&((e=new K(e))[f]=sr,t.call(this,e))},_r(e,cr,t.$listener)}(e,n):t===ur&&dr(e)?function(e,t){t.$listener=function(e){(e=new K(e))[f]=ur,t.call(this,e)},_r(e,or,t.$listener)}(e,n):e.attachEvent("on"+t,n)}function fr(e,t,n){t===sr?function(e,t){fr(e,cr,t.$listener),delete t.$listener}(e,n):t===ur&&dr(e)?function(e,t){fr(e,or,t.$listener),delete t.$listener}(e,n):e.detachEvent("on"+t,n)}var pr={on:_r,off:fr,createEvent:function(e,t){return new lr(e,t)},find:function(e,t){return(t=t||N).querySelector?t.querySelector(e):t.getElementById(Me(e,1))},setProp:function(e,t,n){try{rt(e,t,n)}catch(i){"STYLE"!==e.tagName||"innerHTML"!==t&&"innerText"!==t&&"textContent"!==t||(e.setAttribute(f,"text/css"),e.styleSheet.cssText=n)}}},hr=tt(ar);N&&!N.addEventListener&&et(hr,pr);var gr=hr.on,Er=hr.off;hr.specialEvents={input:{on:function(e,t){var n=r;hr.on(e,"compositionstart",t.compositionstart=function(){n=i}),hr.on(e,"compositionend",t.compositionend=function(e){n=r,t(e,sr)}),gr(e,sr,t[sr]=function(e){n||t(e)})},off:function(e,t){hr.off(e,"compositionstart",t.compositionstart),hr.off(e,"compositionend",t.compositionend),Er(e,sr,t[sr]),t.compositionstart=t.compositionend=t[sr]=a}}},hr.on=function(e,t,n,i){var r=e.$emitter||(e.$emitter=new ct);if(!r.has(t)){var a=function(t,n){K.is(t)||(t=new K(hr.createEvent(t,e))),n&&(t[f]=n),r.fire(t[f],t,i)};r[t]=a;var o=hr.specialEvents[t];o?o.on(e,a):gr(e,t,a)}r.on(t,n)},hr.off=function(e,t,n){var r=e.$emitter,a=$e(r.listeners);r.off(t,n),ve(a,function(t,n){if(r[t]&&!r.has(t)){var i=r[t],o=hr.specialEvents[t];o?o.off(e,i):Er(e,t,i),delete r[t],a.splice(n,1)}},i),a[m]||hr.removeProp(e,"$emitter")};var vr=[or,"tap"],mr=function(e){var t,n,i,r,o=e.el,s=e.node,u=e.instance,c=e.component,l=e.directives,d=e.type,_=e.listener;if(d||(d=s.modifier),_||(_=u.compileDirective(s)),d&&_){var f=l.lazy;if(f){var p=f[E];Y(p)&&p>=0?(t=_,n=p,i=be(vr,d),_=function(){if(!r){var e=Ie(arguments);i&&W(t,a,e),r=setTimeout(function(){r=a,i||W(t,a,e)},n)}}):d===sr&&(d=ur)}return c?(c.on(d,_),function(){c.off(d,_)}):(hr.on(o,d,_),function(){hr.off(o,d,_)})}};function Sr(e){return k(e[E])?e[E]:e[p]}var Ar={set:function(e,t,n){var i=_t(n.get(t));i!==e[E]&&(e[E]=i)},sync:function(e,t,n){n.set(t,e[E])},attr:E},yr={set:function(e,t,n){e.set(e.$model,n.get(t))},sync:function(e,t,n){n.set(t,e.get(e.$model))}},Tr={radio:{set:function(e,t,n){e.checked=e[E]===_t(n.get(t))},sync:function(e,t,n){e.checked&&n.set(t,e[E])},attr:"checked"},checkbox:{set:function(e,t,n){var i=n.get(t);e.checked=x(i)?be(i,e[E],r):H(i)?i:!!i},sync:function(e,t,n){var i=n.get(t);x(i)?e.checked?n.append(t,e[E]):n.removeAt(t,Oe(i,e[E],r)):n.set(t,e.checked)},attr:"checked"},select:{set:function(e,t,n){var i=_t(n.get(t)),a=e.options;a&&ve(a,function(t,n){if(Sr(t)===i)return e.selectedIndex=n,r})},sync:function(e,t,n){n.set(t,Sr(e.options[e.selectedIndex]))}}},Rr=ln(hr),Ir=y,Cr="$"+Ir,Or=function(){function e(t){var n=this;V(t)||(t={}),n.$options=t,W(t[jt],n,t);var r=t,o=r.el,s=r.data,u=r.props,c=r.parent,l=r.replace,d=r.computed,_=r.template,f=r.transitions,p=r.components,h=r.directives,g=r.partials,E=r.filters,v=r.slots,A=r.events,y=r.methods,R=r.watchers,I=(r.propTypes,r.extensions);I&&et(n,I);var C=this.checkPropTypes(u||{});v&&et(C,v),u&&V(s)&&gt('"data" option expected to be a function.'),n.$observer=new Ji({context:n,data:C,computed:d});var O=M(s)?W(s,n,t):s;V(O)&&qe(O,function(e,t){Xe(C,t)?gt('"'+t+'" is already defined as a prop. Use prop default value instead.'):C[t]=e}),n.$emitter=new ct(i);var b='"'+Ir+'" option expected to have just one root element.';G(_)?(qi.test(_)&&(_=hr.html(hr.find(_))),zi.test(_)||c||Et(b)):_=a,G(o)&&qi.test(o)&&(o=hr.find(o)),o&&(hr.isElement(o)?l||(hr.html(o,"<div></div>"),o=hr[S](o)[0]):Et('"el" option expected to be a html element.')),c&&(n.$parent=c),y&&qe(y,function(e,t){Xe(br,t)&&vt('"'+t+'" method is conflicted with built-in methods.'),n[t]=e});var L=function(e,t){M(t)?n[e](W(t,n)):V(t)&&n[e](t)};L("transition",f),L(T,p),L("directive",h),L("partial",g),L("filter",E),W(t[Wt],n),_&&((_=e.compile(_))[m]>1&&vt(b),n.$template=_[0],n.$observer.addComputed(Cr,function(){return n.render()}),(R=R?tt(R):{})[Cr]=function(e){n.updateView(e,n.$node)},n.updateView(n.get(Cr),o||hr.createElement("div"))),A&&n.on(A),R&&Rt(function(){n.$observer&&n.watch(R)})}return e.prototype.addComputed=function(e,t){return this.$observer.addComputed(e,t)},e.prototype.get=function(e,t){return this.$observer.get(e,t)},e.prototype.set=function(e,t){this.$observer&&this.$observer.set(e,t)},e.prototype.on=function(e,t){return this.$emitter.on(e,t),this},e.prototype.once=function(e,t){return this.$emitter.once(e,t),this},e.prototype.off=function(e,t){return this.$emitter.off(e,t),this},e.prototype.fire=function(e,t,n){var r=e;G(e)&&(r=new K(e)),r.target||(r.target=this);var a=[r];V(t)&&Te(a,t);var o=this.$parent,s=this.$children,u=this.$emitter.fire(r[f],a,this);return u&&(n?s&&ve(s,function(e){return u=e.fire(r,t,i)}):o&&(u=o.fire(r,t))),u},e.prototype.watch=function(e,t,n){return this.$observer.watch(e,t,n),this},e.prototype.watchOnce=function(e,t,n){return this.$observer.watchOnce(e,t,n),this},e.prototype.unwatch=function(e,t){return this.$observer.unwatch(e,t),this},e.prototype.forceUpdate=function(){if(this.$node){var e=this.$observer.computed[Cr];e.isDirty()?this.$observer.nextRun():this.updateView(e.get(i),this.$node)}},e.prototype.render=function(){var e=this,t=e.$template,n=e.$getter;if(!n){var i=et({},Lr.filter,e.$filters),s=function(t,n,a){if(a){var s,u,c=n.lookup!==r,l=a[m]-2,d=function(){var n=l;if(!c){var i=[];We(t,function(e){"$parent"===e?n-=2:"$this"!==e&&Te(i,e)}),t=me(i,O)}var r=Ke(a[n],t);u||(u=r);var o=a[n+1];if(Xe(o,t))return s=o[t],r;if(Xe(o,_)){if(o=o[_],t===Q)return s=o,r;if(o&&Xe(o,t))return s=o[t],r}return(s=e.get(r,d))!==d?r:c&&l>0?(l--,d()):void 0},f=d();if(k(f))u=f;else if(s=o,i){var p=it(i,t);p&&(s=p[E])}return n[C]=u,s}return e.get(t)};n=e.$getter=function(t,n,i){var r,o=Ji.computed;return i&&(Ji.computed=a),r=G(t)?s(t):Wn(t,function(e,t){return s(e,t,n)},e),i&&(Ji.computed=o),r}}return Bi(t,n,e)},e.prototype.updateView=function(e,t){var n,i=this,r=i.$node,a=i.$options;i.$flags={},r?(W(a.beforeUpdate,i),i.$node=Rr(t,e),n="afterUpdate"):(W(a.beforeMount,i),r=Rr(t,e),i.$el=r.el,i.$node=r,n="afterMount"),Tt(function(){i.$node&&W(a[n],i)})},e.prototype.checkPropTypes=function(t){var n=this.$options.propTypes;return n?e.checkPropTypes(t,n):t},e.prototype.create=function(t,n,r){if((t=tt(t)).parent=this,n&&r){t.el=r,t.replace=i,t.slots=n.slots;var a=n.attrs;if(n.model){a||(a={});var o=t.model||E;Xe(a,o)||(a[o]=n.instance.get(n.model)),t.extensions={$model:o}}t.props=a}var s=new e(t);return Te(this.$children||(this.$children=[]),s),s},e.prototype.importPartial=function(t){return e.compile(this.partial(t))},e.prototype.compileDirective=function(e){var t=this,n=e[h],i=e[E],a=(e[R],e.keypathStack);if(n&&n[f]===Rn){var o=n.callee,s=n.args,u=t[o[g]];if(u){var c=function(e){return t.$getter(e,a)};return function(e,n){var i,o=K.is(e);if(s&&s[m]){var l=Le(a);o&&(l.$event=e),l.$data=n,i=W(u,t,s.map(c))}else o&&(i=W(u,t,n?[e,n]:e));i===r&&o&&e.prevent().stop()}}}else if(i)return function(e,n){e[f]!==i&&((e=new K(e))[f]=i),t.fire(e,n)}},e.prototype.destroy=function(){var e=this.$options,t=this.$node,n=this.$parent,i=this.$emitter,r=this.$observer;W(e.beforeDestroy,this),n&&n.$children&&Ne(n.$children,this),t&&Rr(t,an(Q)),i.off(),r.destroy(),Ze(this),W(e.afterDestroy,this)},e.prototype.nextTick=function(e){this.$observer.nextTick(e)},e.prototype.toggle=function(e){return this.$observer.toggle(e)},e.prototype.increase=function(e,t,n){return this.$observer.increase(e,t,n)},e.prototype.decrease=function(e,t,n){return this.$observer.decrease(e,t,n)},e.prototype.copy=function(e,t){return tt(e,t)},e.prototype.insert=function(e,t,n){return this.$observer.insert(e,t,n)},e.prototype.append=function(e,t){return this.$observer.insert(e,t,i)},e.prototype.prepend=function(e,t){return this.$observer.insert(e,t,r)},e.prototype.removeAt=function(e,t){return this.$observer.removeAt(e,t)},e.prototype.remove=function(e,t){return this.$observer.remove(e,t)},e}();Or.version="0.62.6",Or.is=j,Or.dom=hr,Or.array=ke,Or.object=at,Or.string=Fe,Or.logger=mt,Or.Event=K,Or.Emitter=ct;var br=Or.prototype,Lr={};function Dr(e,t,n){var i=e[t];if(M(i)){var r=i.$pending;r?Te(r,n):(r=i.$pending=[n],i(function(n){delete i.$pending,e[t]=n,ve(r,function(e){e(n)})}))}else n(i)}function Nr(e,t,n){V(t)?qe(t,function(t,n){e[n]=t}):e[t]=n}return ve([T,"transition","directive","partial","filter"],function(e){br[e]=function(t,n){var i=this,r="$"+e+"s",a=i[r];if(G(t)){var o=arguments[m],s=a&&Xe(a,t);if(1===o)return s?a[t]:Or[e](t);if(2===o&&e===T&&M(n))return s?Dr(a,t,n):Or[e](t,n)}Nr(a||(i[r]={}),t,n)},Or[e]=function(t,n){var i=Lr[e];if(G(t)){var r=arguments[m],a=i&&Xe(i,t);if(1===r)return a?i[t]:o;if(2===r&&e===T&&M(n))return a?Dr(i,t,n):n()}Nr(i||(Lr[e]={}),t,n)}}),Or.nextTick=Tt,Or.compile=function(e){return G(e)?function(e){var t=Mi[e];if(t)return t;t=[];var n,o,s=[],_=[],A=[],R=function(t){vt("Error compiling "+y+":"+he+e+he+"- "+t)},I=function(e){var t=Le(s);t&&t[f]===$n&&t[l]!==e&&be(Ui,t[l])&&C($n,t[l])},C=function(e,t){var n;if(t&&I(t),ve(s,function(t,i){if(t[f]===e)return n=s.splice(i,1)[0],r},i),n){var o=n,_=o.tag,v=o.name,T=o.divider,C=o.children,O=o.component;if(e===$n&&t&&_!==t&&R("end "+l+" expected </"+_+"> to be </"+t+">."),C&&!C[m]&&(C=a,delete n[S]),!C)return;if(e===$n){if(!O&&_!==y&&C[m]-T==1){var b=Le(C);if(b[f]===Qn)n.props=[{name:Vi,value:b[p]}],De(C);else if(b[f]===ii){var L=[];b.safe===r?Te(L,{name:"innerHTML",value:b[h]}):Te(L,{name:Vi,value:b[h]}),n.props=L,De(C)}C[m]||delete n[S]}}else{if(e===Jn){var D=Le(A);if(v===u||v===c||"transition"===v||D[l]===y&&v===d||D[l]===d&&v===g)return Ne(D[S],n),D[S][m]||delete D[S],void(C[m]&&(D[v]=C))}var N=1===C[m]&&C[0];if(N)if(N[f]===Qn){var P=N[p];e===zn?(n[h]=Fn(P),n[E]=P,delete n[S]):e===Jn&&(n[E]=P,delete n[S])}else e===Jn&&N[f]===ii&&(n[h]=N[h],delete n[S])}}else R("{{/"+di[e]+"}} is not a pair.")},O=function(e){var n=e[f],r=e[p];if(n===Qn){if(function(e){return Ge(e,he)&&!Ue(e)}(r)||!(r=function(e){return e.replace(/^\s*[\n\r]\s*|\s*[\n\r]\s*$/g,Q)}(r)))return;e[p]=r}if(A[m]||I(),oi[n]){var a=De(_);return a.next=e,C(a[f]),Te(_,e),void Te(s,e)}var o=Le(s);if(o){var u=o[S],c=o.divider;u?u[m]!==c&&u[u[m]-1]:u=o[S]=[],Te(u,e)}else Le(t),Te(t,e);ai[n]?(A[m]||(e.stump=i),Te(_,e)):si[n]&&Te(A,e),ui[n]||Te(s,e)},b=[function(e){if(!A[m]){var t=e.match(Ni);if(t&&!t[v]){var n=t[2];return t[1]===Z?C($n,n):O(new Ai(n,wi.test(n))),t[0]}}},function(e){var t=e.match(Pi);if(t){if(1===A[m]){var n=Le(A);n.divider=n[S]?n[S][m]:0,t[1]===Z&&C($n),De(A)}return t[0]}},function(e){if(1===A[m]){var t=e.match(ki);if(t){var i=t[1];return ci[i]?O(new mi(we(i))):Be(i,Bt)?(i=Me(i,Bt[m]),O(new mi(Yt,we(i)))):Be(i,Gt)?(i=Me(i,Gt[m]),O(new mi(we(i)))):O(new vi(A[0][T]?we(i):i)),(n=t[2])||C(De(A)[f]),t[0]}}},function(e){if(2===A[m]){for(var t,r,a=0;t=$(e,a);){if(t===n){r=i;break}a++}var o=Q;return a&&(o=Me(e,0,a),O(new Li(o))),r&&(o+=n,(r=De(A))[S]||(r[E]=Q),C(r[f])),o}var s=e.match(Ni);return s&&s[v]&&(e=Me(e,0,s[v])),(1!==A[m]||Ue(e))&&O(new Li(e)),e}],L=[function(e,t){if(Be(e,Pt)){var n=(e=xi(e,Pt)).replace(/\s+/g,Q).split(ie);if(n[0])return new Si(Fn(Ue(n[0])),Ue(n[1]));R(Gi+" each: "+t)}},function(e,t){if(Be(e,wt))return(e=xi(e,wt))?new Ci(e):R(Gi+" import: "+t)},function(e,t){if(Be(e,kt))return(e=xi(e,kt))?new Oi(e):R(Gi+" partial: "+t)},function(e,t){if(Be(e,Lt))return(e=xi(e,Lt))?new Ii(Fn(e)):R(Gi+" if: "+t)},function(e,t){if(Be(e,Nt))return(e=xi(e,Nt))?new Ti(Fn(e)):R(Gi+" else if: "+t)},function(e){if(Be(e,Dt))return new yi},function(e,t){if(Be(e,Ut))return(e=xi(e,Ut))?new bi(Fn(e)):R(Gi+" spread: "+t)},function(e,t){if(!Mt.test(e))return(e=Ue(e))?new Ri(Fn(e),!He(t,"}}}")):R(Gi+" expression: "+t)}],D=function(e){e&&function(){for(var t=e;t;)ve(b,function(e,n){if(n=e(t))return t=Me(t,n[m]),r});P=Me(P,e[m])}()},N=function(e,t){if(e)if($(e)===Z){var n=Me(e,1),i=li[n];if(ai[i]){var a=De(_);a?i=a[f]:R("if is not begined.")}C(i)}else ve(L,function(n,i){if(i=n(e,t))return O(i),r});P=Me(P,t[m])},P=e;for(P=P.replace(/<!--[\s\S]*?-->/g,function(){return Q});P;)(o=P.match(Di))?(D(Me(P,0,o[v])),o[1][m]===o[3][m]?N(o[2],o[0]):R(Gi+" syntax: "+o[0])):D(P);return Mi[e]=t}(e).map(function(e){return new Function("a","b","c","e","i","m","o","p","s","x","y","z","return "+e.stringify())}):e},Or.checkPropTypes=function(e,t){var n=tt(e);return qe(t,function(t,a){var o=t[f],s=t[E],u=t.required;if(u=u===i||M(u)&&u(e),k(e[a])){var c=e[a];if(M(t))n[a]=t(c);else if(o){var l;Ye(o)?Pe(o)?M(o)&&(l=o(c,e)):ve(o,function(e){if(U(c,e))return l=i,r}):l=U(c,o),l!==i&&gt('The prop "'+a+'" '+f+" is not matched.")}}else u?gt('The prop "'+a+'" is marked as required, but its '+E+' is "undefined".'):Xe(t,E)&&(n[a]=o===A?s:M(s)?s(e):s)}),n},Or.use=function(e){e.install(Or)},Or.directive({event:mr,model:function(e){var t=e.el,n=e.node,i=e.instance,r=e.directives,o=e.attrs,s=e.component,u=n[E];if(u){var c,d,_,p,h=function(){d&&d.set(c,u,i)},g=function(){d.sync(c,u,i)};if(s){c=s,d=yr;var v=s.$model;s.watch(v,g),_=function(){s.unwatch(v,g)}}else{c=t,d=Tr[t[f]]||Tr[hr[l](t)];var m=ur;d||(d=Ar,m=sr),d.attr&&Xe(o,d.attr)||h(),_=mr({el:t,node:n,instance:i,directives:r,type:m,listener:g})}return Rt(function(){h&&(i.watch(u,h),p=function(){i.unwatch(u,h)})}),function(){W(_),W(p),h=a}}},binding:function(e){var t=e.el,n=e.node,i=e.instance,r=e.component,o=n[E];if(o){var s=function(e){var i=n.modifier;r?r.set(i,e):hr[n.prop?"setProp":"setAttr"](t,i,e)};return Rt(function(){s&&i.watch(o,s)}),function(){i.unwatch(o,s),s=a}}}}),Or.filter({hasSlot:function(e){return k(this.get(Vt+e))}}),window.Yox=Or,Or}()}).call(this,n(397).setImmediate)},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(r.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new a(r.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(398),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(226))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,r,a,o,s,u=1,c={},l=!1,d=e.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(e);_=_&&_.setTimeout?_:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick(function(){p(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){p(e.data)},i=function(e){a.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(r=d.documentElement,i=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):i=function(e){setTimeout(p,0,e)}:(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(o+t,"*")}),_.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return c[u]=r,i(u),u++},_.clearImmediate=f}function f(e){delete c[e]}function p(e){if(l)setTimeout(p,0,e);else{var t=c[e];if(t){l=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}(t)}finally{f(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(226),n(399))},function(e,t){var n,i,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var u,c=[],l=!1,d=-1;function _(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&f())}function f(){if(!l){var e=s(_);l=!0;for(var t=c.length;t;){for(u=c,c=[];++d<t;)u&&u[d].run();d=-1,t=c.length}u=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t){var i,a=n(7),o=n(11),s=n(197),u=n(138),c=n(5),l=o.CUSTOMCAST_KEY_OF_H5_DOC,d=[],_={};function f(){var e=a.get("partner.liveCustomBroadcastSignal");e&&(l+=","+e.keys,i=e.maxLength),f=$.noop}t.init=function(){c.on(c.CUSTOMCAST_RECEIVE,function(e,t){var n=t.fromId,i=_[t.key];i&&i(n,t.value)}),c.on(c.CUSTOMCAST_CACHE_RES,function(e,t){var n=t.fromId,i=_[t.key];i&&i(n,t.value,!0)})},t.sendBroadcast=function(e,t,n){if(f(),-1===l.indexOf(e))throw{name:"BroadcastException",code:1,message:"Illegal key"};if((0,r.default)(t).length>i)throw{name:"BroadcastException",code:2,message:"Size exceeded"};var a=+new Date,u=d.length,c=d[u-5]?d[u-5]:-1,_=d[u-30]?d[u-30]:-1;if(!(a-c>o.SECOND&&a-_>o.MINUTE))throw{name:"BroadcastException",code:3,message:"Frequency exceeded"};d.push(a),s.sendCustomcast({key:e,value:t,options:n}),u>60&&d.shift()},t.onReceiveBroadcast=function(e,t){_[e]=t},t.getCachedBroadcast=function(e){s.getCachedCustomcast({key:e})},t.getCameraList=function(){return u.getCameraList()},t.getMicList=function(){return u.getMicList()},t.getSpeakerList=function(){return u.getSpeakerList()},t.getCameraIndex=function(){return u.getCameraIndex()},t.getAssistCameraIndex=function(){return u.getAssistCameraIndex()},t.getMicIndex=function(){return u.getMicIndex()},t.getSpeakerIndex=function(){return u.getSpeakerIndex()},t.switchCamera=function(e){null!=e?"number"==typeof e?c.trigger(c.CAMERA_INDEX_CHANGE_TRIGGER,{index:e}):console.log("switchCamera->参数类型错误,number"):console.log("switchCamera->参数不能为空")},t.switchAssistCamera=function(e){null!=e?"number"==typeof e?c.trigger(c.ASSIST_CAMERA_INDEX_CHANGE_TRIGGER,{index:e}):console.log("switchAssistCamera->参数类型错误,number"):console.log("switchAssistCamera->参数不能为空")},t.switchMic=function(e){null!=e?"number"==typeof e?c.trigger(c.MIC_INDEX_CHANGE_TRIGGER,{index:e}):console.log("switchMic->参数类型错误,number"):console.log("switchMic->参数不能为空")},t.switchSpeaker=function(e){null!=e?"number"==typeof e?c.trigger(c.SPEAKER_INDEX_CHANGE_TRIGGER,{index:e}):console.log("switchSpeaker->参数类型错误,number"):console.log("switchSpeaker->参数不能为空")},t.setMicVolume=function(e){null!=e?"number"==typeof e?e<0||e>o.MIC_VOLUME_MAX?console.log("setMicVolume->参数有效范围: 0-"+o.MIC_VOLUME_MAX):c.trigger(c.MIC_VOLUME_CHANGE_TRIGGER,{value:e}):console.log("setMicVolume->参数类型错误,number"):console.log("setMicVolume->参数不能为空")},t.setSpeakerVolume=function(e){null!=e?"number"==typeof e?e<0||e>o.SPEAKER_VOLUME_MAX?console.log("setSpeakerVolume->参数有效范围: 0-"+o.SPEAKER_VOLUME_MAX):c.trigger(c.SPEAKER_VOLUME_CHANGE_TRIGGER,{value:e}):console.log("setSpeakerVolume->参数类型错误,number"):console.log("setSpeakerVolume->参数不能为空")},t.setCameraQuality=function(e){null!=e?"number"==typeof e?c.trigger(c.CAMERA_QUALITY_CHANGE_TRIGGER,{value:e}):console.log("setCameraQuality->参数类型错误,number"):console.log("setCameraQuality->参数不能为空")},t.setAssistCameraQuality=function(e){null!=e?"number"==typeof e?c.trigger(c.ASSIST_CAMERA_QUALITY_CHANGE_TRIGGER,{value:e}):console.log("setAssistCameraQuality->参数类型错误,number"):console.log("setAssistCameraQuality->参数不能为空")}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t){var i,a=n(169),o=n(170);function s(){i||(i=BJY.loggerManager.create({prefix:"room",output:{aliServer:!0}}))}var u={media_publish_ext:1,media_republish_ext:1,media_publish_ext_trigger:1,media_republish_ext_trigger:1,media_publish:1,media_publish_trigger:1,media_republish:1,media_republish_trigger:1,user_active_res:1,user_active_req:1};return{onSend:{after:function(e){var t=e.message_type;if("heart_beat"!=t){var n="rs send => "+(0,r.default)(e,o.jsonStringifyReplacer);a.write(n),u[t]&&(!i&&s(),i({content:n}))}}},onReceive:{before:function(e){var t=e.message_type;if("user_count_change"!==t){var n="rs receive => "+(0,r.default)(e,o.jsonStringifyReplacer);a.write(n),u[t]&&(!i&&s(),i({content:n}))}}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e,t){var n=0;return $.each(e,t.name?function(e,i){if(i.name===t.name)return n=e,!1}:function(e,i){if(i.ip===t.ip&&i.port===t.port)return n=e,!1}),n===e.length-1?n=0:n++,e[n]}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(11),r=n(294),a=i.PREFIX_OF_SNIPPET_SHAPE_MESSAGE,o=a+"shape_",s=Yox.string.startsWith;return{send:{before:function(e){var t=e.doc_id,n=e.message_type;t===i.SNIPPET_DOC_ID_LOCAL&&s(n,"shape_")&&(e.doc_id=i.SNIPPET_DOC_ID_BROAD,e.layer=e.layer||r.getLayer(),e.message_type=a+n)}},onReceive:{before:function(e){var t=e.message_type;s(t,o)&&(e.doc_id=i.SNIPPET_DOC_ID_LOCAL,e.message_type=t.replace(a,""))}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(95),r=n(7),a=n(26),o=n(5),s=n(79),u=n(43),c=n(296),l=n(109),d=n(297),_=n(298),f=n(148),p=["videoOn","audioOn"];t.messageTypes={media_publish_ext:function(e){l(e.user_id,function(){var t=u(e.user),n={},r={};"boolean"===$.type(e.video_on)&&(r.videoOn=n.videoOn=e.video_on),"boolean"===$.type(e.audio_on)&&(r.audioOn=n.audioOn=e.audio_on),"number"===$.type(e.support_mute_stream)&&(r.supportMuteStream=t.supportMuteStream=1===e.support_mute_stream),"number"===$.type(e.is_screen_sharing)&&(r.isScreenSharing=n.isScreenSharing=1===e.is_screen_sharing),"number"===$.type(e.support_black_stream)&&(r.supportBlackStream=t.supportBlackStream=1===e.support_black_stream),"number"===$.type(e.action_type)&&(r.actionType=e.action_type),"number"===$.type(e.video_ratio)&&(r.videoRatio=e.video_ratio),c(e,"publish_index",n,"publishIndex"),a.isSelf(t.id)||c(e,"publish_server",t,"publishServer"),c(e,"link_type",t,"linkType");var s=e.media_id;r.mediaId=s,t.mediaExtMap=t.mediaExtMap||{},t.mediaExtMap[s]=n,r.user=$.extend(!0,{},i.update(t,p)||t),r.linkType=t.linkType,i.updateAssistActive(t.id,!!r.videoOn,s),o.trigger(o.ASSIST_MEDIA_PUBLISH,r)})},media_republish_ext:function(e){l(e.user_id,function(){var t=u(e.user),n={},r={};!0===e.video_on&&(r.videoOn=n.videoOn=!0),!0===e.audio_on&&(r.audioOn=n.audioOn=!0),"number"===$.type(e.action_type)&&(r.actionType=e.action_type);var s=i.find(t.id);s&&s.mediaExt&&e.publishIndex>s.mediaExt[0].publishIndex&&(r.switchServer=!0),"number"===$.type(e.support_mute_stream)&&(r.supportMuteStream=t.supportMuteStream=1===e.support_mute_stream),"number"===$.type(e.support_black_stream)&&(r.supportBlackStream=t.supportBlackStream=1===e.support_black_stream),"number"===$.type(e.is_screen_sharing)&&(r.isScreenSharing=n.isScreenSharing=1===e.is_screen_sharing),c(e,"publish_index",n,"publishIndex"),a.isSelf(t.id)||c(e,"publish_server",t,"publishServer"),c(e,"link_type",t,"linkType");var l=e.media_id;f.mediaAssistCamera(l)&&(t.id2=l),r.mediaId=l,t.mediaExtMap=t.mediaExtMap||{},t.mediaExtMap[l]=n,r.user=i.update(t,p)||t,r.linkType=t.linkType,i.updateAssistActive(t.id,!!r.videoOn,l),o.trigger(o.ASSIST_MEDIA_REPUBLISH,r)})}},t.methods={publishAssistMedia:function(e){e.isAssist=!0;var t=_(e),n=r.get("user");t.user.videoOn=n.videoOn,t.user.audioOn=n.audioOn,t.message_type="media_publish_ext_trigger",t.media_id=e.mediaId||n.id2,f.mediaAssistCamera(t.media_id)&&$.type(e.videoOn)&&r.set("user.assistVideoOn",e.videoOn),t.user.assistVideoOn=n.assistVideoOn||!1;var i="boolean"===$.type(e.videoOn),a="boolean"===$.type(e.audioOn);(i||a)&&s.send(t)},republishAssistMedia:function(e){e.isAssist=!0;var t=d(e),n=r.get("user");t.user.videoOn=n.videoOn,t.user.audioOn=n.audioOn,t.message_type="media_republish_ext_trigger",t.media_id=e.mediaId||n.id2,f.mediaAssistCamera(t.media_id)&&$.type(e.videoOn)&&r.set("user.assistVideoOn",e.videoOn),t.user.assistVideoOn=n.assistVideoOn||!1;var i=!0===e.videoOn,a=!0===e.audioOn;(i||a)&&s.send(t)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(7),r=n(5),a=n(79),o=n(43);t.messageTypes={snippet_publish:function(e){e=o(e),r.trigger(r.SNIPPET_PUBLISH,{id:e.id,operate:e.operate,duration:e.duration,timeStart:e.timeStart,from:e.from})},snippet_participate:function(e){e=o(e),r.trigger(r.SNIPPET_PARTICIPATE,{id:e.id,isActive:e.isActive,from:e.from})},snippet_submit:function(e){e=o(e),r.trigger(r.SNIPPET_SUBMIT,{id:e.id,isActive:e.isActive,from:e.from})},snippet_pull_res:function(e){e=o(e),r.trigger(r.SNIPPET_PULL_RES,{id:e.id,timeStart:e.timeStart,duration:e.duration,isActive:e.isActive,userParticipated:e.userParticipated,userSubmitted:e.userSubmitted})}},t.methods={operateSnippet:function(e){var t=i.get("user"),n={message_type:"snippet_publish_trigger",id:e.id,operate:e.operate,from:{id:t.id,number:t.number,type:t.type,name:t.name,group:t.group,avatar:t.avatar,end_type:t.endType}};null!=e.duration&&(n.duration=e.duration),a.send(n)},participateSnippet:function(e){var t=i.get("user"),n={message_type:"snippet_participate_trigger",id:e,from:{id:t.id,number:t.number,type:t.type,name:t.name,group:t.group,avatar:t.avatar,end_type:t.endType}};a.send(n)},submitSnippet:function(e){var t=i.get("user"),n={message_type:"snippet_submit_trigger",id:e,from:{id:t.id,number:t.number,type:t.type,name:t.name,group:t.group,avatar:t.avatar,end_type:t.endType}};a.send(n)},requestSnippet:function(e){var t={message_type:"snippet_pull_req"};e&&(t.id=e),a.send(t)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(26),r=n(5);t.messageTypes={student_paint_switch:function(e){i.isAudition()||r.trigger(r.SWITCH_STUDENT_PAINT,{studentPaintAuth:e.student_paint_auth||[],cache:e.cache,fromId:e.user_id})},student_auth_switch:function(e){i.isAudition()||r.trigger(r.SWITCH_STUDENT_AUTH,{studentAuth:e.student_auth?e.student_auth:{},cache:e.cache,fromId:e.user_id})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t){var i=n(148),a=n(95),o=n(132),s=n(168),u=(n(70),n(11)),c=n(7),l=n(26),d=n(5),_=n(55),f=n(139),p=n(121),h=n(79),g=n(109),E=n(239),v=n(299);t.messageTypes={login_res:function(e){0===e.code?(c.set({"class.started":e.started,"class.totalUserCount":e.accumulative_user_count,"class.userCount":e.user_count,"class.speakState":e.speak_state,"class.loginTime":1e3*e.timestamp,"class.diffNTP":1e3*e.timestamp-$.now(),"class.isFree":e.speak_state===u.SPEAK_STATE_FREE,"class.teacherSwitchable":1==e.teacher_switchable,"class.classSwitch":1==e.class_switch}),0!==c.get("partner.liveLinkTypeConsistency",0)&&e.link_type>=0&&v(e.link_type,e.teacher_switchable),null!=e.user_group&&c.set("user.group",e.user_group),s.add(s.ROOM_SERVER_LOGIN_SUCCESS),t.methods.startHeartbeat(),d.trigger(d.ROOM_SERVER_LOGIN_SUCCESS)):1===e.code?d.trigger(d.ROOM_SERVER_LOGIN_FAIL):2===e.code?(d.trigger(d.ROOM_SERVER_LOGIN_OVERFLOW),d.has(d.ROOM_SERVER_LOGIN_OVERFLOW)||E("教室人数已达上限，无法进入")):3===e.code?(d.trigger(d.ROOM_SERVER_LOGIN_KICKED_OUT),d.has(d.ROOM_SERVER_LOGIN_KICKED_OUT)||E("你已被踢出教室，无法再次进入")):4===e.code?(d.trigger(d.ROOM_SERVER_LOGIN_CONFLICT),c.set("loginConflict",!0)):5===e.code&&d.trigger(d.ROOM_SERVER_LOGIN_AUDITION_END)},login_conflict:function(e){d.trigger(d.LOGIN_CONFLICT,{endType:e.end_type})},broadcast_cache_res:function(e){d.trigger(d.BROADCAST_CACHE_RES,{key:e.key,value:e.value,fromId:e.user_id})},command_receive:function(e){d.trigger(d.COMMAND_RECEIVE,{fromId:e.from,toId:e.to,command:e.data})},broadcast_receive:function(e){Yox.array.has(u.BUFFERED_BROADCAST_LIST,e.key)?g(e.user_id,function(){d.trigger(d.BROADCAST_RECEIVE,{fromId:e.user_id,key:e.key,value:e.value})}):d.trigger(d.BROADCAST_RECEIVE,{fromId:e.user_id,key:e.key,value:e.value})},log:function(e){if("production"!==c.get("env"))switch(e.type){case"info":BJY.logger.info("rs log",e.msg);break;case"warn":BJY.logger.warn("rs log",e.msg);break;case"danger":E("rs log: "+e.msg)}},webrtc_info_res:function(e){c.set("user.webrtcInfo",camelCaseObject(e.webrtc_info)),d.trigger(d.WEBRTC_INFO_RES)},praise_cnt_res:function(e){d.trigger(d.GET_THUMBUP_NUMBER_RES,{likesNumberCounts:e.praise_cnt})},parent_room_quiz_res:function(e){d.trigger(d.PARENT_ROOM_QUIZ_RES,{list:camelCaseObject(e.list)})},class_start:function(e){d.trigger(d.CLASS_START)},class_end:function(e){g(e.user_id,function(){d.trigger(d.CLASS_END)})},presenter_change:function(e){var t,n=e.presenter_id;n&&(t=a.find(n),n||(n="")),c.set({presenterId:n,presenter:t}),d.trigger(d.PRESENTER_CHANGE,{presenterId:n})},class_switch:function(e){d.trigger(d.CLASS_SWITCH,{targetClassId:e.target_class_id,groupId:e.group_id})},heart_beat:function(e){d.trigger(d.HEARTBEAT_RECEIVE,e)}},t.methods={startHeartbeat:function(){t.methods.endHeartbeat(),t.heartbeatTimer=setInterval(function(){t.methods.heartbeat(),d.trigger(d.SEND_HEARTBEAT)},u.HEARTBEAT_INTERVAL)},endHeartbeat:function(){var e=t.heartbeatTimer;e&&(clearInterval(e),t.heartbeatTimer=null)},heartbeat:function(){var e=new Date;h.send({message_type:"heart_beat",timestamp:Math.round(e.getTime()/1e3)+60*(e.getTimezoneOffset()+480)})},logout:function(){h.send({message_type:"logout_req"})},login:function(e){var t=c.get("user"),n=c.get("class.speakState");null==n&&(n=u.SPEAK_STATE_LIMIT);var r=_.get(t.number+"")||"";c.set("user.cameraCover",r);var a={message_type:"login_req",speak_state:n,auth_url:c.get("authUrl"),token:c.get("token"),user:{number:t.number,group:c.get("user.group"),type:t.type,name:t.name,actual_name:t.actualName,avatar:t.avatar,camera_cover:r,status:t.status,end_type:t.endType,is_backdoor:"info"===BJY.query.log?1:0,is_record:l.isWebRTCRecord()?1:0,webrtc_support:t.webrtcSupport,is_audition:!!t.isAudition,audition_duration:t.auditionDuration},course_number:c.get("class.number"),start_time:o.getStartTime(),end_time:o.getEndTime(),support:{points_decoder:2,link_type_consistency:c.get("partner.liveLinkTypeConsistency",0),teacher_preferred_link_type:c.get("partner.liveTeacherPreferredLinkType",0)}};if(l.isTeacher(t.type)&&(a.class_name=o.getClassName(),a.class_number=o.getClassNumber(),a.check_unique=e&&(e.needCheckUnique?1:0)),t.webrtcInfo&&(a.user.webrtc_info=p(t.webrtcInfo)),i.smallCourse()&&(a.get_cache_group=!0),BJY.query.rs_params)try{$.extend(a,JSON.parse(decodeURIComponent(BJY.query.rs_params)))}catch(e){}h.send(a)},sendCommand:function(e,t){var n=c.get("user");h.send({message_type:"command_send",from:n.id,to:e,data:t})},sendBroadcast:function(e){var t=e.options||{},n={message_type:"broadcast_send",options:{cache:null!=t.cache&&t.cache,all:null==t.all||t.all},key:e.key,value:e.value||{}};e.route&&(n.route=e.route),h.send(n)},getCachedBroadcast:function(e){h.send({message_type:"broadcast_cache_req",key:e.key})},getWebrtcInfo:f(function(){h.send({message_type:"webrtc_info_req",route:"master",class_id:c.get("class.id"),user_id:c.get("user.id"),webrtc_type:c.get("class.webrtcType"),update_token:c.get("class.webrtcType")===u.WEBRTC_TYPE_AGORA?u.TOKEN_GENERATE_TYPE.SINGLE_CHANNEL:u.TOKEN_GENERATE_TYPE.DEFAULT})},1e3),trace:function(e){var t=c.get("user");h.send({message_type:"trace",data:{class:c.get("class"),user:{id:t.id,number:t.number,type:t.type,name:t.name,avatar:t.avatar,status:t.status,end_type:t.endType},data:(0,r.default)(e)}})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(5),r=n(79);t.messageTypes={cloud_record_stop:function(e){i.trigger(i.CLOUD_RECORD_END_TRIGGER)},cloud_record_command_accept:function(e){i.trigger(i.CLOUD_RECORD_COMMAND_ACCEPT,{command:e.command})}},t.methods={recordShapeClean:function(e){r.send({message_type:"record_shape_clean_req",class_id:e.classId,user_id:e.userId})},startCloudRecord:function(){r.send({message_type:"cloud_record_command_send",command:"start_processing"})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(43),r=n(5),a=n(137),o=n(79),s=n(109);t.messageTypes={doc_all_res:function(e){var t=$.map(e.doc_list||[],function(e){return i(e)});$.each(t,function(e,t){var n=[],i=0,r=t.pageInfo,o=t.pageInfo.pageIds,s=r.width,u=r.height,c=r.urlPrefix,l=+r.totalPages,d=r.isDoc,_=r.url;if(!a.isWhiteboardDoc(t.id)||o&&o.length||(o=[0],t.pageInfo.pageIds=o),d)for(;i<l;)n[i]={width:s,height:u,url:c+"_"+ ++i+".png"};else Yox.is.array(o)&&a.isWhiteboardDoc(t.id)?Yox.array.each(o,function(e,t){n[t]={width:s,height:u,url:_,pageId:e}}):n[i]={width:s,height:u,url:_};t.extra&&null!=t.extra.scale&&(t.extra.scale=+t.extra.scale),t.pageList=n}),r.trigger(r.DOC_ALL_RES,{oldDocList:a.all(),docList:t});var n=e.doc_id,o=e.page,s=e.step,u=e.page_id;a.getDocumentById(n)||(n=o=0,s=null),a.isWhiteboardDoc(n)&&u&&(o=a.getPageById(n,u)),-1===a.getSimplePage(n,o).page&&(n="0",o=0);var c={docId:n,page:o};Yox.is.number(s)&&(c.step=s),a.update(n,{page:c.page,step:c.step}),r.trigger(r.SERVER_PAGE_CHANGE,c)},doc_add:function(e){var t=e.doc.page_info,n=t.total_pages,a=t.is_doc,o=0;if(e.doc.page_list=[],a)for(;o<n;)e.doc.page_list[o]={width:t.width,height:t.height,url:t.url_prefix+"_"+ ++o+".png"};else e.doc.page_list[o]={width:t.width,height:t.height,url:t.url};s(e.user_id,function(){r.trigger(r.DOC_ADD,{fromId:e.user_id,doc:i(e.doc)})})},doc_update:function(e){var t=i(e.extra);null!=t.scale&&(t.scale=+t.scale),r.trigger(r.DOC_UPDATE,{fromId:e.user_id,docId:e.doc_id,extra:t})},doc_del:function(e){s(e.user_id,function(){var t=a.remove(e.doc_id);r.trigger(r.DOC_REMOVE,{fromId:e.user_id,docId:t.id,docNumber:t.number})})},doc_attach_res:function(e){r.trigger(r.DOC_ATTACH_RES,{code:e.code})},doc_detach_res:function(e){r.trigger(r.DOC_DETACH_RES,{code:e.code})},doc_library_list_res:function(e){r.trigger(r.DOC_LIBRARY_LIST_RES,{docList:e.doc_list})}},t.methods={attachDoc:function(e){o.send({message_type:"doc_attach_req",doc:{number:e.number,name:e.name,ext:e.ext,fid:e.number,sn:e.sn}})},detachDoc:function(e){o.send({message_type:"doc_detach_req",doc:{number:e.number,name:e.name,ext:e.ext,fid:e.number,sn:e.sn}})},getDocLibraryList:function(){o.send({message_type:"doc_library_list_req"})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(300),r=n(5),a=n(79),o=n(43);t.messageTypes={h5_doc_all_res:function(e){e=o(e),i.add(e.docList),r.trigger(r.H5_DOC_ALL_RES,{docList:e.docList})},h5_doc_add:function(e){var t=o(e.doc);i.add(t),r.trigger(r.H5_DOC_ADD,{doc:t})},h5_doc_del:function(e){i.remove(e.doc_id),r.trigger(r.H5_DOC_REMOVE,{fromId:e.user_id,docId:e.doc_id})},h5_doc_update:function(e){i.update(e.doc_id,e.visible),r.trigger(r.H5_DOC_UPDATE,{fromId:e.user_id,docId:e.doc_id,visible:e.visible})}},r.on(r.H5_DOC_ALL_REQ,function(){a.send({message_type:"h5_doc_all_req"})}).on(r.H5_DOC_ADD_TRIGGER,function(e,t){var n=t.doc;n&&a.send({message_type:"h5_doc_add_trigger",doc:{number:n.number,ext:n.ext,name:n.name,url:n.url,cover_url:n.coverUrl}})}).on(r.H5_DOC_REMOVE_TRIGGER,function(e,t){a.send({message_type:"h5_doc_del_trigger",doc_id:t.docId})}).on(r.H5_DOC_UPDATE_TRIGGER,function(e,t){a.send({message_type:"h5_doc_update_trigger",doc_id:t.docId,visible:t.visible})})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(26),r=n(5),a=n(43);t.messageTypes={message_send_forbid:function(e){var t=a(e.from),n=a(e.to);r.trigger(r.MESSAGE_SEND_FORBID,{from:t,to:n,forbidSelf:i.isSelf(n.id),duration:e.duration})},message_send_forbid_all:function(e){r.trigger(r.MESSAGE_SEND_FORBID_ALL,{from:a(e.from),duration:e.duration,group:e.group})},message_send_forbid_all_res:function(e){r.trigger(r.MESSAGE_SEND_FORBID_ALL_RES,{duration:e.duration,superDuration:e.super_duration,group:e.group})},get_forbid_list_res:function(e){r.trigger(r.FORBID_USER_ALL_LIST_RES,{userList:e.user_list?e.user_list:[]})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(5),r=n(43);t.messageTypes={group_size_res:function(e){i.trigger(i.GROUP_SIZE_RES,e.group_size)},group_info:function(e){i.trigger(i.GROUP_INFO,{groups:e.groups||[]})},group_info_update:function(e){i.trigger(i.GROUP_INFO_UPDATE,{groups:r(e.groups)})},group_member_update:function(e){i.trigger(i.GROUP_MEMBER_UPDATE,{groups:r(e.groups)})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(26),r=n(5),a=n(43);t.messageTypes={lottery_complete_res:function(e){i.isAudition()||r.trigger(r.LOTTERY_COMPLETE_RES,{complete:e.complete,lotteryCode:e.lottery_code,lotteryNumber:e.lottery_number,lotteryName:e.lottery_name})},lottery_receive:function(e){i.isAudition()||r.trigger(r.LOTTERY_RECEIVE,{lotteryName:e.lottery_name,lotteryNumber:e.lottery_number})},lottery_draw_res:function(e){i.isAudition()||r.trigger(r.LOTTERY_DRAW_RES,{isWin:e.win,lotteryCode:e.lottery_code})},lottery_result_res:function(e){if(!i.isAudition()){var t=e.winner_list;t.length&&(t=a(t)),r.trigger(r.LOTTERY_RESULT_RES,{winnerList:t,lotteryName:e.lottery_name,lotteryNumber:e.lottery_number})}}},t.methods={}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(5);t.messageTypes={notice_change:function(e){i.trigger(e.is_sticky?i.STICKY_NOTICE_CHANGE:i.NOTICE_CHANGE,{content:e.content,link:e.link,isSticky:e.is_sticky,group:e.group})},notice_res:function(e){i.trigger(e.is_sticky?i.STICKY_NOTICE_RES:i.NOTICE_RES,{content:e.content,link:e.link,isSticky:e.is_sticky,group:e.group,sGroup:e.s_group})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(137),r=n(5),a=n(109);t.messageTypes={page_change:function(e){a(e.user_id,function(){var t={docId:e.doc_id,page:i.isWhiteboardDoc(e.doc_id)?i.getPageById(e.doc_id,e.page_id):e.page,fromId:e.user_id};Yox.is.number(e.step)&&(t.step=e.step),e.event&&(t.event=e.event),e.ts&&(t.ts=e.ts),r.trigger(r.SERVER_PAGE_CHANGE,t)},e.message_type)},page_add:function(e){-1!==e.page_id&&i.addPage(e.doc_id,e.page_id)},page_del:function(e){i.deletePage(e.doc_id,e.page_id)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(26),r=n(5);t.messageTypes={roll_call:function(e){i.isAudition()||r.trigger(r.ROLL_CALL,{duration:e.duration,fromId:e.user_id})},roll_call_result:function(e){i.isAudition()||r.trigger(r.ROLL_CALL_RESULT,{sessionId:e.session_id,ackList:e.ack_list,nackList:e.nack_list})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(137),r=n(5),a=n(344),o=n(109);t.messageTypes={shape_all_res:function(e){var t=e.shape_list||[],n=e.shape_append_list||[];$.each(t,function(e,t){t.points=a(t)}),r.trigger(r.SHAPE_ALL_RES,{docId:e.doc_id,page:i.getLocalPage(e.doc_id,e.page),layer:e.layer,shapeList:t}),n.length&&o(n[0].userId,function(){n.forEach(function(t){t.points=a(t),r.trigger(r.SHAPE_APPEND,{fromId:t.userId,docId:e.doc_id,page:i.getLocalPage(e.doc_id,e.page),layer:e.layer,shape:t})})})},shape_add:function(e){o(e.user_id,function(){var t=e.shape;t.points=a(t),r.trigger(r.SHAPE_ADD,{fromId:e.user_id,docId:e.doc_id,page:i.getLocalPage(e.doc_id,e.page),layer:e.layer,shape:t})})},shape_append:function(e){o(e.user_id,function(){var t=e.shape;t.points=a(t),r.trigger(r.SHAPE_APPEND,{fromId:e.user_id,docId:e.doc_id,page:i.getLocalPage(e.doc_id,e.page),layer:e.layer,shape:t})})},shape_del:function(e){e.record_clean?r.trigger(r.RECORD_SHAPE_CLEAN):o(e.user_id,function(){r.trigger(r.SHAPE_REMOVE,{fromId:e.user_id,docId:e.doc_id,page:i.getLocalPage(e.doc_id,e.page),layer:e.layer,shapeId:e.shape_id||""})})},shape_update:function(e){o(e.user_id,function(){var t=e.shape_list;$.each(t,function(e,t){t.points=a(t)}),r.trigger(r.SHAPE_UPDATE,{fromId:e.user_id,docId:e.doc_id,page:i.getLocalPage(e.doc_id,e.page),layer:e.layer,shapeList:t})})},shape_laser:function(e){o(e.user_id,function(){r.trigger(r.SHAPE_LASER,{fromId:e.user_id,docId:e.doc_id,page:i.getLocalPage(e.doc_id,e.page),layer:e.layer,shape:e.shape})})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(26),r=n(5),a=n(11),o=n(79),s=n(43),u=n(239);t.messageTypes={speak_apply_req:function(e){r.trigger(r.SPEAK_APPLY_REQ,{user:s(e.from)})},speak_apply_res:function(e){r.trigger(r.SPEAK_APPLY_RES,{speakState:e.speak_state,user:s(e.user),fromId:e.user_id})},speak_invite_req:function(e){r.trigger(r.SPEAK_INVITE_REQ,{to:e.to,invite:e.invite})},speak_invite_res:function(e){i.isAudition()||r.trigger(r.SPEAK_INVITE_RES,{confirm:e.confirm,fromId:e.user_id})},speak_invite_pending_list:function(e){if(!i.isAudition()){var t=e.user_list;t&&r.trigger(r.SPEAK_INVITE_PENDING_LIST,{userIdList:t})}},speak_apply_res_result:function(e){r.trigger(r.SPEAK_APPLY_ACCEPT_RESULT,{userId:e.user.id,success:e.speak_state===a.SPEAK_STATE_FREE})},speak_invite_deny:function(e){r.has(r.SPEAK_INVITE_DENY)?r.trigger(r.SPEAK_INVITE_DENY,e):u("发言人数已满，请先关闭其他人的音视频。")}},t.methods={changeSpeakState:function(e){o.send({message_type:"speak_state_change_trigger",speak_state:e})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(26),r=n(5),a=n(43);t.messageTypes={survey_prev_res:function(e){i.isAudition()||(e=a(e),r.trigger(r.SURVEY_PREV_RES,{isEnded:e.isEnded,surveyList:e.surveyList,goldMedalCount:e.goldMedalCount,silverMedalCount:e.silverMedalCount}))},survey_receive:function(e){if(!i.isAudition()){var t=e.survey_list;t&&(t=a(t)),r.trigger(r.SURVEY_QUESTION_RECEIVE,{surveyList:t})}},survey_del_receive:function(e){i.isAudition()||r.trigger(r.SURVEY_QUESTION_DELETE_RECEIVE,e)},survey_close_receive:function(){i.isAudition()||r.trigger(r.SURVEY_QUESTION_END_RECEIVE)},survey_clear_res:function(){i.isAudition()||r.trigger(r.SURVEY_QUESTION_CLEAR_RECEIVE)},survey_answer_count:function(e){var t=e.survey_list;t&&(t=a(t)),r.trigger(r.SURVEY_ANSWER_COUNT,{surveyList:t})},survey_answer_user:function(e){var t=e.survey_list;t&&(t=a(t)),r.trigger(r.SURVEY_ANSWER_USER,{surveyList:t})},answer_submit_res:function(e){var t=e.options;r.trigger(r.ANSWER_SUBMIT_RES,{options:t})}},t.methods={}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(55),r=n(95),a=n(7),o=n(26),s=n(5),u=n(43),c=n(301);t.messageTypes={user_active_res:function(e){var t=$.map(e.user_list||[],function(e){return(e=u(e)).mediaExt&&(e.mediaExt=$.map(e.mediaExt,function(e){return u(e)})),e});Yox.nextTick(function(){var n=e.presenter_id;if(a.set("presenterId",n),s.trigger(s.USER_ACTIVE_RES,{userList:t}),n){var i=r.find(n);i?a.set("presenter",i):a.set("presenterId","")}if(e.mix_stream){var o=e.mix_stream;o.user={id:o.id,name:o.name,type:o.type,number:o.number,avatar:o.avatar,status:o.status,end_type:o.end_type},c.messageTypes.media_publish_mix(o)}})},user_active_add:function(e){r.updateActive(e.user.id,!0)},user_active_add_deny:function(e){var t=e.user;r.find(t.id)&&s.trigger(s.USER_ACTIVE_ADD_DENY,{user:e.user,code:e.code})},user_active_remove:function(e){r.updateActive(e.user.id,!1)},user_in:function(e){var t=e.user;if(t.mediaExtMap={},!o.isSelf(t.id)){t=u(t);var n,i=function(){s.trigger(s.USER_IN,{user:t})};if(o.isTeacher(t.type)){var c=a.get("teacher.id");c&&(n=r.find(c))}else n=r.findByNumber(t.number);n?((n.videoOn||n.audioOn)&&s.trigger(s.MEDIA_PUBLISH,{videoOn:!1,audioOn:!1,user:n,linkType:n.linkType}),s.trigger(s.USER_OUT,{user:n}),a.get("playback")?i():Yox.nextTick(i)):i()}},user_out:function(e){var t=e.user_id,n=r.find(t);n&&s.trigger(s.USER_OUT,{user:n})},user_more_res:function(e){var t=$.map(e.user_list||[],function(e){return u(e)}),n={hasMore:e.has_more,userList:t};null!=e.group&&(n.group=e.group),s.trigger(s.USER_MORE_RES,n)},user_update:function(e){var t=u(e);s.trigger(s.USER_UPDATE_RES,t),i.set(t.userNumber+"",t.user.cameraCover)},blocked_user_list_res:function(e){var t=$.map(e.blocked_user_list||[],function(e){return u(e)});s.trigger(s.BLOCKED_USER_LIST_RES,{blockedUserList:t})},blocked_user:function(e){s.trigger(s.USER_BLOCKED,{blockedUser:u(e.user)})},blocked_user_free_trigger_res:function(e){s.trigger(s.USER_UNBLOCK,{number:e.number})},blocked_user_free_all_trigger_res:function(e){s.trigger(s.ALL_USERS_UNBLOCK)},user_count_change:function(e){s.trigger(s.USER_COUNT_CHANGE,{userCount:e.user_count,accumulativeUserCount:e.accumulative_user_count,groupCount:e.group_cnt})},user_state_res:function(e){s.trigger(s.USER_STATE_RES,{userNumber:e.user_number,userState:u(e.user_state)})},user_search_res:function(e){var t=$.map(e.result||[],function(e){return u(e)});s.trigger(s.USER_SEARCH_RES,{result:t})},user_fuzzy_query_res:function(e){var t=[];Yox.array.each(e.user_list,function(e,n){t.push(u(JSON.parse(e)))}),r.add(t),s.trigger(s.USER_FUZZY_QUERY_RES,{userList:t})},student_list_res:function(e){var t=e.students;s.trigger(s.STUDENT_LIST_RES,{studentList:u(t)})},get_virtual_user_number_res:function(e){s.trigger(s.GET_VIRTUAL_USER_NUMBER_RES,e)}},t.methods={}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(7),r=n(5),a=n(79);t.messageTypes={customcast_cache_res:function(e){r.trigger(r.CUSTOMCAST_CACHE_RES,{key:e.key,value:e.value,fromId:e.user_id})},customcast_receive:function(e){r.trigger(r.CUSTOMCAST_RECEIVE,{fromId:e.user_id,key:e.key,value:e.value})}},t.methods={sendCustomcast:function(e){var t=e.options||{};a.send({message_type:"customcast_send",options:{cache:null!=t.cache&&t.cache,all:null==t.all||t.all},key:e.key,value:e.value||{},role:i.get("user.type")})},getCachedCustomcast:function(e){a.send({message_type:"customcast_cache_req",key:e.key})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.ADMIN_AUTH_SPEAK_CHANGE="admin_auth_speak_change",t.ADMIN_AUTH_PAINTER_CHANGE="admin_auth_painter_change",t.ADMIN_AUTH_DOCUMENT_CONTROL_CHANGE="admin_auth_document_control_change",t.ADMIN_AUTH_DOCUMENT_UPLOAD_CHANGE="admin_auth_document_upload_change",t.ADMIN_AUTH_NOTICE_CHANGE="admin_auth_notice_change",t.ADMIN_AUTH_FORBID_AND_KICK_CHANGE="admin_auth_forbid_and_kick_change",t.ADMIN_AUTH_CLASS_START_END_CHANGE="admin_auth_class_start_end_change",t.ADMIN_AUTH_CLOUD_RECORD_CHANGE="admin_auth_cloud_record_change"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.AUTH_CONFIG_ITEM_SPEAK="speak",t.AUTH_CONFIG_ITEM_PAINTER="painter",t.AUTH_CONFIG_ITEM_DOCUMENT_CONTROL="document_control",t.AUTH_CONFIG_ITEM_DOCUMENT_UPLOAD="document_upload",t.AUTH_CONFIG_ITEM_NOTICE="notice",t.AUTH_CONFIG_ITEM_FORBID_AND_KICK="forbid_and_kick",t.AUTH_CONFIG_ITEM_CLASS_START_END="class_start_end",t.AUTH_CONFIG_ITEM_CLOUD_RECORD="cloud_record",t.DEFAULT_AUTH_ROLE_TEACHER_SPEAK=1,t.DEFAULT_AUTH_ROLE_TEACHER_PAINTER=1,t.DEFAULT_AUTH_ROLE_TEACHER_DOCUMENT_CONTROL=1,t.DEFAULT_AUTH_ROLE_TEACHER_DOCUMENT_UPLOAD=1,t.DEFAULT_AUTH_ROLE_TEACHER_NOTICE=1,t.DEFAULT_AUTH_ROLE_TEACHER_CLASS_START_END=1,t.DEFAULT_AUTH_ROLE_TEACHER_CLOUD_RECORD=1,t.DEFAULT_AUTH_ROLE_TEACHER_FORBID_AND_KICK=1,t.DEFAULT_AUTH_ROLE_ASSISTANT_SPEAK=1,t.DEFAULT_AUTH_ROLE_ASSISTANT_PAINTER=1,t.DEFAULT_AUTH_ROLE_ASSISTANT_DOCUMENT_CONTROL=1,t.DEFAULT_AUTH_ROLE_ASSISTANT_DOCUMENT_UPLOAD=1,t.DEFAULT_AUTH_ROLE_ASSISTANT_NOTICE=1,t.DEFAULT_AUTH_ROLE_ASSISTANT_FORBID_AND_KICK=1,t.DEFAULT_AUTH_ROLE_ASSISTANT_CLASS_START_END=1,t.DEFAULT_AUTH_ROLE_ASSISTANT_CLOUD_RECORD=1}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r,a,o=n(26),s=n(7),u=n(11),c=n(5),l=n(138),d=(n(234),n(198),n(31)),_=n(118),f=0,p=1,h=2,g=0,E=2,v=0,m=1,S=2,A=0,y=1,T=1,R=2,I=3,C=4,O=5,b=g,L={},D=0,N=0,P=-1;function k(e){if(e){if(e.name)return e.name;if(e.tag){var t=e.tag;return"default"===t&&e.ip&&(t=e.ip.split("-")[0].substring(4)),t}return e.ip}return null}function w(){if(s.get("class.type",P),s.get("class.type")===u.CLASS_TYPE_SMALLCOURSE)return m;var e=s.get("partner.templateName",P);return BJY.isLive||"singleVideo"===e||"docVideo"===e||"docAudio"===e?S:v}function U(e,t,n){if(n.videoOn){if("number"==typeof e&&"number"==typeof t){var i=e*t;return i<57600?y:i<230400?T:i<518400?R:i<921600?I:i<2073600?C:O}return P}return n.audioOn?A:P}function M(){if(b===g)return{};var e=[],t=[],n=[],i=[];Yox.object.each(L,function(r,a){Yox.is.object(r)&&(e.push(r.blockType),t.push(r.downWh),n.push(r.downLink),i.push(r.downServer))});var r={blockType:e.join(","),downWh:t.join(","),downLink:n.join(","),downServer:i.join(",")};return L.upServer&&(r.upServer=L.upServer),L.upLink&&(r.upLink=L.upLink),L.upWh&&(r.upWh=L.upWh),r}function x(e,t){$.ajax({url:a,data:e,dataType:"jsonp"}),t||(b=g,D=0,N=0,L={})}function V(){var e,t=$.Deferred(),n=l.getCameraConfig(l.getCameraQuality(),l.getCameraRatio(),!1),i=BJY.Player.instances[s.get("user.id")],r={event:b,partner:s.get("partner.partnerId",P),product:w(),room:s.get("class.id",null),uid:s.get("user.id",null),unum:s.get("user.number",null),uname:s.get("user.name",null),urole:s.get("user.type",P),sdk:BJY.version,client:s.get("user.endType",P),device:BJY.os.name+":"+BJY.os.version+"/"+BJY.browser.name+":"+BJY.browser.version,upLink:P,upBlockCnt:D,downBlockCnt:N,upServer:null,upWh:P,fps:null,lossRate:null,cpu:null,mem:null,presenter:o.isPresenter()?1:0,upCnt:s.get("user.audioOn")||s.get("user.videoOn")?1:0,downCnt:(e=0,Yox.object.each(BJY.Player.instances,function(t,n){t.isPull()&&(t.videoOn||t.audioOn)&&e++}),e)};function a(){_()&&BJY.cef?BJY.cef.getSystemResourceStatus().then(function(e){r.cpu=e.cpuLoad,r.mem=100-Math.floor(e.freePhysicalMemory/e.totalPhysicalMemory*100),t.resolve(r)}):setTimeout(function(){t.resolve(r)},0)}if(i&&(s.get("user.videoOn")||s.get("user.audioOn"))){s.get("user.endType")!==u.END_TYPE_MOBILE_BROWSER&&(o.isWebRTC()?r.upLink=h:s.get("class.uplinkType")===u.LINK_TYPE_UDP?r.upLink=f:s.get("class.uplinkType")===u.LINK_TYPE_TCP&&(r.upLink=p)),r.lossRate=i.getUplinkVideoLossRate();var c=i.getServer();c&&(r.upServer=k(c.getActiveUplinkServer())),r.fps=n.cameraFps,i.getStreamResolution().then(function(e){e.width&&e.height&&(r.upWh=U(e.width,e.height,i)),a()},function(){a()})}else a();return t}function G(e,t){t&&V().then(function(n){var i;n.event=E,n.failType=e,n.downWh=P,n.downLink=P,n.downServer=null,t.isPull()?(n.downLink=t.isWebRTC()?t.isWebRTCMixPull()?p:h:t.linkType===u.LINK_TYPE_UDP?f:p,(i=t.getServer())&&(n.downServer=k(i.getActiveDownlinkServer()))):t.isPush()&&(n.upLink=t.isWebRTC()?h:t.linkType===u.LINK_TYPE_UDP?f:p,(i=t.getServer())&&(n.upServer=k(i.getActiveUplinkServer()))),t.isPull()?t.getStreamResolution().then(function(e){n.downWh=U(e.width,e.height,t),x(n,!0)},function(){x(n,!0)}):x(n,!0)})}function B(e,t){V().then(function(n){n.event=E,n.failType=e,n.downWh=P,n.downLink=P,n.downServer=null,t&&(n=t(n)),x(n,!0)})}t.setLogTypeDataServerFail=function(e){B(0,function(t){return e.class&&(t.product=e.class.type||P,t.room=e.class.id||null),e.user&&(t.uid=e.user.id||null,t.unum=e.user.number||null,t.uname=e.user.name||null,t.urole=e.user.type||P,t.client=e.user.endType||P),t})},t.setLogTypeMediaServerFail=function(e){e&&G(3,e)},t.setLogTypeBlock=function(e){if(e){var t,n={};e.isPush()?(n.blockType=0,D++):(n.blockType=1,N++),b=1,n.downWh=P,n.downLink=P,n.downServer=P,e.isPull()?(n.downLink=e.isWebRTC()?e.isWebRTCMixPull()?p:h:e.linkType===u.LINK_TYPE_UDP?f:p,(t=e.getServer())&&(n.downServer=k(t.getActiveDownlinkServer()))):e.isPush()&&(L.upLink=e.isWebRTC()?h:e.linkType===u.LINK_TYPE_UDP?f:p,(t=e.getServer())&&(L.upServer=k(t.getActiveUplinkServer()))),r=!0,e.getStreamResolution().then(function(t){t.width&&t.height&&(e.isPull()?n.downWh=U(t.width,t.height,e):L.upWh=U(t.width,t.height,e)),L[e.id]=n,r=!1},function(){L[e.id]=n,r=!1})}},t.init=function(e){BJY.Player&&(a=function(e){return e||(e=/test(-at)?(\S*)baijiayun.com/.test(location.host)?"test":/beta(-at)?(\S*)baijiayun.com/.test(location.host)?"beta":"production"),e="test"===e?e+"-":"",location.protocol+"//"+e+"qs.baijiayun.com/heart"}(e),new d({task:function(){V().then(function(e){r?setTimeout(function(){x(e=Yox.object.extend(e,M()))},200):x(e=Yox.object.extend(e,M()))})},interval:60*u.SECOND}).start(),c.on(c.MASTER_SERVER_CONNECT_FAIL,function(e,t){B(1)}).on(c.MASTER_SERVER_CONNECT_TIMEOUT,function(e,t){B(1)}).on(c.ROOM_SERVER_CONNECT_FAIL,function(e,t){B(2)}).on(c.ROOM_SERVER_CONNECT_TIMEOUT,function(e,t){B(2)}).on(c.AV_PLAY_FAIL,function(e,t){G(4,t.player)}).on(c.AV_PLAY_CONNECT_FAIL,function(e,t){G(4,t.player)}).on(c.AV_PUBLISH_FAIL,function(e,t){G(5,t.player)}).on(c.AV_PUBLISH_CONNECT_FAIL,function(e,t){G(5,t.player)}))}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(4);t.init=function(){var e=[8];r.document.on("keydown",function(t){var n=document.activeElement;n&&n.tagName||Yox.array.has(e,t.keyCode)&&t.preventDefault()})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(26),r=n(7),a=n(5),o=n(307);t.init=function(){var e,t=o(),s=!1;function u(e){BJY.cef.desktopNotification(e.content)}function c(e){e.title=e.title||r.get("class.title",""),new Notification(e.title,{icon:e.icon,body:e.content})}a.one(a.VIEW_RENDER_TRIGGER,function(){if(!i.isWebRTCRecord()&&(r.get("cefApiVersion")>="7.3.0"?e=u:"Notification"in window&&("granted"===Notification.permission?e=c:Notification.requestPermission(function(t){"granted"===t&&(e=c)})),e)){var o=n(47)(e,5e3,!0);a.on(a.OS_NOTIFY,function(e,t){s&&o(t)}),a.SPEAK_APPLYING_ADD&&a.on(a.SPEAK_APPLYING_ADD,function(){s&&o({content:t.OS_NOTIFY_SPEAK_APPLY})}),window.addEventListener("focus",function(){s=!1}),window.addEventListener("blur",function(){s=!0})}})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){t.UNKNOW_EMOTION="[Unknown Emotion]",t.OS_NOTIFY_SPEAK_APPLY="Someone is applying to speak"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){t.UNKNOW_EMOTION="[不支持的表情]",t.OS_NOTIFY_SPEAK_APPLY="教室内有学生举手"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){t.UNKNOW_EMOTION="[不支持的表情]",t.OS_NOTIFY_SPEAK_APPLY="教室内有学生举手"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(431),a=n(7),o=n(5),s=n(118);t.init=function(){var e=r.support,t=s();o.on(o.FULLSCREEN_EXIT_TRIGGER,function(n,i){a.get("fullscreen")&&(a.set("fullscreen",!1),e&&!t&&r.exit(),o.trigger(o.FULLSCREEN_EXIT,i))}).on(o.FULLSCREEN_ENTER_TRIGGER,function(n,i){a.get("fullscreen")||(a.set("fullscreen",!0),e&&!t&&r.enter(),o.trigger(o.FULLSCREEN_ENTER,i))})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";var i,r,a,o=document.documentElement,s=$.noop;o.requestFullscreen?(i=function(){o.requestFullscreen()},r=function(){document.exitFullscreen()},a=function(e){document.addEventListener("fullscreenchange",function(){e(document.fullscreen)})}):o.webkitRequestFullScreen?(i=function(){o.webkitRequestFullScreen()},r=function(){document.webkitCancelFullScreen()},a=function(e){document.addEventListener("webkitfullscreenchange",function(){e(document.webkitIsFullScreen)})}):o.mozRequestFullScreen?(i=function(){o.mozRequestFullScreen()},r=function(){document.mozCancelFullScreen()},a=function(e){document.addEventListener("mozfullscreenchange",function(){e(document.mozFullScreen)})}):i=r=a=s,t.enter=i,t.exit=r,t.change=a,t.support=a!==s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t,i){var a=n(11),o=n(7),s=n(95),u=n(53),c=document.createElement("canvas"),l=c.getContext("2d"),d={getIndexById:function(e){e||(e=o.get("user.id"));var t=s.active().slice();return t.sort(this.sortRule),t.findIndex(function(t){return t.id===e})},sortRule:function(e,t){return e.type===a.ROLE_TYPE_TEACHER?-1:t.type===a.ROLE_TYPE_TEACHER?1:e.id-t.id}};t.setUserGallery=function(e){d=e},t.uploadSnapshot=function(){var e,t,n,i,a,s,_=(e=document.querySelectorAll('[data-video-on="1"][data-self="1"] video'),t=null,e.forEach(function(e){"none"!==e.style.display&&(t=e)}),t?(c.width=t.videoWidth,c.height=t.videoHeight,l.drawImage(t,0,0,c.width,c.height),c.toDataURL("image/jpeg")):null);n=0,i=_,a=o.get("user"),s={courseId:o.get("class.id"),userId:a.id,userType:a.type,userName:a.name,userNumber:a.number,position:d.getIndexById(),type:n,blob:i},$.ajax({url:u("/collage/upload"),method:"POST",dataType:"json",contentType:"application/json; charset=utf-8",headers:{Authorization:"Token "+o.get("user.webrtcInfo.token")},data:(0,r.default)(s)})},t.userGallery=d}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(5),a={},o={};function s(e){return e||0===e}function u(e){var t=a[e];if(t&&t===o[t.number])return t}t.add=function(e){$.isArray(e)||(e=[e]);var n=[];$.each(e,function(e,i){if(i){var r=i.id,c=i.number;if(s(r)){if(u(r))return;if(0!=c){var l=o[i.number];l&&s(l.id)&&t.remove(l.number)}a[r]=o[c]=i,n.push(i)}}}),n.length>0&&r.trigger(r.FORBID_USER_ADD,{userList:n})},t.remove=function(e){var n=t.findByNumber(e);return!!n&&(delete a[n.id],delete o[e],r.trigger(r.FORBID_USER_REMOVE,{number:e}),!0)},t.removeAll=function(){a={},o={}},t.find=function(e){return u(e)},t.findByNumber=function(e){var t=o[e];return t&&u(t.id)},t.all=function(){var e=[];return $.each(a,function(t){var n=u(t);n&&e.push(n)}),e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(5),a={},o={};function s(e){return e||0===e}function u(e){var t=a[e];if(t&&t===o[t.number])return t}t.add=function(e){$.isArray(e)||(e=[e]);var n=[];$.each(e,function(e,i){if(i){var r=i.id,c=i.number;if(s(r)){if(u(r))return;if(0!=c){var l=o[i.number];l&&s(l.id)&&t.remove(l.id)}a[r]=o[c]=i,n.push(i)}}}),n.length>0&&r.trigger(r.BLOCKED_USER_ADD,{userList:n})},t.remove=function(e){var n=t.findByNumber(e);return!!n&&(delete a[n.id],delete o[e],r.trigger(r.BLOCKED_USER_REMOVE,{number:e}),!0)},t.removeAll=function(){a={},o={},r.trigger(r.ALL_BLOCKED_USERS_REMOVE)},t.find=function(e){return u(e)},t.findByNumber=function(e){var t=o[e];return t&&u(t.id)},t.all=function(){var e=[];return $.each(a,function(t){var n=u(t);n&&e.push(n)}),e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(26),a=n(5),o=n(137),s=0,u=0,c=0,l=0,d=0,_=0,f=0;a.on(a.SERVER_PAGE_CHANGE,function(e,n){var i=o.getSimplePage(n.docId,n.page).page;s=l=i,u=d=n.step,o.setPageChangeStatus(o.PAGE_CHANGE_STATUS_RETURN),t.checkPageChange(!0)}).on(a.CLIENT_PAGE_CHANGE,function(e,t){var n=o.getSimplePage(t.docId,t.page).page;l=n,d=t.step,o.setCanTurningPage(!0)}).on(a.PAGE_CHANGE_TRIGGER,function(e,n){o.setCanTurningPage(!1),o.setPageChangeStatus(o.PAGE_CHANGE_STATUS_TRIGGER),c=(new Date).getTime(),setTimeout(t.checkPageChange,300,!1)}).on(a.MAX_PAGE_CHANGE,function(e,t){_=t.page,f=t.step}),t.hasPrevPage=function(e){return e>0},t.hasNextPage=function(e){return r.canServerPage()?e<o.getWhiteboardPageCount()+o.getDocumentCount()-1:e<s},t.hasPrevStep=function(e,t){return t>0},t.hasNextStep=function(e,t,n){return r.canServerPage()?t<n-1:e!==s?t<n-1:t<u},t.prevPage=function(){if(t.hasPrevPage(l))return l--,!0},t.nextPage=function(){if(t.hasNextPage(l))return l++,!0},t.setClientPage=function(e){e>=0&&(l=e)},t.getClientPage=function(){return l},t.getClientStep=function(){return d},t.getServerPage=function(){return s},t.getServerStep=function(){return u},t.getMaxPage=function(){return _},t.getMaxStep=function(){return f},t.checkPageChange=function(e){var t=(new Date).getTime()-c;(!e||t>=300)&&o.PAGE_CHANGE_STATUS_RETURN===o.getPageChangeStatus()&&o.setCanTurningPage(!0)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(7),r=n(302),a=n(307);t.all=function(){return i.get("partner.customExpression")},t.render=function(e,t){return t?function(e){return'<img src="'+BJY.compressImage({url:e,width:32,height:32})+'" srcset="'+e+' 2x" ondragstart="return false">'}(t):a().UNKNOW_EMOTION},t.stringify=r.stringifyEmoji,t.parse=function(e){return r.parseEmoji(e,t.render)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(71),a=n(72);t.devicePixelRatio=void 0!==window.devicePixelRatio?window.devicePixelRatio:1,t.getDeviceWidth=function(){return r()},t.getDeviceHeight=function(){return a()}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(25),a=n(7),o=n(11),s=n(5),u=n(43),c=n(121),l=n(295),d=n(95),_=n(168),f=n(70),p=n(238),h=n(233),g=n(439),E={server_info_res:function(e){v.serverInfo=e,v.close(),f.addRoomServer(e.room_server,!0),e.parent_room_server&&f.addParentRoomServer(e.parent_room_server,!0),f.addChatServer(e.chat_server,!0),f.addLiveServer(u(e.cdn_domain)),f.setUdpUplinkServerList(e.uplink_server_list),f.setUdpDownlinkServerList(e.downlink_server_list),f.setRoomProxyServerList(u(e.proxy_room_server_list)),e.parent_proxy_room_server_list&&f.setParentRoomProxyServerList(u(e.parent_proxy_room_server_list)),f.setChatProxyServerList(u(e.proxy_chat_server_list)),f.setActiveMasterServer({ip:v.ip,port:v.port}),f.setWebrtcSignalUri(e.webrtc_signal_uri||"webrtc-signal.baijiayun.com:3010");var t=a.get("user");t.id&&d.remove(t.id);var n=l(e.id),i={stable:e.stable,base:e.base,live:u(e.config),"user.id":e.id,"user.id2":n.id2,"user.id3":n.id3,"user.id4":n.id4,"user.ip":e.user_ip,"user.mediaExtMap":{}};e.webrtc_info&&(i["user.webrtcInfo"]=e.webrtc_info),a.set(i),_.add(_.SERVER_INFO_FETCH_SUCCESS),Yox.nextTick(function(){s.trigger(s.SERVER_INFO_FETCH_SUCCESS)})}},v={messageTypes:E,init:function(){v.serverInfo=null;var e=v.socket=new p({interval:o.SECOND,retryCount:o.WEBSOCKET_TRY_CONNECT_COUNT,timeout:o.MASTER_SERVER_CONNECT_TIMEOUT,native:window.WebSocket,onSend:function(e){s.trigger(s.WEBSOCKET_SEND,e)},onReceive:function(e){v.onReceive(e)},onOpen:function(t){$.extend(v,t.server),_.add(_.MASTER_SERVER_CONNECT_SUCCESS),s.trigger(s.MASTER_SERVER_CONNECT_SUCCESS,t);var n=a.get("class"),i=a.get("parentId"),u=n.enrolledStudents,l=n.freeOfCharge,d={message_type:"server_info_req",class_id:a.get("class.id"),class_type:a.get("class.type"),webrtc_type:a.get("class.webrtcType"),update_token:a.get("class.webrtcType")===o.WEBRTC_TYPE_AGORA?o.TOKEN_GENERATE_TYPE.SINGLE_CHANNEL:o.TOKEN_GENERATE_TYPE.DEFAULT,link_capability:a.get("class.linkCapability")||0,teacher_number:a.get("teacher.number"),user_type:a.get("user.type"),live_chat_mode:a.get("partner.liveChatMode"),client_ip:a.get("user.clientIp"),end_type:a.get("user.endType"),enrolled_students:"number"===$.type(u)?u:0,free_of_charge:r(l),special_customer:a.get("partner.specialCustomer",""),udp_foreign_proxy:a.get("partner.liveUdpForeignProxy",0),tcp_foreign_proxy:a.get("partner.liveTcpForeignProxy",0),ms_config:c(a.get("partner.msConfig"))};if(i&&(d.parent_class_id=i),BJY.query.ms_params)try{$.extend(d,JSON.parse(decodeURIComponent(BJY.query.ms_params)))}catch(e){}v.send(d),setTimeout(function(){v.serverInfo||(e.close(),s.trigger(s.SERVER_INFO_FETCH_FAIL))},o.SERVER_INFO_FETCH_TIMEOUT)},onClose:function(){s.trigger(s.WEBSOCKET_CLOSE,this)},onError:function(e){s.trigger(s.MASTER_SERVER_CONNECT_FAIL,e)},onTimeout:function(e){s.trigger(s.MASTER_SERVER_CONNECT_TIMEOUT,e)}}),t=f.getMasterServerList();v.connect(t[0],t.slice(1))},onReceive:function(e){var t=E[e.message_type];t&&t(e),s.trigger(s.WEBSOCKET_RECEIVE,e)},connect:function(e,t){var n=v.socket;n&&n.connect(e,t)},send:function(e){v.socket&&this.socketSend(e)},socketSend:function(e){v.socket.send(e)},close:function(){var e=v.socket;e&&(e.close(),v.socket=null)}};return h.init(v,g),v}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e){var t,i=n(169),a=n(170);function o(){t||(t=BJY.loggerManager.create({prefix:"master",output:{aliServer:!0}}))}return{socketSend:{after:function(e){var n="ms send => "+(0,r.default)(e,a.jsonStringifyReplacer);i.write(n),!t&&o(),t({content:n})}},onReceive:{after:function(e){var n="ms receive => "+(0,r.default)(e,a.jsonStringifyReplacer);i.write(n),!t&&o(),t({content:n})}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(31),a=n(7),o=n(11),s=n(5),u=n(70),c=n(43),l=n(231),d=n(238),_=n(233),f=n(441),p={login_res:function(e){h.startHeartbeat(),0===e.code?s.trigger(s.CHAT_SERVER_LOGIN_SUCCESS,{messageList:c(e.message_list)}):s.trigger(s.CHAT_SERVER_LOGIN_FAIL)},message_receive:function(e){var t=c(e.from);s.trigger(s.MESSAGE_RECEIVE,{id:e.id,time:e.time,content:e.content,channel:e.channel,data:e.data,from:{id:t.id,number:t.number,name:t.name,type:t.type,status:t.status,endType:t.endType,avatar:t.avatar,webrtcSupport:t.webrtcSupport}})},message_whisper_receive:function(e){var t=c(e.from);s.trigger(s.MESSAGE_RECEIVE,{time:e.time,content:e.content,data:e.data,to:e.to,toNumber:e.to_num,from:{id:t.id,number:t.number,name:t.name,type:t.type,status:t.status,endType:t.endType,avatar:t.avatar}})},message_pull_res:function(e){s.trigger(s.MESSAGE_PULL_RES,{next:e.next,channel:e.channel,hasMore:!!e.has_more,messageList:c(e.message_list)})},message_translate_receive:function(e){s.trigger(s.MESSAGE_TRANSLATE_RECEIVE,e)},message_revoke_res:function(e){s.trigger(s.MESSAGE_REVOKE_RES,{id:e.id,fromId:e.from_uid,flag:e.flag})},message_revoke:function(e){s.trigger(s.MESSAGE_REVOKE,{id:e.id,fromId:e.from_uid,operator:e.uid,group:e.group})}},h={messageTypes:p,init:function(){h.socket;h.socket=new d({interval:o.SECOND,retryCount:o.WEBSOCKET_TRY_CONNECT_COUNT,timeout:o.CHAT_SERVER_CONNECT_TIMEOUT,native:window.WebSocket,onSend:function(e){h.onSend(e)},onReceive:function(e){h.onReceive(e)},onOpen:function(e){var t=e.server;$.extend(h,t),u.setActiveChatServer(t),s.trigger(s.CHAT_SERVER_CONNECT_SUCCESS,e),h.login()},onClose:function(){h.onClose()},onError:function(){s.trigger(s.CHAT_SERVER_CONNECT_FAIL)},onTimeout:function(){s.trigger(s.CHAT_SERVER_CONNECT_FAIL)}});var e=u.getChatServerList()[0];e.url=l(e),h.connect(e,u.getChatProxyServerList()),h.heartbeatTimer=new r({task:function(){h.heartbeat()},interval:o.HEARTBEAT_INTERVAL})},connect:function(e,t){var n=h.socket;n&&n.connect(e,t)},login:function(){var e=h.socket,t=a.get("user");e.send({message_type:"login_req",class_id:a.get("class.id"),user:{id:t.id,number:t.number,group:a.get("user.group"),type:t.type,name:t.name,actual_name:t.actualName,avatar:t.avatar,status:t.status,end_type:t.endType}})},startHeartbeat:function(){h.endHeartbeat(),h.heartbeatTimer.start()},endHeartbeat:function(){h.heartbeatTimer.stop()},heartbeat:function(){h.send({message_type:"heart_beat"})},onClose:function(){h.endHeartbeat(),s.trigger(s.WEBSOCKET_CLOSE,this),s.trigger(s.CHAT_SERVER_OFFLINE)},onReceive:function(e){var t=p[e.message_type];t&&t(e),s.trigger(s.WEBSOCKET_RECEIVE,e)},onSend:function(e){s.trigger(s.WEBSOCKET_SEND,e)},send:function(e){var t=h.socket;e.ts=(new Date).getTime(),t&&t.send(e)},close:function(){var e=h.socket;e&&(e.close(),h.socket=null)}};return _.init(h,f),h}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t){var i,a=n(170),o={login_req:1,login_res:1};function s(){i||(i=BJY.loggerManager.create({prefix:"chatServer",output:{server:!0,aliServer:!0,disk:!0}}))}return{onSend:{after:function(e){var t=e.message_type;if("heart_beat"!=t){var n="cs send => "+(0,r.default)(e,a.jsonStringifyReplacer);o[t]&&(!i&&s(),i({content:n}))}}},onReceive:{after:function(e){var t=e.message_type,n="cs receive => "+(0,r.default)(e,a.jsonStringifyReplacer);o[t]&&(!i&&s(),i({content:n}))}},onClose:{after:function(e){!i&&s(),i({content:"cs server closed!!"})}}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(26),r=n(7),a=n(70),o=n(237),s=n(199),u={name:"",ip:"",port:""};function c(){return"NAN"}t.uplinkServerList=[],t.downlinkServerList=[],t.activeUplinkServer=null,t.activeDownlinkServer=null,t.activeUplinkArea,t.activeDownlinkArea,t.init=function(){t.uplinkServerList=t.downlinkServerList=a.getWebrtcServerList()},t.sort=t.fetch=$.noop,t.getUplinkStreamName=c,t.getUplinkAudioMixedStreamName=c,t.getUplinkStreamNamePattern=c,t.getDownlinkStreamName=c,t.getDownlinkAudioMixedStreamName=c,t.getDownlinkStreamNamePattern=c,t.getActiveUplinkServer=function(){return t.activeUplinkServer||u},t.setActiveUplinkServer=function(e){var n=s(e.name);t.activeUplinkServer=e,t.activeUplinkArea=n},t.getActiveDownlinkServer=function(){return t.activeDownlinkServer||u},t.setActiveDownlinkServer=function(e){var n=s(e.name);t.activeDownlinkServer=e,t.activeDownlinkArea=n},t.switchUplinkServer=function(e,n){return t.setActiveUplinkServer(o(t.uplinkServerList,e,n)),t.getActiveUplinkServer()},t.switchDownlinkServer=function(e,n){return t.setActiveDownlinkServer(o(t.downlinkServerList,e,n)),t.getActiveDownlinkServer()},t.getActiveDownlinkArea=function(){var e=r.get("partner.msConfig.assignLanUp",0);return i.isWebRTCRecord()&&(e=0),2===e?"Local":t.activeDownlinkArea},t.setActiveDownlinkArea=function(e){t.activeDownlinkArea=e},t.getActiveUplinkArea=function(){var e=r.get("partner.msConfig.assignLanUp",0);return i.isWebRTCRecord()&&(e=0),2===e?"Local":t.activeUplinkArea},t.setActiveUplinkArea=function(e){t.activeUplinkArea=e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(119));void 0===(i=function(e,t){var i=n(11),a=n(70),o=n(5),s=0;return function(){o.on(o.ROOM_SERVER_OFFLINE,function(e,t){t.type===i.ROOM_SERVER_OFFLINE_BY_SERVER&&a.takeTurnMasterServerList(),s=0}).on(o.HEARTBEAT_RECEIVE,function(e,t){var n=(0,r.default)()-t.ts;(s=n>3e3?s+1:0)>=3&&(a.takeTurnMasterServerList(),o.trigger(o.ROOM_SERVER_OFFLINE))})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t,n){return function(e,t,n,i,a,o){0===n.indexOf("//")&&(n=location.protocol+n);var s=[];return $.each(i||{},function(e,t){null!=t&&""!==t&&($.isPlainObject(t)?t=(0,r.default)(t):$.isArray(t)&&(t=t.join(",")),s.push(e+"="+encodeURIComponent(t)))}),'<object id="'+e+'" '+(null!=a?'width="'+a+'" ':"")+(null!=o?'height="'+o+'" ':"")+'class="'+t+'" type="application/x-shockwave-flash" data="'+n+'"><param name="movie" value="'+n+'" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="wmode" value="opaque" /><param name="flashvars" value="'+s.join("&amp;")+'" /></object>'}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(){return function(e){return 0===e.indexOf("http")&&(e=0===e.indexOf("https")?e.slice(6):e.slice(5)),e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(){return function(e){return/img\.gsxservice\.com/.test(e)||/imgs?\.genshuixue\.com/.test(e)||/imgs?\.baijiayun\.com/.test(e)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e){return e.replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2")}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t){var i=n(269).list;function a(e){e<0&&(e=0),e>1&&(e=1),e=Math.floor(4095*e);var t=Math.floor(e/64),n=e%64;return i[t]+i[n]}return function(e){var t=e.points;if(!Yox.is.array(t))return t;if("Doodle"===e.name&&!e.autoClosePath){var n=[];return t.forEach(function(e){var t=a(e.x)+a(e.y);t!==n[n.length-1]&&n.push(t)}),e.encodeType=2,n.join("")}return e.encodeType=0,(0,r.default)(t)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t,n){return function(e,t,n){var i=BJY.auth,a=BJY.logger;i.canInitiativeGetDevicesAuth()?navigator.mediaDevices.getUserMedia(e).then(function(){t&&t()},function(e){var t,i;e?"NotFoundError"==e.name||"DeviceNotFoundError"==e.name?(t=0,i="未找到摄像头或麦克风"):"NotReadableError"==e.name||"TrackStartError"==e.name?(t=1,i="摄像头或麦克风设备被占用"):"NotAllowedError"==e.name||"PermissionDeniedError"==e.name?(t=2,i="摄像头或麦克风设备被禁用"):(t=3,i="设备错误，请检查你的摄像头和麦克风，flash是否被禁用，或者使用https协议重新进入教室"):(t=3,i="设备错误，请检查你的摄像头和麦克风，flash是否被禁用，或者使用https协议重新进入教室");var o={code:t,text:i};a.danger("devices auth error",(0,r.default)(o)),n&&n(o)}):t&&t()}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t,i){var a=n(55),o=n(232),s=n(306),u=n(169),c=n(451),l=c,d=n(170),_=d,f={prefix:"",output:{console:!0,local:!0,disk:!0,server:!0,aliServer:!1,clickServer:!1}},p="console",h="disk",g="BJY_LOG_BLACK_PREFIX",E="BJY_LOG_WHITE_PREFIX",v=T(g),m=T(E),S={console:{module:o,handle:o.info},local:{module:s,handle:s.log},disk:{module:u,handle:u.write},server:{module:c,handle:c.send},aliServer:{module:l,handle:l.sendToAliyun},clickServer:{module:d,handle:d.send}};function A(e){return m.indexOf(e)>-1||m.indexOf("*")>-1}function y(){a.set(g,(0,r.default)(v)),a.set(E,(0,r.default)(m))}function T(e){try{var t=a.get(e);return t?JSON.parse(t):[]}catch(e){return[]}}function R(e){var t=[],n=e.output;for(var i in n)if(n[i]&&S[i]){var r=S[i];t.push(I(i,e.prefix,r.handle))}return t}function I(e,t,n){var i=n;return e===p?i=function(e){return e&&"string"!=typeof e&&(e=(0,r.default)(e,_.jsonStringifyReplacer)),n.apply(this,[t,e])}:e===h&&(i=function(e,t,n){return function(e){return e&&"string"!=typeof e&&(e=(0,r.default)(e,_.jsonStringifyReplacer)),n.apply(this,[t+e])}}(0,t,n)),{key:e,handler:i}}t.enable=function(e){"*"===e&&(v=[]),-1===m.indexOf(e)&&m.push(e);var t=v.indexOf(e);t>-1&&v.splice(t,1),y()},t.disabled=function(e){"*"===e&&(m=[]),-1===v.indexOf(e)&&v.push(e);var t=m.indexOf(e);t>-1&&m.splice(t,1),y()},t.create=function(e){e?(e.prefix=e.prefix||f.prefix,e.output=e.output||f.output):e=f;var t=R(e);function n(n,i){var r,a=t;if(i?(i.prefix=i.prefix||e.prefix,i.output=i.output||e.output,a=R(i)):i=e,r=i.prefix,-1===v.indexOf(r)&&(-1===v.indexOf("*")||m.indexOf(r)>-1))for(var o in n&&"string"==typeof n?n="[".concat(i.prefix,"]:").concat(n):n.msg="".concat(i.prefix,":").concat(n.msg||""),a){var s=a[o];if(s.key!==p||A(i.prefix))(0,s.handler)(n)}}return n.handlers=t,n}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0),a=r(n(131)),o=r(n(128));void 0===(i=function(e,t){var i,r=n(7),s=n(452),u=n(453),c=[],l=2,d="pending",_="idle",f=2e3;function p(){i||(i=u.init(l,h)),c.length>=f&&c.shift()}function h(){if(0!==c.length&&!r.get("offline")){var e=c.shift();return new a.default(function(t,n){d;var i=$.param(e.data),r=e.url+i,a=new Image,o=function(){a=a.onload=a.onerror=null,_,t()};a.onload=o,a.onerror=function(){o()},a.src=r})}}t.send=function(e,t){p(),t||(t=function(){var e=r.get("env","");!e&&/test(-at)?(\S*)baijiayun.com/.test(location.host)&&(e="test");var t="test"===e?"test-":"";return location.protocol+"//"+t+"qs.baijiayun.com/front_log?"}()),(e=(0,o.default)(s.getParams(),e)).content&&(e.msg=e.msg+e.content,delete e.content),c.push({url:t,data:e})},t.sendToAliyun=function(e){p();var t="test"==r.get("env")?"test-":"";e.classId=r.get("class.id"),e.userId=r.get("user.id"),c.push({data:e,url:"//bjy.cn-beijing.log.aliyuncs.com/logstores/".concat(t,"frontend/track_ua.gif?APIVersion=0.6.0&")})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(7),r=n(11),a=n(229),o=n(196),s={};s[r.END_TYPE_PC_CLIENT]=1,s[r.END_TYPE_PC_BROWSER]=2,s[r.END_TYPE_MOBILE_APPLE]=3,s[r.END_TYPE_MOBILE_ANDROID]=3,s[r.END_TYPE_MOBILE_BROWSER]=4,s[r.END_TYPE_MAC_CLIENT]=5;var u={ie:1,chrome:2,firefox:3,opera:4,safari:5};t.getParams=function(){var e={};e.class_id=i.get("class.id"),e.class_type=i.get("class.type");var t=i.get("user");e.user_id=t.id,e.user_number=t.number,e.user_name=t.name,e.user_type=t.type,e.client_ip=t.ip,e.client_type=s[t.endType],e.browser_type=u[o.name],e.platform=a.ios?"ios":a.name,e.fe_version=BJY.version,e.cef_version=i.get("cefApiVersion"),e.app_version=i.get("appVersion");var n=i.get("partner.partnerId");return e.partner_id=n||r.GSX_PARTNER_ID,i.get("machineCode")&&(e.device_unique=i.get("machineCode")),e.msg=" ",e}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(11),a=n(31);t.init=function(e,t){var n=new a({task:function(){t&&t.apply(t,arguments)},interval:e*r.SECOND});return n.start(),n}}.call(t,n,t,e))||(e.exports=i)},,,,,,function(e,t,n){"use strict";var i,r=n(0)(n(8));void 0===(i=function(e,t,i){var a=n(3),o=BJY.store,s=BJY.auth,u=BJY.config,c=BJY.logger,l=BJY.eventEmitter,d=BJY.camelCaseObject,_=BJY.data.media;$.extend(s,n(460)),$.extend(u,n(461)),$.extend(l,n(462));var f,p=n(321),h=(n(215),n(53)),g=n(139),E=n(463),v={linksInfoReport:1,linksVolumeReport:1,getStreamsInfo:1,logConsole:1,mediaFilePlayPosition:1,upUDPLinkVideoLostRate:1,upUDPLinkAudioLostRate:1};window.onCefCallback=function(e){var n=e.funcName;n=n.charAt(0).toLowerCase()+n.slice(1),v[n]||c.dark("cef callback",n,(0,r.default)(e.params));var i=t.callbacks[n];i&&i(e.params)};var m={GetSpeechLevel:1,GetBitRateReport:1,GetLinksInfo:1,GetLinksVolume:1,GetStreamsInfo:1,SaveLogToDisk:1};function S(e,t){var n=$.Deferred();if(void 0===window.cefQuery)return n;var i={funcName:e=e.charAt(0).toUpperCase()+e.substr(1)};return $.isPlainObject(t)?i.params=t:i.params="",window.DEBUG&&!m[e]&&c.info("cef call",e,(0,r.default)(t)),cefQuery({request:(0,r.default)(i),persistent:!1,onSuccess:function(t){var i=JSON.parse(t),r=0===i.code;window.DEBUG&&!m[e]&&(r?c.success("cef call success",e,t):c.danger("cef call failed",e,t)),r?n.resolve(i.data):n.reject(i)},onFailure:function(e,t){c.danger("cef call failed",e,t),n.reject()}}),n}t.init=function(e,n){var i=$.Deferred();return S("runCNE").then(function(r){var u=a(r&&r.processorType,1);o.set("setting.hardwareDecodeNew",u),function(e){var t,n=$.Deferred(),i=o.get("env");e&&(t=e.latestVersion[i]);return Yox.nextTick(function(){var i;e&&(i=t.version),S("getVersion").then(function(r){var a=r.version,s=r.proVersion;s||(s=a),o.set({cefVersion:s,cefApiVersion:a}),s<i&&s<=e.minVersion?l.trigger(l.CLIENT_UPGRADE_TRIGGER,{url:t.url}):n.resolve()})}),n}(e).then(function(){(function(){var e=$.Deferred();s.canCheckGrayscaleRelease()?t.getAppEnvCode().then(function(n){var i={env:n.env,product:n.product,room_id:o.get("class.id")};$.ajax({url:h("/web/client/getEnv"),data:i,method:"get",dataType:"json"}).done(function(n){if(0==n.code&&n.data){var i=d(n.data);i.needSwitch&&i.updateInfo?t.switchAppEnv({url:window.location.href,env:i.env,window:i.updateInfo.windowsUpdateXml,xp:i.updateInfo.windowsXpUpdateXml,mac:i.updateInfo.macUpdateXml}).then(function(t){e.resolve(t)},function(t){e.reject(!0)}):e.reject()}else e.reject(!0)}).fail(function(t){e.reject(!0)})},function(t){e.reject(!0)}):Yox.nextTick(function(){e.reject()});return e})().then(function(){},function(e){e&&n&&n(),f=!0,l.trigger(l.CLIENT_INIT_SUCCESS),i.resolve()})})},function(){l.trigger(l.CLIENT_INIT_FAIL)}),l.on(l.ROOM_SERVER_LOGIN_SUCCESS,function(){S("setEnterClass",{isEnter:!0}),S("setIdentifier",{userid:o.get("user.id")})}).on(l.CLASSROOM_CONNECT_TRIGGER,function(e,t){t.reconnect&&S("setEnterClass",{isEnter:!1})}).on(l.ROOM_SERVER_OFFLINE,function(){t.restoreClient()}).on(l.SYSTEM_GET_MIC_VOLUME,function(e,t){S("getMicVolumeWR").then(function(e){l.trigger(l.MIC_VOLUME_CHANGE_TRIGGER,{value:e.volume})})}).on(l.SYSTEM_GET_SPEAKER_VOLUME,function(e,t){S("getSpeakerVolumeWR").then(function(e){l.trigger(l.SPEAKER_VOLUME_CHANGE_TRIGGER,{value:e.volume}),l.trigger(l.SPEAKER_MUTE_STATE_CHANGE,{muted:e.mute})})}).on(l.SYSTEM_MIC_VOLUME_CHANGE,function(e,t){S("setMicVolumeWR",{volume:t.volume})}).on(l.SYSTEM_SPEAKER_VOLUME_CHANGE,function(e,t){S("setSpeakerVolumeWR",{volume:t.volume})}).on(l.SYSTEM_MIC_CHANGE,function(e,t){S("setAudioDeviceWR",{micName:t.micName})}).on(l.SYSTEM_SPEAKER_CHANGE,function(e,t){S("setAudioDeviceWR",{speakerName:t.speakerName})}).on(l.CLASSROOM_EXIT_END,function(e,t){t&&"shuntdown_by_user"===t.type?setTimeout(function(){S("shutdown")},500):S("setEnterClass",{isEnter:!1})}).on(l.CLIENT_SHUTDOWN_TRIGGER,function(){S("shutdown")}).on(l.FULLSCREEN_ENTER_TRIGGER,function(e,t){S("toggleFullScreen",{fullscreen:!0,occupiedModel:null!=t.occupiedModel?t.occupiedModel:!!(o.get("user")&&s.isStudent()&&o.get("setting.screenLock"))})}).on(l.FULLSCREEN_EXIT_TRIGGER,function(e,t){S("toggleFullScreen",{fullscreen:!1,occupiedModel:null!=t.occupiedModel?t.occupiedModel:!!(o.get("user")&&s.isStudent()&&o.get("setting.screenLock"))})}).on(l.PAGE_ZOOM_IN_TRIGGER,function(){S("zoomIn")}).on(l.PAGE_ZOOM_OUT_TRIGGER,function(){S("zoomOut")}).on(l.CLIENT_COMMAND_TRIGGER,function(e,t){var n=t.name,i=t.from,r=t.params||{};n=n.charAt(0).toLowerCase()+n.substr(1);var a=o.get("user");r.classId=o.get("class.id"),r.userName=a.name,r.userNumber=a.number,S(n,r).then(function(e){l.trigger(l.CLIENT_COMMAND,{from:i,result:e,name:n,params:r})})}).on(l.SWITCH_VIRTUAL_CAMERA_CHANNEL,function(e,t){S("setBroadcasterChannel",{channel:t.channel})}).on(l.SWITCH_COMPOSE_VIRTUAL_CAMERA,function(e,t){var n=E(t.index);S("setSpecialDisplayType",{type:n.type,picture:n.picture})}).on(l.OPEN_VIRTUAL_CAMERA,function(){S("startNetBroadcaster")}).on(l.CLIENT_SCREENSHOT_TRIGGER,function(e,t){S("startScreenShot",{hideClient:!!t.hideClient})}),t.init=$.noop,i},t.send=function(e,t){if(f)return S(e,t);window.DEBUG&&c.warn("unready cef call",e,t)},t.callbacks={logReport:function(e){l.trigger(l.TRACE_LOG,e)},micRenderAborted:function(e){l.trigger(l.MIC_RENDER_ABORTED,e)},logConsole:function(e){window.DEBUG&&c.light("cef log",e)},shutdown:g(function(){BJY.dispose("shuntdown_by_user")},500),setSpeakerState:function(e){l.trigger(l.SPEAKER_MUTE_STATE_CHANGE,{muted:e.mute})},performanceWarning:function(e){l.trigger(l.WRITE_CNE_LOG,{info:"warning:"+e.data}),l.trigger(l.CPU_MEMORY_PERFORMANCE_WARNING,{warning:e.data})},screenShotFinish:function(){l.trigger(l.CLIENT_SCREENSHOT)},micVolumeChange:function(e){var t=e.volume;t!==_.getMicVolume()&&(_.setMicVolume(t),l.trigger(l.SYSTEM_MIC_VOLUME_CHANGE_CALLBACK,{value:t}))},speakerVolumeChange:function(e){var t=e.volume,n=_.getSpeakerVolume();e.mute!==_.getSpeakerMuteStatus()&&l.trigger(l.SPEAKER_MUTE_STATE_CHANGE,{muted:e.mute}),t!==n&&(_.setSpeakerVolume(t),l.trigger(l.SYSTEM_SPEAKER_VOLUME_CHANGE_CALLBACK,{value:t}))},captureCardSupport:function(e){e.support&&(o.set("supportVirtualCamera",!0),o.set("virtualCameraKey",e.name)),l.trigger(l.VERIFY_CAPTURE_CARD_SUPPORT_CALLBACK)},channelSignalNotify:function(e){l.trigger(l.VIRTUAL_CHANNEL_SIGNAL_NOTIFY,e)},startBroadcasterComplete:function(){l.trigger(l.OPEN_VIRTUAL_CAMERA_COMPLETE)}},t.minimizeClient=function(){S("setMinimize",{isMinimize:!0})},t.restoreClient=function(){o.get("cefApiVersion")>="7.4.0"&&S("setMinimize",{isMinimize:!1})},t.shutdown=function(){S("powerOff")},t.closeClient=function(){S("shutdown")},t.decodeData=function(e){var t=$.Deferred();return S("decodeData",e).then(function(e){if(e){try{e=JSON.parse(e)}catch(e){}t.resolve(e)}else t.reject()}),t},t.getCPUInfo=function(){var e=$.Deferred();return S("getCPUType").then(function(t){t?e.resolve(p(t.replace(/'/g,'"'))):e.reject()}),e},t.getSystemResourceStatus=function(){var e=$.Deferred();return S("getCurrentPerform").then(function(t){t?e.resolve(p(t.replace(/'/g,'"'))):e.reject()}),e},t.getOSVersion=function(){var e=$.Deferred();return S("getOSVersion").then(function(t){t?e.resolve(p(t.replace(/'/g,'"'))):e.reject()}),e},t.getFullScreenState=function(){var e=$.Deferred();return S("getFullscreenState").then(function(t){if(t){var n=1==t.isFullscreen;e.resolve(n)}else e.reject()}),e},t.getMachineCode=function(){var e=$.Deferred();return S("getMachineCode").then(function(t){t?e.resolve(t):e.reject()}),e},t.writeCNELog=function(e){s.canWriteCNELog()&&S("saveLogToDisk",{log:e})},t.setWindowTitle=function(e){e&&S("setWindowTitle",{title:e})},t.getAppEnvCode=function(){var e=$.Deferred();return S("getEnvCode").then(function(t){t?e.resolve(t):e.reject()},function(t){e.reject(t)}),e},t.switchAppEnv=function(e){if(e){var t=$.Deferred();return S("switchEnv",{url:e.url,env:e.env,window:e.window,xp:e.xp,mac:e.mac}).then(function(e){e?t.resolve(e):t.reject()},function(e){t.reject(e)}),t}},t.desktopNotification=function(e){S("desktopNotification",{content:e||""})},t.turnOnMic=function(e){S("turnOnMic",{turnOn:!!e})},BJY.cef=t}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i=BJY.store,r=BJY.config;t.canAddWaterMarkOnLocalRecord=function(){return!1},t.canUseUdpPush=function(){return i.get("cefApiVersion")&&i.get("live.uplinkType")===r.LINK_TYPE_UDP},t.canUseUdpPull=function(){return i.get("cefApiVersion")&&i.get("live.downlinkType")===r.LINK_TYPE_UDP},t.canSetTouchEnable=function(){return i.get("cefApiVersion")&&"windows"===BJY.os.name},t.canWriteCNELog=function(){return i.get("cefApiVersion")>="6.8.0"&&"windows"===BJY.os.name||i.get("cefApiVersion")>="6.8.5"&&"mac"===BJY.os.name},t.canUseHardwareDecodeNew=function(){return i.get("cefApiVersion")>="7.0.1"},t.canSetVolumeSeparately=function(){return i.get("cefApiVersion")>="7.2.0"&&"windows"===BJY.os.name},t.canUseClientScreenshot=function(){return i.get("cefApiVersion")>="7.5.0"},t.canUseVirtualCamera=function(){return i.get("cefApiVersion")>="7.5.0"},t.supportScreenLock=function(){return!!BJY.os.windows&&i.get("cefApiVersion")>="6.5.0"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.AUDIO_REPAIR_NO=1,t.AUDIO_REPAIR_LEFT=2,t.AUDIO_REPAIR_RIGHT=3,t.AUDIO_REPAIR_AUTO=4,t.SCREEN_SHARE_MODE_FULLSCREEN=0,t.SCREEN_SHARE_MODE_PART=1,t.SCREEN_SHARE_MODE_PROGRAM=2,t.RECORD_MODE_PART=1,t.RECORD_MODE_FULLSCREEN=0}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.CLIENT_INIT_SUCCESS="cef_init_success",t.CLIENT_INIT_FAIL="cef_init_fail",t.CLIENT_UPGRADE_TRIGGER="cef_upgrade_trigger",t.CLIENT_SHUTDOWN_TRIGGER="shutdown_trigger",t.CAMERA_OPEN_FAIL="camera_open_fail",t.MIC_OPEN_FAIL="mic_open_fail",t.MIC_CAPTURE_FAIL="mic_capture_fail",t.MIC_RENDER_ABORTED="mic_render_aborted",t.AUDIO_PLAYBACK_ERROR="audio_playback_error",t.SPEAKER_OPEN_FAIL="speaker_open_fail",t.PAGE_ZOOM_IN_TRIGGER="page_zoom_in_trigger",t.PAGE_ZOOM_OUT_TRIGGER="page_zoom_out_trigger",t.SPEAKER_MUTE_STATE_CHANGE="speaker_mute_state_change",t.CPU_MEMORY_PERFORMANCE_WARNING="cpu_memory_performance_warning",t.SYSTEM_MIC_VOLUME_CHANGE_CALLBACK="system_mic_volume_change_callback",t.SYSTEM_SPEAKER_VOLUME_CHANGE_CALLBACK="system_speaker_volume_change_callback",t.WRITE_CNE_LOG="write_cne_log",t.CLIENT_COMMAND_TRIGGER="client_command_trigger",t.CLIENT_COMMAND="client_command",t.SCREEN_SHARE_STOP_TRIGGER="share_desktop_stop_trigger",t.SCREEN_SHARE_STOP="share_desktop_stop",t.SCREEN_SHARE_START_TRIGGER="share_desktop_start_trigger",t.SCREEN_SHARE_START="share_desktop_start",t.SCREEN_SHARE_MODE_CHANGE="share_desktop_mode_change",t.LOCAL_RECORD_ERROR="local_record_error",t.RECORD_FAIL_BY_DISK_NOT_ENOUGH="record_fail_by_disk_not_enough",t.RECORD_FILE_DIRECTORY_REQ="record_file_directory_req",t.RECORD_FILE_DIRECTORY_RES="record_file_directory_res",t.RECORD_FILE_DEFAULT_DIRECTORY_REQ="record_file_default_directory_req",t.RECORD_FILE_DEFAULT_DIRECTORY_RES="record_file_default_directory_res",t.LOCAL_RECORD_START_TRIGGER="local_record_start_trigger",t.LOCAL_RECORD_START="local_record_start",t.LOCAL_RECORD_STOP_TRIGGER="local_record_stop_trigger",t.LOCAL_RECORD_STOP="local_record_stop",t.LOCAL_RECORD_PAUSE_TRIGGER="local_record_pause_trigger",t.LOCAL_RECORD_PAUSE="local_record_pause",t.LOCAL_RECORD_RESTART_TRIGGER="local_record_restart_trigger",t.LOCAL_RECORD_RESTART="local_record_restart",t.RECORD_FILE_FOLDER_POPUP="record_file_folder_popup",t.TOUCH_ENABLE_CHANGE_TRIGGER="touch_enable_change_trigger",t.TEST_SOUND_PLAY_TRIGGER="test_sound_play_trigger",t.TEST_SOUND_STOP_TRIGGER="test_sound_stop_trigger",t.AUDIO_DEVICE_OS_SETTINGS_POPUP_TRIGGER="audio_device_os_settings_popup_trigger",t.VIDEO_DEVICE_OS_SETTINGS_POPUP_TRIGGER="video_device_os_settings_popup_trigger",t.RTMP_AGENT_STATUS_CHANGE="rtmp_agent_status_change",t.UDP_UPLINK_AUDIO_LOST_RATE="udp_uplink_audio_lost_rate",t.UDP_UPLINK_VIDEO_LOST_RATE="udp_uplink_video_lost_rate",t.UDP_UPLINK_AVERAGE_LOST_RATE="udp_uplink_average_lost_rate",t.TCP_UPLINK_PACKETS_DELAY="tcp_uplink_packets_delay",t.TCP_UPLINK_GET_BETTER="tcp_uplink_get_better",t.CLIENT_PLAYER_POPDOWN="client_player_popdown",t.SCREEN_SHARE_ERROR="screen_share_error",t.SYSTEM_MIC_VOLUME_CHANGE="system_mic_volume_change",t.SYSTEM_GET_MIC_VOLUME="system_get_mic_volume",t.SYSTEM_SPEAKER_VOLUME_CHANGE="system_speaker_volume_change",t.SYSTEM_GET_SPEAKER_VOLUME="system_get_speaker_volume",t.SYSTEM_MIC_CHANGE="system_mic_change",t.SYSTEM_SPEAKER_CHANGE="system_speaker_change",t.VERIFY_CAPTURE_CARD_SUPPORT_CALLBACK="verify_capture_card_support_callback",t.VIRTUAL_CHANNEL_SIGNAL_NOTIFY="virtual_channel_siganel_notify",t.CLIENT_SCREENSHOT_TRIGGER="client_screenshot_trigger",t.CLIENT_SCREENSHOT="client_screenshot"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(271),a=BJY.data.media,o=r.CAMERA_LAYOUT_TRIPLE,s=r.CAMERA_LAYOUT_FOUR_PALACE,u=r.TRIPLE_RIGHT,c=r.PALACE_TOP_RIGHT,l=r.PALACE_BOTTOM_LEFT,d=r.PALACE_BOTTOM_RIGHT,_=r.PIP_MAIN,f=r.PIP_TWO_MAIN,p=r.PIP_TWO_SMALL_2;return function(e){var t,n,i=a.getCameraList()[e],h=i.layout,g=i.composeCameraInfo,E=[];return h===o||h===s?(t=r.VIRTUAL_CAMERA_LAYOUT_SPLICE,Yox.object.each(g,function(e,t){n={x:0,y:0,width:960,height:h===o?1080:540,channel:e.channelIndex},t!==u&&t!==c&&t!==d||(n.x=960),t!==l&&t!==d||(n.y=540),E.push(n)})):(t=r.VIRTUAL_CAMERA_LAYOUT_PIP,Yox.object.each(g,function(e,t){n={x:0,y:0,width:1920,height:1080,channel:e.channelIndex,zOrder:0},t!==f&&t!==_&&(n.x=7.5*e.left,n.y=7.5*e.top,n.width=7.5*e.width,n.height=7.5*e.height,n.zOrder=e.zIndex?2:0,t===p&&(n.zOrder=1)),E.push(n)})),{type:t,picture:E}}}.call(t,n,t,e))||(e.exports=i)},,function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=n(3),r=BJY.is,a=BJY.auth,o=BJY.store,s=BJY.config,u=BJY.command,c=BJY.broadcast,l=BJY.eventEmitter,d=BJY.data.media,_=BJY.server.room,f=BJY.data.adminAuth,p=BJY.server.live,h=BJY.server.liveUdp,g=n(275),E=n(276);$.extend(a,n(466)),$.extend(s,n(271)),$.extend(l,n(467)),$.extend(u.messageTypes,n(468)),$.extend(c.messageTypes,n(469));var v=n(470),m=null,S=null,A=0,y=3;function T(e){return Yox.is.boolean(e)?e?1:0:i(e)}function R(e,t){var n=t.index;if($.isNumeric(n))return e[n];var i=t.ip;return i?g(e,i,t.port):void 0}l.on(l.MEDIA_PUBLISH,function(){var e=BJY.Player.instances[o.get("presenterId")];e&&o.get("presenterId")==o.get("user.id")&&_.publishMixAudio({videoOn:e.videoOn,audioOn:e.audioOn,linkType:e.linkType,isScreenSharing:e.isScreenSharing})}).one(l.CLASSROOM_CONNECT_TRIGGER,function(){n(487).init(),n(488).init(),o.watch("class.started",function(e){if(!e){var t=o.get("user"),n=BJY.Player.instances[o.get("user.id")];!function(){if(t.videoOn||t.audioOn){l.on(l.MEDIA_PUBLISH,function e(n,i){i.user.id===t.id&&(o.set({"user.videoOn":null,"user.audioOn":null}),l.off(l.MEDIA_PUBLISH,e))}).trigger(l.MEDIA_SWITCH_TRIGGER,{videoOn:!1,audioOn:!1,release:!0,isScreenSharing:!1,actionType:s.MEDIA_PUBLISH_BY_CLASS}),a.canUseDoubleCamera()&&l.trigger(l.ASSIST_MEDIA_SWITCH_TRIGGER,{videoOn:!1,audioOn:!1,release:!0,isScreenSharing:!1,actionType:s.MEDIA_PUBLISH_BY_CLASS})}else o.set({"user.videoOn":null,"user.audioOn":null}),Yox.object.each(BJY.Player.instances,function(e){e&&e.user&&a.isPresenter(e.user.id)&&e.isPush()&&(e.hasAudioStream&&a.canPublishMuteStream()&&e.detachAudio(),e.hasVideoStream&&a.canPublishBlackStream()&&e.detachVideo())});o.get("class.speakState")!==s.SPEAK_STATE_FREE||o.get("class.isFree")||o.get("isClassSwitching")||o.set("class.speakState",s.SPEAK_STATE_LIMIT)}(),n&&n.isScreenSharing&&l.trigger(l.SCREEN_SHARE_STOP_TRIGGER)}})}).on(l.MEDIA_AUTO_SWITCH_TRIGGER,function(e,t){var n=BJY.Player.instances[o.get("user.id")];n&&function e(t){if(o.get("class.started")&&t.isReady&&(d.getIsSharingScreenWhenOffline()||!t.videoOn&&!t.audioOn)){A=0;var n,i,r=t.user;null!==S?(n=S,S=null):null!=r.prevVideoOn?(n=r.prevVideoOn,delete r.prevVideoOn):n=r.videoOn,null!==m?(i=m,m=null):null!=r.prevAudioOn?(i=r.prevAudioOn,delete r.prevAudioOn):i=r.audioOn,Yox.is.boolean(n)||(n=a.isDefaultVideoOn()),Yox.is.boolean(i)||(i=a.isDefaultAudioOn()),n&&!d.getCameraList().length&&(n=!1),i&&!d.getMicList().length&&(i=!1),a.isAdmin()&&!f.getUserSpeakAuth()&&(n=!1,i=!1),l.trigger(l.MEDIA_SWITCH_TRIGGER,{videoOn:n,audioOn:i,auto:!0,actionType:s.MEDIA_PUBLISH_BY_CLASS})}else A++<y?setTimeout(function(){e(t)},3e3):A=0}(n)}).on(l.UPLINK_SERVER_CHANGE_TRIGGER,function(e,t){t.player.switchUplinkServer()}).on(l.DOWNLINK_SERVER_CHANGE_TRIGGER,function(e,t){var n=t.player;n.user.linkType===s.LINK_TYPE_TCP?setTimeout(function(){n.replay(!0)},1e3):n.switchDownlinkServer()}).on(l.LINK_TYPE_INIT,function(){var e,t,n=o.get("user"),i=o.get("partner.liveTeacherPreferredLinkType",s.LINK_TYPE_UDP),r=o.get("partner.liveStudentPreferredLinkType",s.LINK_TYPE_TCP);n.type===s.ROLE_TYPE_TEACHER||n.type===s.ROLE_TYPE_ASSISTANT?(e=a.canUseUdpPush()?i:s.LINK_TYPE_TCP,t=a.canUseUdpPull()?i:s.LINK_TYPE_TCP):(e=a.canUseUdpPush()?i:s.LINK_TYPE_TCP,t=a.canUseUdpPull()?r:s.LINK_TYPE_TCP),o.set("class.canSetLinkType",1!==o.get("partner.liveLinkTypeConsistency",0)||n.type===s.ROLE_TYPE_TEACHER),l.trigger(l.UPLINK_LINK_TYPE_CHANGE_TRIGGER,{value:e,force:!0}),l.trigger(l.DOWNLINK_LINK_TYPE_CHANGE_TRIGGER,{value:t,force:!0})}).on(l.UPLINK_LINK_TYPE_CHANGE_TRIGGER,function(e,t){var n,r=t.force,u=Yox.object.has(t,"value")?i(t.value):i(t.linkType),c=o.get("class.uplinkType");if((r||c!==u)&&(n=c!==(u=u===s.LINK_TYPE_UDP&&a.canUseUdpPush()?s.LINK_TYPE_UDP:s.LINK_TYPE_TCP)),r||n){var d=u===s.LINK_TYPE_UDP?h:p,_=d.getActiveUplinkServer(),f=d.uplinkServerList;o.set({"class.uplinkType":u,"user.publishServer":_,"user.linkType":u}),l.trigger(l.UPLINK_LINK_TYPE_CHANGE,{value:u,linkType:u,server:_,serverList:f})}}).on(l.DOWNLINK_LINK_TYPE_CHANGE_TRIGGER,function(e,t){var n,r=t.force,u=Yox.object.has(t,"value")?i(t.value):i(t.linkType),c=o.get("class.downlinkType");if((r||!o.get("partner.liveLinkTypeConsistency"))&&((r||c!==u)&&(n=c!==(u=u===s.LINK_TYPE_UDP&&a.canUseUdpPull()?s.LINK_TYPE_UDP:s.LINK_TYPE_TCP)),r||n)){var d=u===s.LINK_TYPE_UDP?h:p;o.set("class.downlinkType",u),l.trigger(l.DOWNLINK_LINK_TYPE_CHANGE,{value:u,linkType:u,server:d.getActiveDownlinkServer(),serverList:d.downlinkServerList})}}).on(l.UPLINK_SERVER_NODE_CHANGE_TRIGGER,function(e,t){var n,i=(n=a.isWebRTC()?p:o.get("class.uplinkType")===s.LINK_TYPE_UDP?h:p).getActiveUplinkServer(),r=R(n.uplinkServerList,t);n.switchUplinkServer(i,r),o.set("user.publishServer",r),l.trigger(l.UPLINK_SERVER_NODE_CHANGE,{server:r})}).on(l.DOWNLINK_SERVER_NODE_CHANGE_TRIGGER,function(e,t){var n,i=(n=a.isWebRTC()?p:o.get("class.downlinkType")===s.LINK_TYPE_UDP?h:p).getActiveDownlinkServer(),r=R(n.downlinkServerList,t);n.switchDownlinkServer(i,r),l.trigger(l.DOWNLINK_SERVER_NODE_CHANGE,{server:r})}).on(l.SPEAKER_VOLUME_CHANGE_TRIGGER,function(e,t){var n=i(t.value,80);n>=0&&n<=s.SPEAKER_VOLUME_MAX&&n!==d.getSpeakerVolume()&&(t.value=n,d.setSpeakerVolume(n),l.trigger(l.SPEAKER_VOLUME_CHANGE,t))}).on(l.SPEAKER_INDEX_CHANGE_TRIGGER,function(e,t){var n=i(t.index);n!==d.getSpeakerIndex()&&(t.index=n,d.setSpeakerIndex(n),l.trigger(l.SPEAKER_INDEX_CHANGE,t))}).on(l.MIC_INDEX_CHANGE_TRIGGER,function(e,t){var n=i(t.index);n!==d.getMicIndex()&&(t.index=n,d.setMicIndex(n),l.trigger(l.MIC_INDEX_CHANGE,t))}).on(l.CAMERA_INDEX_CHANGE_TRIGGER,function(e,t){var n=i(t.index),r=d.getCameraList(),o=d.getCameraIndex(),s=r[n];if(n!==o){s.virtual&&(r[o].virtual&&(t.isVirtualCameraSwitch=!0),s.isComposed?l.trigger(l.SWITCH_COMPOSE_VIRTUAL_CAMERA,{index:n}):l.trigger(l.SWITCH_VIRTUAL_CAMERA_CHANNEL,{channel:s.channelIndex})),d.setCameraIndex(n),t.index=n,l.trigger(l.CAMERA_INDEX_CHANGE,t);var u=E(d.getCameraIndex(),d.getCameraQuality(),a.canUseSuper(),a.canUse720p(),a.canUse720pHigh(),a.canUse1080p(),a.canUse1080pHigh(),a.canUse4k());l.trigger(l.CAMERA_QUALITY_CHANGE_TRIGGER,{value:u})}}).on(l.ASSIST_CAMERA_INDEX_CHANGE_TRIGGER,function(e,t){var n=i(t.index),r=d.getAssistCameraIndex();if(n!==r){-1===r&&Yox.object.each(BJY.Player.instances,function(e){if(e.isAssist&&e.isSetting)return e.isCameraOpened=!0,!1}),t.index=n,d.setAssistCameraIndex(n),l.trigger(l.ASSIST_CAMERA_INDEX_CHANGE,t);var o=E(d.getAssistCameraIndex(),d.getAssistCameraQuality(),a.canUseSuper(),a.canUse720p(),a.canUse720pHigh(),a.canUse1080p(),a.canUse1080pHigh(),a.canUse4k());l.trigger(l.ASSIST_CAMERA_QUALITY_CHANGE_TRIGGER,{value:o})}}).on(l.MIC_VOLUME_CHANGE_TRIGGER,function(e,t){var n=i(t.value,80);n>=0&&n<=s.MIC_VOLUME_MAX&&n!==d.getMicVolume()&&(t.value=n,d.setMicVolume(n),l.trigger(l.MIC_VOLUME_CHANGE,t))}).on(l.MIC_NR_CHANGE_TRIGGER,function(e,t){var n=T(t.enable);n!==d.getMicNr()&&(t.enable=n,d.setMicNr(n),l.trigger(l.MIC_NR_CHANGE,t))}).on(l.MIC_EC_CHANGE_TRIGGER,function(e,t){var n=T(t.enable);n!==d.getMicEc()&&(t.enable=n,d.setMicEc(n),l.trigger(l.MIC_EC_CHANGE,t))}).on(l.MIC_AGC_CHANGE_TRIGGER,function(e,t){var n=T(t.enable);n!==d.getMicAgc()&&(t.enable=n,d.setMicAgc(n),l.trigger(l.MIC_AGC_CHANGE,t))}).on(l.MIC_CSS_CHANGE_TRIGGER,function(e,t){var n=T(t.enable);n!==d.getMicCss()&&(t.enable=n,d.setMicCss(n),l.trigger(l.MIC_CSS_CHANGE,t))}).on(l.MIC_SCALING_CHANGE_TRIGGER,function(e,t){var n=T(t.value);n!==d.getMicScaling()&&(t.value=n,d.setMicScaling(n),l.trigger(l.MIC_SCALING_CHANGE,t))}).on(l.AUDIO_REPAIR_CHANGE_TRIGGER,function(e,t){var n=T(t.value);n!==s.AUDIO_REPAIR_NO&&n!==s.AUDIO_REPAIR_LEFT&&n!==s.AUDIO_REPAIR_RIGHT&&n!==s.AUDIO_REPAIR_AUTO||(t.value=n,n!==d.getAudioRepair()&&(d.setAudioRepair(n),l.trigger(l.AUDIO_REPAIR_CHANGE,t)))}).on(l.CAMERA_QUALITY_CHANGE_TRIGGER,function(e,t){var n=T(t.value);n!==d.getCameraQuality()&&(n===s.VIDEO_QUALITY_LOW||n===s.VIDEO_QUALITY_MEDIUM||n===s.VIDEO_QUALITY_HIGH||a.canUseSuper()&&n===s.VIDEO_QUALITY_SUPER||a.canUse720p()&&n===s.VIDEO_QUALITY_720P||a.canUse720pHigh()&&n===s.VIDEO_QUALITY_720P_HIGH||a.canUse1080p()&&n===s.VIDEO_QUALITY_1080P||a.canUse1080pHigh()&&n===s.VIDEO_QUALITY_1080P_HIGH||a.canUse4k()&&n===s.VIDEO_QUALITY_4K)&&(t.value=n,d.setCameraQuality(n),l.trigger(l.CAMERA_QUALITY_CHANGE,t))}).on(l.ASSIST_CAMERA_QUALITY_CHANGE_TRIGGER,function(e,t){var n=T(t.value);n!==d.getAssistCameraQuality()&&(n===s.VIDEO_QUALITY_LOW||n===s.VIDEO_QUALITY_MEDIUM||n===s.VIDEO_QUALITY_HIGH||a.canUseSuper()&&n===s.VIDEO_QUALITY_SUPER||a.canUse720p()&&n===s.VIDEO_QUALITY_720P||a.canUse720pHigh()&&n===s.VIDEO_QUALITY_720P_HIGH||a.canUse1080p()&&n===s.VIDEO_QUALITY_1080P||a.canUse1080pHigh()&&n===s.VIDEO_QUALITY_1080P_HIGH||a.canUse4k()&&n===s.VIDEO_QUALITY_4K)&&(t.value=n,d.setAssistCameraQuality(n),l.trigger(l.ASSIST_CAMERA_QUALITY_CHANGE,t))}).on(l.CAMERA_RATIO_CHANGE_TRIGGER,function(e,t){var n=T(t.value);n!==d.getCameraRatio()&&(t.value=n,d.setCameraRatio(n),l.trigger(l.CAMERA_RATIO_CHANGE,t))}).on(l.ASSIST_CAMERA_RATIO_CHANGE_TRIGGER,function(e,t){var n=T(t.value);n!==d.getAssistCameraRatio()&&(t.value=n,d.setAssistCameraRatio(n),l.trigger(l.ASSIST_CAMERA_RATIO_CHANGE,t))}).on(l.BEAUTIFY_DENOISE_CHANGE_TRIGGER,function(e,t){if(a.canSetBeautifyDenoise()){var n=T(t.enable);n!==d.getBeautifyDenoise()&&(t.enable=n,d.setBeautifyDenoise(n),l.trigger(l.BEAUTIFY_DENOISE_CHANGE,t))}}).on(l.CAMERA_CROP_CHANGE_TRIGGER,function(e,t){if(a.canCropCamera()){var n=T(t.value);n!==d.getCameraCrop()&&(t.value=n,d.setCameraCrop(n),l.trigger(l.CAMERA_CROP_CHANGE,t))}}).on(l.CAMERA_VERTICAL_FLIP_CHANGE_TRIGGER,function(e,t){if(a.canSetCameraFlip()){var n=T(t.value);n!==d.getCameraVerticalFlip()&&(t.value=n,d.setCameraVerticalFlip(n),l.trigger(l.CAMERA_VERTICAL_FLIP_CHANGE,t))}}).on(l.CAMERA_HORIZONTAL_FLIP_CHANGE_TRIGGER,function(e,t){if(a.canSetCameraFlip()){var n=T(t.value);n!==d.getCameraHorizontalFlip()&&(t.value=n,d.setCameraHorizontalFlip(n),l.trigger(l.CAMERA_HORIZONTAL_FLIP_CHANGE,t))}}).on(l.SHARE_TARGET_CHANGE_TRIGGER,function(e,t){var n=T(t.value);n!==d.getShareTarget()&&(t.value=n,d.setShareTarget(n),l.trigger(l.SHARE_TARGET_CHANGE,t))}).on(l.ROOM_SERVER_OFFLINE,function(){$.each(BJY.Player.instances,function(e,t){t.isScreenSharing&&t.isPush()&&(d.setIsSharingScreenWhenOffline(t.isScreenSharing),d.setSharingScreenStreamForOffline(t.__screenStream))}),m=o.get("user.audioOn",null),S=o.get("user.videoOn",null)}).on(l.CAMERA_REMOVE,function(e,t){if(o.get("user.videoOn")){var n=d.getCameraGuid();Yox.array.each(t.deviceList,function(e){if(e.guid===n)return l.trigger(l.MEDIA_SWITCH_TRIGGER,{videoOn:!1}),!1})}}).on(l.MIC_REMOVE,function(e,t){if(o.get("user.audioOn")){var n=d.getMicGuid();Yox.array.each(t.deviceList,function(e){if(e.guid===n)return!1})}}).on(l.MIC_FORBID_ALL_CHANGE,function(e,t){a.isStudent()&&t.forbid&&l.trigger(l.MEDIA_SWITCH_TRIGGER,{audioOn:!1})}).one(l.CLASSROOM_CONNECT_SUCCESS,function(e,t){r.isBJYWebRTC()&&a.canSupportWebRTC()&&v.init()})}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.auth,a=BJY.store,o=BJY.config,s=n(277);t.needPermissionOnPublishAV=function(){},t.canPushHLS=function(){return r.isTeacher()},t.canUseCamera=function(){return a.get("class.mediaType",o.MEDIA_TYPE_VIDEO)!=o.MEDIA_TYPE_AUDIO},t.canSetLinkType=function(){return a.get("class.canSetLinkType")&&!BJY.auth.isWebRTC()&&(r.canUseUdpPush()||r.canUseUdpPull())},t.canGetLinksVolume=function(){return!!a.get("cefApiVersion")},t.isDefaultVideoOn=function(){return!1},t.isDefaultAudioOn=function(){return!1},t.canUseLow=function(){return!0},t.canUseStd=function(){return!0},t.canUseHigh=function(){return!0},t.canUseSuper=function(){return+a.get("partner.supportSuper")},t.canUse720p=function(){return r.isWebRTC()&&a.get("isShuangshi")?!!s(a.get("partner.doubleTeacherLiveDefinition"))["720p"]:+a.get("partner.support720p")},t.canUse720pHigh=function(){if(r.isWebRTC()&&a.get("isShuangshi")&&s(a.get("partner.doubleTeacherLiveDefinition"))["720pHigh"])return!0;return!1},t.canUse1080p=function(){return r.isWebRTC()&&a.get("isShuangshi")?!(!s(a.get("partner.doubleTeacherLiveDefinition"))["1080p"]||!r.isTeacher()):+a.get("partner.support1080p")},t.canUse1080pHigh=function(){return!(!r.isWebRTC()||!a.get("isShuangshi"))&&!(!s(a.get("partner.doubleTeacherLiveDefinition"))["1080pHigh"]||!r.isTeacher())},t.canUse4k=function(){return!(!r.isWebRTC()||!a.get("isShuangshi"))&&!(!s(a.get("partner.doubleTeacherLiveDefinition"))["4k"]||!r.isTeacher())},t.canSetBeautifyDenoise=function(){return!!a.get("cefApiVersion")&&r.isPlayerExtensionCef()},t.canUseAutoAudioRepair=function(){return a.get("cefApiVersion")>="6.5.0"},t.canSetMicCss=function(){return"windows"===BJY.os.name&&!r.isWebRTC()&&r.isTeacher()&&a.get("cefApiVersion")>="6.4.0"&&1===a.get("partner.liveCollectSystemSound")},t.canCropCamera=function(){return a.get("cefApiVersion")>="6.4.0"&&r.isPlayerExtensionCef()},t.canSetCameraFlip=function(){return a.get("cefApiVersion")>="6.4.0"&&r.isPlayerExtensionCef()||r.isWebRTC()},t.canRepairMic=function(){return!!a.get("cefApiVersion")},t.canSetMicVolume=function(){return!0},t.canSetMicAgc=function(){return!!a.get("cefApiVersion")||r.isWebRTC()},t.canSetMicEc=function(){return!!a.get("cefApiVersion")},t.canSetMicNr=function(){return!!a.get("cefApiVersion")},t.canSetMicScaling=function(){return!!a.get("cefApiVersion")},t.canChangeLinkType=function(){var e=BJY.Player.instances[a.get("user.id")];return!e||!(e.isScreenSharing||e.isThirdPushing||e.isMediaPlaying)},t.canPublishMuteStream=function(){var e=a.get("cefApiVersion");return null==e||e>="6.6.5"},t.canPublishBlackStream=function(){return a.get("cefApiVersion")>="6.7.0"&&!r.isWebRTC()},t.canNotifyPluginLoaded=function(){return a.get("cefApiVersion")>="6.8.0"},t.canUseCombinedAttachAV=function(){return a.get("cefApiVersion")>="6.8.5"},t.canInitiativeGetDevicesAuth=function(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)},t.canPullAudioOnlyStream=function(e){return!r.isWebRTC()&&e&&(e.endType===o.END_TYPE_PC_CLIENT||e.endType===o.END_TYPE_MAC_CLIENT||e.endType===o.END_TYPE_MOBILE_APPLE||e.endType===o.END_TYPE_MOBILE_ANDROID)&&e.linkType===o.LINK_TYPE_UDP||e&&e.special===o.USER_SPECIAL_GUIDE_STA&&1===a.get("partner.pushStreamType")},t.isDefaultPullAudioOnly=function(){return!1}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){t.VIDEO_DEVICE_DETECT="video_device_detect",t.AUDIO_DEVICE_DETECT="audio_device_detect",t.CAMERA_QUALITY_CHANGE_TRIGGER="camera_quality_change_trigger",t.CAMERA_QUALITY_CHANGE="camera_quality_change",t.CAMERA_QUALITY_LIST_CHANGE="cqlc",t.ASSIST_CAMERA_QUALITY_CHANGE_TRIGGER="assist_camera_quality_change_trigger",t.ASSIST_CAMERA_QUALITY_CHANGE="assist_camera_quality_change",t.CAMERA_RATIO_CHANGE="camera_ratio_change",t.CAMERA_RATIO_CHANGE_TRIGGER="camera_ratio_change_trigger",t.CAMERA_CROP_CHANGE="camera_crop_change",t.CAMERA_CROP_CHANGE_TRIGGER="camera_crop_change_trigger",t.CAMERA_HORIZONTAL_FLIP_CHANGE="camera_horizontal_filp_change",t.CAMERA_HORIZONTAL_FLIP_CHANGE_TRIGGER="camera_horizontal_filp_change_trigger",t.CAMERA_VERTICAL_FLIP_CHANGE="camera_vertical_filp_change",t.CAMERA_VERTICAL_FLIP_CHANGE_TRIGGER="camera_vertical_filp_change_trigger",t.ASSIST_CAMERA_RATIO_CHANGE="assist_camera_ratio_change",t.ASSIST_CAMERA_RATIO_CHANGE_TRIGGER="assist_camera_ratio_change_trigger",t.SPEAKER_VOLUME_CHANGE_TRIGGER="speaker_volume_change_trigger",t.SPEAKER_VOLUME_CHANGE="speaker_volume_change",t.SPEAKER_INDEX_CHANGE_TRIGGER="speaker_index_change_trigger",t.SPEAKER_INDEX_CHANGE="speaker_index_change",t.UPLINK_LINK_TYPE_CHANGE_TRIGGER="uplink_link_type_change_trigger",t.DOWNLINK_LINK_TYPE_CHANGE_TRIGGER="downlink_link_type_change_trigger",t.DOWNLINK_SERVER_NODE_CHANGE_TRIGGER="downlink_server_node_change_trigger",t.DOWNLINK_SERVER_NODE_CHANGE="downlink_server_node_change",t.UPLINK_SERVER_NODE_CHANGE_TRIGGER="uplink_server_node_change_trigger",t.UPLINK_SERVER_NODE_CHANGE="uplink_server_node_change",t.UPLINK_BLOCK="uplink_block",t.DOWNLINK_BLOCK="downlink_block",t.DOWNLINK_BLOCK_RECOVERY="downlink_block_recovery",t.UPLINK_DROP_PACKET="uplink_drop_packet",t.DOWNLINK_DROP_PACKET="downlink_drop_packet",t.UPLINK_VIDEO_DATA_OCCUR="uplink_video_data_occur",t.UPLINK_AUDIO_DATA_OCCUR="uplink_audio_data_occur",t.DOWNLINK_VIDEO_DATA_OCCUR="downlink_video_data_occur",t.DOWNLINK_AUDIO_DATA_OCCUR="downlink_audio_data_occur",t.DOWNLINK_BUFFER_OVERFLOW="downlink_buffer_overflow",t.DOWNLINK_VIDEO_BUFFER_CHANGE="downlink_video_buffer_change",t.DOWNLINK_AUDIO_BUFFER_CHANGE="downlink_audio_buffer_change",t.DOWNLINK_VIDEO_BANDWIDTH_CHANGE="downlink_video_bandwidth_change",t.DOWNLINK_AUDIO_BANDWIDTH_CHANGE="downlink_audio_bandwidth_change",t.UPLINK_VIDEO_BANDWIDTH_CHANGE="uplink_video_bandwidth_change",t.UPLINK_AUDIO_BANDWIDTH_CHANGE="uplink_audio_bandwidth_change",t.PLAYER_RUN_INFO_CHANGE="player_run_info_change",t.UPLINK_VIDEO_BANDWIDTH_SUM_CHANGE="uplink_video_bandwidth_sum_change",t.UPLINK_AUDIO_BANDWIDTH_SUM_CHANGE="uplink_audio_bandwidth_sum_change",t.DOWNLINK_VIDEO_BANDWIDTH_SUM_CHANGE="downlink_video_bandwidth_sum_change",t.DOWNLINK_AUDIO_BANDWIDTH_SUM_CHANGE="downlink_audio_bandwidth_sum_change",t.LINK_VOLUME_CHANGE="link_volume_change",t.UPLINK_SERVER_CHANGE_TRIGGER="uplink_server_change_trigger",t.UPLINK_SERVER_CHANGE="uplink_server_change",t.DOWNLINK_SERVER_CHANGE_TRIGGER="downlink_server_change_trigger",t.DOWNLINK_SERVER_CHANGE="downlink_server_change",t.AV_PUBLISH_CONNECT_SUCCESS="av_publish_connect_success",t.AV_PUBLISH_CONNECT_FAIL="av_publish_connect_fail",t.AV_PUBLISH_SUCCESS="av_publish_success",t.AV_PUBLISH_FAIL="av_publish_fail",t.AV_PUBLISH_TIMEOUT="av_publish_timeout",t.AV_PLAY_CONNECT_SUCCESS="av_play_connect_success",t.AV_PLAY_CONNECT_FAIL="av_play_connect_fail",t.AV_PLAY_SUCCESS="av_play_success",t.AV_PLAY_FAIL="av_play_fail",t.AV_PLAY_TIMEOUT="av_play_timeout",t.VIDEO_ATTACH="video_attach",t.VIDEO_DETACH="video_detach",t.AUDIO_ATTACH="audio_attach",t.AUDIO_DETACH="audio_detach",t.PLAYER_REMOUNT_START="player_remount_start",t.PLAYER_REMOUNT_END="player_remount_end",t.PLAYER_CREATE_START="player_create_start",t.PLAYER_CREATE_END="player_create_end",t.PLAYER_CREATE_SUCCESS="player_create_success",t.PLAYER_CREATE_TIMEOUT="player_create_timeout",t.PLAYER_DISPOSED="player_disposed",t.AV_PUBLISH_START="av_publish_start",t.AV_PUBLISH_END="av_publish_end",t.AV_PUBLISH_CLOSE_START="av_publish_close_start",t.AV_PUBLISH_CLOSE_END="av_publish_close_end",t.AV_PUBLISH_RELEASE_START="av_publish_release_start",t.AV_PUBLISH_RELEASE_END="av_publish_release_end",t.AV_PLAY_START="av_play_start",t.AV_PLAY_END="av_play_end",t.AV_PLAY_CLOSE_START="av_play_close_start",t.AV_PLAY_CLOSE_END="av_play_close_end",t.AV_PLAY_RELEASE_START="av_play_release_start",t.AV_PLAY_RELEASE_END="av_play_release_end",t.AV_SWITCH_START="av_switch_start",t.AV_SWITCH_END="av_switch_end",t.HTML_VIDEO_LOAD_START="html_video_load_start",t.HTML_VIDEO_LOAD_FAIL="html_video_load_fail",t.HTML_VIDEO_LOAD_TIMEOUT="html_video_load_timeout",t.HTML_VIDEO_PLAY="html_video_play",t.HTML_VIDEO_PAUSE="html_video_pause",t.HTML_AUDIO_LOAD_START="html_audio_load_start",t.HTML_AUDIO_LOAD_FAIL="html_audio_load_fail",t.HTML_AUDIO_LOAD_TIMEOUT="html_audio_load_timeout",t.HTML_AUDIO_PLAY="html_audio_play",t.HTML_AUDIO_PAUSE="html_audio_pause",t.HTML_FLV_VIDEO_ERROR="html_flv_video_error",t.HTML_VIDEO_FULLSCREEN_ENTER="html_video_fullscreen_enter",t.HTML_VIDEO_FULLSCREEN_EXIT="html_video_fullscreen_EXIT",t.NET_MONITOR_DEBUG_START="net_monitor_debug_start",t.NET_MONITOR_DEBUG_END="net_monitor_debug_end",t.TEACHER_MEDIA_ON="teacher_media_on",t.TEACHER_MEDIA_OFF="teacher_media_off",t.MIC_VOLUME_CHANGE="mic_volume_change",t.MIC_VOLUME_CHANGE_TRIGGER="mic_volume_change_trigger",t.MIC_INDEX_CHANGE="mic_index_change",t.MIC_INDEX_CHANGE_TRIGGER="mic_index_change_trigger",t.CAMERA_INDEX_CHANGE="camera_index_change",t.CAMERA_INDEX_CHANGE_TRIGGER="camera_index_change_trigger",t.ASSIST_CAMERA_INDEX_CHANGE="assist_camera_index_change",t.ASSIST_CAMERA_INDEX_CHANGE_TRIGGER="assist_camera_index_change_trigger",t.SWITCH_VIRTUAL_CAMERA_CHANNEL="switch_virtual_camera_channel",t.SWITCH_COMPOSE_VIRTUAL_CAMERA="switch_compose_virtual_camera",t.DELETE_SELECTED_VIRTUAL_CAMERA="delete_selected_virtual_camera",t.OPEN_VIRTUAL_CAMERA="open_virtual_camera",t.OPEN_VIRTUAL_CAMERA_COMPLETE="open_virtual_camera_complete",t.MIC_NR_CHANGE="mic_nr_change",t.MIC_NR_CHANGE_TRIGGER="mic_nr_change_trigger",t.MIC_EC_CHANGE="mic_ec_change",t.MIC_EC_CHANGE_TRIGGER="mic_ec_change_trigger",t.MIC_AGC_CHANGE="mic_agc_change",t.MIC_AGC_CHANGE_TRIGGER="mic_agc_change_trigger",t.MIC_CSS_CHANGE="mic_css_change",t.MIC_CSS_CHANGE_TRIGGER="mic_css_change_trigger",t.MIC_SCALING_CHANGE="mic_scaling_change",t.MIC_SCALING_CHANGE_TRIGGER="mic_scaling_change_trigger",t.CAMERA_ADD="camera_add",t.CAMERA_REMOVE="camera_remove",t.MIC_ADD="mic_add",t.MIC_REMOVE="mic_remove",t.SPEAKER_ADD="speaker_add",t.SPEAKER_REMOVE="speaker_remove",t.FLASH_AUTHORIZATION_FAIL="flash_authorization_fail",t.FLASH_AUTHORIZATION_SUCCESS="flash_authorization_success",t.AUDIO_REPAIR_CHANGE_TRIGGER="audio_repair_change_trigger",t.AUDIO_REPAIR_CHANGE="audio_repair_change",t.BEAUTIFY_DENOISE_CHANGE_TRIGGER="beautify_denoise_change_trigger",t.BEAUTIFY_DENOISE_CHANGE="beautify_denoise_change",t.SHARE_TARGET_CHANGE_TRIGGER="share_target_change_trigger",t.SHARE_TARGET_CHANGE="share_target_change",t.DOWNLINK_BLOCK_COUNT_CHANGE="downlink_block_count_change",t.UPLINK_BLOCK_COUNT_CHANGE="uplink_block_count_change",t.MEDIA_AUTO_SWITCH_TRIGGER="media_auto_switch_trigger",t.PPAPI_COMMAND="ppapi_command",t.FLASH_AUTH_SETTING_SHOWING="flash_auth_setting_showing",t.SUBSCRIBE_ERROR="subscribe_error",t.PUBLISH_ERROR="publish_error",t.PLAYER_READY="player_ready",t.PLAYER_RUN_WARN="player_run_info"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i=BJY.auth,r=BJY.store,a=BJY.config,o=BJY.command,s=BJY.eventEmitter,u=BJY.data.media,c=BJY.data.server;return{runtime_info_req:function(e,t){var n=BJY.Player.instances[r.get("user.id")],i=r.get("partner");try{delete i.customExpression,delete i.smallCourseLogo}catch(e){}var a={partner:i,stable:r.get("stable"),base:r.get("base"),live:r.get("live"),sdk_version:BJY.version,cef_version:r.get("cefApiVersion"),user_agent:navigator.userAgent,ip:r.get("user.ip"),master_server:c.getActiveMasterServer(),room_server:c.getActiveRoomServer(),chat_server:c.getActiveChatServer(),live_server_list:c.getLiveServerList(),webrtc_server_list:c.getWebrtcServerList(),mic_list:u.getMicList(),camera_list:u.getCameraList(),speaker_list:u.getSpeakerList(),camera_info:{quality:u.getCameraQuality(),assist_quality:u.getAssistCameraQuality(),camera_index:u.getCameraIndex(),assist_camera_index:u.getAssistCameraIndex()},mic_index:u.getMicIndex(),speaker_index:u.getSpeakerIndex(),mic_volume:u.getMicVolume(),mic_agc:u.getMicAgc(),audio_repair:u.getAudioRepair(),speaker_volume:u.getSpeakerVolume(),beautify_denoise:u.getBeautifyDenoise(),uplink_video_bandwidth:n?n.getUplinkVideoBandwidth():-1,uplink_audio_bandwidth:n?n.getUplinkAudioBandwidth():-1,downlink_buffer:r.get("class.playBuffer")};o.send(e,{name:"runtime_info_res",params:{runtime_info:a}})},link_info_req:function(e,t){var n=[];$.each(BJY.Player.instances,function(e,t){var o=t.user,s=t.videoOn,u=t.audioOn,c=s||u,l=t.getServer(),d={user_id:o.id,video_on:s,audio_on:u};t.isPush()?(d.uplink_server=t.getUplinkServer(),d.uplink_index=t.getUplinkIndex(),d.can_publish_mixed_audio_stream=i.canPublishMixedAudioStream(),c&&(d.uplink_stream=t.getUplinkStream(),d.uplink_stream_name=l.getUplinkStreamName(t.id,t.getUserPublishIndex()),d.uplink_connect_status=t.statusInfo.publishAVConnectSuccessTime>0?"success":"unconnected")):(d.downlink_server=t.getDownlinkServer(),d.downlink_index=t.getDownlinkIndex(),c&&(d.downlink_stream=t.getDownlinkStream(),t.extention&&"html"===t.extention.name?i.isWebRTC()?d.downlink_stream_name=l.getDownlinkWebRTCMixedStreamName():o.audioMixed?t.audioStreamOnly?d.downlink_stream_name=l.getDownlinkAudioOnlyMixedStreamName(t.id,t.getUserPublishIndex()):d.downlink_stream_name=l.getDownlinkAudioMixedStreamName(t.id,t.getUserPublishIndex()):t.audioStreamOnly?d.downlink_stream_name=l.getDownlinkAudioOnlyStreamName(t.id,t.getUserPublishIndex()):d.downlink_stream_name=l.getDownlinkStreamName(t.id,t.getUserPublishIndex()):i.isWebRTC()&&!i.canSupportWebRTC()?d.downlink_stream_name=l.getDownlinkWebRTCMixedStreamName():d.downlink_stream_name=l.getDownlinkStreamName(t.id,t.getUserPublishIndex()),d.downlink_connect_status=t.statusInfo.playAVConnectSuccessTime>0?"success":"unconnected"),d.block_count=t.blockCount||0,d.downlink_buffer=r.get("class.playBuffer")),t.linkType===a.LINK_TYPE_TCP?d.link_type="TCP":t.linkType===a.LINK_TYPE_UDP&&(d.link_type="UDP"),t.isWebRTC()&&(d.link_type="WebRTC"),n.push(d)}),o.send(e,{name:"link_info_res",params:{link_info:n}})},user_link_switch_trigger:function(e,t){var n=t.server;if(null!=n.port&&(n.port=+n.port),n){var i="uplink"===t.type;i&&r.set("user.publishServer",n),$.each(BJY.Player.instances,function(e,t){i?t.isPush()&&t.setUplinkServer(n,a.MEDIA_PUBLISH_BY_CHANGE_SERVER):t.isPush()||(t.user.linkType===a.LINK_TYPE_UDP||t.isWebRTC())&&t.setDownlinkServer(n,a.REPLAY_BY_CHANGE_SERVER)}),o.send(e,{name:"user_link_switch"})}},link_batch_switch_trigger:function(e,t){var n=t.from_server||{},i=t.to_server||{};$.each(BJY.Player.instances,function(e,t){var r;t.isPush()?(r=t.getUplinkServer()).ip===n.ip&&r.port===n.port&&t.setUplinkServer(i):(r=t.getDownlinkServer()).ip===n.ip&&r.port===n.port&&t.setDownlinkServer(i)}),o.send(e,{name:"link_batch_switch"})},user_settings_trigger:function(e,t){var n=t.quality;null!=n&&s.trigger(s.CAMERA_QUALITY_CHANGE_TRIGGER,{value:n});var i=t.assist_quality;null!=i&&s.trigger(s.ASSIST_CAMERA_QUALITY_CHANGE_TRIGGER,{value:i});var r=t.camera_index,c=t.assist_camera_index,l=u.getCameraList();r!==c&&(r>=0&&r<l.length&&s.trigger(s.CAMERA_INDEX_CHANGE_TRIGGER,{index:r}),c>=0&&c<l.length&&s.trigger(s.ASSIST_CAMERA_INDEX_CHANGE_TRIGGER,{index:c}));var d=t.mic_index,_=u.getMicList();d>=0&&d<_.length&&s.trigger(s.MIC_INDEX_CHANGE_TRIGGER,{index:d});var f=t.mic_volume;null!=f&&s.trigger(s.MIC_VOLUME_CHANGE_TRIGGER,{value:f});var p=t.mic_agc;null!=p&&s.trigger(s.MIC_AGC_CHANGE_TRIGGER,{enable:p});var h=t.audio_repair;null!=h&&s.trigger(s.AUDIO_REPAIR_CHANGE_TRIGGER,{value:h});var g=t.speaker_volume;null!=g&&s.trigger(s.SPEAKER_VOLUME_CHANGE_TRIGGER,{value:Math.ceil(a.SPEAKER_VOLUME_MAX*g/100)});var E=t.beautify_denoise;null!=E&&s.trigger(s.BEAUTIFY_DENOISE_CHANGE_TRIGGER,{enable:E});var v=t.wide_screen;null!=v&&s.trigger(s.CAMERA_RATIO_CHANGE_TRIGGER,{value:v}),o.send(e,{name:"user_settings"})},user_media_control_trigger:function(e,t){s.trigger(s.MEDIA_SWITCH_TRIGGER,{videoOn:t.video_on,audioOn:t.audio_on}),o.send(e,{name:"user_media_control"})},av_play_buffer_change_trigger:function(e,t){"number"===$.type(t.buffer)&&r.set("class.playBuffer",t.buffer),o.send(e,{name:"av_play_buffer_change"})},uplink_link_type_change_trigger:function(e,t){s.trigger(s.UPLINK_LINK_TYPE_CHANGE_TRIGGER,{value:t.link_type}),o.send(e,{name:"uplink_link_type_change"})},downlink_link_type_change_trigger:function(e,t){s.trigger(s.DOWNLINK_LINK_TYPE_CHANGE_TRIGGER,{value:t.link_type}),o.send(e,{name:"downlink_link_type_change"})},udp_uplink_server_switch_trigger:function(e,t){s.trigger(s.UPLINK_SERVER_NODE_CHANGE_TRIGGER,{ip:t.ip,port:t.port}),o.send(e,{name:"udp_switch_uplink_server"})},udp_downlink_server_switch_trigger:function(e,t){s.trigger(s.DOWNLINK_SERVER_NODE_CHANGE_TRIGGER,{ip:t.ip,port:t.port}),o.send(e,{name:"udp_switch_downlink_server"})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i=BJY.auth,r=BJY.store,a=BJY.eventEmitter;return{buffer_remote_change_trigger:function(e,t){i.isSelf(e)||Yox.is.number(t.buffer)&&r.set("class.playBuffer",t.buffer)},udp_downlink_server_batch_switch_trigger:function(e,t){a.trigger(a.DOWNLINK_SERVER_NODE_CHANGE_TRIGGER,{ip:t.ip,port:t.port})}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i=n(0);n(66)(t,"__esModule",{value:!0}),t.init=function(){function e(){return t.apply(this,arguments)}function t(){return(t=(0,o.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!BJY.Player.SignalServer){e.next=4;break}return BJY.Player.SignalServer.dispose(),e.next=4,new d.Sleep(1);case 4:BJY.Player.SignalServer=new A("wss://"+p.getWebrtcSignalUri(),f.get("user.webrtcInfo.token"));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}r=E("SignalServer:"),h.on(h.CLASSROOM_CONNECT_SUCCESS,function(t,n){(n.reconnect||n.isClassSwitching)&&e()}).on(h.WEBRTC_INFO_RES,function(t,n){e()}),e()},t.ERROR_CODE=void 0;var r,a=i(n(174)),o=i(n(175)),s=i(n(471)),u=i(n(123)),c=i(n(155)),l=i(n(104)),d=n(272),_=n(486),f=BJY.store,p=BJY.data.server,h=BJY.eventEmitter,g=BJY.server.webrtc,E=n(200),v=0,m={enableLog:!0,cpuDetect:!1,encrypt:!0};var S={SESSION_EXIST:0,SERVER_UNCONNECT:1,RTCAT_ERROR:2};t.ERROR_CODE=S;var A=function(){function e(t,n,i){(0,u.default)(this,e),this.serverUrl=t,this.token=n,this.options=i||m,this.status=v,this.sessionMap=new s.default,this.reconnectCount=0,this.connect()}var t;return(0,c.default)(e,[{key:"connect",value:function(){var e=this;2!==this.status&&(this.signalServer=RTCat.createSignalServer(this.serverUrl,this.token,this.options),this.reconnectTimeouter&&clearTimeout(this.reconnectTimeouter),this.reconnectTimeouter=setTimeout(function(){h.trigger(h.WEBRTC_SERVER_CONNECT_TIMEOUT),this.reconnectTimeouter=null},15e3),this.catchError=!1,this.signalServer.on("close",function(t){e.reconnectTimeouter&&(clearTimeout(e.reconnectTimeouter),e.reconnectTimeouter=null),3===e.status?(e.status=v,r("user close")):(r("error close",t),e.status=v,e.reconnectCount>=5?h.trigger(h.WEBRTC_SERVER_CONNECT_TIMEOUT):e.catchError?h.trigger(h.WEBRTC_SERVER_CONNECT_ERROR):(e.status=1,r("reconnecting"),e.reconnectCount++,e.reconnectTimer=setTimeout(function(){e.connect(),e.reconnectTimer=null},3e3))),e.sessionMap&&e.sessionMap.clear()}),this.signalServer.on("open",function(){e.signalServer&&(r("connect success"),e.status=2,e.reconnectTimeouter&&(clearTimeout(e.reconnectTimeouter),e.reconnectTimeouter=null),e.reconnectCount=0,h.trigger(h.WEBRTC_SERVER_CONNECT_SUCCESS),e.signalServer.getMediaServers().then(function(e){!function(e){var t=[];(0,l.default)(e).forEach(function(n){e[n].forEach(function(e){t.push({name:e})})}),p.setWebrtcServer(t),g.uplinkServerList=g.downlinkServerList=t}(e.servers)}).catch(function(e){r(e)}))}),this.signalServer.on("rtcat-error",function(t){r("rtcat-error",t),t&&t.code===RTCat.ErrorCode.TOKEN_INVALID&&(e.catchError=!0)}),r("connecting"),this.status=1,this.signalServer.connect())}},{key:"joinSession",value:(t=(0,o.default)(a.default.mark(function e(t){var n,i,r,o,s=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(2!==this.status){e.next=23;break}if(n=t.channel,i=t.userId,r=t.area,!this.sessionMap.has(n+"-"+i)){e.next=4;break}throw new _.Error(S.SESSION_EXIST,"session has already joined");case 4:return e.prev=4,e.next=7,this.signalServer.joinSession({sessionId:n,userId:i.toString(),userNumber:f.get("user.number")},{area:r});case 7:return o=e.sent,t.area=o.area,this.sessionMap.set(n+"-"+i,o),o.on("quit",function(){s.sessionMap&&s.sessionMap.delete(n+"-"+i)}),e.abrupt("return",o);case 14:if(e.prev=14,e.t0=e.catch(4),!e.t0||e.t0.code!==RTCat.ErrorCode.ALREADY_EXIST){e.next=20;break}throw new _.Error(S.SESSION_EXIST,"session has already joined");case 20:throw new _.Error(S.RTCAT_ERROR,e.t0.message);case 21:e.next=24;break;case 23:throw new _.Error(S.SERVER_UNCONNECT,"server not connect");case 24:case"end":return e.stop()}},e,this,[[4,14]])})),function(e){return t.apply(this,arguments)})},{key:"dispose",value:function(){this.signalServer&&(this.status=3,this.sessionMap.clear(),this.sessionMap=null,this.signalServer.close(),this.signalServer=null),this.reconnectTimer&&clearTimeout(this.reconnectTimer)}},{key:"isConnected",get:function(){return 2===this.status}}]),e}()},function(e,t,n){e.exports=n(472)},function(e,t,n){n(127),n(89),n(110),n(473),n(479),n(482),n(484),e.exports=n(1).Map},function(e,t,n){"use strict";var i=n(474),r=n(308);e.exports=n(475)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=i.getEntry(r(this,"Map"),e);return t&&t.v},set:function(e,t){return i.def(r(this,"Map"),0===e?0:e,t)}},i,!0)},function(e,t,n){"use strict";var i=n(14).f,r=n(84),a=n(194),o=n(29),s=n(193),u=n(134),c=n(90),l=n(136),d=n(227),_=n(9),f=n(133).fastKey,p=n(308),h=_?"_s":"size",g=function(e,t){var n,i=f(t);if("F"!==i)return e._i[i];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var l=e(function(e,i){s(e,l,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[h]=0,null!=i&&u(i,n,e[c],e)});return a(l.prototype,{clear:function(){for(var e=p(this,t),n=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];e._f=e._l=void 0,e[h]=0},delete:function(e){var n=p(this,t),i=g(n,e);if(i){var r=i.n,a=i.p;delete n._i[i.i],i.r=!0,a&&(a.n=r),r&&(r.p=a),n._f==i&&(n._f=r),n._l==i&&(n._l=a),n[h]--}return!!i},forEach:function(e){p(this,t);for(var n,i=o(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!g(p(this,t),e)}}),_&&i(l.prototype,"size",{get:function(){return p(this,t)[h]}}),l},def:function(e,t,n){var i,r,a=g(e,t);return a?a.v=n:(e._l=a={i:r=f(t,!0),k:t,v:n,p:i=e._l,n:void 0,r:!1},e._f||(e._f=a),i&&(i.n=a),e[h]++,"F"!==r&&(e._i[r]=a)),e},getEntry:g,setStrong:function(e,t,n){c(e,t,function(e,n){this._t=p(e,t),this._k=n,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?l(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,l(1))},n?"entries":"values",!n,!0),d(t)}}},function(e,t,n){"use strict";var i=n(2),r=n(6),a=n(133),o=n(15),s=n(17),u=n(194),c=n(134),l=n(193),d=n(10),_=n(56),f=n(14).f,p=n(476)(0),h=n(9);e.exports=function(e,t,n,g,E,v){var m=i[e],S=m,A=E?"set":"add",y=S&&S.prototype,T={};return h&&"function"==typeof S&&(v||y.forEach&&!o(function(){(new S).entries().next()}))?(S=t(function(t,n){l(t,S,e,"_c"),t._c=new m,null!=n&&c(n,E,t[A],t)}),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in y&&(!v||"clear"!=e)&&s(S.prototype,e,function(n,i){if(l(this,S,e),!t&&v&&!d(n))return"get"==e&&void 0;var r=this._c[e](0===n?0:n,i);return t?this:r})}),v||f(S.prototype,"size",{get:function(){return this._c.size}})):(S=g.getConstructor(t,e,E,A),u(S.prototype,n),a.NEED=!0),_(S,e),T[e]=S,r(r.G+r.W+r.F,T),v||g.setStrong(S,e,E),S}},function(e,t,n){var i=n(29),r=n(80),a=n(42),o=n(81),s=n(477);e.exports=function(e,t){var n=1==e,u=2==e,c=3==e,l=4==e,d=6==e,_=5==e||d,f=t||s;return function(t,s,p){for(var h,g,E=a(t),v=r(E),m=i(s,p,3),S=o(v.length),A=0,y=n?f(t,S):u?f(t,0):void 0;S>A;A++)if((_||A in v)&&(g=m(h=v[A],A,E),e))if(n)y[A]=g;else if(g)switch(e){case 3:return!0;case 5:return h;case 6:return A;case 2:y.push(h)}else if(l)return!1;return d?-1:c||l?l:y}}},function(e,t,n){var i=n(478);e.exports=function(e,t){return new(i(e))(t)}},function(e,t,n){var i=n(10),r=n(115),a=n(13)("species");e.exports=function(e){var t;return r(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!r(t.prototype)||(t=void 0),i(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var i=n(6);i(i.P+i.R,"Map",{toJSON:n(480)("Map")})},function(e,t,n){var i=n(157),r=n(481);e.exports=function(e){return function(){if(i(this)!=e)throw TypeError(e+"#toJSON isn't generic");return r(this)}}},function(e,t,n){var i=n(134);e.exports=function(e,t){var n=[];return i(e,!1,n.push,n,t),n}},function(e,t,n){n(483)("Map")},function(e,t,n){"use strict";var i=n(6);e.exports=function(e){i(i.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){n(485)("Map")},function(e,t,n){"use strict";var i=n(6),r=n(37),a=n(29),o=n(134);e.exports=function(e){i(i.S,e,{from:function(e){var t,n,i,s,u=arguments[1];return r(this),(t=void 0!==u)&&r(u),null==e?new this:(n=[],t?(i=0,s=a(u,arguments[2],2),o(e,!1,function(e){n.push(s(e,i++))})):o(e,!1,n.push,n),new this(n))}})}},function(e,t,n){"use strict";var i=n(0);n(66)(t,"__esModule",{value:!0}),t.Error=void 0;var r=i(n(123));t.Error=function e(t,n){(0,r.default)(this,e),this.code=t,this.message=n||"unkown"}},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(154),a=BJY.log,o=BJY.config,s=BJY.eventEmitter,u=BJY.data.class,c=BJY.data.mark;new r({task:function(e,t){e(),setTimeout(t,10*o.SECOND)}});var l={};t.init=function(){s.on(s.UPLINK_SERVER_CHANGE,function(e,t){var n=t.player,i=n.user,r=t.from,s=t.to;a.send({info_type:4,link_type:BJY.log.LINK_TYPE_UP,av_type:n.videoOn?BJY.log.AV_TYPE_VIDEO:BJY.log.AV_TYPE_AUDIO,ls_from:r.ip+":"+r.port,ls_to:s.ip+":"+s.port,switch_count:n.getUplinkIndex(),watch_number:i.number,use_udp:n.linkType!==o.LINK_TYPE_UDP?0:1})}).on(s.DOWNLINK_SERVER_CHANGE,function(e,t){var n=t.player,i=n.user,r=t.from,s=t.to;a.send({info_type:4,link_type:BJY.log.LINK_TYPE_DOWN,av_type:n.videoOn?BJY.log.AV_TYPE_VIDEO:BJY.log.AV_TYPE_AUDIO,ls_from:r.ip+":"+r.port,ls_to:s.ip+":"+s.port,switch_count:n.getDownlinkIndex(),watch_number:i.number,watch_user_type:i.type,use_udp:n.linkType!==o.LINK_TYPE_UDP?0:1})}).on(s.UPLINK_BLOCK,function(e,t){var n=t.player,i=n.user,r=n.getUplinkServer();a.send({info_type:6,link_type:BJY.log.LINK_TYPE_UP,av_type:n.videoOn?BJY.log.AV_TYPE_VIDEO:BJY.log.AV_TYPE_AUDIO,ls:r.ip+":"+r.port,watch_number:i.number,watch_user_type:i.type,block_duration:t.duration,user_count:u.getUserCount(),use_udp:n.linkType!==o.LINK_TYPE_UDP?0:1})}).on(s.DOWNLINK_BLOCK,function(e,t){var n=t.player,i=n.user,r=n.getDownlinkServer();a.send({info_type:6,link_type:BJY.log.LINK_TYPE_DOWN,av_type:n.videoOn?BJY.log.AV_TYPE_VIDEO:BJY.log.AV_TYPE_AUDIO,ls:r.ip+":"+r.port,watch_number:i.number,block_counter:t.blockCount,enter_stamp:c.get(c.ROOM_SERVER_CONNECT_SUCCESS),user_type:i.type,use_udp:n.linkType!==o.LINK_TYPE_UDP?0:1})}).on(s.AV_PUBLISH_END,function(e,t){var n=t.player;l[n.user.id]=$.now()}).on(s.AV_PUBLISH_CLOSE_END,function(e,t){var n=t.player;l[n.user.id]=0}).on(s.AV_PUBLISH_RELEASE_END,function(e,t){var n=t.player;l[n.user.id]=0}).on(s.AV_PLAY_END,function(e,t){var n=t.player;l[n.user.id]=$.now()}).on(s.AV_PLAY_CLOSE_END,function(e,t){var n=t.player;l[n.user.id]=0}).on(s.AV_PLAY_RELEASE_END,function(e,t){var n=t.player;l[n.user.id]=0}).on(s.AV_PUBLISH_SUCCESS,function(e,t){var n=t.player,i=l[n.user.id];i>0&&a.send({info_type:8,link_type:BJY.log.LINK_TYPE_UP,av_type:n.videoOn?BJY.log.AV_TYPE_VIDEO:BJY.log.AV_TYPE_AUDIO,duration:$.now()-i})}).on(s.AV_PLAY_SUCCESS,function(e,t){var n=t.player,i=l[n.user.id];i>0&&a.send({info_type:8,link_type:BJY.log.LINK_TYPE_DOWN,av_type:n.videoOn?BJY.log.AV_TYPE_VIDEO:BJY.log.AV_TYPE_AUDIO,duration:$.now()-i})}).one(s.CLIENT_INIT_SUCCESS,function(e,t){c.add(c.CLIENT_INIT_SUCCESS)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i,r,a,o,s=BJY.auth,u=BJY.store,c=BJY.config,l=BJY.eventEmitter,d={bufferSpeak:.3,bufferNoSpeak:1.1,bufferInitial:1.1,bufferMax:10,bufferStep:3},_={bufferSpeak:.6,bufferNoSpeak:1.1,bufferInitial:1.1,bufferMax:2,bufferStep:.2};function f(e){var t;switch(u.get("user.endType")){case c.END_TYPE_PC_BROWSER:e===c.LINK_TYPE_TCP&&(t=u.get("partner.livePcWebBuffer")||d);break;case c.END_TYPE_PC_CLIENT:case c.END_TYPE_MAC_CLIENT:var n=u.get("partner.client"),i=e===c.LINK_TYPE_TCP?"Tcp":"Udp";n&&((t={}).bufferSpeak=n["buffer"+i+"Speak"],t.bufferNoSpeak=n["buffer"+i+"NoSpeak"],t.bufferInitial=n["buffer"+i+"Initial"],t.bufferMax=n["buffer"+i+"Max"],t.bufferStep=n["buffer"+i+"Step"])}return t||(t=e===c.LINK_TYPE_TCP?d:_),t}function p(e){if(!u.get("offline")){var t=u.get("user");if(t.endType!==c.END_TYPE_MOBILE_BROWSER&&!s.isWebRTC()&&!u.get("class.lockBuffer",!1)){var n=u.get("class.downlinkType"),i=f(n);null==e&&(e=a?"bufferSpeak":null==t.videoOn&&null==t.audioOn&&(s.isDefaultVideoOn()||s.isDefaultAudioOn())?"bufferSpeak":"bufferNoSpeak");var o=i[e];n===c.LINK_TYPE_TCP&&r===c.LINK_TYPE_UDP&&(o+=2),u.set("class.playBuffer",o)}}}function h(e){e.id==u.get("user.id")?function(){var e=u.get("user"),t=e.videoOn||e.audioOn;a!==t&&(a=t,p())}():e.id==u.get("presenter.id")&&function(){var e=u.get("presenter")||{};if(e.id!==u.get("user.id")){var t,n=e.videoOn||e.audioOn,a=e.linkType;i!==n?(i=n,r=a,t=!0,l.trigger(n?l.TEACHER_MEDIA_ON:l.TEACHER_MEDIA_OFF)):r!==a&&(r=a,t=!0),t&&p()}}()}t.init=function(){l.on(l.CLASSROOM_CONNECT_START,function(e,t){i=r=a=o=null}).on(l.CLASSROOM_CONNECT_SUCCESS,function(e,t){p()}).on(l.DOWNLINK_SERVER_CHANGE,function(e,t){p()}).on(l.DOWNLINK_SERVER_NODE_CHANGE,function(e){p()}).on(l.DOWNLINK_BLOCK,function(e,t){var n=t.player;if(n&&n.id===u.get("presenterId"))if(u.get("user.audioOn")||u.get("user.videoOn"))o=null;else{var i=t.blockCount;if(o!=i){o=i;var r=f(n.linkType);u.increase("class.playBuffer",r.bufferStep,r.bufferMax)===r.bufferMax&&p()}}}).on(l.USER_ADD,function(e,t){Yox.array.each(t.userList,h)}).on(l.USER_UPDATE,function(e,t){h(t.user)}),u.get("user.endType")!==c.END_TYPE_MOBILE_BROWSER&&u.watch("class.playBuffer",function(e){Yox.array.each(BJY.Player.instances,function(t){if(t.isPull()&&e!==t.playBuffer){var n=t.user;(n.videoOn||n.audioOn)&&t.replay(!0)}})})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(290),a=BJY.auth,o=BJY.store,s=BJY.config,u=BJY.logger,c=BJY.eventEmitter,l=BJY.is,d=BJY.data.media,_=BJY.server.live,f=BJY.server.liveUdp,p=BJY.server.webrtc,h=n(490),g=n(493),E=n(495),v=n(251),m=n(496),S="camera",A="screen",y="file",T={camera:0,screen:1,file:2};function R(e){$.extend(this,e.extension.extensions,e),e.isSetting?this.id=""+v():e.isAssist?this.id=e.user.id2:this.id=e.user.id,this.init()}function I(e,t){var n;switch(t){case S:n=e.vtag;break;case A:n=e.stag;break;case y:n=e.ftag}return n}function C(e,t,n){var i=e.extension;if($.isFunction(i[t]))return $.isArray(n)||(n=[]),n.unshift(e),i[t].apply(i,n)}function O(e,t){var n=e.user,i=e.linkType,r=e.getDownlinkServer(),u=e.publishIndex,l=i,d=r,p=e.getUserPublishIndex(),h=function(e){var t=null,n=null;if(e.isWebRTC())return{linkType:t,server:n};var i=e.user,r=i.publishServer.ip;return i.linkType==s.LINK_TYPE_TCP?(t=i.linkType,$.each(_.uplinkServerList,function(e,t){if(t.ip===r)return n=_.downlinkServerList[e],!1})):(t=1==o.get("partner.liveLinkTypeConsistency")?i.linkType:o.get("class.downlinkType"))===s.LINK_TYPE_TCP?n=_.getActiveDownlinkServer():t===s.LINK_TYPE_UDP&&(n=f.getActiveDownlinkServer()),{linkType:t,server:n}}(e);null!=h.linkType&&(l=h.linkType),null!=h.server&&(d=h.server);var g,E=!!e.getUserVideoOn(),v=!!e.getUserAudioOn();e.disableVideo&&(e.forceDisableVideo||n.audioOn)?E=!1:e.disableVideo=!1,p!==u&&(null!=u&&(g=!0),e.publishIndex=p),l!==i&&(g=!0,e.linkType=l),d!==r&&(g=!0,e.serverInfo.downlinkServer=d);var m=!!e.videoOn,S=!!e.audioOn;v!=S||E!=m?(c.trigger(c.AV_SWITCH_START,{player:e}),S||m?v||E?g?(e.playAVRelease(),e.playAV(E)):(e.playAVClose(!1),e.playAV(E,!1,!1)):g?e.playAVRelease():a.isPresenter(n.id)&&n.supportMuteStream&&t===s.MEDIA_PUBLISH_BY_USER||e.playAVClose():e.playAV(E),e.switchVideoStream(E),e.isAssist||e.switchAudioStream(v),c.trigger(c.AV_SWITCH_END,{player:e})):g&&e.replay(g)}function b(e,t){!e||e.isDisposed()||e.isPush()||(e.isScreenSharing=t)}function L(e,t,n){!e||e.isDisposed()||e.isPush()||(t?O(e,n):Yox.nextTick(function(){e.isDisposed()||O(e,n)}))}return R.prototype={constructor:R,init:function(){var e=this.user;if(!(this.isSetting||this.isWebRTCMix||this.isWebRTC()||e.publishServer))throw new Error("user 缺少 publish 信息");this.linkType=a.isSelf(e.id)?o.get("class.uplinkType"):o.get("class.downlinkType"),(e.id===o.get("class.mixStreamUserId")||this.isWebRTC())&&(this.linkType=s.LINK_TYPE_TCP),this.runInfo=new h(this),this.serverInfo=new g(this),this.statusInfo=new E(this),this.videoOn=null,this.audioOn=null,this.serverShutDown=!1,this.isReady=!1,this.mediaStatusStack=[],R.instances[this.id]=this,C(this,"initPlayer"),c.trigger(c.PLAYER_CREATE_START,{player:this}),(!this.asyncReady||this.isHidden&&!this.isWebRTC())&&this.onReady(),this.initMediaStatus()},mount:function(e){this.swf&&!this.element?(e instanceof HTMLElement&&(e=$(e)),e instanceof jQuery&&(e.append(this.swf),this.element=e)):this.element&&u.warn("请先执行 unmount 从 Dom 树卸载 Player")},unmount:function(){this.element?(this.element.empty(),this.element=null):u.warn("当前 Player 并未挂载")},destroy:function(){this.dispose()},dispose:function(){this.isPush()?((this.videoOn||this.hasVideoStream)&&this.detachVideo(),(this.audioOn||this.hasAudioStream)&&this.detachAudio(),this.publishAVRelease()):this.isPull()&&this.playAVRelease(),this.cameraOn&&this.closeCamera(),this.micOn&&this.closeMic(),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.runInfo.dispose(),this.serverInfo.dispose(),this.statusInfo.dispose(),C(this,"disposePlayer"),this.isReady=!1,c.trigger(c.PLAYER_DISPOSED,{player:this}),R.instances[this.id]&&delete R.instances[this.id]},onReady:function(){this.isReady||(this.isReady=!0,C(this,"initComplete"),function(e){if(e.remount())return;if(e.isPull()){L(e,!0);var t=s.PLAYER_FIRST_SWITCH_LIMIT,n=s.PLAYER_PLAY_SWITCH_LIMIT,i=s.PLAYER_PLAY_SWITCH_OFFSET;t>=0&&n>=0&&i>=0&&e.initStreamBuffer({firstSwitchLimit:t,playSwitchLimit:n,playSwitchOffset:i})}c.trigger(c.PLAYER_CREATE_SUCCESS,{player:e}),c.trigger(c.PLAYER_CREATE_END,{player:e}),e.onComplete&&e.onComplete()}(this))},isDisposed:function(){return!this.isReady&&null==R.instances[this.id]},isWebRTC:function(){return"webrtc"===this.extension.name||this.isWebRTCMixPull()},publishAV:function(e){var t=this,n=$.Deferred();if(t.isReady&&4!==t.publishStatus&&1!==t.publishStatus){t.publishStatus=4,c.trigger(c.AV_PUBLISH_START,{player:t}),t.runInfo.reset(),t.statusInfo.reset();var i=function(){c.trigger(c.AV_PUBLISH_END,{player:t})};t.isWebRTC()?C(t,"publishAV").then(function(){t.publishStatus=1,i(),n.resolve()}).catch(function(e){t.publishStatus=5,i(),"create_av_stream_error"===e.message?c.trigger(t.isAssist?c.ASSIST_MEDIA_PUBLISH_TRIGGER:c.MEDIA_SWITCH_TRIGGER,{videoOn:!1,audioOn:!1}):c.trigger(c.PUBLISH_ERROR),n.reject()}):C(t,"publishAV",[e]).then(function(){t.publishStatus=1,i(),n.resolve()})}else t.isReady||n.reject(),1==t.publishStatus&&n.resolve();return n},publishAVClose:function(e){var t=this;if(1===t.publishStatus){c.trigger(c.AV_PUBLISH_CLOSE_START,{player:t}),t.videoOn&&(t.detachVideo(),t.hideVideo()),t.audioOn&&t.detachAudio();var n=C(t,"publishAVClose",[e]);return t.publishStatus=2,c.trigger(c.AV_PUBLISH_CLOSE_END,{player:t}),n}},publishAVRelease:function(e){var t=this;if(1===t.publishStatus||2===t.publishStatus){c.trigger(c.AV_PUBLISH_RELEASE_START,{player:t});var n=C(t,"publishAVRelease",[e]);return t.publishStatus=3,c.trigger(c.AV_PUBLISH_RELEASE_END,{player:t}),n}},attachVideo:function(e,t){var n=this,i=function(){C(n,"attachVideo",[e,t]),e||(n.hasVideoStream=!0),t||(n.videoOn=!0,c.trigger(c.VIDEO_ATTACH,{player:n,closeBlackFrame:e,blackStream:t}))};if(n.isReady)return 1!==n.publishStatus?n.publishAV().then(function(){i()}):i(),r()},detachVideo:function(e){var t=this;t.isReady&&(C(t,"detachVideo",[e]),t.videoOn=!1,e||(t.hasVideoStream=!1),c.trigger(c.VIDEO_DETACH,{player:t,openBlackFrame:e}))},attachAudio:function(e,t){var n=this;if(n.isReady){var i=function(){C(n,"attachAudio",[e,t]),e||(n.hasAudioStream=!0),t||(n.audioOn=!0,c.trigger(c.AUDIO_ATTACH,{player:n,fromMute:e}))};1!==n.publishStatus?n.publishAV().then(function(){i()}):i()}},detachAudio:function(e){var t=this;t.isReady&&(C(t,"detachAudio",[e]),t.audioOn=!1,e||(t.hasAudioStream=!1),c.trigger(c.AUDIO_DETACH,{player:t,toMute:e}))},playAV:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,r=this;if(r.isReady&&("html"===r.extension.name||1!==r.playStatus)){(e=!0===e)&&r.disableVideo&&(e=!1);var a=r.user.audioOn,s=!e||r.isHidden;n&&c.trigger(c.AV_PLAY_START,{player:r,audioOnly:s}),r.playBuffer=o.get("class.playBuffer"),r.playStatus=1,r.runInfo.reset(),r.statusInfo.reset(),C(r,"playAV",[{audioOnly:s,actionType:i}]),(e!==r.videoOn||t)&&(e?r.showVideo():r.hideVideo()),r.audioOn=a,n&&c.trigger(c.AV_PLAY_END,{player:r,audioOnly:s})}},playAVClose:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this;return"html"!==n.extension.name&&1!==n.playStatus||(t&&c.trigger(c.AV_PLAY_CLOSE_START,{player:n}),n.videoOn&&n.hideVideo(),e=C(n,"playAVClose"),n.audioOn=!1,n.playStatus=2,t&&c.trigger(c.AV_PLAY_CLOSE_END,{player:n}),n.runInfo&&n.runInfo.uplinkAudioLowRateTimer&&(clearTimeout(n.runInfo.uplinkAudioLowRateTimer),n.runInfo.uplinkAudioLowRateTimer=null)),e},playAVRelease:function(){var e,t=this;return"html"!==t.extension.name&&1!==t.playStatus&&2!==t.playStatus||(c.trigger(c.AV_PLAY_RELEASE_START,{player:t}),1===t.playStatus&&t.playAVClose(),2===t.playStatus&&(e=C(t,"playAVRelease"),t.playStatus=3),c.trigger(c.AV_PLAY_RELEASE_END,{player:t})),e},showVideo:function(){var e=this;e.isReady&&!e.disableVideo&&!e.videoOn&&e.getUserVideoOn()&&(1!==e.playStatus?e.playAV(!0):C(e,"showVideo"),e.videoOn=!0)},hideVideo:function(){this.isReady&&this.videoOn&&(C(this,"hideVideo"),this.videoOn=!1)},showSnapshot:function(){return this.isSnapshotShown||(C(this,"hideVideo",[!1,!0]),this.isSnapshotShown=!0),this.isSnapshotShown},hideSnapshot:function(){return this.isSnapshotShown&&(C(this,"showVideo",[!1]),this.isSnapshotShown=!1),this.isSnapshotShown},isLinkTypeChange:function(e){return e==s.MEDIA_PUBLISH_BY_LINK_TYPE},republish:function(e,t,n){var i,r=this,o=r.user,s=r.videoOn,u=r.audioOn,l=r.hasAudioStream,d=r.hasVideoStream;function _(){(l||d)&&r.publishAV(t).then(function(){s?r.attachVideo():s||!d||r.isLinkTypeChange(t)||r.attachVideo(!1,!0),u?r.attachAudio():u||!l||r.isLinkTypeChange(t)||r.attachAudio(!1,!0),(o.videoOn||o.audioOn)&&c.trigger(r.isAssistPush()?c.ASSIST_MEDIA_REPUBLISH_TRIGGER:c.MEDIA_REPUBLISH_TRIGGER,{videoOn:s,audioOn:u,linkType:r.linkType,actionType:t,isScreenSharing:r.isScreenSharing}),a.isPresenter()&&c.trigger(c.MIXAUDIO_MUTE_PUBLISH_TRIGGER,{videoOn:s,audioOn:u,linkType:r.linkType,actionType:t,isScreenSharing:r.isScreenSharing})})}d&&r.detachVideo(),l&&r.detachAudio();var f=function(){n?setTimeout(_,n):_()};(i=e?r.publishAVRelease(t):r.publishAVClose(t))&&i.then?i.then(f):f()},reopenCamera:function(e,t){var n=this,i=n.user,r=n.videoOn,a=n.hasVideoStream;a&&n.detachVideo(),t&&t(),r?n.attachVideo():r||!a||n.isLinkTypeChange(e)||n.attachVideo(!1,!0),(i.videoOn||i.audioOn)&&c.trigger(n.isAssistPush()?c.ASSIST_MEDIA_REPUBLISH_TRIGGER:c.MEDIA_REPUBLISH_TRIGGER,{videoOn:n.videoOn,audioOn:n.audioOn,linkType:n.linkType,actionType:e,isScreenSharing:n.isScreenSharing})},reopenMic:function(e,t){var n=this,i=n.user,r=n.audioOn,a=n.hasAudioStream;a&&n.detachAudio(),t&&t(),r?n.attachAudio():r||!a||n.isLinkTypeChange(e)||n.attachAudio(!1,!0),(i.videoOn||i.audioOn)&&c.trigger(n.isAssistPush()?c.ASSIST_MEDIA_REPUBLISH_TRIGGER:c.MEDIA_REPUBLISH_TRIGGER,{videoOn:n.videoOn,audioOn:n.audioOn,linkType:n.linkType,actionType:e,isScreenSharing:n.isScreenSharing})},replay:function(e,t){console.log("replay called",this),console.trace();var n,i=this,r=i.videoOn,a=i.audioOn;n=e?i.playAVRelease():i.playAVClose(!1),(r||a)&&(n&&n.then?n.then(function(){i.playAV(r,!0,!1,t)}):i.playAV(r,!0,!1,t))},getRtt:function(){return this.runInfo.getRtt()},setRtt:function(e){this.runInfo.setRtt(e)},getDownlinkVideoBufferLength:function(){return this.runInfo.getDownlinkVideoBufferLength()},setDownlinkVideoBufferLength:function(e){this.runInfo.setDownlinkVideoBufferLength(e)},getDownlinkAudioBufferLength:function(){return this.runInfo.getDownlinkAudioBufferLength()},setDownlinkAudioBufferLength:function(e){this.runInfo.setDownlinkAudioBufferLength(e)},getDownlinkVideoBandwidth:function(){return this.runInfo.downlinkVideoBandwidth},setDownlinkVideoBandwidth:function(e){this.runInfo.setDownlinkVideoBandwidth(e)},getDownlinkAudioBandwidth:function(){return this.runInfo.downlinkAudioBandwidth},setDownlinkAudioBandwidth:function(e){this.runInfo.setDownlinkAudioBandwidth(e)},getDownlinkDropPacket:function(e){return this.runInfo.downlinkDropPacket},setDownlinkDropPacket:function(e){this.runInfo.setDownlinkDropPacket(e)},getDownlinkTotalBytes:function(){return this.runInfo.getDownlinkTotalBytes()},setDownlinkTotalBytes:function(e){this.runInfo.setDownlinkTotalBytes(e)},getDownlinkDropBytes:function(){return this.runInfo.getDownlinkDropBytes()},setDownlinkDropBytes:function(e){this.runInfo.setDownlinkDropBytes(e)},getDownlinkUpKbits:function(){return this.runInfo.getDownlinkUpKbits()},setDownlinkUpKbits:function(e){this.runInfo.setDownlinkUpKbits(e)},getDownlinkStream:function(){return this.runInfo.getDownlinkStream()},setDownlinkStream:function(e){this.runInfo.setDownlinkStream(e)},getDownlinkVideoLossRate:function(){return this.runInfo.getDownlinkVideoLossRate()},getDownlinkAudioLossRate:function(){return this.runInfo.getDownlinkAudioLossRate()},getDownlinkLinkType:function(){return this.runInfo.getDownlinkLinkType()},getUplinkVideoBandwidth:function(){return this.runInfo.uplinkVideoBandwidth},setUplinkVideoBandwidth:function(e){this.runInfo.setUplinkVideoBandwidth(e)},setUplinkAudioBandwidth:function(e){this.runInfo.setUplinkAudioBandwidth(e)},getUplinkAudioBandwidth:function(){return this.runInfo.uplinkAudioBandwidth},setUplinkDropPacket:function(e){this.runInfo.setUplinkDropPacket(e)},getUplinkStream:function(){return this.runInfo.getUplinkStream()},setUplinkStream:function(e){this.runInfo.setUplinkStream(e)},getUplinkVideoLossRate:function(){return this.runInfo.getUplinkVideoLossRate()},getUplinkAudioLossRate:function(){return this.runInfo.getUplinkAudioLossRate()},getUplinkLinkType:function(){return this.runInfo.getUplinkLinkType()},getLinkVolume:function(){return this.runInfo.getLinkVolume()},setLinkVolume:function(e){this.runInfo.setLinkVolume(e)},setUplinkVideoLossRate:function(e){this.runInfo.setUplinkVideoLossRate(e)},setUplinkAudioLossRate:function(e){this.runInfo.setUplinkAudioLossRate(e)},setDownlinkVideoLossRate:function(e){this.runInfo.setDownlinkVideoLossRate(e)},setDownlinkAudioLossRate:function(e){this.runInfo.setDownlinkAudioLossRate(e)},getUplinkServer:function(){return this.serverInfo.getUplinkServer()},setUplinkServer:function(e,t){this.serverInfo.setUplinkServer(e,t)},switchUplinkServer:function(){this.serverInfo.switchUplinkServer()},getDownlinkServer:function(){return this.serverInfo.getDownlinkServer()},getDynamicDownlinkServer:function(){return this.serverInfo.getDynamicDownlinkServer()},getDynamicUplinkServer:function(){return this.serverInfo.getDynamicUplinkServer()},setDownlinkServer:function(e,t){this.serverInfo.setDownlinkServer(e,!1,t)},switchDownlinkServer:function(e){this.serverInfo.switchDownlinkServer(e)},getUplinkIndex:function(){return this.serverInfo.uplinkIndex},getDownlinkIndex:function(){return this.serverInfo.downlinkIndex},publishAVConnectSuccess:function(){(this.videoOn||this.audioOn)&&this.statusInfo.publishAVConnectSuccess()},publishAVConnectFail:function(){(this.videoOn||this.audioOn)&&this.statusInfo.publishAVConnectFail()},getPublishAVConnectSuccessTime:function(){return this.statusInfo.publishAVConnectSuccessTime},publishAVSuccess:function(){(this.videoOn||this.audioOn)&&this.statusInfo.publishAVSuccess()},publishAVFail:function(){(this.videoOn||this.audioOn)&&this.statusInfo.publishAVFail()},playAVConnectSuccess:function(){if(this.videoOn||this.audioOn){this.statusInfo.player=this,this.statusInfo.playAVConnectSuccess(),this.reconnectTimer&&clearTimeout(this.reconnectTimer);var e=this;this.reconnectTimer=setTimeout(function(){e.playAVConnectFail()},s.AV_PLAY_TIMEOUT)}},playAVConnectFail:function(){this.swf&&(this.videoOn||this.audioOn)&&(this.statusInfo.player=this,this.statusInfo.playAVConnectFail())},getPlayAVConnectSuccessTime:function(){return this.statusInfo.player=this,this.statusInfo.playAVConnectSuccessTime},playAVSuccess:function(){(this.videoOn||this.audioOn)&&(this.statusInfo.player=this,this.statusInfo.playAVSuccess(),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null))},playAVFail:function(){(this.videoOn||this.audioOn)&&(this.statusInfo.player=this,this.statusInfo.playAVFail())},getUserVideoOn:function(){var e=this.user;return this.isAssist?e.mediaExtMap[e.id2]&&e.mediaExtMap[e.id2].videoOn:e.videoOn},getUserAudioOn:function(){var e=this.user;return!this.isAssist&&e.audioOn},getUserPublishIndex:function(){var e=this.user;return e.mediaExtMap=e.mediaExtMap||{},e.mediaExtMap[e.id2]||(e.mediaExtMap[e.id2]={publishIndex:0}),this.isAssist?e.mediaExtMap[e.id2].publishIndex:e.publishIndex},increaseUserPublishIndex:function(){var e=this.user;this.isAssist?e.mediaExtMap[e.id2].publishIndex++:e.publishIndex++},getUserPublishServer:function(){var e=this.user,t=e.publishServer,n=e.id2;return this.isAssist&&e.mediaExtMap&&e.mediaExtMap[n].publishServer&&$.extend(t,e.mediaExtMap[n].publishServer),t},getInputVolume:function(){return C(this,"getInputVolume")},openCamera:function(){this.cameraOn=!0,C(this,"openCamera")},closeCamera:function(){this.cameraOn=!1,C(this,"closeCamera")},openMic:function(e){this.micOn=!0,C(this,"openMic",[e])},closeMic:function(){this.micOn=!1,C(this,"closeMic")},getId:function(){return this.id},isPull:function(){return!this.isPush()&&!this.isSetting},isPush:function(){return this.isMainPush()||this.isAssistPush()},isMainPush:function(){return a.isSelf(this.id)&&!this.isSetting},isAssistPush:function(){return a.isSelfAssist(this.id)&&!this.isSetting},isWebRTCMixPull:function(){return!!this.isWebRTCMix&&this.isPull()},initStreamBuffer:function(e){C(this,"initStreamBuffer",[e])},setStreamBuffer:function(e){C(this,"setStreamBuffer",[e])},switchAudioStream:function(e){C(this,"switchAudioStream",[e])},switchVideoStream:function(e){C(this,"switchVideoStream",[e])},getServer:function(){return this.isWebRTC()?this.isWebRTCMixPull()?_:p:this.linkType===s.LINK_TYPE_UDP?f:_},remount:function(){return!(!this.videoOn&&!this.audioOn)&&(C(this,"remount"),!0)},popupWindow:function(e){return C(this,"popupWindow",[{popup:!!e}])},logConsole:function(e){u.primary("flash callback",e)},DownlinkFirstDataReport:function(e){JSON.parse(e).code},isCameraSource:function(){return!(!this.isPush()||!this.attachVideoOptions)&&("camera"===this.attachVideoOptions.source||"Camera"===this.attachVideoOptions.ContentType)},getStreamResolution:function(){if(this.isPush()&&("flash"===this.extension.name||"cef"===this.extension.name&&o.get("cefApiVersion")<"7.4.0")){var e=d.getCameraConfig(d.getCameraQuality(),d.getCameraRatio(),this.isAssist),t=$.Deferred(),n={width:e.cameraWidth,height:e.cameraHeight};return setTimeout(function(){t.resolve(n)},0),t}return C(this,"getStreamResolution")},disableStream:function(e){var t=this;function n(){if(t.isPush()&&t.isWebRTC())switch(e){case S:t.__avStream&&(l.isBJYWebRTC()?C(t,"muteVideo"):l.isAGORAWebRTC()&&t.__avStream.muteVideo());break;case A:t.__screenStream&&(l.isBJYWebRTC()?t.__screenStream.disableVideo():l.isAGORAWebRTC()&&t.__screenStream.muteVideo());break;case y:t.__fileStream&&(l.isBJYWebRTC()?t.__fileStream.disableVideo():l.isAGORAWebRTC()&&t.__fileStream.muteVideo())}}t.disableStreamTimer&&(clearTimeout(t.disableStreamTimer),t.disableStreamTimer=null,t.disableStreamWaitingStatus=null),l.isBJYWebRTC()?n():l.isAGORAWebRTC()&&(t.disableStreamTimer=setTimeout(function(){n(),t.disableStreamTimer=null,t.disableStreamWaitingStatus=null},4e3),t.disableStreamWaitingStatus=e)},enableStream:function(e){if(this.isPush()&&this.isWebRTC()){switch(e){case S:this.__avStream&&this.videoOn&&(l.isBJYWebRTC()?C(this,"unmuteVideo"):l.isAGORAWebRTC()&&this.__avStream.unmuteVideo());break;case A:this.__screenStream&&(l.isBJYWebRTC()?this.__screenStream.enableVideo():l.isAGORAWebRTC()&&this.__screenStream.unmuteVideo());break;case y:this.__fileStream&&(l.isBJYWebRTC()?this.__fileStream.enableVideo():l.isAGORAWebRTC()&&this.__fileStream.unmuteVideo())}this.disableStreamWaitingStatus===e&&(clearTimeout(this.disableStreamTimer),this.disableStreamTimer=null,this.disableStreamWaitingStatus=null)}},getActiveMediaView:function(){return this.mediaStatusStack[this.mediaStatusStack.length-1]},getMediaStatusInsertIndex:function(e){var t=0;return Yox.array.each(this.mediaStatusStack,function(n,i){T[n]<T[e]&&(t=i+1)},!0),t},pushStatus:function(e){var t,n=this;Yox.array.has(n.mediaStatusStack,e)||n.pushWaitingStatus===e||(n.pushStatusTimer&&(n.pushWaitingStatus&&i(n.pushWaitingStatus),clearTimeout(n.pushStatusTimer),n.pushStatusTimer=null,n.pushWaitingStatus=null),l.isBJYWebRTC()||e===S||n.isPush()?i(e):l.isAGORAWebRTC()&&(n.pushStatusTimer=setTimeout(function(){i(e),n.pushStatusTimer=null,n.pushWaitingStatus=null},4e3),n.pushWaitingStatus=e));function i(e){if(n.mediaStatusStack.length){var i=n.getActiveMediaView();T[i]<=T[e]?(n.disableStream(i),(t=I(n,i))&&(t.style.display="none"),n.mediaStatusStack.push(e),(t=I(n,e))&&(t.style.display="block")):(n.mediaStatusStack.splice(n.getMediaStatusInsertIndex(e),0,e),n.disableStream(e),(t=I(n,e))&&(t.style.display="none"))}else n.mediaStatusStack.push(e),(t=I(n,e))&&(t.style.display="block")}},popStatus:function(e){if(this.pushWaitingStatus===e&&(clearTimeout(this.pushStatusTimer),this.pushStatusTimer=null,this.pushWaitingStatus=null),Yox.array.has(this.mediaStatusStack,e)){if(Yox.array.indexOf(this.mediaStatusStack,e)===this.mediaStatusStack.length-1){this.mediaStatusStack.pop();var t,n=this.getActiveMediaView();this.enableStream(n),(t=I(this,n))&&(t.style.display="block")}else Yox.array.remove(this.mediaStatusStack,e);(t=I(this,e))&&(t.style.display="none")}},initMediaStatus:function(){var e=this,t=e.user;e.isPull()&&(e.isAssist||!t.videoOn&&!t.audioOn||e.pushStatus(S),t.mediaExtMap&&Yox.object.each(t.mediaExtMap,function(n,i){l.mediaAssistCamera(i)?e.isAssist&&n.videoOn&&e.pushStatus(S):l.mediaMainScreenShare(i)&&!l.mediaPopupScreenShare(t)?!e.isAssist&&n.videoOn&&e.pushStatus(A):l.mediaAssistScreenShare(i)&&!l.mediaPopupScreenShare(t)?e.isAssist&&n.videoOn&&e.pushStatus(A):l.mediaFile(i)&&!l.mediaPopupMediaPlayer()&&!e.isAssist&&n.videoOn&&e.pushStatus(y)}))}},R.instances={},c.on(c.MEDIA_REMOTE_CONTROL_TRIGGER,function(e,t){var n=R.instances[t.user.id];n&&n.disableVideo&&!n.forceDisableVideo&&!1===t.videoOn&&(n.disableVideo=!1)}).on(c.MEDIA_PUBLISH,function(e,t){var n=R.instances[t.user.id],i=t.skipRelease;b(n,t.isScreenSharing),n&&(t.videoOn||t.audioOn?n.pushStatus(S):n.popStatus(S)),t.videoOn&&n&&!n.videoOn&&(i=!1),!0!==i&&L(n,null,t.actionType)}).on(c.MEDIA_REPUBLISH,function(e,t){var n=R.instances[t.user.id];b(n,t.isScreenSharing),L(n)}).on(c.ASSIST_MEDIA_PUBLISH,function(e,t){var n,i=t.mediaId;l.mediaAssistCamera(i)?(L(n=R.instances[t.user.id2]),n&&(t.videoOn?n.pushStatus(S):n.popStatus(S))):l.mediaMainScreenShare(i)?(n=R.instances[t.user.id],l.mediaPopupScreenShare(n&&n.user)||(b(n,t.videoOn),n&&(t.videoOn?n.pushStatus(A):n.popStatus(A)))):l.mediaAssistScreenShare(i)?(n=R.instances[t.user.id2],l.mediaPopupScreenShare(n&&n.user)||(b(n,t.videoOn),n&&(t.videoOn?n.pushStatus(A):n.popStatus(A)))):l.mediaFile(i)&&!l.mediaPopupMediaPlayer()&&(n=R.instances[t.user.id])&&(t.videoOn?n.pushStatus(y):n.popStatus(y))}).on(c.ASSIST_MEDIA_REPUBLISH,function(e,t){var n=R.instances[t.user.id2];b(n,t.isScreenSharing),L(n)}).on(c.WEBRTC_MIX_MEDIA_PUBLISH,function(e,t){t.skipRelease||L(R.instances[t.user.id])}).on(c.USER_UPDATE,function(e,t){var n=R.instances[t.user.id],i=R.instances[t.user.id2];n&&(n.user=t.user),i&&(i.user=t.user)}).on(c.AV_PLAY_TIMEOUT,function(e,t){t.player.playAVConnectFail()}).on(c.DOWNLINK_LINK_TYPE_CHANGE,function(e,t){var n=t.value;$.each(R.instances,function(e,i){i.isPull()&&i.linkType!==n&&i.user.linkType!==s.LINK_TYPE_TCP&&(i.linkType=n,i.setDownlinkServer(t.server))})}).on(c.UPLINK_LINK_TYPE_CHANGE,function(e,t){var n=t.value;$.each(R.instances,function(e,i){i.isPush()&&i.linkType!==n&&(i.linkType=n,i.setUplinkServer(t.server))})}).on(c.DOWNLINK_SERVER_NODE_CHANGE,function(e,t){$.each(R.instances,function(e,n){n.isPull()&&n.user.linkType!==s.LINK_TYPE_TCP&&n.setDownlinkServer(t.server)})}).on(c.UPLINK_SERVER_NODE_CHANGE,function(e,t){$.each(R.instances,function(e,n){n.isPush()&&n.setUplinkServer(t.server)})}).on(c.DOWNLINK_BLOCK,function(e,t){var n=t.player;n&&!n.isDisposed()&&(null==n.blockCount&&(n.blockCount=0),n.blockCount++,c.trigger(c.DOWNLINK_BLOCK_COUNT_CHANGE,{player:n}))}).on(c.UPLINK_BLOCK,function(e,t){var n=t.player;n&&!n.isDisposed()&&(null==n.blockCount&&(n.blockCount=0),n.blockCount++,c.trigger(c.UPINK_BLOCK_COUNT_CHANGE,{player:n}))}).on(c.CLASSROOM_EXIT_END,function(e,t){Yox.object.each(R.instances,function(e){e.dispose()})}),R.MEDIA_STATUS_CAMERA=S,R.MEDIA_STATUS_SCREEN=A,R.MEDIA_STATUS_FILE=y,BJY.Player=R,BJY.webrtcMixMediaPublish=m,R}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){var t=BJY.is,i=BJY.auth,r=BJY.store,a=BJY.config,o=BJY.data.media,s=BJY.eventEmitter,u=n(47),c=n(491),l=n(492),d=10;function _(){var e=r.get("partner.livePacketLossDuration");e&&(d=e),_=$.noop}function f(e,t){t=+t||0,e.push(t);var n=0;return e.length>d&&(e.shift(),(n=e.reduce(function(e,t){return e+t})/e.length)>=0&&n.toFixed(2)),n}function p(e){this.player=e,this.init()}function h(e,t){var n=e[t];return n>=0?n:-1}return p.prototype={constructor:p,init:function(){var e=this;if(e.reset(),e.uplinkStream={},e.downlinkStream={},_(),e.fireRunInfo=u(function(){var e=this;s.trigger(s.PLAYER_RUN_INFO_CHANGE,{uplinkVideoBandwidth:e.uplinkVideoBandwidth,uplinkAudioBandwidth:e.uplinkAudioBandwidth,downlinkVideoBandwidth:e.downlinkVideoBandwidth,downlinkAudioBandwidth:e.downlinkAudioBandwidth,uplinkVideoAverageLossRate:e.uplinkVideoAverageLossRate,uplinkAudioAverageLossRate:e.uplinkAudioAverageLossRate,downlinkVideoAverageLossRate:e.downlinkVideoAverageLossRate,downlinkAudioAverageLossRate:e.downlinkAudioAverageLossRate,player:e.player})},a.SECOND),!e.player.isAssist&&e.player.isPush()&&e.player.extension&&("cef"===e.player.extension.name&&r.get("class.liveAudioCodec")===a.AUDIO_CODEC_AAC||"webrtc"===e.player.extension.name)&&t.isBJYWebRTC()){e.minUplinkAudioBandwidth=.5*(i.isWebRTC()?o.getAudioBitrate(o.getCameraQuality()):32);e.uplinkAudioLowRate=function(t){e.player&&e.player.audioOn?t>e.minUplinkAudioBandwidth&&e.uplinkAudioLowRateTimer?(clearTimeout(e.uplinkAudioLowRateTimer),e.uplinkAudioLowRateTimer=null):t<e.minUplinkAudioBandwidth&&!e.uplinkAudioLowRateTimer&&(e.uplinkAudioLowRateTimer=setTimeout(function(){s.trigger(s.PLAYER_RUN_WARN,{code:a.PLAYER_RUN_WARN_CODE.lowUplinkAudioBandwidth,data:{minUplinkAudioBandwidth:e.minUplinkAudioBandwidth,maxLowUplinkAudioBandwidthInertval:10}}),e.uplinkAudioLowRateTimer=null},1e4)):e.uplinkAudioLowRateTimer&&(clearTimeout(e.uplinkAudioLowRateTimer),e.uplinkAudioLowRateTimer=null)}}},reset:function(){var e=this;e.rtt=e.downlinkTotalBytes=e.downlinkDropBytes=e.downlinkUpKbits=e.downlinkDropPacket=e.uplinkDropPacket=e.downlinkVideoBufferLength=e.downlinkAudioBufferLength=e.uplinkVideoBandwidth=e.uplinkAudioBandwidth=e.downlinkVideoBandwidth=e.downlinkAudioBandwidth=e.uplinkVideoLossRate=e.uplinkAudioLossRate=e.downlinkVideoLossRate=e.downlinkAudioLossRate=e.uplinkVideoAverageLossRate=e.uplinkAudioAverageLossRate=e.downlinkVideoAverageLossRate=e.downlinkAudioAverageLossRate=-1,e.uplinkVideoLossRatePool=[],e.uplinkAudioLossRatePool=[],e.downlinkVideoLossRatePool=[],e.downlinkAudioLossRatePool=[]},getRtt:function(){return this.rtt},setRtt:function(e){this.rtt=e},getDownlinkTotalBytes:function(){return this.downlinkTotalBytes},setDownlinkTotalBytes:function(e){this.downlinkTotalBytes=e},getDownlinkDropBytes:function(){return this.downlinkDropBytes},setDownlinkDropBytes:function(e){this.downlinkDropBytes=e},getDownlinkUpKbits:function(){return this.downlinkUpKbits},setDownlinkUpKbits:function(e){this.downlinkUpKbits=e},getDownlinkVideoBufferLength:function(){return this.downlinkVideoBufferLength},setDownlinkVideoBufferLength:function(e){var t=this.player;this.downlinkVideoBufferLength!==e&&(this.downlinkVideoBufferLength=e,s.trigger(s.DOWNLINK_VIDEO_BUFFER_CHANGE,{player:t})),e>a.THRESHOLD_VIDEO_BUFFER_LENGTH&&s.trigger(s.DOWNLINK_BUFFER_OVERFLOW,{player:t})},getDownlinkAudioBufferLength:function(){return this.downlinkAudioBufferLength},setDownlinkAudioBufferLength:function(e){this.downlinkAudioBufferLength!==e&&(this.downlinkAudioBufferLength=e,s.trigger(s.DOWNLINK_AUDIO_BUFFER_CHANGE,{player:this.player}))},setDownlinkVideoBandwidth:function(e){var t=this.player,n=this.downlinkVideoBandwidth;n<0&&e<=0||n!==e&&(n<0&&e>0&&t.playAVSuccess(),this.downlinkVideoBandwidth=e,n<0&&e>0&&s.trigger(s.DOWNLINK_VIDEO_DATA_OCCUR,{player:t}),s.trigger(s.DOWNLINK_VIDEO_BANDWIDTH_CHANGE,{player:t}),this.fireRunInfo())},setDownlinkAudioBandwidth:function(e){var t=this.player,n=this.downlinkAudioBandwidth;n<0&&e<=0||n!==e&&(n<0&&e>0&&t.playAVSuccess(),this.downlinkAudioBandwidth=e,n<0&&e>0&&s.trigger(s.DOWNLINK_AUDIO_DATA_OCCUR,{player:t}),s.trigger(s.DOWNLINK_AUDIO_BANDWIDTH_CHANGE,{player:t}),this.fireRunInfo())},setUplinkVideoBandwidth:function(e){var t=this.player,n=this.uplinkVideoBandwidth;n<0&&e<=0||n!==e&&(n<0&&e>0&&t.publishAVSuccess(),this.uplinkVideoBandwidth=e,n<0&&e>0&&s.trigger(s.UPLINK_VIDEO_DATA_OCCUR,{player:t}),s.trigger(s.UPLINK_VIDEO_BANDWIDTH_CHANGE,{player:t}),this.fireRunInfo())},setUplinkAudioBandwidth:function(e){var t=this.player,n=this.uplinkAudioBandwidth;n<0&&e<=0||n!==e&&(n<0&&e>0&&t.publishAVSuccess(),this.uplinkAudioBandwidth=e,n<0&&e>0&&s.trigger(s.UPLINK_AUDIO_DATA_OCCUR,{player:t}),s.trigger(s.UPLINK_AUDIO_BANDWIDTH_CHANGE,{player:t}),this.fireRunInfo())},getUplinkDropPacket:function(){return this.uplinkDropPacket},setUplinkDropPacket:function(e){this.uplinkDropPacket=e,e>0&&s.trigger(s.UPLINK_DROP_PACKET,{player:this.player,drop:e})},getUplinkVideoLossRate:function(){return this.uplinkVideoLossRate},setUplinkVideoLossRate:function(e){l.call(this.player,this.uplinkVideoLossRate,e,!1),this.uplinkVideoLossRate=e,this.uplinkVideoAverageLossRate=f(this.uplinkVideoLossRatePool,e),this.fireRunInfo()},getUplinkAudioLossRate:function(){return this.uplinkAudioLossRate},setUplinkAudioLossRate:function(e){l.call(this.player,this.uplinkAudioLossRate,e,!0),this.uplinkAudioLossRate=e,this.uplinkAudioAverageLossRate=f(this.uplinkAudioLossRatePool,e)},getDownlinkVideoLossRate:function(){return this.downlinkVideoLossRate},setDownlinkVideoLossRate:function(e){this.downlinkVideoLossRate=e,this.downlinkVideoAverageLossRate=f(this.downlinkVideoLossRatePool,e)},getDownlinkAudioLossRate:function(){return this.downlinkAudioLossRate},setDownlinkAudioLossRate:function(e){this.downlinkAudioLossRate=e,this.downlinkAudioAverageLossRate=f(this.downlinkAudioLossRatePool,e)},getDownlinkDropPacket:function(){return this.downlinkDropPacket},setDownlinkDropPacket:function(e){this.downlinkDropPacket=e,e>0&&s.trigger(s.DOWNLINK_DROP_PACKET,{player:this.player,total:this.downlinkTotalBytes,drop:e})},setDownlinkLinkType:function(e){this.downlinkLinkType=e},getDownlinkLinkType:function(){return this.downlinkLinkType},setUplinkLinkType:function(e){this.uplinkLinkType=e},getUplinkLinkType:function(){return this.uplinkLinkType},getUplinkStream:function(){return this.uplinkStream},setUplinkStream:function(e){var t=this,n=t.uplinkStream;e?$.extend(n,e):n=t.uplinkStream={};var i=n.stream||{},r=c(i.videoBytesPerSecond),a=c(i.audioBytesPerSecond),o=c(i.currentBytesPerSecond);o>=0&&a<0&&(r=a=o),t.setUplinkVideoBandwidth(r),t.setUplinkAudioBandwidth(a);var s=h(i,"droppedFrames");t.setUplinkDropPacket(s),t.setUplinkVideoLossRate(i.videoLossRate),t.setUplinkAudioLossRate(i.audioLossRate),t.setUplinkLinkType(i.linkType)},getDownlinkStream:function(){return this.downlinkStream},setDownlinkStream:function(e){var t=this,n=(t.player,t.downlinkStream);e?$.extend(n,e):n=t.downlinkStream={};var i=n.stream||{},r=c(i.videoBytesPerSecond),a=c(i.audioBytesPerSecond),o=c(i.currentBytesPerSecond);o>=0&&a<0&&(r=a=o);var s=a>0?"audio":"video",u=h(n,s+"TotalBytes"),l=h(n,s+"DropBytes"),d=h(n,s+"UpKbits");t.setDownlinkTotalBytes(u),t.setDownlinkDropBytes(l),t.setDownlinkDropPacket(l),t.setDownlinkUpKbits(d),t.setDownlinkVideoBandwidth(r),t.setDownlinkAudioBandwidth(a),t.setDownlinkVideoBufferLength(h(i,"videoBufferLength")),t.setDownlinkAudioBufferLength(h(i,"audioBufferLength")),t.setDownlinkVideoLossRate(i.videoLossRate),t.setDownlinkAudioLossRate(i.audioLossRate),t.setDownlinkLinkType(i.linkType)},getLinkVolume:function(){return this.linkVolume},setLinkVolume:function(e){this.getLinkVolume()!==e&&(this.linkVolume=e,s.trigger(s.LINK_VOLUME_CHANGE,{player:this.player}))},dispose:function(){this.player=null}},p}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(323);return function(e){return e>=0?r(8*e/1024,2):-1}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var n=BJY.auth,i=BJY.config,r=BJY.data.user,a=BJY.eventEmitter;return a.on(a.BROADCAST_RECEIVE,function(e,t){if("presenter_uplink_loss_rate"===t.key&&t.value&&!n.isSelf(t.fromId)){var a=t.value.user_id,o=t.value.media_id,s=t.value.type,u=t.value.rate,c=r.find(a);if(!c)return;var l=BJY.Player.instances[o===c.id2||o===i.MEDIA_TYPE_ASSIST_SCREEN_SHARE?c.id2:a];if(!l)return;0===s?l.setUplinkAudioLossRate(u):l.setUplinkVideoLossRate(u)}}),function(e,t,n){}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){var t=BJY.store,i=BJY.config,r=BJY.eventEmitter,a=(BJY.getExtension,n(494)),o=(n(199),n(3)),s=BJY.server.room,u=BJY.data.media;function c(e){this.player=e,this.init()}return c.prototype={constructor:c,init:function(){this.uplinkIndex=this.downlinkIndex=0,this.canSwitchUplinkServer=this.canSwitchDownlinkServer=!0},getUplinkServer:function(){return this.uplinkServer||(this.uplinkServer=this.player.user.publishServer),this.uplinkServer},setUplinkServer:function(e,n){var o=this.getUplinkServer();if(n=n||i.MEDIA_PUBLISH_BY_LINK_TYPE,(e.ip&&e.port||e.name)&&!a(o,e)){var s=this.player,u=s.user;this.uplinkServer=u.publishServer=e,1!==t.get("partner.av.liveStreamIndexUnchanged")&&(this.uplinkIndex++,s.increaseUserPublishIndex()),s.getServer().setActiveUplinkServer(e);var c=!1;e.name&&(c=!0),c||s.republish(!0,n),r.trigger(r.UPLINK_SERVER_CHANGE,{player:s,from:o,to:e})}},switchUplinkServer:function(){var e=this;if(e.canSwitchUplinkServer){var t=e.player.getServer();e.setUplinkServer(t.switchUplinkServer(e.getUplinkServer())),e.canSwitchUplinkServer=!1,setTimeout(function(){e.player&&(e.canSwitchUplinkServer=!0,e.needSwitchUplinkServer&&(e.switchUplinkServer(),e.needSwitchUplinkServer=!1))},i.LIVE_SERVER_UPLINK_SWITCH_INTERVAL)}else e.needSwitchUplinkServer=!0},getDownlinkServer:function(){var e=this;return!e.downlinkServer&&e.player&&(e.downlinkServer=e.player.getServer().getActiveDownlinkServer()),e.downlinkServer},getDynamicUplinkServer:function(){var e=this.player,n=e.user,r=e.isAssist?u.getAssistCameraQuality():u.getCameraQuality(),a=u.getCameraConfig(r,u.getCameraRatio()),c=e.linkType,l=e.getServer().getActiveUplinkServer(),d=$.Deferred(),_={linkType:c,definitions:[{type:i.CAMERA_QUALITY_MAP[r],width:a.cameraWidth,height:a.cameraHeight,frame_per_second:a.cameraFps,bitrate:a.cameraBandwidth,audio_codec:o(t.get("class.liveAudioCodec"),i.AUDIO_CODEC_AAC)}]};return e.serverShutDown&&(_.sessionId=n.sessionId),c===i.LINK_TYPE_TCP&&(_.preferredCdn=l.tag),s.getUplinkServerInfo(_).then(function(t){e.serverShutDown=!1,d.resolve(t)}),d},getDynamicDownlinkServer:function(){var e=this,t=e.player,n=t.user,r=$.Deferred(),a=BJY.Player,o=t.getServer();if(n.sessionId){var u={isRetry:t.serverShutDown,linkType:t.linkType,sessionId:n.sessionId},c=n.definitions;c&&c.length&&(u.definition={type:c[0]}),u.linkType===i.LINK_TYPE_TCP&&(u.preferredCdn=o.getActiveDownlinkServer().tag),s.getDownlinkServerInfo(u).then(function(n){if(t.serverShutDown=!1,n.code)r.resolve(e.getDownlinkServer());else if(n.linkType===i.LINK_TYPE_TCP){var o=n.tcp;r.resolve({ip:a&&a.html?a.ignoreHLS?o.pull:o.hls:o.pull,hlsSuffix:o.hlsSuffix,speexToAacSuffix:o.speexToAacSuffix,port:1935,mount:"mgclient"})}else{o=n.udp;r.resolve({ip:o.ip,port:o.port})}},function(){r.reject({reason:i.SIGNAL_RES_TIMEOUT})})}else r.resolve(e.getDownlinkServer());return r},setDownlinkServer:function(e,t,n){var i=this.getDownlinkServer();if(e&&(e.ip&&e.port||e.name)&&!a(i,e)){var o=this.player;this.downlinkServer=e,this.downlinkIndex++;var s=!1;e.name&&(s=!0,o.getServer().setActiveDownlinkServer(e)),s||o.replay(!0,n),r.trigger(r.DOWNLINK_SERVER_CHANGE,{player:o,from:i,to:e,needReport:t})}},switchDownlinkServer:function(e){var t=this;if(t.canSwitchDownlinkServer){var n=t.player.getServer();t.setDownlinkServer(n.switchDownlinkServer(t.getDownlinkServer()),e),t.canSwitchDownlinkServer=!1,setTimeout(function(){t.player&&(t.canSwitchDownlinkServer=!0,t.needSwitchDownlinkServer&&(t.switchDownlinkServer(t.needSwitchDownlinkServer.needReport),t.needSwitchDownlinkServer=null))},i.LIVE_SERVER_DOWNLINK_SWITCH_INTERVAL)}else t.needSwitchDownlinkServer={needReport:e}},dispose:function(){this.player=null}},c}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0),a=r(n(104)),o=r(n(228));void 0===(i=function(e,t,n){return function e(t,n){if(null==t||null==n)return t===n;if(t.constructor!==n.constructor)return!1;if(t instanceof Function)return t===n;if(t instanceof RegExp)return t===n;if(t===n||t.valueOf()===n.valueOf())return!0;if((0,o.default)(t)&&t.length!==n.length)return!1;if(t instanceof Date)return!1;if(!(t instanceof Object))return!1;if(!(n instanceof Object))return!1;var i=(0,a.default)(t);return(0,a.default)(n).every(function(e){return-1!==i.indexOf(e)})&&i.every(function(i){return e(t[i],n[i])})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e){var t=BJY.store,n=BJY.config,i=BJY.eventEmitter;function r(e){this.player=e,this.init()}function a(e,t){e[t]&&(clearTimeout(e[t]),e[t]=null)}function o(e,t){a(t.player,"publishTimer")}function s(e,t){a(t.player,"playTimer")}function u(e,t){a(t.player,"createTimer")}return r.prototype={constructor:r,init:function(){this.reset()},reset:function(){var e=this;e.publishAVConnectFailCount=e.publishAVFailCount=e.playAVConnectFailCount=e.playAVFailCount=0,e.publishAVConnectSuccessTime=e.playAVConnectSuccessTime=e.publishAVSuccessTime=e.playAVSuccessTime=-1,e.republishTimer&&(clearTimeout(e.republishTimer),e.republishTimer=null),e.replayTimer&&(clearTimeout(e.replayTimer),e.replayTimer=null)},publishAVConnectSuccess:function(){var e=this.player;this.publishAVConnectSuccessTime=$.now(),this.publishAVConnectFailCount=0,i.trigger(i.AV_PUBLISH_CONNECT_SUCCESS,{player:e})},publishAVConnectFail:function(){var e=this,r=e.player;if(!r.isDisposed()){r.user;e.publishAVConnectSuccessTime=-1,i.trigger(i.AV_PUBLISH_CONNECT_FAIL,{player:r}),!t.get("offline")&&++e.publishAVConnectFailCount<n.AV_RECONNECT_COUNT?e.republishTimer=setTimeout(function(){e.republishTimer=null,r.republish(!0)},1e4):e.publishAVFail()}},publishAVSuccess:function(){var e=this.player;this.publishAVSuccessTime<0&&(this.publishAVSuccessTime=$.now(),this.publishAVConnectFailCount=0,i.trigger(i.AV_PUBLISH_SUCCESS,{player:e}))},publishAVFail:function(){var e=this.player;this.publishAVSuccessTime=-1,this.publishAVConnectFailCount=0,this.publishAVFailCount++,i.trigger(i.AV_PUBLISH_FAIL,{player:e})},playAVConnectSuccess:function(){var e=this.player,t=e.user;(t.videoOn||t.audioOn)&&this.playAVConnectSuccessTime<0&&(this.playAVConnectSuccessTime=$.now(),this.playAVConnectFailCount=0,i.trigger(i.AV_PLAY_CONNECT_SUCCESS,{player:e}))},playAVConnectFail:function(){var e=this,t=e.player,r=t.user;(r.videoOn||r.audioOn)&&(e.playAVConnectSuccessTime=-1,i.trigger(i.AV_PLAY_CONNECT_FAIL,{player:t}),e.playAVConnectFailCount+=1,e.playAVConnectFailCount<n.AV_RECONNECT_COUNT?e.replayTimer=setTimeout(function(){t.replay(!0)},5e3):e.playAVFail())},playAVSuccess:function(){var e=this.player;this.playAVSuccessTime=$.now(),this.playAVConnectFailCount=0,i.trigger(i.AV_PLAY_SUCCESS,{player:e})},playAVFail:function(){var e=this.player;this.playAVSuccessTime=-1,this.playAVConnectFailCount=0,this.playAVFailCount++,i.trigger(i.AV_PLAY_FAIL,{player:e})},dispose:function(){this.player=null,this.republishTimer&&(clearTimeout(this.republishTimer),this.republishTimer=null),this.replayTimer&&(clearTimeout(this.replayTimer),this.replayTimer=null)}},i.on(i.AV_PUBLISH_END,function(e,t){var r=t.player;r.setUplinkVideoBandwidth(-1),r.setUplinkAudioBandwidth(-1),o(0,t),r.publishTimer=setTimeout(function(){r.isDisposed()||i.trigger(i.AV_PUBLISH_TIMEOUT,{player:r})},n.AV_PUBLISH_TIMEOUT)}).on(i.AV_PUBLISH_CLOSE_END,o).on(i.AV_PUBLISH_RELEASE_END,o).on(i.AV_PUBLISH_SUCCESS,o).on(i.AV_PUBLISH_FAIL,o).on(i.AV_PLAY_START,function(e,t){var r=t.player,a=".sdk_player_core_av_play",o=function(e,t){s(0,t),i.off(a)},u=function(e,t){t.player===r&&o(0,t)};r.setDownlinkVideoBandwidth(-1),r.setDownlinkAudioBandwidth(-1),o(0,t),r.playTimer=setTimeout(function(){!r.isDisposed()&&r.statusInfo.playAVSuccessTime>0||i.trigger(i.AV_PLAY_TIMEOUT,{player:r})},n.AV_PLAY_TIMEOUT),i.one(i.AV_PLAY_SUCCESS+a,u).one(i.AV_PLAY_FAIL+a,u).one(i.AV_PLAY_TIMEOUT+a,u)}).on(i.AV_PLAY_CLOSE_END,s).on(i.AV_PLAY_RELEASE_END,s).on(i.AV_PLAY_SUCCESS,s).on(i.AV_PLAY_FAIL,s).on(i.PLAYER_CREATE_START,function(e,t){var r=t.player;r.setUplinkVideoBandwidth(-1),r.setUplinkAudioBandwidth(-1),r.setDownlinkVideoBandwidth(-1),r.setDownlinkAudioBandwidth(-1),u(0,t),r.createTimer=setTimeout(function(){r.isDisposed()||(i.trigger(i.PLAYER_CREATE_TIMEOUT,{player:r}),i.trigger(i.PLAYER_CREATE_END,{player:r}))},n.PLAYER_CREATE_TIMEOUT)}).on(i.PLAYER_CREATE_END,u),r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i=1,r=BJY.data.user,a=BJY.config,o=[a.MEDIA_TYPE_ASSIST_CAMERA,a.MEDIA_TYPE_FILE,a.MEDIA_TYPE_MAIN_SCREEN_SHARE,a.MEDIA_TYPE_ASSIST_SCREEN_SHARE];return function(e){var t=BJY.store,n=BJY.os,a=BJY.eventEmitter;n.android&&(i=0);var s,u,c=t.get("presenterId"),l=t.get("class.started"),d=t.get("webrtcMixUser.videoOn"),_=t.get("webrtcMixUser.audioOn");if(c&&l?(s=function(){var e,t=!1;return e=r.active(),Yox.array.each(e,function(e,n){if(e.videoOn)return t=!0,!1}),t||Yox.array.each(o,function(n,i){if(e=r.activeAssist(n),t=!!e.length)return!1}),t}(),u=function(){var e=r.active(),t=!1;return Yox.array.each(e,function(e,n){if(e.audioOn)return t=!0,!1}),t}()):s=u=!1,s!==d||u!==_){t.set("webrtcMixUser.audioOn",u),t.set("webrtcMixUser.videoOn",s);var f=(d||_)&&(s||u);d||_||!s&&!u?a.trigger(a.WEBRTC_MIX_MEDIA_PUBLISH,{user:t.get("webrtcMixUser"),videoOn:s,audioOn:u,skipRelease:f}):setTimeout(function(){a.trigger(a.WEBRTC_MIX_MEDIA_PUBLISH,{user:t.get("webrtcMixUser"),videoOn:s,audioOn:u,skipRelease:f})},1e3*i)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i=BJY.data.media,r=BJY.store;return function(e,t,n){var a,o,s,u,c;return e.isAssist?(a=i.getAssistCameraQuality(),o=i.getAssistCameraRatio(),s=i.getCameraConfig(a,o,!0),t||(t=i.getCameraList()[i.getAssistCameraIndex()]),t&&(u=t.guid)):(a=i.getCameraQuality(),o=i.getCameraRatio(),s=i.getCameraConfig(a,o,!1),t||(t=i.getCameraList()[i.getCameraIndex()]),t&&(u=t.virtual&&(c=r.get("virtualMainCamera"))&&!n?c.guid:t.guid)),{cameraQuality:a,cameraRatio:o,cameraConfig:s,cameraId:u}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.PRESENTER_IN="Teacher Camera OFF",t.PRESENTER_OUT="Left Classroom",t.PRESENTER_AUDIO_ON="Mic ON",t.PRESENTER_AUDIO_OFF="Mic OFF",t.PRESENTER_VIDEO_ON="Camera ON",t.PRESENTER_VIDEO_OFF="Camera OFF",t.PRESENTER_VIDEO_ON_AUDIO_ON="Camera ON, Mic ON",t.PRESENTER_VIDEO_ON_AUDIO_OFF="Camera ON, Mic OFF",t.PRESENTER_VIDEO_OFF_AUDIO_ON="Camera OFF, Mic ON",t.PRESENTER_VIDEO_OFF_AUDIO_OFF="Camera OFF, Mic OFF",t.PRESENTER_AUDIO_ONLY_AUDIO_ON="Audio Living",t.PRESENTER_AUDIO_ONLY_AUDIO_OFF="Mic Off",t.USER_IN="Camera OFF",t.USER_OUT="Left Classroom",t.USER_AUDIO_ON="Mic ON",t.USER_AUDIO_OFF="Mic OFF",t.USER_VIDEO_ON="Camera ON",t.USER_VIDEO_OFF="Camera OFF",t.USER_VIDEO_ON_AUDIO_ON="Camera ON, Mic ON",t.USER_VIDEO_ON_AUDIO_OFF="Camera ON, Mic OFF",t.USER_VIDEO_OFF_AUDIO_ON="Camera OFF, Mic ON",t.USER_VIDEO_OFF_AUDIO_OFF="Camera OFF, Mic OFF",t.USER_AUDIO_ONLY_AUDIO_ON="Audio Living",t.USER_AUDIO_ONLY_AUDIO_OFF="Mic Off",t.SELF_IN="Camera OFF",t.SELF_OUT="Left Classroom",t.SELF_AUDIO_ON="Mic ON",t.SELF_AUDIO_OFF="Mic OFF",t.SELF_VIDEO_ON="Camera ON",t.SELF_VIDEO_OFF="Camera OFF",t.SELF_VIDEO_ON_AUDIO_ON="Camera ON, Mic ON",t.SELF_VIDEO_ON_AUDIO_OFF="Camera ON, Mic OFF",t.SELF_VIDEO_OFF_AUDIO_ON="Camera OFF, Mic ON",t.SELF_VIDEO_OFF_AUDIO_OFF="Camera OFF, Mic OFF",t.SELF_AUDIO_ONLY_AUDIO_ON="Audio Living",t.SELF_AUDIO_ONLY_AUDIO_OFF="Mic Off",t.SELF_CAMERA_NOT_FOUND="Camera not found",t.SELF_MIC_NOT_FOUND="Mic not found",t.FOLD="Fold",t.UNFOLD="Unfold",t.REJECT="Reject",t.ACCEPT="Accept",t.VIDEO_OFF_TIP="Camera OFF",t.AUDIO_OFF_TIP="Mic OFF",t.PUBLISH_STATUS_CONNECTING="Opening Device...",t.PUBLISH_STATUS_LOADING="Sending Data...",t.PUBLISH_STATUS_FAIL="Send Failed",t.PLAY_STATUS_CONNECTING="Connecting...",t.PLAY_STATUS_LOADING="Buffering Data...",t.PLAY_STATUS_FAIL="Connect Failed",t.SPEAK_LAY="Lay",t.USER_SEAT="${userName}'s seat",t.FLASH_ERROR="Sorry, flash is not work.",t.FLASH_RUN="Try again",t.STOPPING_SPEAK_TIP="Stopping",t.PLEASE_WAIT_TIP="Please wait...",t.REFRESH_AND_RETRY="Refresh and retry",t.ALREADY_INTERACTED="Interacted",t.IS_SCREEN_SHARING="Screen sharing",t.CLASS_NOT_STARTED="Class not started",t.CLASS_STARTED="Class started",t.START_PLAY_TIPS="Click to play"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.PRESENTER_IN="主讲未开摄像头",t.PRESENTER_OUT="已离开教室",t.PRESENTER_AUDIO_ON="主讲已开麦克风",t.PRESENTER_AUDIO_OFF="主讲已关麦克风",t.PRESENTER_VIDEO_ON="主讲已开摄像头",t.PRESENTER_VIDEO_OFF="主讲已关摄像头",t.PRESENTER_VIDEO_ON_AUDIO_ON="主讲已开摄像头和麦克风",t.PRESENTER_VIDEO_ON_AUDIO_OFF="主讲已开摄像头，已关麦克风",t.PRESENTER_VIDEO_OFF_AUDIO_ON="主讲已开麦克风，已关摄像头",t.PRESENTER_VIDEO_OFF_AUDIO_OFF="主讲已关摄像头和麦克风",t.PRESENTER_AUDIO_ONLY_AUDIO_ON="主讲音频直播中",t.PRESENTER_AUDIO_ONLY_AUDIO_OFF="主讲已关麦克风",t.USER_IN="未开摄像头",t.USER_OUT="已离开房间",t.USER_AUDIO_ON="已开麦克风",t.USER_AUDIO_OFF="已关麦克风",t.USER_VIDEO_ON="已开摄像头",t.USER_VIDEO_OFF="已关摄像头",t.USER_VIDEO_ON_AUDIO_ON="已开摄像头和麦克风",t.USER_VIDEO_ON_AUDIO_OFF="已开摄像头，已关麦克风",t.USER_VIDEO_OFF_AUDIO_ON="已开麦克风，已关摄像头",t.USER_VIDEO_OFF_AUDIO_OFF="已关摄像头和麦克风",t.USER_AUDIO_ONLY_AUDIO_ON="音频直播中",t.USER_AUDIO_ONLY_AUDIO_OFF="已关麦克风",t.SELF_IN="未开摄像头",t.SELF_OUT="已离开教室",t.SELF_AUDIO_ON="已开麦克风",t.SELF_AUDIO_OFF="已关麦克风",t.SELF_VIDEO_ON="已开摄像头",t.SELF_VIDEO_OFF="已关摄像头",t.SELF_VIDEO_ON_AUDIO_ON="已开摄像头和麦克风",t.SELF_VIDEO_ON_AUDIO_OFF="已开摄像头，已关麦克风",t.SELF_VIDEO_OFF_AUDIO_ON="已开麦克风，已关摄像头",t.SELF_VIDEO_OFF_AUDIO_OFF="已关摄像头和麦克风",t.SELF_AUDIO_ONLY_AUDIO_ON="音频直播中",t.SELF_AUDIO_ONLY_AUDIO_OFF="已关麦克风",t.SELF_CAMERA_NOT_FOUND="未安装摄像头",t.SELF_MIC_NOT_FOUND="未安装麦克风",t.FOLD="收起",t.UNFOLD="展开",t.REJECT="拒绝",t.ACCEPT="同意",t.VIDEO_OFF_TIP="未开启摄像头",t.AUDIO_OFF_TIP="未开启麦克风",t.PUBLISH_STATUS_CONNECTING="正在启动设备...",t.PUBLISH_STATUS_LOADING="正在发送数据...",t.PUBLISH_STATUS_FAIL="发送数据失败",t.PLAY_STATUS_CONNECTING="与对方建立连接中...",t.PLAY_STATUS_LOADING="正在缓冲数据...",t.PLAY_STATUS_FAIL="建立连接失败",t.USER_SEAT="${userName}的位子",t.FLASH_ERROR="抱歉，Flash 没有正常运行。",t.FLASH_RUN="再试一下",t.STOPPING_SPEAK_TIP="正在终止发言",t.PLEASE_WAIT_TIP="请稍候...",t.REFRESH_AND_RETRY="刷新重试",t.ALREADY_INTERACTED="已互动",t.IS_SCREEN_SHARING="已开启屏幕共享",t.CLASS_NOT_STARTED="直播尚未开始",t.CLASS_STARTED="直播已开始",t.START_PLAY_TIPS="直播中，点击播放"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.PRESENTER_IN="老师未开摄像头",t.PRESENTER_OUT="已离开教室",t.PRESENTER_AUDIO_ON="老师已开麦克风",t.PRESENTER_AUDIO_OFF="老师已关麦克风",t.PRESENTER_VIDEO_ON="老师已开摄像头",t.PRESENTER_VIDEO_OFF="老师已关摄像头",t.PRESENTER_VIDEO_ON_AUDIO_ON="老师已开摄像头和麦克风",t.PRESENTER_VIDEO_ON_AUDIO_OFF="老师已开摄像头，已关麦克风",t.PRESENTER_VIDEO_OFF_AUDIO_ON="老师已开麦克风，已关摄像头",t.PRESENTER_VIDEO_OFF_AUDIO_OFF="老师已关摄像头和麦克风",t.PRESENTER_AUDIO_ONLY_AUDIO_ON="老师音频直播中",t.PRESENTER_AUDIO_ONLY_AUDIO_OFF="老师已关麦克风",t.USER_IN="未开摄像头",t.USER_OUT="已离开教室",t.USER_AUDIO_ON="已开麦克风",t.USER_AUDIO_OFF="已关麦克风",t.USER_VIDEO_ON="已开摄像头",t.USER_VIDEO_OFF="已关摄像头",t.USER_VIDEO_ON_AUDIO_ON="已开摄像头和麦克风",t.USER_VIDEO_ON_AUDIO_OFF="已开摄像头，已关麦克风",t.USER_VIDEO_OFF_AUDIO_ON="已开麦克风，已关摄像头",t.USER_VIDEO_OFF_AUDIO_OFF="已关摄像头和麦克风",t.USER_AUDIO_ONLY_AUDIO_ON="音频直播中",t.USER_AUDIO_ONLY_AUDIO_OFF="已关麦克风",t.SELF_IN="未开摄像头",t.SELF_OUT="已离开教室",t.SELF_AUDIO_ON="已开麦克风",t.SELF_AUDIO_OFF="已关麦克风",t.SELF_VIDEO_ON="已开摄像头",t.SELF_VIDEO_OFF="已关摄像头",t.SELF_VIDEO_ON_AUDIO_ON="已开摄像头和麦克风",t.SELF_VIDEO_ON_AUDIO_OFF="已开摄像头，已关麦克风",t.SELF_VIDEO_OFF_AUDIO_ON="已开麦克风，已关摄像头",t.SELF_VIDEO_OFF_AUDIO_OFF="已关摄像头和麦克风",t.SELF_AUDIO_ONLY_AUDIO_ON="音频直播中",t.SELF_AUDIO_ONLY_AUDIO_OFF="已关麦克风",t.SELF_CAMERA_NOT_FOUND="未安装摄像头",t.SELF_MIC_NOT_FOUND="未安装麦克风",t.FOLD="收起",t.UNFOLD="展开",t.REJECT="拒绝",t.ACCEPT="同意",t.VIDEO_OFF_TIP="未开启摄像头",t.AUDIO_OFF_TIP="未开启麦克风",t.PUBLISH_STATUS_CONNECTING="正在启动设备...",t.PUBLISH_STATUS_LOADING="正在发送数据...",t.PUBLISH_STATUS_FAIL="发送数据失败",t.PLAY_STATUS_CONNECTING="与对方建立连接中...",t.PLAY_STATUS_LOADING="正在缓冲数据...",t.PLAY_STATUS_FAIL="建立连接失败",t.USER_SEAT="${userName}的位子",t.FLASH_ERROR="抱歉，Flash 没有正常运行。",t.FLASH_RUN="再试一下",t.STOPPING_SPEAK_TIP="正在终止发言",t.PLEASE_WAIT_TIP="请稍候...",t.REFRESH_AND_RETRY="刷新重试",t.ALREADY_INTERACTED="已互动",t.IS_SCREEN_SHARING="已开启屏幕共享",t.CLASS_NOT_STARTED="课程尚未开始",t.CLASS_STARTED="课程已开始",t.START_PLAY_TIPS="直播中，点击播放"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.WATERMARK_POSITION_LEFT_TOP=1,t.WATERMARK_POSITION_RIGHT_TOP=2,t.WATERMARK_POSITION_RIGHT_BOTTOM=3,t.WATERMARK_POSITION_LEFT_BOTTOM=4}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";var i=[];return function(e,t){var n=new Image,r=i.push(n);n.onload=function(){var e=n.height;null!=e&&e>0?(t(n.width,e),delete i[r-1],n=null):setTimeout(n.onload,10)},n.src=e}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bjy-watermark" style="{{formatWatermarkStyle()}}">{{#if !isSelf && isPresenter && watermarkUrl}}<img class="bjy-watermark-img" src="{{compressWatermark(1)}}" srcset="{{compressWatermark(2)}} 2x" ondragstart="return false" >{{/if}}</div>'},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.config,a=BJY.os,o=BJY.auth,s=BJY.data.media,u=n(325),c=0,l={};function d(e){$.extend(this,e),this.status=c,this.init()}return d.prototype={constructor:d,init:function(){var e,t,n=this,i=n.element,r=n.namespace=".flv_player"+Math.random(),a=function(i,r){!n.disposed&&n.src&&n.src!==location.href&&i!==n.status&&(t=$.now(),e&&t-e<500||(e=t,n.playTimer&&(clearTimeout(n.playTimer),n.playTimer=null),2===i&&(l[n.src]=!0),function(e,t){n.status=e,$.isFunction(n[t])&&n[t]()}(i,r)))};n.timeoutHandler=function(){n.disposed||!i.paused||l[n.src]||a(6,"onTimeout")};var o=function(){a(2,"onPlaying")};(n.wrapper=$(i)).on("play"+r,function(){2!==n.status&&a(1,"onLoading")}).on("canplay"+r,function(){l[n.src]=!0}).on("playing"+r,o).on("timeupdate"+r,o).on("pause"+r,function(){2===n.status&&a(3,"onPaused")}).on("error"+r,function(){2!==n.status&&a(4,"onError")}).on("stalled"+r,function(){2!==n.status&&a(5,"onStalled")}).on("x5videoenterfullscreen"+r,function(){$.isFunction(n.onFullscreenEnter)&&n.onFullscreenEnter()}).on("x5videoexitfullscreen"+r,function(){$.isFunction(n.onFullscreenExit)&&(n.onFullscreenExit(),n.replay())}),n.replayCount=0},play:function(e){var t=this;if(e){var n=t.src;n?e!==n?(t.setSource(e),$.isFunction(t.onSourceChange)&&t.onSourceChange()):t.flvPlayer||t.setSource(e):t.setSource(e)}t.timeout&&(t.playTimer&&clearTimeout(t.playTimer),t.playTimer=setTimeout(t.timeoutHandler,t.timeout)),t.status=c,t.flvPlayer.play(),t.replayCount=0},playClose:function(){if(this.flvPlayer){try{this.flvPlayer.unload()}catch(e){console.log(e)}this.destroyPlayer()}},replay:function(){var e=this;if(e.flvPlayer){try{e.status=1,e.onReplay?e.onReplay():(e.flvPlayer.unload(),e.flvPlayer.load(),e.flvPlayer.play())}catch(e){console.log(e)}e.replayCount++}},errorHandler:function(e){this.destroyPlayer(),this.onFlvPlayerError&&this.onFlvPlayerError(e)},autoPlayRateHandler:function(){try{var e=this.currentTime,t=this.buffered.end(0)-e,n=1;n=t>4?1.25:t>3?1.2:t>2?1.1:t>1.5?1.05:t<.4?.4:t<.8?.7:1,this.playbackRate=n}catch(e){console.log(e)}},onErrorHandler:function(e){var t=this;"NetworkError"===e?t.replayCount>=10?t.errorHandler(e):setTimeout(function(){t.replay()},3e3):t.errorHandler(e)},onResolutionChange:function(){this.replay()},statisticsInfo:function(e){var t;2===this.status?this.flvPlayer&&this.onFlvPlayerMediaInfo({videoBandwidth:e.bps_video?+e.bps_video.toFixed(2):0,audioBandwidth:(t=e.bps_audio?+e.bps_audio.toFixed(2):0,t>60?50+Math.floor(t-10*Math.floor(t/10)):t)}):this.onFlvPlayerMediaInfo({videoBandwidth:0,audioBandwidth:0})},setSource:function(e){var t=this;t.flvPlayer&&t.destroyPlayer(),t.flvPlayer=u.createPlayer({type:"flv",url:e},{isLive:!0,enableWorker:!1,enableStashBuffer:!1,autoCleanupMaxBackwardDuration:60,autoCleanupMinBackwardDuration:30,stashInitialSize:131072,enableDurationMonitor:!a.android,statisticsInfoReportInterval:1e3,enableVideoFrozenMonitor:!0,enableConstVideoViewSize:o.isWebRTC()}),t.flvPlayer.on(u.Events.ERROR,t.onErrorHandler.bind(t)),t.flvPlayer.on(u.Events.VIDEO_RESOLUTION_CHANGE,t.replay.bind(t)),t.flvPlayer.on(u.Events.MS_BUFFER_FULL,t.replay.bind(t)),t.flvPlayer.on(u.Events.VIDEO_FROZEN,t.replay.bind(t)),t.flvPlayer.on(u.Events.MEDIA_SOURCE_CLOSE,t.replay.bind(t)),t.flvPlayer.on(u.Events.MEDIA_SOURCE_ENDED,t.replay.bind(t)),t.onFlvPlayerMediaInfo&&t.flvPlayer.on(u.Events.STATISTICS_INFO,t.statisticsInfo.bind(t)),t.flvPlayer.attachMediaElement(t.element),t.flvPlayer.load(),t.src=e,t.element.volume=a.android||a.ios?1:s.getSpeakerVolume()/r.SPEAKER_VOLUME_MAX},setVolume:function(e){this.flvPlayer&&((e/=r.SPEAKER_VOLUME_MAX)>1&&(e=1),this.flvPlayer.volume=e)},show:function(){this.wrapper.show()},hide:function(){this.wrapper.hide()},getWidth:function(){return this.element.clientWidth||0},setWidth:function(e){this.element.width=e},getHeight:function(){return this.element.clientHeight||0},setHeight:function(e){this.element.height=e},destroyPlayer:function(){if(this.flvPlayer){this.errorHandler&&this.flvPlayer.off(u.Events.ERROR,this.onErrorHandler),this.flvPlayer.off(u.Events.VIDEO_RESOLUTION_CHANGE,this.replay),this.flvPlayer.off(u.Events.MS_BUFFER_FULL,this.replay),this.flvPlayer.off(u.Events.VIDEO_FROZEN,this.replay),this.flvPlayer.off(u.Events.MEDIA_SOURCE_CLOSE,this.replay),this.flvPlayer.off(u.Events.MEDIA_SOURCE_ENDED,this.replay),this.flvPlayer.off(u.Events.STATISTICS_INFO,this.statisticsInfo);try{this.flvPlayer.destroy()}catch(e){console.log(e)}this.flvPlayer=null}this.src=null},remove:function(){var e=this.element;this.destroyPlayer();var t=e.parentNode;t&&t.removeChild(e)},dispose:function(){var e=this;e.flvPlayer;e.wrapper.off(e.namespace),e.remove(),e.disposed=!0}},d.STATUS_WAITING=c,d.STATUS_LOADING=1,d.STATUS_PLAYING=2,d.STATUS_PAUSED=3,d.STATUS_ERROR=4,d.STATUS_STALLED=5,d.STATUS_TIMEOUT=6,d}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,r=n(0),a=r(n(8)),o=r(n(273));void 0===(i=function(e,t,i){var r=n(290),s=n(3),u=n(31),c=n(274),l=BJY.store,d=BJY.auth,_=BJY.logger,f=BJY.eventEmitter,p=BJY.data.media,h=BJY.createSWF,g=BJY.blockLog,E=BJY.Player,v=new(n(339))({extension:t}),m=!0;function S(){Yox.object.each(E.instances,function(e){e.hasDetectCamera&&(e.isCameraOpened?(e.closeCamera(),A(e),e.openCamera()):e.isPush()?e.reopenCamera(null,function(){A(e)}):A(e))})}function A(e){var t=p.getCameraIndex(),n=p.getCameraList()[t];if(n){var i=p.getCameraQuality(),r=p.getCameraRatio(),a=p.getCameraConfig(i,r);a&&(w(e,"setVideoDevice",{cameraIndex:n.guid,cameraWidth:a.cameraWidth,cameraHeight:a.cameraHeight,cameraBandwidth:a.cameraBandwidth,cameraFps:a.cameraFps,cameraKeyframeInterval:a.cameraKeyframeInterval}),e.hasSetCamera=!0)}}function y(){Yox.object.each(E.instances,function(e){e.hasDetectMic&&(T(e),e.isMicOpened?e.openMic():e.isPush()&&e.reopenMic())})}function T(e){var t=p.getMicIndex(),n=p.getMicList()[t];n?(w(e,"setAudioDevice",{micIndex:n.guid,autoGain:1,echoSuppression:1,rate:22}),e.hasSetMic=!0):l.get("user.audioOn")&&f.trigger(f.MEDIA_SWITCH_TRIGGER,{audioOn:!1})}function R(e){var n=w(e,"enumVideoDevices"),i=$.map(n.cameras||[],function(e,t){return{name:e,guid:t,index:t}}),r=R.counter,a=c(p.filterDeviceList(i),p.getCameraList(),r?f.CAMERA_ADD:null,r?f.CAMERA_REMOVE:null);i=(0,o.default)(a,1)[0],r?r++:r=1,R.counter=r;var s=p.getCameraGuid();p.setCameraList(i);var u=p.getCameraGuid();d.canInitiativeGetDevicesAuth()&&!m||A(e),u!==s&&f.trigger(f.CAMERA_INDEX_CHANGE,{index:p.getCameraIndex()}),f.trigger(f.VIDEO_DEVICE_DETECT,{cameraList:p.getCameraList()}),e.hasDetectCamera=t.hasDetectCamera=!0}function I(e){var n=w(e,"enumAudioDevices"),i=$.map(n.mics||[],function(e,t){return{name:e,guid:t,index:t}}),r=I.counter,a=c(p.filterDeviceList(i),p.getMicList(),r?f.MIC_ADD:null,r?f.MIC_REMOVE:null);i=(0,o.default)(a,1)[0],r?r++:r=1,I.counter=r;var s=p.getMicGuid();p.setMicList(i),p.getMicGuid()!==s&&f.trigger(f.MIC_INDEX_CHANGE,{micIndex:p.getMicIndex()}),d.canInitiativeGetDevicesAuth()&&!m||T(e),f.trigger(f.AUDIO_DEVICE_DETECT,{micList:p.getMicList()}),e.hasDetectMic=t.hasDetectMic=!0}function C(e){w(e,"setInputVolume",{volume:p.getMicVolume()}),e.hasSetMicVolume=!0}function O(e){w(e,"setOutputVolume",{volume:p.getSpeakerVolume()}),e.hasSetSpeakVolume=!0}t.name="flash",t.pluginUrl="",t.init=function(e){return t.pluginUrl||(BJY.cdnOrigin?t.pluginUrl=BJY.cdnOrigin+"/player/extension/flash.swf":t.pluginUrl="//live-cdn.baijiayun.com/js-sdk/latest/player/extension/flash.swf"),e&&!1===e.getDevicesAuth&&(m=!1),P.start(),f.on(f.CLASSROOM_EXIT_START,function(){P.stop()}).on(f.CAMERA_INDEX_CHANGE,S).on(f.CAMERA_QUALITY_CHANGE,S).on(f.MIC_INDEX_CHANGE,y).on(f.CAMERA_REMOVE,function(e,t){var n,i=p.getCameraList()[p.getCameraIndex()];i&&(Yox.array.each(t.deviceList,function(e){if(e.guid===i.guid)return n=!0,!1}),n&&S())}).on(f.MIC_REMOVE,function(e,t){var n,i=p.getMicList()[p.getMicIndex()];i&&(Yox.array.each(t.deviceList,function(e){if(e.guid===i.guid)return n=!0,!1}),n&&y())}).on(f.SPEAKER_VOLUME_CHANGE,function(){Yox.object.each(E.instances,function(e){O(e)})}).on(f.MIC_VOLUME_CHANGE,function(){Yox.object.each(E.instances,function(e){(e.isPush()||e.isSetting)&&C(e)})}),r()},t.initPlayer=function(e){t.disposePlayer(e);var n=$(e.createSWF());e.element&&e.element.append(n),n[0].pluginId=e.id,e.isPPAPI&&(n[0].addEventListener("message",e.ppapiMessageHandler=function(t){var n=t.data;n&&f.trigger(f.PPAPI_COMMAND,{playerId:e.id,command:n.command})}),d.canNotifyPluginLoaded()&&(e.waitTimer=new u({task:function(){e.element&&(n.remove(),e.element.append(n))},timeout:3e3,interval:3e3}),e.waitTimer.start(),f.on(f.PPAPI_COMMAND,function(t,n){n&&n.playerId===e.id&&"pluginLoaded"===n.command&&(e.waitTimer&&(e.waitTimer.stop(),e.waitTimer=null),onPluginReady({pluginId:e.id}))}))),e.swf=n[0],t.antiScreenRecord(e.swf)},t.antiScreenRecord=function(e){var t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(t){var n=new t(function(e){"style"===e[0].attributeName&&(document.write('<div style="position:absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);">视频禁止在小窗口播放，请关闭小窗口并刷新页面重试</div>'),n.disconnect())});n.observe(e,{attributes:!0})}},t.disposePlayer=function(e){var t=e.swf;t&&(e.ppapiMessageHandler&&t.removeEventListener("message",e.ppapiMessageHandler),t.dispose&&t.dispose(),$(t).remove(),e.swf=null),e.waitTimer&&(e.waitTimer.stop(),e.waitTimer=null),e.hasSetCamera=!1,e.hasSetMic=!1},t.initComplete=function(e){(e.isPush()||!p.getSpeakerList()||e.isSetting)&&(R(e),I(e))},t.openCamera=function(e){e.hasSetCamera||A(e),p.getCameraIndex()>=0&&(w(e,"openCamera"),e.isCameraOpened=!0)},t.closeCamera=function(e){p.getCameraIndex()>=0&&(w(e,"closeCamera"),e.isCameraOpened=!1)},t.openMic=function(e){e.hasSetMic||T(e),p.getMicIndex()>=0&&(w(e,"openMic"),e.isMicOpened=!0),t.isDeviceAllow(e)||t.showSetting(e)},t.closeMic=function(e){p.getMicIndex()>=0&&(w(e,"closeMic"),e.isMicOpened=!1)},t.getInputVolume=function(e){var t=s(w(e,"getInputVolume"),0);return r(function(){return{volume:t=t>=0&&t<=100?t:0}})},t._publishAV=function(e,t){w(e,"publishAV",{streamName:t.streamName,publishIp:t.publishIp,publishPort:t.publishPort,pushHLS:t.pushHLS,protocolType:t.protocolType||"rtmp"})},t._publishAVClose=function(e,t){w(e,"publishAVClose",{streamName:t.streamName})},t._publishAVRelease=function(e,t){w(e,"publishAVRelease",{streamName:t.streamName})},t._playAV=function(e,t){(t=Yox.object.copy(t,!0)).streamBuffer=e.playBuffer||.1,t.audioOnly=t.audioOnly?1:0,w(e,"playAV",t)},t._playAVClose=function(e,t){w(e,"playAVClose",{streamName:t.streamName})},t._playAVRelease=function(e,t){w(e,"playAVRelease",{streamName:t.streamName})},t.publishAV=function(e){var n=v.publishAV(e);return t.isDeviceAllow(e)||t.showSetting(e),e.hasSetMicVolume||C(e),n},t.publishAVClose=function(e,t){v.publishAVClose(e,t)},t.publishAVRelease=function(e,t){v.publishAVRelease(e,t)},t.attachVideo=function(e){e.hasSetCamera||A(e),w(e,"attachVideo")},t.detachVideo=function(e){w(e,"detachVideo")},t.attachAudio=function(e,t,n){e.hasSetMic||T(e),t?w(e,"unmuteMic"):(w(e,"attachAudio"),n&&w(e,"unmuteMic"))},t.detachAudio=function(e,t){t?w(e,"muteMic"):(d.canPublishMuteStream()&&e.hasAudioStream&&e.attachAudio(!0),w(e,"detachAudio"))},t.playAV=function(e,t){v.playAV(e,{audioOnly:t.audioOnly}),e.hasSetSpeakVolume||O(e)},t.playAVClose=function(e){v.playAVClose(e)},t.playAVRelease=function(e){v.playAVRelease(e)},t.setStreamBuffer=function(e,t){w(e,"setStreamBuffer",{streamBuffer:t})},t.initStreamBuffer=function(e,t){w(e,"initStreamBuffer",t)},t.showVideo=function(e){w(e,"showVideo")},t.hideVideo=function(e){w(e,"hideVideo")},t.switchAudioStream=function(e,t){w(e,"switchAudioStream",{hasAudioStream:t?1:0})},t.switchVideoStream=function(e,t){w(e,"switchVideoStream",{hasVideoStream:t?1:0})},t.showSetting=function(e){w(e,"showSetting"),f.trigger(f.FLASH_AUTH_SETTING_SHOWING,{player:e})},t.isDeviceAllow=function(e){return w(e,"isDeviceAllow")},t.remount=function(e){e.isRemounting?(delete e.isRemounting,e.isPush()?e.republish():e.isPull()&&e.replay(),f.trigger(f.PLAYER_REMOUNT_END,{player:e})):e.isReady&&(e.isReady=!1,e.isRemounting=!0,f.trigger(f.PLAYER_REMOUNT_START,{player:e}))},t.getStreamResolution=function(e){var t=$.Deferred();return setTimeout(function(){var n={width:null,height:null};if(e.isPull()){var i=w(e,"getVideoResolution");i.width&&(n.width=i.width),i.height&&(n.height=i.height)}t.resolve(n)},0),t},t.extensions={asyncReady:!0,hasPublishAuth:!1,hasPlayAuth:!0,createSWF:function(){var e=this.user;return h("camera-player-"+this.id,"bjy-player-object",t.pluginUrl,{classId:l.get("class.id"),userId:this.id,userAvatar:e.avatar,userName:e.name,canFullSreen:!1===this.canFullScreen?0:1,showBjy:l.get("partner.hideBjySupportMessage")?0:1,runInClient:0})},onPublishAVAck:function(e){window.DEBUG&&_.dark("flash callback","onPublishAVAck",e),0===(e=JSON.parse(e)).code?this.publishAVConnectSuccess():this.publishAVConnectFail()},onPlayAVAck:function(e){window.DEBUG&&_.dark("flash callback","onPlayAVAck",e),e=JSON.parse(e);var t=this;0===e.code?t.playAVConnectSuccess():setTimeout(function(){t.isDisposed()||l.get("offline")||t.playAVConnectFail()},500)},onFlashAuthorization:function(){window.DEBUG&&_.dark("flash callback","onFlashAuthorization"),f.trigger(f.FLASH_AUTHORIZATION_FAIL)},onFlashAuthorizationFinished:function(){window.DEBUG&&_.dark("flash callback","onFlashAuthorizationFinished"),f.trigger(f.FLASH_AUTHORIZATION_SUCCESS)},streamBlockReport:function(){g.setLogTypeBlock(this)},onDevicesStatus:function(e){window.DEBUG&&_.dark("flash log",e)}};var b=0,L=0,D=0,N=0,P=new u({task:function(){var e=0,t=0,n=0,i=0;Yox.object.each(E.instances,function(r){if(!r.isSetting&&"flash"===r.extension.name){var a=function(e){if(!e.hasUplinkStatisticsAuth&&e.isMainPush()){w(e,"getMicMute").mute&&(e.hasUplinkStatisticsAuth=!0)}var t=w(e,"getStreamInfo");e.isReady&&(e.videoOn||e.audioOn)&&t&&t.stream||(t=null);e.isPush()?e.setUplinkStream(t):e.setDownlinkStream(t);return{uplinkVideoBandwidth:e.getUplinkVideoBandwidth(),uplinkAudioBandwidth:e.getUplinkAudioBandwidth(),downlinkVideoBandwidth:e.getDownlinkVideoBandwidth(),downlinkAudioBandwidth:e.getDownlinkAudioBandwidth()}}(r);a.uplinkVideoBandwidth>=0&&(e+=a.uplinkVideoBandwidth),a.uplinkAudioBandwidth>=0&&(t+=a.uplinkAudioBandwidth),a.downlinkVideoBandwidth>=0&&(n+=a.downlinkVideoBandwidth),a.downlinkAudioBandwidth>=0&&(i+=a.downlinkAudioBandwidth)}}),e!==b&&(b=e,f.trigger(f.UPLINK_VIDEO_BANDWIDTH_SUM_CHANGE,{bandwidth:b})),t!==L&&(L=t,f.trigger(f.UPLINK_AUDIO_BANDWIDTH_SUM_CHANGE,{bandwidth:L})),n!==D&&(D=n,f.trigger(f.DOWNLINK_VIDEO_BANDWIDTH_SUM_CHANGE,{bandwidth:D})),i!==N&&(N=i,f.trigger(f.DOWNLINK_AUDIO_BANDWIDTH_SUM_CHANGE,{bandwidth:N}))},interval:1e3}),k={getStreamInfo:1,getInputVolume:1,getMicMute:1};function w(e,t,n){if(!e.extension||"html"!==e.extension.name){var i;window.DEBUG&&!k[t]&&_.primary("flash call",t,(0,a.default)(n));try{var o=e.swf;e.isPPAPI?((n=n||{}).command=t,i=o.postMessage(n)):o[t]&&(n?(n=(0,a.default)(n),i=o[t](n)):i=o[t]())}catch(e){_.danger("flash player error",t,(0,a.default)(n),e)}return window.DEBUG&&!k[t]&&_.dark("flash call result",t,i),null==i?r():i}}window.CameraPlayer=BJY.Player,BJY.Player.flash=t}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i=n(88),r=n(582);e.exports=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?r(e):t}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){var i=n(584),r=n(329);function a(t){return e.exports=a=r?i:function(e){return e.__proto__||i(e)},a(t)}e.exports=a},function(e,t,n){e.exports=n(585)},function(e,t,n){n(586),e.exports=n(1).Object.getPrototypeOf},function(e,t,n){var i=n(42),r=n(142);n(159)("getPrototypeOf",function(){return function(e){return r(i(e))}})},function(e,t,n){n(588),e.exports=n(1).Object.setPrototypeOf},function(e,t,n){var i=n(6);i(i.S,"Object",{setPrototypeOf:n(589).set})},function(e,t,n){var i=n(10),r=n(18),a=function(e,t){if(r(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{(i=n(29)(Function.call,n(135).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return a(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:a}},function(e,t,n){var i=n(591),r=n(594);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=i(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){e.exports=n(592)},function(e,t,n){n(593);var i=n(1).Object;e.exports=function(e,t){return i.create(e,t)}},function(e,t,n){var i=n(6);i(i.S,"Object",{create:n(84)})},function(e,t,n){var i=n(329);function r(t,n){return e.exports=r=i||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t,n){"use strict";var i=n(0);n(66)(t,"__esModule",{value:!0}),t.Emitter=void 0;var r=i(n(123)),a=i(n(155)),o=function(){function e(){(0,r.default)(this,e),this._emitter=new Yox({})}return(0,a.default)(e,[{key:"trigger",value:function(e,t){return this._emitter.fire(e,t),this}},{key:"once",value:function(e,t){return e&&this._emitter.once(e,t),this}},{key:"on",value:function(e,t){return e&&this._emitter.on(e,t),this}},{key:"off",value:function(e,t){return e&&this._emitter.off(e,t),this}},{key:"removeAllListeners",value:function(){return this._emitter.off(),this}}]),e}();t.Emitter=o},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.MAX_GAIN=1.5,t.PUBLISH_TRY_COUNT=5,t.VIDEO_MUTE_TRY_COUNT=5,t.CREATE_AV_STREAM_ERROR="create_av_stream_error",t.FLV_TIMEPUT_TIME=3e4}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(131));void 0===(i=function(e,t,n){return function(e){return new r.default(function(t){return setTimeout(function(){return t()},e)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.is,a=BJY.auth,o=BJY.store,s=BJY.Player,u=BJY.logger,c=BJY.config,l=BJY.data.user,d=BJY.data.media,_=BJY.userStatus,f=BJY.data.browser,p=BJY.getExtension,h=BJY.eventEmitter;$.extend(h,n(599));var g=n(600),E=n(38),v=n(129),m=n(4),S=n(377),A=n(3),y=n(601),T=n(112),R=n(77),I=n(76),C=n(285),O={},b=S(),L=n(605),D=n(606),N=n(607),P=[c.MEDIA_TYPE_FILE,c.MEDIA_TYPE_MAIN_SCREEN_SHARE,c.MEDIA_TYPE_ASSIST_SCREEN_SHARE];function k(e,t,n){a.isSelf(e)?h.trigger(h.MEDIA_SWITCH_TRIGGER,{videoOn:t,audioOn:n}):h.trigger(h.MEDIA_REMOTE_CONTROL_TRIGGER,{user:l.find(e),videoOn:t,audioOn:n})}function w(e){var t=e.offset();return{position:"fixed",left:t.left-I(),top:t.top-R(),width:e.width(),height:e.height()}}return h.on(h.CLASSROOM_EXIT_END,function(e,t){Yox.object.each(O,function(e){try{e&&e.destroy()}catch(e){}})}),BJY.DefaultThemePlayer={template:n(608),language:b,propTypes:{user:{type:"object",required:!0},extension:{type:"object",value:p},isAssist:{type:"boolean",value:!1},isHidden:{type:"boolean",value:!1},isWebRTCMix:{type:"boolean",value:function(){return a.isWebRTC()&&!a.canSupportWebRTC()}},canDisableVideo:{type:"boolean",value:!0},canFold:{type:"boolean"},canManageSpeak:{type:"boolean",value:a.canManageSpeak},canDrag:{type:"boolean",value:!0},canPopByDrag:{type:"boolean"},showApplyingInSimpleTemplate:{type:"boolean",value:!1},foldHandleVisible:{type:"boolean",value:!0},needFooter:{type:"boolean",value:!0},needSwitch:{type:"boolean",value:!0},needIGroup:{type:"boolean",value:!0},needPopupFooter:{type:"boolean",value:!0},needNativePopup:{type:"boolean",value:BJY.os.windows},needAvatar:{type:"boolean",value:!0},needLocalPreview:{type:"boolean",value:!1},needShowGroupColor:{type:"boolean",value:!1},onComplete:{type:"function"},customLabel:{type:"string",value:""},draggableRectSelector:{type:"string"},homelandRectSelector:{type:"string"},popupMinSize:{type:"object",value:{width:360,height:240}},hasWatermark:{type:"boolean",value:!0},showMaskWhenScreenSharing:{type:"boolean",value:!1},actionTop:{type:"boolean",value:!1},switchOptions:{type:"object"},footerOptions:{type:"object"},iGroupOptions:{type:"object"},showCameraCover:{type:"boolean",value:!1}},data:function(){var e=!this.get("isAssist"),t=this.get("user"),n=a.isWebRTCMixUser(t.id)?o.get("webrtcMixUser"):l.find(t.id),i=!1,s=!1,u=!1,_=!1;n&&(e?(i=n.videoOn,s=n.audioOn):n.mediaExtMap&&n.mediaExtMap[n.id2]&&(i=n.mediaExtMap[n.id2].videoOn),u=!r.mediaPopupScreenShare(n)&&(this.get("isAssist")?r.isUserAssistScreenSharing(n):r.isUserScreenSharing(n)),_=!r.mediaPopupMediaPlayer()&&r.isUserMediaFile(n));var f=a.isDefaultPullAudioOnly(t),p=l.getGroupInfoById(t.group);return{language:b,videoOn:i,audioOn:s,userIn:!!n,isWebRTC:a.isWebRTC(),presenterId:o.get("presenterId"),isAudioMediaType:o.get("class.mediaType")===c.MEDIA_TYPE_AUDIO,requestPublishAuth:!1,isFlashAuthShowing:!1,inClient:o.get("cefVersion"),hasRunAuth:!!o.get("cefVersion"),isFlashError:"flash"===this.get("extension.name")&&!BJY.support.flash,isSpeakApplying:!1,isScreenSharing:u,isMediaPlaying:_,cameraIndex:e?d.getCameraIndex():d.getAssistCameraIndex(),cameraCover:t.cameraCover,canSetCameraCover:a.isCameraCoverEnabled(),studentCameraCover:o.get("class.pcCameraCover"),isStudentRole:a.isStudent(),player:null,userStatus:"",videoStatus:"",publishStatus:"",PUBLISH_STATUS_CONNECTING:g.PUBLISH_STATUS_CONNECTING,PUBLISH_STATUS_LOADING:g.PUBLISH_STATUS_LOADING,PUBLISH_STATUS_SUCCESS:g.PUBLISH_STATUS_SUCCESS,PUBLISH_STATUS_FAIL:g.PUBLISH_STATUS_FAIL,playStatus:"",PLAY_STATUS_CONNECTING:g.PLAY_STATUS_CONNECTING,PLAY_STATUS_LOADING:g.PLAY_STATUS_LOADING,PLAY_STATUS_SUCCESS:g.PLAY_STATUS_SUCCESS,PLAY_STATUS_FAIL:g.PLAY_STATUS_FAIL,volume:0,isPopup:!1,isFolded:!1,isDOMPopup:!1,isMaximize:!1,isFullScreen:!1,isSnapshotShown:!1,isLocalPreviewOn:!1,isVideoDisabled:f,isForceVideoDisabled:f,needPositionTransition:!1,finalPopMethodCalled:{method:null,arguments:[]},selfGroupColor:p&&p.color||""}},computed:{showScreenShareMask:function(){return this.get("showMaskWhenScreenSharing")&&this.get("isScreenSharing")&&this.get("isSelf")},isSelf:function(){return a.isSelfByNumber(this.get("user.number"))},isStudent:function(){return a.isStudent(this.get("user.type"))},isPresenter:function(){return this.get("user.id")===this.get("presenterId")},mediaOn:function(){return this.get("videoOn")||this.get("audioOn")||this.get("isScreenSharing")||this.get("isMediaPlaying")},isReady:{deps:["mediaOn","isSelf","publishStatus","playStatus","player","isScreenSharing","isMediaPlaying"],get:function(){var e=!1;return(e=!this.get("mediaOn")||!!this.get("player")&&(this.get("isSelf")?this.get("publishStatus")===g.PUBLISH_STATUS_SUCCESS:this.get("playStatus")===g.PLAY_STATUS_SUCCESS||this.get("isScreenSharing")||this.get("isMediaPlaying")))&&h.trigger(h.PLAYER_READY,{player:this.player}),e}},groupColorStyle:function(){var e=this.get("user.id"),t=this.get("selfGroupColor");return t?'\n                        .bjy-player-theme-default[data-user-id="'.concat(e,'"] {\n                            color: ').concat(t,";\n                            box-shadow: 0 2px ").concat(t,';\n                        }\n                        .bjy-player-theme-default[data-user-id="').concat(e,'"][data-popup="1"] .bjy-video-player {\n                            border: 2px solid ').concat(t,";\n                        }\n                    "):""}},filters:{getUserSeat:function(e){return E(b.USER_SEAT,{userName:e})},compressImage:function(e,t,n){return BJY.compressImage({url:e,width:t,height:n})}},events:{popUp:function(e,t){this.popup(null)},popDown:function(e,t){this.popdown()},exitFullScreen:function(e,t){this.exitFullScreen()},enterFullScreen:function(e,t){this.enterFullScreen()},zoomIn:function(e,t){this.zoomIn()},zoomOut:function(e,t){this.zoomOut()},isStoppingSpeakChange:function(e,t){this.set("isStoppingSpeak",t.isStoppingSpeak)},videoDisableChange:function(e,t){this.get("isForceVideoDisabled")||this.set("isVideoDisabled",t.isVideoDisabled)},videoRatioChange:function(e,t){this.set("videoRatio",t.videoRatio)},qualityChange:function(e,t){this.$refs&&this.$refs.debug&&this.$refs.debug.set("quality",t.quality)},volumeChange:function(e,t){this.set("volume",t.volume)},closeMic:function(){this.closeMic()},openMic:function(){this.openMic()},playerRootElementMousedown:function(e){var t=this,n=t.$refs&&t.$refs.switch,i=t.get("draggableRectSelector");if(i&&!t.get("isPopup")&&t.get("canPopByDrag")&&n&&n.get("canDragOut")&&n.get("canDragOuted")){var r=e.originalEvent.originalEvent,a=r.pageX,o=r.pageY;m.body.addClass(c.DRAGGING_CLASS_NAME_FOR_BODY),m.body.one("mouseup",function(e){var n=C($(i)),r=e.pageX,s=e.pageY;(Math.abs(r-a)>30||Math.abs(s-o)>30)&&r>n.left&&r<n.left+n.width&&s>n.top&&s<n.top+n.height&&t.popup(),m.body.removeClass(c.DRAGGING_CLASS_NAME_FOR_BODY)})}},playerMousedown:function(){var e=this,t=e.get("homelandRectSelector");t&&e.get("canPopByDrag")&&e.get("isPopup")&&m.body.one("mouseup",function(n){var i=C($(t)),r=n.pageX,a=n.pageY;r>i.left&&r<i.left+i.width&&a>i.top&&a<i.top+i.height&&e.popdown()})},onUserSeatDoubleClick:function(){var e=this.$refs&&this.$refs.switch;return this.get("isPopup")&&e&&e.get("canDragOut")&&this.popdown(),!1}},watchers:{user:function(e,t){var n=e.number;e.id!==t.id&&this.watchUserStatus(n)},videoRatio:function(e,t){var n=this;if(n.get("isPopup")){var i=n.container.find(".bjy-video-player"),r=n.getVideoSizeByRatio(i);i.css(r),setTimeout(function(){n.updateWatermark()},400)}},videoOn:function(e,t){var n=this;!e&&t&&(n.get("isFullScreen")&&n.exitFullScreen(),n.get("isPopup")&&n.get("needNativePopup")&&n.popdown())},isForceVideoDisabled:function(e){this.set("isVideoDisabled",e),this.player&&(this.player.forceDisableVideo=e)},isVideoDisabled:function(e){var t=this;t.get("videoOn")&&t.player&&(t.player.disableVideo=e,t.player.playAVClose(),(t.player.getUserVideoOn()&&!e||t.player.getUserAudioOn())&&t.player.playAV(!e))},isPopAnimating:function(e,t){if(t&&!e){var n=this,i=n.get("finalPopMethodCalled"),r=n.get("isPopup")?n.popup:n.popdown;i.method&&i.method!==r&&i.method.apply(n,i.arguments||[])}}},methods:{initIsSpeakApply:function(){var e=this;if(BJY.userSpeak){var t=BJY.userSpeak.getApplyingList();$.each(t,function(t,n){n.id==e.get("user.id")&&e.set("isSpeakApplying",!0)})}},closeMic:function(){k(this.get("user.id"),this.get("videoOn"),!1)},openMic:function(){k(this.get("user.id"),this.get("videoOn"),!0)},getVideoSizeByRatio:function(e,t){var n,i=this.get("popupMinSize");null==t&&(t=e.width()),t<i.width&&(t=i.width);var r=this.get("videoRatio");return r===c.CAMERA_RATIO_4_3?n=3*t/4:r===c.CAMERA_RATIO_16_9&&(n=9*t/16),{width:t,height:n}},enterFullScreen:function(){m.html.css("overflow","hidden"),m.body.css("overflow","hidden"),h.trigger(h.FULLSCREEN_ENTER_TRIGGER);var e=this;e.set("isFullScreen",!0),setTimeout(function(){e.updateWatermark()},400)},exitFullScreen:function(){m.html.css("overflow",""),m.body.css("overflow",""),h.trigger(h.FULLSCREEN_EXIT_TRIGGER);var e=this;e.set("isFullScreen",!1),setTimeout(function(){e.updateWatermark()},400)},popupAnimate:function(e,t,n){var i=this,r=w(e);return e.css(r),i.set({isPopAnimating:!0}),setTimeout(function(){i.set("needPositionTransition",!0),i.nextTick(function(){t(r),setTimeout(function(){i.set({isPopAnimating:!1}),n&&n()},400)})},50),r},popdownAnimate:function(e,t,n){var i=this;i.set({isPopAnimating:!0}),i.nextTick(function(){t(),setTimeout(function(){i.$el&&(i.set({isPopAnimating:!1,needPositionTransition:!1}),e.prop("style").cssText="",n&&n())},400)})},popup:function(e,t){var n=this,i=n.container.find(".bjy-video-player");if(e&&(n.get("isPopup")&&n.get("finalPopMethodCalled.method")===n.popup&&i.css(e),n.popupStyle=e),n.set("finalPopMethodCalled",{method:n.popup,arguments:[e]}),n.get("isPopup")||n.get("isPopAnimating"))return!1;var r=n.getPlayer();if(r&&n.get("needNativePopup")&&r.popupWindow(!0))n.set("isPopup",!0);else{var a,o=n.popupAnimate(i,function(){n.set({isPopup:!0,isDOMPopup:!0}),i.css(n.popupStyle)},function(){n.updateWatermark()});if(!e){var s=o.width,u=o.height,l=f.getDeviceWidth(),d=f.getDeviceHeight(),_=n.get("popupMinSize.width",s)/n.get("popupMinSize.height",u);(s=(u*=1.5)*_)>l&&(u=(s=l)/_),u>d&&(s=(u=d)*_),(e=y({element:i,x:"50%",y:"50%",fixed:!0,width:s,height:u})).width=s,e.height=u}!t&&n.fire("playerPopup",e),n.popupStyle=e;var p=n.get("draggableRectSelector");p&&(a=$(p)),n.get("canDrag")&&(n.dragger=T({element:i,containerElement:a,excludeSelector:[".bjy-label",".bjy-button",".bjy-dragger",".bjy-more-switcher"],bodyDraggingClass:c.DRAGGING_CLASS_NAME_FOR_BODY,onbeforedrag:function(e){n.get("isMaximize")||n.get("isFullscreen")?e.preventDefault():n.set("needPositionTransition",!1)},onafterdrag:function(e,t){n.set("needPositionTransition",!0),n.fire("playerRectChange",{x:t.left,y:t.top,width:i.width(),height:i.height()})},dragAnimation:function(e){e.mainElement.css(e.mainStyle)}}))}},popdown:function(e,t){var n=this;if(n.set("finalPopMethodCalled",{method:n.popdown,arguments:[e]}),!n.get("isPopup")||n.get("isPopAnimating"))return!1;var i=n.getPlayer();if(i&&n.get("needNativePopup")&&i.popupWindow(!1))n.set("isPopup",!1);else{n.dragger&&n.dragger.dispose();var r=n.container.find(".bjy-video-player");!0===e?(r.removeAttr("style"),n.set({isPopup:!1,isDOMPopup:!1}),n.updateWatermark()):n.popdownAnimate(r,function(){r.css(w(n.container))},function(){r.removeAttr("style"),n.set({isPopup:!1,isDOMPopup:!1}),n.updateWatermark()}),!t&&n.fire("playerPopdown")}},zoomIn:function(){if(this.get("isPopup")){var e=this.container.find(".bjy-video-player"),t=e.width()*g.ZOOM_STEP,n=e.height()*g.ZOOM_STEP,i=t/n,r=f.getDeviceWidth(),a=f.getDeviceHeight();t>r&&(n=(t=r)/i),n>a&&(t=(n=a)*i),this.setSize(e,t,n)}},zoomOut:function(){if(this.get("isPopup")){var e=this.container.find(".bjy-video-player"),t=e.width()/g.ZOOM_STEP,n=e.height()/g.ZOOM_STEP,i=t/n,r=this.get("popupMinSize");t<r.width&&(n=(t=r.width)/i),n<r.height&&(t=(n=r.height)*i),this.setSize(e,t,n)}},watchUserStatus:function(e){var t=this;if(!t.get("isWebRTCMix")){var n=t.userStatusNamespace;_.unwatch(n),_.watch(e,n,{onCameraOpened:function(){t.log("onCameraOpened"),t.set({videoOn:!0,userStatus:t.getUserStatus("VIDEO_ON"),videoStatus:t.getUserStatus("VIDEO_ON")}),t.updateWatermark()},onMicOpened:function(){t.log("onMicOpened"),t.set({audioOn:!0,userStatus:t.getUserStatus("AUDIO_ON")}),t.get("isAudioMediaType")&&t.set("videoStatus",t.getUserStatus("AUDIO_ONLY_AUDIO_ON"))},onCameraMicOpened:function(){t.log("onCameraMicOpened"),t.set({videoOn:!0,audioOn:!0,userStatus:t.getUserStatus("VIDEO_ON_AUDIO_ON"),videoStatus:t.getUserStatus("VIDEO_ON")})},onCameraClosed:function(){t.log("onCameraClosed"),t.set({videoOn:!1,userStatus:t.getUserStatus("VIDEO_OFF"),videoStatus:t.getUserStatus("VIDEO_OFF")})},onMicClosed:function(){t.log("onMicClosed"),t.set({audioOn:!1,userStatus:t.getUserStatus("AUDIO_OFF")}),t.get("isAudioMediaType")&&t.set("videoStatus",t.getUserStatus("AUDIO_ONLY_AUDIO_OFF"))},onCameraMicClosed:function(){t.log("onCameraMicClosed"),t.set({videoOn:!1,audioOn:!1,userStatus:t.getUserStatus("VIDEO_OFF_AUDIO_OFF"),videoStatus:t.getUserStatus("VIDEO_OFF")})},onCameraOpenedMicClosed:function(){t.log("onCameraOpenedMicClosed"),t.set({videoOn:!0,audioOn:!1,userStatus:t.getUserStatus("VIDEO_ON_AUDIO_OFF"),videoStatus:t.getUserStatus("VIDEO_ON")})},onCameraClosedMicOpened:function(){t.log("onCameraClosedMicOpened"),t.set({videoOn:!1,audioOn:!0,userStatus:t.getUserStatus("VIDEO_OFF_AUDIO_ON"),videoStatus:t.getUserStatus("VIDEO_OFF")})},onMediaOpened:function(){t.log("onMediaOpened"),t.getPlayer()||t.createPlayer(),t.get("requestPublishAuth")&&t.set("requestPublishAuth",!1)},onEntered:function(){if(t.$el){t.log("onEntered");var e=l.findByNumber(t.get("user.number"));e?t.set("user",e):u.warn("Default Theme Player","user not found on entered.");var n=t.player;n&&(n.isDisposed()||(t.get("destroySelf")?(n.unmount(),t.set("destroySelf",!1)):n.dispose()),t.player=null,t.set("publishStatus",""),t.set("playStatus","")),(t.get("isSelf")||a.isWebRTC())&&t.createPlayer(),t.get("isSelf")&&t.get("needLocalPreview")&&t.createLocalPreview();var i=!r.mediaPopupMediaPlayer()&&r.isUserMediaFile(e);t.set({userIn:!0,videoOn:!1,audioOn:!1,userStatus:t.getUserStatus("IN"),videoStatus:t.getUserStatus("VIDEO_OFF"),isScreenSharing:!r.mediaPopupScreenShare(e)&&(t.get("isAssist")?r.isUserAssistScreenSharing(e):r.isUserScreenSharing(e)),isMediaPlaying:i}),t.get("isAudioMediaType")&&t.set("videoStatus",t.getUserStatus("AUDIO_ONLY_AUDIO_OFF"))}},onScreenSharing:function(){t.log("onScreenSharing"),r.mediaPopupScreenShare(t.get("user"))||t.set({isScreenSharing:!0}),t.getPlayer()||t.createPlayer()},onScreenSharingStopped:function(){t.log("onScreenSharingStopped"),t.set({isScreenSharing:!1})},onLeaved:function(){t.log("onLeaved"),t.set({userIn:!1,videoOn:!1,audioOn:!1,isScreenSharing:!1,userStatus:t.getUserStatus("OUT"),videoStatus:t.getUserStatus("VIDEO_OFF")}),t.get("isPopup")&&t.popdown()}},t.get("isAssist"))}},setSize:function(e,t,n){var i=this;t=Math.floor(t),n=Math.floor(n),e.css({width:t,height:n}),i.fire("playerRectChange",{x:A(e.css("left"),0,"int"),y:A(e.css("top"),0,"int"),width:t,height:n}),setTimeout(function(){i.updateWatermark()},400)},getUserStatus:function(e){var t=this.get("user");return a.isSelf(t.id)?this.get("language.SELF_"+e):a.isPresenter(t.id)||a.isWebRTCMixUser(t.id)||t.type===c.ROLE_TYPE_TEACHER?this.get("language.PRESENTER_"+e):this.get("language.USER_"+e)},getPlayer:function(){var e=this.player;return e&&!e.isDisposed()?e:null},changePlayerSize:function(e){var t,n,i,r,a=this,o=a.container.find(".bjy-video-player"),s=a.get("draggableRectSelector");if(s){var u=$(s),l=u.offset();i=(t=l.top)+u.height(),n=(r=l.left)+u.width()}var d=a.get("popupMinSize");a.set("needPositionTransition",!1),a.fire("playerRectChangeStart"),v({point:e,element:o,safeTop:t,safeRight:n,safeBottom:i,safeLeft:r,minWidth:d.width,minHeight:d.height,bodyDraggingClass:c.DRAGGING_CLASS_NAME_FOR_BODY,onChange:function(){a.updateWatermark()},onComplete:function(e){a.set("needPositionTransition",!0),a.fire("playerRectChange",{x:e.left,y:e.top,width:e.width,height:e.height})}})},acceptSpeakApplying:function(){BJY.userSpeak.processApply(this.get("user.id"),!0)},rejectSpeakApplying:function(){BJY.userSpeak.processApply(this.get("user.id"),!1)},log:function(e){},createPlayer:function(e){var t=this,n=t.get("user"),i=t.container;if(n.id&&(n=t.get("isWebRTCMix")?o.get("webrtcMixUser"):l.findByNumber(n.number))){var r=t.get("isAssist")?n.id2:n.id;BJY.Player.instances[r]?(t.player=BJY.Player.instances[r],t.player.mount(i.find(".bjy-video-player .bjy-player-container")),t.set({player:t.player})):(t.player=new s({element:i.find(".bjy-video-player .bjy-player-container"),user:n,disableVideo:t.get("isVideoDisabled"),forceDisableVideo:t.get("isForceVideoDisabled"),extension:t.get("extension"),canFullScreen:!1,isHidden:t.get("isHidden"),isAssist:t.get("isAssist"),isWebRTCMix:t.get("isWebRTCMix"),onComplete:function(){if(e&&e(),t&&t.$el){var n=t.get("onComplete");n&&n(t)}}}),t.set({player:t.player}))}},createLocalPreview:function(){var e=this;e.previewPlayer&&e.previewPlayer.dispose(),e.previewPlayer=new s({element:e.container.find(".bjy-video-player .bjy-local-preview-container"),user:o.get("user"),extension:e.get("extension"),isSetting:!0,onComplete:function(){e.previewPlayer.openCamera(),h.trigger(h.PLAYER_LOCAL_PREVIEW_CREATE_SUCCESS)}})},fold:function(){this.set("isFolded",!0)},unfold:function(){this.set("isFolded",!1)},showFoldHandle:function(){this.set("foldHandleVisible",!0)},hideFoldHandle:function(){this.set("foldHandleVisible",!1)},destroySelf:function(){this.set("destroySelf",!0),this.destroy()},getParentRoot:function(){return $(this.$el)},updateWatermark:function(){this.$refs&&this.$refs.watermark&&this.$refs.watermark.updateWatermark()}},components:{Switch:n(609),Footer:n(615),IGroup:n(622),Debug:n(624),Watermark:n(378)},afterMount:function(){var e=this;e.container=$(e.$el);var t=e.namespace=".default_theme_player"+Math.random();e.userStatusNamespace=".default_theme_player_user_status"+Math.random();var n,i=e.get("user.number");i?(e.watchUserStatus(i),e.instanceKey=(e.get("isAssist")?c.PLAYER_INSTANCE_KEY_PREFIX_OF_ASSIST:"")+i,O[e.instanceKey]=e):a.isTeacher(e.get("user.type"))&&(e.set("userStatus",e.getUserStatus("OUT")),h.one(h.TEACHER_ADD+t,function(t,n){var i=n.userList[0];e.set("user",i),e.watchUserStatus(i.number),e.instanceKey=(e.get("isAssist")?c.PLAYER_INSTANCE_KEY_PREFIX_OF_ASSIST:"")+i.number,O[e.instanceKey]=e})),e.debugPlugin=new L(e),e.actionTopPlugin=new N(e),e.webrtcMixPlugin=new D(e),e.initIsSpeakApply();e.get("isSelf")?(e.get("isAssist")?h.on(h.ASSIST_CAMERA_INDEX_CHANGE+t,function(){e.set("cameraIndex",d.getAssistCameraIndex())}):h.on(h.CAMERA_INDEX_CHANGE+t,function(){e.set("cameraIndex",d.getCameraIndex())}),e.get("needLocalPreview")&&h.on(h.PLAYER_LOCAL_PREVIEW_ON_CHNAGE+t,function(t,n){e.set("isLocalPreviewOn",!!n.value)}).on(h.CAMERA_QUALITY_LIST_CHANGE+e.namespace,function(){e.previewPlayer&&!e.previewPlayer.isCameraOpened&&e.previewPlayer.openCamera()}),h.on(h.UPLINK_LINK_TYPE_CHANGE+t,function(t,n){e.get("isPopup")&&e.get("needNativePopup")&&e.popdown()}).on(h.AV_PUBLISH_START+t,function(t,n){var i=n.player;i===e.player&&(i.hasPublishAuth||e.set("requestPublishAuth",!0))}).on(h.AV_PUBLISH_CLOSE_START+t,function(t,n){n.player===e.player&&(e.log("av publish close start"),e.set("publishStatus",""))}).on(h.PLAYER_REMOUNT_START+t,function(t,n){n.player===e.player&&(e.log("remount"),e.set("publishStatus",""))}).on(h.VIDEO_ATTACH+t,function(t,n){n.closeBlackFrame||n.player===e.player&&(e.log("attach video"),e.set("publishStatus",g.PUBLISH_STATUS_CONNECTING))}).on(h.AUDIO_ATTACH+t,function(t,n){n.fromMute||n.player===e.player&&e.log("attach audio")}).on(h.AV_PUBLISH_CONNECT_SUCCESS+t,function(t,n){n.player===e.player&&(e.log("av publish connect success"),e.set("publishStatus",g.PUBLISH_STATUS_LOADING))}).on(h.AV_PUBLISH_FAIL+t,function(t,n){n.player===e.player&&(e.log("av publish fail"),e.set("publishStatus",g.PUBLISH_STATUS_FAIL))}).on(h.CLOSE_MIC+t,function(t,n){n.player===e.player&&e.set("isFlashAuthShowing",!0)}).on(h.FLASH_AUTH_SETTING_SHOWING+t,function(t,n){n.player===e.player&&e.set("isFlashAuthShowing",!0)}),h.SCREEN_SHARE_STOP&&h.on(h.SCREEN_SHARE_STOP+t,function(t,n){e.set("isScreenSharing",!1)})):h.on(h.DOWNLINK_LINK_TYPE_CHANGE+t,function(t,n){e.get("isPopup")&&e.get("needNativePopup")&&e.popdown()}).on(h.AV_PLAY_START+t,function(t,n){var i=n.mediaType;~P.indexOf(i)||n.player===e.player&&(e.log("av play start"),e.set("playStatus",g.PLAY_STATUS_CONNECTING))}).on(h.AV_PLAY_CLOSE_START+t,function(t,n){n.player===e.player&&(e.log("av play close start"),e.set("playStatus",""))}).on(h.PLAYER_REMOUNT_START+t,function(t,n){n.player===e.player&&(e.log("remount"),e.set("playStatus",""))}).on(h.AV_PLAY_CONNECT_SUCCESS+t,function(t,n){n.player===e.player&&(e.log("av play connect success"),e.set("playStatus",g.PLAY_STATUS_LOADING))}).on(h.AV_PLAY_FAIL+t,function(t,n){n.player===e.player&&(e.log("av play fail"),e.set("playStatus",g.PLAY_STATUS_FAIL))}).on(h.SPEAK_APPLYING_ADD+t,function(t,n){n.user.id===e.get("user.id")&&e.set("isSpeakApplying",!0)}).on(h.SPEAK_APPLYING_REMOVE+t,function(t,n){n.user.id===e.get("user.id")&&e.set("isSpeakApplying",!1)});var s=function(t,n){var i=n.user;e.player&&i.id===e.get("user.id")&&(!n.hasOwnProperty("isScreenSharing")||r.mediaPopupScreenShare(i)||e.get("isAssist")||e.set("isScreenSharing",!!n.isScreenSharing))},u=function(t,n){var i=n.user;e.player&&i.id===e.get("user.id")&&(r.mediaPopupScreenShare(i)||((e.get("isAssist")&&r.mediaAssistScreenShare(n.mediaId)||!e.get("isAssist")&&r.mediaMainScreenShare(n.mediaId))&&e.set("isScreenSharing",!!n.videoOn),!a.isWebRTC()&&e.get("isAssist")&&e.get("user.id2")===n.mediaId&&e.set("isScreenSharing",!!n.isScreenSharing)),r.mediaFile(n.mediaId)&&!r.mediaPopupMediaPlayer()&&e.set("isMediaPlaying",!!n.videoOn))};if(h.on(h.PRESENTER_CHANGE+t,function(){e.set("presenterId",o.get("presenterId"))}).on(h.FULLSCREEN_EXIT+t,function(){e.get("isFullScreen")&&e.exitFullScreen()}).on(h.USER_UPDATE+t,function(t,n){var i=n.user;i.id===e.get("user.id")&&e.set({user:i,cameraCover:i.cameraCover})}).on(h.MEDIA_PUBLISH+t,s).on(h.MEDIA_REPUBLISH+t,s).on(h.ASSIST_MEDIA_PUBLISH+t,u).on(h.ASSIST_MEDIA_REPUBLISH+t,u).on(h.PLAYER_RUN_INFO_CHANGE+t,function(t,i){i.player===e.player&&(e.get("isSelf")?(i.uplinkAudioBandwidth>0||i.uplinkVideoBandwidth>0)&&(e.set("publishStatus",g.PUBLISH_STATUS_SUCCESS),e.set("isFlashError",!1),e.set("hasRunAuth",!0),e.set("requestPublishAuth",!1),e.set("isFlashAuthShowing",!1)):(i.downlinkAudioBandwidth>0||i.downlinkVideoBandwidth>0)&&(n&&(clearTimeout(n),n=null),n=setTimeout(function(){e.set("playStatus",g.PLAY_STATUS_SUCCESS),e.set("isFlashError",!1),e.set("hasRunAuth",!0)},200)))}),h.CLIENT_PLAYER_POPDOWN&&h.on(h.CLIENT_PLAYER_POPDOWN+t,function(t,n){n.player===e.player&&e.get("isPopup")&&e.popdown()}),e.get("needShowGroupColor")&&!e.get("isAssist")){var _=function(){var t=l.getGroupInfoById(e.get("user.group"));e.set("selfGroupColor",t&&t.color||"")};h.on(h.GROUP_INFO+t,_).on(h.GROUP_INFO_UPDATE+t,_).on(h.GROUP_MEMBER_UPDATE+t,_)}},beforeDestroy:function(){var e=this;e.debugPlugin&&e.debugPlugin.destroy(),e.actionTopPlugin&&e.actionTopPlugin.destroy(),e.webrtcMixPlugin&&e.webrtcMixPlugin.destroy();var t=e.player;t&&!t.isDisposed()&&(e.get("destroySelf")?(e.get("isPopup")&&e.popdown(),t.unmount(),e.set("destroySelf",!1)):t.dispose()),e.namespace&&(_.unwatch(e.userStatusNamespace),h.off(e.namespace)),e.instanceKey&&delete O[e.instanceKey]},instances:O,create:function(e){var t=Yox.object.copy(BJY.DefaultThemePlayer);t.el=e.element[0],t.replace=!1!==e.replace,t.props=e;var n=function(e,t){var n={};return(e=e instanceof Array?e:[]).forEach(function(e){e in t&&(n[e]=t[e])}),n};return e.footerOptions||(e.footerOptions=n(["canSwitchMic","needRatio","needZoom","needQualitySelector","onToggleClick","canPopup","canPopdown","canFullScreen","labelAfterName"],e)),e.switchOptions||(e.switchOptions=n(["canKickOut","needOffStage","canSwitchCamera","canSwitchMic","canSwitchPaint","canSwitchDocumentControl","canSwitchScreenShare","canSwitchAssistCamera","canChangePresenter","canDragOut","canStopSpeak","onKickOutConfirm"],e)),e.iGroupOptions||(e.iGroupOptions=n(["needInteraction"],e)),new Yox(t)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){t.PLAYER_LOCAL_PREVIEW_ON_CHNAGE="player_local_preview_on_change",t.PLAYER_LOCAL_PREVIEW_CREATE_SUCCESS="player_local_preview_create_success"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.PUBLISH_STATUS_CONNECTING="connecting",t.PUBLISH_STATUS_LOADING="loading",t.PUBLISH_STATUS_SUCCESS="success",t.PUBLISH_STATUS_FAIL="fail",t.PLAY_STATUS_CONNECTING="connecting",t.PLAY_STATUS_LOADING="loading",t.PLAY_STATUS_SUCCESS="success",t.PLAY_STATUS_FAIL="fail",t.ZOOM_STEP=1.2}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(602),a=n(604),o=n(71),s=n(72),u=n(76),c=n(77);return function(e){var t={silent:!0,element:e.element,x:"50%"===e.x?"50%":0,y:"50%"===e.y?"50%":0,width:e.width,height:e.height,attachment:{element:a(),width:o(),height:s(),x:e.x,y:e.y}};return e.fixed||(t.offset={x:u(),y:c()}),r(t)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(4),a=n(603),o={left:0,top:0,center:"50%",middle:"50%",right:"100%",bottom:"100%"};function s(e){var t=o[e.x];if(null==t&&(t=e.x),"string"===$.type(t)){var n=a(t);null!=n&&(t=n*(e.width||e.element.outerWidth()))}return t}function u(e){var t=o[e.y];if(null==t&&(t=e.y),"string"===$.type(t)){var n=a(t);null!=n&&(t=n*(e.height||e.element.outerHeight()))}return t}return function(e){var t=e.element,n=e.attachment||{};n.element||(n.element=r.body);var i=n.element.offset(),a=i.left+s(n),o=i.top+u(n),c=a-s(e),l=o-u(e),d=e.offset;d&&("number"===$.type(d.x)&&(c+=d.x),"number"===$.type(d.y)&&(l+=d.y));var _={left:c,top:l},f=t.css("position");if("absolute"!==f&&"fixed"!==f&&(_.position="absolute"),e.silent)return _;t.css(_)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(161),a=/(-?\d+(\.\d+)?)%/;return function(e){if(a.test(e))return r(RegExp.$1,100)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,i){"use strict";var r=n(4);return function(){return r.body.prop("clientHeight")>r.html.prop("clientHeight")?r.html:r.body}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.store,a=(BJY.eventEmitter,n(265)),o={data:function(){return{showDebugMediaInfo:null}},watchers:{showDebugMediaInfo:function(e){this.hook.set("showDebugMediaInfo",e)}},afterCreate:function(){var e=this;e.debugMediaInfoChangeHandler=function(t){e.set("showDebugMediaInfo",t)},r.watch("showDebugMediaInfo",e.debugMediaInfoChangeHandler,!0)},beforeDestroy:function(){this.debugMediaInfoChangeHandler&&r.unwatch("showDebugMediaInfo",this.debugMediaInfoChangeHandler)}};function s(e){this.plugin=new a(e,o)}return s.prototype.destroy=function(){this.plugin&&this.plugin.dispose()},s}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.store,a=BJY.data.class,o=BJY.eventEmitter,s=BJY.webrtcMixMediaPublish,u=n(265),c={afterCreate:function(){var e=this.hook,t=this.namespace=".player-webrtcmix-plugin"+Math.random();e.createPlayer(),e.get("presenterId")?e.set({userIn:!0,userStatus:e.getUserStatus("IN"),videoStatus:a.isStarted()?e.getUserStatus("VIDEO_ON"):e.getUserStatus("VIDEO_OFF")}):e.set({userIn:!1,userStatus:e.getUserStatus("OUT")}),this.offlineHandler=function(t){if(!t){var n=e.getPlayer();n&&n.replay()}},r.watch("offline",this.offlineHandler),o.on(o.WEBRTC_MIX_MEDIA_PUBLISH+t,function(t,n){var i=n.user;i&&i.id===e.get("user.id")&&(e.set({videoOn:n.videoOn,audioOn:n.audioOn}),n.videoOn?e.set("videoStatus",e.getUserStatus("VIDEO_ON")):e.set("videoStatus",e.getUserStatus("VIDEO_OFF")),n.videoOn&&n.audioOn?e.set("userStatus",e.getUserStatus("VIDEO_ON_AUDIO_ON")):n.videoOn&&!n.audioOn?e.set("userStatus",e.getUserStatus("VIDEO_ON_AUDIO_OFF")):!n.videoOn&&n.audioOn?e.set("userStatus",e.getUserStatus("VIDEO_OFF_AUDIO_ON")):n.videoOn||n.audioOn||e.set("userStatus",e.getUserStatus("VIDEO_OFF_AUDIO_OFF")),e.get("isAudioMediaType")&&n.audioOn?e.set("videoStatus",e.getUserStatus("AUDIO_ONLY_AUDIO_ON")):e.get("isAudioMediaType")&&!n.audioOn&&e.set("videoStatus",e.getUserStatus("AUDIO_ONLY_AUDIO_OFF")))}).on(o.PRESENTER_CHANGE+t,function(t,n){e.get("isWebRTCMix")&&(r.get("presenterId")?e.set({userIn:!0,userStatus:e.getUserStatus("IN")}):e.set({userIn:!1,userStatus:e.getUserStatus("OUT")}))}).on(o.MEDIA_PUBLISH+t,function(e,t){s()}).on(o.ASSIST_MEDIA_PUBLISH+t,function(e,t){s()}).on(o.MEDIA_REPUBLISH+t,function(e,t){s()}).on(o.ASSIST_MEDIA_REPUBLISH+t,function(e,t){s()}),Yox.nextTick(function(){s()})},beforeDestroy:function(){this.offlineHandler&&r.unwatch("offline",this.offlineHandler),this.namespace&&o.off(this.namespace)}};function l(e){if(e.get("isWebRTCMix")&&!e.getPlayer()){if(!(e instanceof Yox))throw new Error("需要传入yox实例");this.plugin=new u(e,c)}}return l.prototype.destroy=function(){this.plugin&&this.plugin.dispose()},l}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.store,a=(BJY.eventEmitter,n(265)),o={data:function(){return{keepTop:null}},watchers:{keepTop:function(e){this.hook.set("keepTop",e)}},afterCreate:function(){var e=this;e.actionTopHandler=function(t){var n=e.hook.getPlayer();n&&n.id===t?e.set("keepTop",!0):e.set("keepTop",!1)},e.clickHandler=function(){var t=e.hook.getPlayer();t&&e.hook.get("isDOMPopup")&&r.set("actionTopPlayer",t.id)},r.watch("actionTopPlayer",e.actionTopHandler,!0),$(e.hook.$el).on("click",e.clickHandler)},beforeDestroy:function(){var e=this;e.actionTopHandler&&r.unwatch("actionTopPlayer",e.actionTopHandler),e.clickHandler&&$(e.hook.$el).off("click",e.clickHandler)}};function s(e){e.get("actionTop")&&(this.plugin=new a(e,o))}return s.prototype.destroy=function(){this.plugin&&this.plugin.dispose()},s}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bjy-player-theme-default" data-user-id="{{user.id}}" data-user-number="{{user.number}}" data-user-type="{{user.type}}" data-self="{{#if isSelf}}1{{else}}0{{/if}}" data-small="{{#if isSmall}}1{{else}}0{{/if}}" data-draggable="{{#if canDrag && !isMaximize}}1{{else}}0{{/if}}" data-fullscreen="{{#if isFullScreen}}1{{else}}0{{/if}}" data-popup="{{#if isPopup}}1{{else}}0{{/if}}" data-has-volume="{{#if audioOn && volume > 20}}1{{else}}0{{/if}}" data-dom-popup="{{#if isDOMPopup}}1{{else}}0{{/if}}" data-pop-animating="{{#if isPopAnimating}}1{{else}}0{{/if}}" data-screen-sharing="{{#if isScreenSharing}}1{{else}}0{{/if}}" data-ready="{{#if isReady}}1{{else}}0{{/if}}" data-in="{{#if userIn}}1{{else}}0{{/if}}" data-speak-applying="{{#if isSpeakApplying}}1{{else}}0{{/if}}" data-requesting="{{#if requestPublishAuth}}1{{else}}0{{/if}}" data-flash-setting="{{#if isFlashAuthShowing}}1{{else}}0{{/if}}" data-video-on="{{#if videoOn}}1{{else}}0{{/if}}" data-audio-on="{{#if audioOn}}1{{else}}0{{/if}}" data-video-disabled="{{#if isVideoDisabled}}1{{else}}0{{/if}}" data-snapshot-shown="{{#if isSnapshotShown}}1{{else}}0{{/if}}" data-keep-top="{{#if keepTop}}1{{else}}0{{/if}}" data-local-preview="{{needLocalPreview && isLocalPreviewOn ? 1 : 0}}" data-assist="{{isAssist ? 1 : 0}}" data-has-group-style="{{groupColorStyle ? 1 : 0}}" on-dblclick="playerDoubleClick" {{#if canPopByDrag}}on-mousedown="playerRootElementMousedown"{{/if}}>{{#partial mediaStatus}}{{#if isFlashError}}{{else if !mediaOn || hasRunAuth || isWebRTC}}{{#if isSpeakApplying}}<table class="bjy-player-cover bjy-is-applying"><td>{{#if canManageSpeak}}<div class="bjy-speak-applying-buttons"><div class="bjy-button btn-reject-speak-applying" on-click="rejectSpeakApplying()" lazy="1000">{{language.REJECT}}</div><div class="bjy-button btn-accept-speak-applying" on-click="acceptSpeakApplying()" lazy="1000">{{language.ACCEPT}}</div></div>{{/if}}<div class="bjy-icon bjy-speak-applying"></div></td></table>{{else if !isReady}}<table class="bjy-player-cover"><td><div class="bjy-loader-spinner"><div></div><div></div><div></div><div></div><div></div></div>{{#if publishStatus === PUBLISH_STATUS_CONNECTING}}<div class="bjy-player-status">{{language.PUBLISH_STATUS_CONNECTING}}</div>{{else if publishStatus === PUBLISH_STATUS_LOADING}}<div class="bjy-player-status">{{language.PUBLISH_STATUS_LOADING}}</div>{{else if publishStatus === PUBLISH_STATUS_FAIL}}<div class="bjy-player-status">{{language.PUBLISH_STATUS_FAIL}}</div>{{else if playStatus === PLAY_STATUS_CONNECTING}}<div class="bjy-player-status">{{language.PLAY_STATUS_CONNECTING}}</div>{{else if playStatus === PLAY_STATUS_LOADING}}<div class="bjy-player-status">{{language.PLAY_STATUS_LOADING}}</div>{{else if playStatus === PLAY_STATUS_FAIL}}<div class="bjy-player-status">{{language.PLAY_STATUS_FAIL}}</div>{{/if}}</td></table>{{else if isSelf && !isAudioMediaType && cameraIndex < 0 && !(isScreenSharing || isMediaPlaying)}}{{#if canSetCameraCover && cameraCover}}<div class="bjy-custom-player-cover"><img class="bjy-camera-cover" src="{{cameraCover}}"></div>{{else}}<table class="bjy-player-cover" {{#if showCameraCover && isStudentRole && studentCameraCover }} style="background-image: url({{studentCameraCover}});">{{/if}}<td><div class="bjy-icon bjy-user-video-off"></div><div class="bjy-player-status">{{language.SELF_CAMERA_NOT_FOUND}}</div></td></table>{{/if}}{{else if !(videoOn || isScreenSharing || isMediaPlaying)}}{{#if canSetCameraCover && cameraCover && userIn}}<div class="bjy-custom-player-cover"><img class="bjy-camera-cover" src="{{cameraCover}}"></div>{{else}}<table class="bjy-player-cover" {{#if showCameraCover && isStudentRole && studentCameraCover }} style="background-image: url({{studentCameraCover}});">{{/if}}<td>{{#if userIn}}{{#if audioOn && isAudioMediaType}}<div class="bjy-icon bjy-user-audio-on"></div>{{else}}<div class="bjy-icon bjy-user-video-off"></div>{{/if}}{{#if videoStatus}}<div class="bjy-player-status">{{videoStatus}}</div>{{/if}}{{else}}<div class="bjy-icon bjy-user-out"></div>{{#if userStatus}}<div class="bjy-player-status">{{userStatus}}</div>{{/if}}{{/if}}</td></table>{{/if}}{{else if isVideoDisabled}}<table class="bjy-player-cover"><td><div class="bjy-icon bjy-mic-wave"><div class="bjy-icon bjy-mic-circle"></div></div></td></table>{{/if}}{{/if}}{{/partial}}<div class="bjy-video-player{{needPositionTransition ? \' bjy-transition\' : \'\'}}{{showScreenShareMask ? \' bjy-screen-sharing\' : \'\'}}" on-mousedown="playerMousedown">\x3c!-- 重要：这个dom用来做player的根元素，不能在里面再加dom结构，因为其他地方可能会操作里面的dom--\x3e<div class="bjy-player-container"></div>\x3c!-- --\x3e{{#if needLocalPreview}}<div class="bjy-local-preview-container{{videoOn ? \' bjy-hidden\' : \'\'}}"></div>{{/if}}{{#if showDebugMediaInfo}}<Debug key="debug" ref="debug" user="{{user}}" isAssist="{{isAssist}}" />{{/if}}{{#if isStoppingSpeak}}<div class="bjy-stop-speak-layer"><span class="bjy-stop-speak-hint">{{language.STOPPING_SPEAK_TIP}}<br/>{{language.PLEASE_WAIT_TIP}}</span></div>{{/if}}{{#if inClient || isDOMPopup}}<div class="bjy-video-cover">{{#if showScreenShareMask}}<div class="bjy-screen-share-tip"><div class="bjy-screen-share-img"></div><div class="bjy-tip">{{language.IS_SCREEN_SHARING}}</div></div>{{/if}}</div>{{/if}}{{#if isReady}}<Watermark key="watermark" ref="watermark" user="{{user}}" hasWatermark="{{hasWatermark}}" parent="{{this}}"/>{{/if}}{{#if isDOMPopup}}{{> mediaStatus}}{{/if}}{{#if needPopupFooter && (isPopup || isFullScreen)}}<Footer key="footer" ref="footer" type="popup" user="{{user}}" isAssist="{{isAssist}}" userIn="{{userIn}}" videoOn="{{videoOn}}" audioOn="{{audioOn}}" isPopup="{{isPopup}}" isVideoDisabled="{{isVideoDisabled}}" isScreenSharing="{{isScreenSharing}}" isFullScreen="{{isFullScreen}}" {{...footerOptions}} />{{/if}}{{#if isDOMPopup && needSwitch}}<Switch key="switch" ref="switch" user="{{user}}" isAssist="{{isAssist}}" userIn="{{userIn}}" videoOn="{{videoOn}}" audioOn="{{audioOn}}" isPopup="{{isPopup}}" isVideoDisabled="{{isVideoDisabled}}" isScreenSharing="{{isScreenSharing}}" canDisableVideo="{{canDisableVideo}}" canManageSpeak="{{canManageSpeak}}" {{...switchOptions}} />{{#if canDrag && !isMaximize && !isFullscreen}}<div class="bjy-dragger bjy-dragger-lt" on-mousedown="changePlayerSize(\'lt\')"></div><div class="bjy-dragger bjy-dragger-t" on-mousedown="changePlayerSize(\'t\')"></div><div class="bjy-dragger bjy-dragger-rt" on-mousedown="changePlayerSize(\'rt\')"></div><div class="bjy-dragger bjy-dragger-l" on-mousedown="changePlayerSize(\'l\')"></div><div class="bjy-dragger bjy-dragger-r" on-mousedown="changePlayerSize(\'r\')"></div><div class="bjy-dragger bjy-dragger-lb" on-mousedown="changePlayerSize(\'lb\')"></div><div class="bjy-dragger bjy-dragger-b" on-mousedown="changePlayerSize(\'b\')"></div><div class="bjy-dragger bjy-dragger-rb" on-mousedown="changePlayerSize(\'rb\')"></div>{{/if}}{{/if}}{{#if needIGroup}}<IGroup key="iGroup" ref="iGroup" user="{{user}}" {{...iGroupOptions}} />{{/if}}</div>{{#if !requestPublishAuth}}{{#if isPopup}}<table class="bjy-player-cover" on-dblclick="onUserSeatDoubleClick"><td>{{#if needAvatar}}<img class="bjy-user-avatar" src="{{compressImage(user.avatar, 60, 60)}}" srcset="{{compressImage(user.avatar, 120, 120)}} 2x" ondragstart="return false">{{#if userStatus}}<div class="bjy-player-status">{{userStatus}}</div>{{/if}}{{else}}<div class="bjy-icon bjy-user-seat"></div><div class="bjy-player-status">{{getUserSeat(user.name)}}</div>{{/if}}</td></table>{{else}}{{> mediaStatus}}{{/if}}{{/if}}{{#if canFold && foldHandleVisible}}<div class="bjy-fold-bar bjy-transition">{{#if isFolded}}<div class="bjy-fold-toggle" on-click="toggle(\'isFolded\')"><i class="icon icon-angle-up"></i>{{language.UNFOLD}}</div>{{else}}<div class="bjy-fold-toggle" on-click="toggle(\'isFolded\')"><i class="icon icon-angle-down"></i>{{language.FOLD}}</div>{{/if}}</div>{{/if}}{{#if needFooter && !(isPopup || isFullScreen)}}<Footer key="footer" ref="footer" type="default" user="{{user}}" isAssist="{{isAssist}}" userIn="{{userIn}}" videoOn="{{videoOn}}" audioOn="{{audioOn}}" isPopup="{{isPopup}}" isVideoDisabled="{{isVideoDisabled}}" isScreenSharing="{{isScreenSharing}}" isFullScreen="{{isFullScreen}}" {{...footerOptions}}/>{{/if}}{{#if !isSelf && user.name && qualityList.length > 1}}<div class="bjy-popup-name bjy-label">{{user.name}}</div>{{/if}}{{#if !isDOMPopup && needSwitch}}<Switch key="switch" ref="switch" user="{{user}}" userIn="{{userIn}}" isAssist="{{isAssist}}" videoOn="{{videoOn}}" audioOn="{{audioOn}}" isPopup="{{isPopup}}" isVideoDisabled="{{isVideoDisabled}}" isScreenSharing="{{isScreenSharing}}" canDisableVideo="{{canDisableVideo}}" canManageSpeak="{{canManageSpeak}}" {{...switchOptions}} />{{/if}}{{#if needShowGroupColor}}<style>{{groupColorStyle}}</style>{{/if}}</div>'},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.auth,a=BJY.store,o=BJY.config,s=BJY.data.adminAuth,u=BJY.eventEmitter,c=BJY.data.user,l=n(610),d=n(3);function _(e,t,n){r.isSelf(e)?u.trigger(u.MEDIA_SWITCH_TRIGGER,{videoOn:t,audioOn:n}):u.trigger(u.MEDIA_REMOTE_CONTROL_TRIGGER,{user:c.find(e),videoOn:t,audioOn:n})}return{template:n(614),propTypes:{user:{type:"object"},isAssist:{type:"boolean",value:!1},userIn:{type:"boolean",value:!1},videoOn:{type:["boolean","null"],value:!1},audioOn:{type:["boolean","null"],value:!1},isPopup:{type:"boolean",value:!1},isVideoDisabled:{type:"boolean",value:!1},isScreenSharing:{type:"boolean",value:!1},canManageSpeak:{type:"boolean",value:r.canManageSpeak},canStopSpeak:{type:"boolean",value:!1},canSwitchPaint:{type:"boolean"},canSwitchDocumentControl:{type:"boolean"},canSwitchScreenShare:{type:"boolean"},canSwitchAssistCamera:{type:"boolean"},canChangePresenter:{type:"boolean",value:!1},canSwitchCamera:{type:"boolean"},canSwitchMic:{type:"boolean"},needOffStage:{type:"boolean",value:!1},canDragOut:{type:"boolean",value:!1},canKickOut:{type:"boolean",value:r.canKickOut()},onKickOutConfirm:{type:"function"},canDisableVideo:{type:"boolean",value:!0},customOperations:{type:"array",value:[]}},data:function(){var e=this.get("user");return{CLASS_ACTIVE:"bjy-active",language:l(),canUsePaint:r.isAssistant(e.type)?s.getUserPainterAuth(e):r.canStudentPaintByNumber(e.number),canDocumentControl:r.isAssistant(e.type)?s.getUserDocumentControlAuth(e):r.canStudentDocumentControlByNumber(e.number),canScreenShare:r.canStudentScreenShareByNumber(e.number),canUseAssistCamera:r.canStudentAssistCameraByNumber(e.number),presenterId:a.get("presenterId"),isClassStarted:!1}},watchers:{audioOn:function(e){!e&&this.get("isVideoDisabled")&&this.set("isVideoDisabled",!1)},mediaOn:function(e){e||this.set("isStoppingSpeak",!1)},isStoppingSpeak:function(e,t){this.fire("isStoppingSpeakChange",{isStoppingSpeak:e})}},computed:{isSelf:function(){return r.isSelfByNumber(this.get("user.number"))},mediaOn:function(){return this.get("videoOn")||this.get("audioOn")},canCameraSwitched:function(){return this.get("user.endType")!==o.END_TYPE_MOBILE_BROWSER&&this.get("user.endType")!==o.END_TYPE_XIAOCHENGXU&&this.get("isClassStarted")&&this.get("userIn")},canMicSwitched:function(){var e=this.get("user",{});return!(!this.get("isSelf")&&r.isTeacher(e.type))&&(e.endType!==o.END_TYPE_MOBILE_BROWSER&&e.endType!==o.END_TYPE_XIAOCHENGXU&&this.get("isClassStarted")&&this.get("userIn"))},canOffStage:function(){var e=this.get("user");return this.get("needOffStage")&&!r.isTeacher(e.type)&&c.isActive(e.id)},canKickOuted:function(){return r.isStudent(this.get("user.type"))&&this.get("userIn")},canDragOuted:function(){return!this.get("isSelf")||!this.get("isScreenSharing")}},methods:{customOperationsClick:function(e){this.fire("customOperationClick",$.extend({user:this.get("user")},e)),this.hideMoreOptions()},getPlayer:function(){var e=BJY.Player.instances[this.get("user.id")];return e&&!e.isDisposed()?e:null},showMoreOptions:function(e){this.moreOptionsVisible=!0,this.container.addClass("bjy-active"),this.fire("playerMoreOptionsShow")},hideMoreOptions:function(e){var t=this;t.moreOptionsVisible=!1,setTimeout(function(){!1===t.moreOptionsVisible&&(t.container.removeClass("bjy-active"),t.fire("playerMoreOptionsHide"))},200)},toggleVideoDisabled:function(){this.fire("videoDisableChange",{isVideoDisabled:!this.get("isVideoDisabled")}),this.hideMoreOptions()},stopSpeak:function(){BJY.userSpeak.stopSpeak(this.get("user.id")),this.set("isStoppingSpeak",!0),this.hideMoreOptions()},switchPaint:function(){var e=this,t=e.get("user.number"),n=!e.get("canUsePaint");if(r.isAssistant(e.get("user.type")))s.setUserPainterAuth(e.get("user"),n);else{var i=(a.get("class.studentPaintAuth")||[]).slice();n?t&&i.push(t):Yox.array.remove(i,t),u.trigger(u.SWITCH_STUDENT_PAINT_TRIGGER,{studentPaintAuth:i})}e.hideMoreOptions()},switchDocumentControl:function(){var e=this,t=e.get("user.number"),n=!e.get("canDocumentControl");if(r.isAssistant(e.get("user.type")))s.setUserDocumentContolAuth(e.get("user"),n);else{var i=(a.get("class.studentDocumentControlAuth")||[]).slice();n?t&&i.push(t):Yox.array.remove(i,t),u.trigger(u.SWITCH_STUDENT_AUTH_TRIGGER,{studentDocumentControlAuth:i})}e.hideMoreOptions()},switchScreenShare:function(){this.hideMoreOptions();var e=this.get("user.number"),t=!this.get("canScreenShare");if(r.isTeacher()||r.isAssistant()){var n=(a.get("class.studentScreenShareAuth")||[]).slice();t?e&&n.push(e):Yox.array.remove(n,e),u.trigger(u.SWITCH_STUDENT_AUTH_TRIGGER,{studentScreenShareAuth:n})}},switchAssistCamera:function(){var e=this.get("user.number"),t=!this.get("canUseAssistCamera");if(this.hideMoreOptions(),r.isTeacher()||r.isAssistant()){var n=(a.get("class.studentAssistCameraAuth")||[]).slice();t?e&&n.push(e):Yox.array.remove(n,e),u.trigger(u.SWITCH_STUDENT_AUTH_TRIGGER,{studentAssistCameraAuth:n})}},setPresenter:function(){this.get("presenterId")!==this.get("user.id")&&u.trigger(u.PRESENTER_CHANGE_TRIGGER,{presenterId:this.get("user.id")})},cancelPresenter:function(){this.get("presenterId")===this.get("user.id")&&u.trigger(u.PRESENTER_CHANGE_TRIGGER,{presenterId:a.get("user.id")})},openCamera:function(){_(this.get("user.id"),!0,this.get("audioOn")),this.hideMoreOptions()},closeCamera:function(){_(this.get("user.id"),!1,this.get("audioOn")),this.hideMoreOptions()},toggleCamera:function(){this.get("videoOn")?this.closeCamera():this.openCamera()},openMic:function(){this.fire("openMic"),this.hideMoreOptions()},closeMic:function(){this.fire("closeMic"),this.hideMoreOptions()},toggleMic:function(){this.get("audioOn")?this.closeMic():this.openMic()},offStage:function(){u.trigger(u.USER_ACTIVE_REMOVE_TRIGGER,{user:this.get("user")})},kickOut:function(){var e=this,t=e.get("user"),n=t.name.replace(/([<>\/])/g,"\\$1\\"),i=e.get("language.KICK_OUT_CONFIRM").replace("${userName}",n),r=e.get("onKickOutConfirm");r?r(t,i).then(function(n){n&&(u.trigger(u.KICK_OUT_TRIGGER,{userId:t.id}),e.hideMoreOptions())}):(u.trigger(u.KICK_OUT_TRIGGER,{userId:t.id}),this.hideMoreOptions())},dragOut:function(){this.fire("popUp"),this.hideMoreOptions()},dragIn:function(){this.fire("popDown"),this.hideMoreOptions()}},afterMount:function(){var e=this;e.container=$(e.$el);var t=e.namespace=".defaultplayer-switch"+Math.random();e.classStartedHandler=function(t){e.set("isClassStarted",t)},a.watch("class.started",e.classStartedHandler,!0),r.isStudent(e.get("user.type"))?(e.studentAuthChangeHandler=function(t){var n=e.get("user");e.set("canDocumentControl",n&&Yox.array.has(a.get("class.studentDocumentControlAuth",[]),n.number)),e.set("canUsePaint",n&&Yox.array.has(a.get("class.studentPaintAuth",[]),n.number)),e.set("canScreenShare",n&&Yox.array.has(a.get("class.studentScreenShareAuth",[]),n.number)),e.set("canUseAssistCamera",n&&Yox.array.has(a.get("class.studentAssistCameraAuth",[]),n.number))},a.watch("class.studentDocumentControlAuth",e.studentAuthChangeHandler),a.watch("class.studentPaintAuth",e.studentAuthChangeHandler),a.watch("class.studentScreenShareAuth",e.studentAuthChangeHandler)):r.isAssistant(e.get("user.type"))&&u.on(u.ADMIN_AUTH_PAINTER_CHANGE+t,function(t,n){n.number===e.get("user.number")&&e.set("canUsePaint",1===n.value)}).on(u.ADMIN_AUTH_DOCUMENT_CONTROL_CHANGE+t,function(t,n){n.number===e.get("user.number")&&e.set("canDocumentControl",1===n.value)}),u.on(u.SCREEN_SHARE_AUTH_CHANGE+t,function(t,n){!n.canScreenShare&&e.get("isSelf")&&u.trigger(u.SCREEN_SHARE_STOP_TRIGGER)}).on(u.ASSIST_CAMERA_AUTH_CHANGE+t,function(t,n){!n.canUseAssistCamera&&e.get("isSelf")&&u.trigger(u.ASSIST_MEDIA_SWITCH_TRIGGER,{videoOn:!1,audioOn:!1})}).on(u.PRESENTER_CHANGE+t,function(){e.set("presenterId",a.get("presenterId"))}).on(u.REMOTER_KEYBOARD_DOWN+t,function(t,n){var i=n.keyCode,r=n.activeItem;r&&1===r.length&&(r.data().userNumber===d(e.get("user.number"))&&a.get("class.started")&&(i==o.KEYBOARD_TOGGLE_STUDENT_MIC?e.toggleMic():i==o.KEYBOARD_TOGGLE_STUDENT_CAMERA&&e.toggleCamera()))})},beforeDestroy:function(){var e=this;e.classStartedHandler&&a.unwatch("class.started",e.classStartedHandler),e.studentAuthChangeHandler&&(a.unwatch("class.studentDocumentControlAuth",e.studentAuthChangeHandler),a.unwatch("class.studentPaintAuth",e.studentAuthChangeHandler),a.unwatch("class.studentScreenShareAuth",e.studentAuthChangeHandler)),e.namespace&&u.off(e.namespace)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){return function(){return BJY.getLanguage({english:n(611),chineseLive:n(612),chineseClassroom:n(613)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.CAMERA_OPEN="Open Camera",t.CAMERA_CLOSE="Close Camera",t.MIC_OPEN="Open Mic",t.MIC_CLOSE="Close Mic",t.VIDEO_CLOSE="Close Image",t.VIDEO_OPEN="Open Image.",t.STOP_SPEAK="Stop Speaking",t.KICK_OUT="Kick Out",t.DRAG_IN="Drag out of blackboard zone",t.DRAG_OUT="Drag into blackboard zone",t.ENABLE_PAINT="Authorize Brush",t.DISABLE_PAINT="Deauthorize Brush",t.AUTH_PRESENTER="Authorize Presenter",t.DEAUTH_PRESENTER="Deauthorize Presenter",t.ENABLE_DOCUMENT_CONTROL="Authorize PPT",t.DISABLE_DOCUMENT_CONTROL="Deauthorize PPT",t.ENABLE_SCREEN_SHARE="Authorize ScreenShare",t.DISABLE_SCREEN_SHARE="Revoke ScreenShare",t.ENABLE_ASSIST_CAMERA="Assist Camera",t.DISABLE_ASSIST_CAMERA="Revoke Assist Camera",t.OFF_STAGE="Off Stage",t.KICK_OUT_CONFIRM="Confirm remove ${userName} from room?<br/> The user will be unable to enter the room after being removed"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.CAMERA_OPEN="打开摄像头",t.CAMERA_CLOSE="关闭摄像头",t.MIC_OPEN="打开麦克风",t.MIC_CLOSE="关闭麦克风",t.VIDEO_CLOSE="只听声音",t.VIDEO_OPEN="打开画面",t.STOP_SPEAK="终止发言",t.KICK_OUT="踢出房间",t.DRAG_IN="拖出黑板区",t.DRAG_OUT="拖入黑板区",t.ENABLE_PAINT="授权画笔",t.DISABLE_PAINT="收回画笔",t.AUTH_PRESENTER="设为主讲",t.DEAUTH_PRESENTER="收回主讲",t.ENABLE_DOCUMENT_CONTROL="授权PPT",t.DISABLE_DOCUMENT_CONTROL="取消PPT",t.ENABLE_SCREEN_SHARE="屏幕共享",t.DISABLE_SCREEN_SHARE="结束共享",t.ENABLE_ASSIST_CAMERA="辅助摄像头",t.DISABLE_ASSIST_CAMERA="取消辅助摄像头",t.OFF_STAGE="下台",t.KICK_OUT_CONFIRM="您确定将“${userName}”踢出教室?<br/>踢出教室后该用户本节课不能再次进入教室"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.CAMERA_OPEN="打开摄像头",t.CAMERA_CLOSE="关闭摄像头",t.MIC_OPEN="打开麦克风",t.MIC_CLOSE="关闭麦克风",t.VIDEO_CLOSE="只听声音",t.VIDEO_OPEN="打开画面",t.STOP_SPEAK="终止发言",t.KICK_OUT="踢出教室",t.DRAG_IN="拖出黑板区",t.DRAG_OUT="拖入黑板区",t.ENABLE_PAINT="授权画笔",t.DISABLE_PAINT="收回画笔",t.AUTH_PRESENTER="设为主讲",t.DEAUTH_PRESENTER="收回主讲",t.ENABLE_DOCUMENT_CONTROL="授权PPT",t.DISABLE_DOCUMENT_CONTROL="取消PPT",t.ENABLE_SCREEN_SHARE="屏幕共享",t.DISABLE_SCREEN_SHARE="结束共享",t.ENABLE_ASSIST_CAMERA="辅助摄像头",t.DISABLE_ASSIST_CAMERA="取消辅助摄像头",t.OFF_STAGE="下台",t.KICK_OUT_CONFIRM="您确定将“${userName}”踢出教室?<br/>踢出教室后该用户本节课不能再次进入教室"}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bjy-more-switcher bjy-transition{{#if (!isSelf && videoOn && audioOn && canDisableVideo)|| (!isSelf && canStopSpeak)|| (!isSelf && canSwitchPaint)|| (!isSelf && canSwitchDocumentControl)|| (!isSelf && canChangePresenter)|| (!isSelf && canSwitchCamera && canCameraSwitched)|| (!isSelf && canSwitchMic && canMicSwitched)|| (canManageSpeak && canOffStage)|| (!isSelf && canKickOut && canKickOuted)|| (canDragOut && canDragOuted)}} bjy-visible{{/if}} " on-mouseenter="showMoreOptions()" on-mouseleave="hideMoreOptions()">{{#partial toggleVideoDisabled}}<div class="bjy-more-option bjy-toggle-video" on-click="toggleVideoDisabled()" lazy="1000">{{#if isVideoDisabled}}{{language.VIDEO_OPEN}}{{else}}{{language.VIDEO_CLOSE}}{{/if}}</div>{{/partial}}{{#partial retryStopSpeak}}<div class="bjy-more-option bjy-retry-stop-speak" on-click="stopSpeak()" lazy="1000">{{language.REFRESH_AND_RETRY}}</div>{{/partial}}{{#partial stopSpeak}}<div class="bjy-more-option bjy-stop-speak" on-click="stopSpeak()" lazy="1000">{{language.STOP_SPEAK}}</div>{{/partial}}{{#partial switchPaint}}<div class="bjy-more-option bjy-toggle-paint" on-click="switchPaint()" lazy="1000">{{#if canUsePaint}}{{language.DISABLE_PAINT}}{{else}}{{language.ENABLE_PAINT}}{{/if}}</div>{{/partial}}{{#partial switchDocumentControl}}<div class="bjy-more-option bjy-toggle-document-control" on-click="switchDocumentControl()" lazy="1000">{{#if canDocumentControl}}{{language.DISABLE_DOCUMENT_CONTROL}}{{else}}{{language.ENABLE_DOCUMENT_CONTROL}}{{/if}}</div>{{/partial}}{{#partial switchScreenShare}}<div class="bjy-more-option bjy-toggle-screen-share" on-click="switchScreenShare()" lazy="1000">{{#if canScreenShare}}{{language.DISABLE_SCREEN_SHARE}}{{else}}{{language.ENABLE_SCREEN_SHARE}}{{/if}}</div>{{/partial}}{{#partial switchAssistCamera}}<div class="bjy-more-option bjy-toggle-assist-camera" on-click="switchAssistCamera()" lazy="1000">{{#if canUseAssistCamera}}{{language.DISABLE_ASSIST_CAMERA}}{{else}}{{language.ENABLE_ASSIST_CAMERA}}{{/if}}</div>{{/partial}}{{#partial changePresenter}}<div class="bjy-more-option bjy-change-presenter" lazy="1000"{{#if user.id === presenterId}} on-click="cancelPresenter()"{{else}} on-click="setPresenter()"{{/if}}>{{#if user.id === presenterId}}{{language.DEAUTH_PRESENTER}}{{else}}{{language.AUTH_PRESENTER}}{{/if}}</div>{{/partial}}{{#partial switchCamera}}<div class="bjy-more-option bjy-toggle-camera" on-click="toggleCamera()" lazy="2000">{{#if videoOn}}{{language.CAMERA_CLOSE}}{{else}}{{language.CAMERA_OPEN}}{{/if}}</div>{{/partial}}{{#partial switchMic}}<div class="bjy-more-option bjy-toggle-mic" on-click="toggleMic()" lazy="2000">{{#if audioOn}}{{language.MIC_CLOSE}}{{else}}{{language.MIC_OPEN}}{{/if}}</div>{{/partial}}{{#partial offStage}}<div class="bjy-more-option bjy-off-stage" on-click="offStage()" lazy="1000">{{language.OFF_STAGE}}</div>{{/partial}}{{#partial kickOut}}<div class="bjy-more-option bjy-kick-out" on-click="kickOut()" lazy="1000">{{language.KICK_OUT}}</div>{{/partial}}{{#partial dragOut}}<div class="bjy-more-option bjy-toggle-drag" lazy="1000"{{#if isPopup}} on-click="dragIn()"{{else}} on-click="dragOut()"{{/if}}>{{#if isPopup}}{{language.DRAG_IN}}{{else}}{{language.DRAG_OUT}}{{/if}}</div>{{/partial}}{{#partial customOperations}}{{#each customOperations}}<div class="bjy-more-option " on-click="customOperationsClick(this)" lazy="1000">{{this.title}}</div>{{/each}}{{/partial}}<div class="bjy-more-button bjy-icon"></div><div class="bjy-more-options">{{#if isStoppingSpeak}}{{> retryStopSpeak}}{{else}}{{#if !isSelf && canChangePresenter}}{{> changePresenter}}{{/if}}{{#if !isSelf && videoOn && audioOn && canDisableVideo}}{{> toggleVideoDisabled}}{{/if}}{{#if !isSelf && canStopSpeak}}{{> stopSpeak}}{{/if}}{{#if !isSelf && canSwitchCamera && canCameraSwitched && !isScreenSharing}}{{> switchCamera}}{{/if}}{{#if !isSelf && canSwitchMic && canMicSwitched}}{{> switchMic}}{{/if}}{{#if !isSelf && canSwitchPaint}}{{> switchPaint}}{{/if}}{{#if !isSelf && canSwitchDocumentControl}}{{> switchDocumentControl}}{{/if}}{{#if isClassStarted && !isSelf && canSwitchScreenShare}}{{> switchScreenShare}}{{/if}}{{#if isClassStarted && !isSelf && canSwitchAssistCamera}}{{> switchAssistCamera}}{{/if}}{{#if canDragOut && canDragOuted}}{{> dragOut}}{{/if}}{{#if canManageSpeak && canOffStage}}{{> offStage}}{{/if}}{{#if !isSelf && canKickOut && canKickOuted}}{{> kickOut}}{{/if}}{{#if customOperations.length}}{{> customOperations}}{{/if}}{{/if}}</div></div>'},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.auth,a=BJY.store,o=BJY.config,s=BJY.data.class,u=BJY.data.media,c=BJY.eventEmitter,l=n(31),d=n(3),_=n(616),f=n(617),p=n(139),h=n(173),g=[5,15,20,30,40],E=10;function v(){var e=a.get("partner.livePacketLossRateLevel");"string"==typeof e&&(e=e.split(/[,，]/)),g=e||g,v=$.noop}function m(){r.isWebRTC()&&(E=3),m=$.noop}function S(e,t){for(var n=o.CAMERA_QUALITY_MAP,i=[],r=0;r<e.length;r++)switch(e[r]){case n[o.VIDEO_QUALITY_4K]:i.push({text:t.VIDEO_QUALITY_4K,value:o.VIDEO_QUALITY_4K});break;case n[o.VIDEO_QUALITY_1080P_HIGH]:i.push({text:t.VIDEO_QUALITY_1080P_HIGH,value:o.VIDEO_QUALITY_1080P_HIGH});break;case n[o.VIDEO_QUALITY_1080P]:i.push({text:t.VIDEO_QUALITY_1080P,value:o.VIDEO_QUALITY_1080P});break;case n[o.VIDEO_QUALITY_720P_HIGH]:i.push({text:t.VIDEO_QUALITY_720P_HIGH,value:o.VIDEO_QUALITY_720P_HIGH});break;case n[o.VIDEO_QUALITY_720P]:i.push({text:t.VIDEO_QUALITY_720P,value:o.VIDEO_QUALITY_720P});break;case n[o.VIDEO_QUALITY_SUPER]:i.push({text:t.VIDEO_QUALITY_SUPER,value:o.VIDEO_QUALITY_SUPER});break;case n[o.VIDEO_QUALITY_HIGH]:i.push({text:t.VIDEO_QUALITY_HIGH,value:o.VIDEO_QUALITY_HIGH});break;case n[o.VIDEO_QUALITY_MEDIUM]:i.push({text:t.VIDEO_QUALITY_MEDIUM,value:o.VIDEO_QUALITY_MEDIUM});break;case n[o.VIDEO_QUALITY_LOW]:i.push({text:t.VIDEO_QUALITY_LOW,value:o.VIDEO_QUALITY_LOW})}return i}return{template:n(621),propTypes:{user:{type:"object"},isAssist:{type:"boolean",value:!1},type:{type:"string",value:"default"},userIn:{type:"boolean",value:!1},videoOn:{type:["boolean","null"],value:!1},audioOn:{type:["boolean","null"],value:!1},isPopup:{type:"boolean",value:!1},isVideoDisabled:{type:"boolean",value:!1},isScreenSharing:{type:"boolean",value:!1},isFullScreen:{type:"boolean",value:!1},canSwitchMic:{type:"boolean",value:!1},needRatio:{type:"boolean",value:!0},needZoom:{type:"boolean",value:!0},canPopup:{type:"boolean",value:!0},canPopdown:{type:"boolean",value:!0},canFullScreen:{type:"boolean",value:!0},needMicStatusBar:{type:"boolean",value:!0},needQualitySelector:{type:"boolean",value:!0},onToggleClick:{type:["function","null"]},labelAfterName:{type:"function",value:function(){return!1}},useHighestQuality:{type:"boolean",value:!1}},data:function(){v(),m();var e=this,t=e.get("user"),n=f();return{language:n,CLASS_ACTIVE:"bjy-active",FOOTER_TYPE_DEFAULT:"default",FOOTER_TYPE_POPUP:"popup",FOOTER_TYPE_SIMPLE:"simple",micIndex:u.getMicIndex(),cameraIndex:e.get("isAssist")?u.getCameraIndex():u.getAssistCameraIndex(),isAudioMediaType:a.get("class.mediaType")===o.MEDIA_TYPE_AUDIO,volume:0,volumeLevels:new Array(10),uplinkVideoBandwidth:0,uplinkAudioBandwidth:0,downlinkVideoBandwidth:0,downlinkAudioBandwidth:0,videoRatio:o.CAMERA_RATIO_4_3,VIDEO_RATIO_4_3:o.CAMERA_RATIO_4_3,VIDEO_RATIO_16_9:o.CAMERA_RATIO_16_9,isInSharingMode:!1,lastQuality:e.get("isAssist")?u.getAssistCameraQuality():u.getCameraQuality(),quality:e.get("isAssist")?u.getAssistCameraQuality():u.getCameraQuality(),qualityList:function(){var i=[];if(r.isSelfByNumber(t.number))i=h(n,e.get("isAssist")?u.getAssistCameraIndex():u.getCameraIndex(),r.canUseSuper(),r.canUse720p(),r.canUse720pHigh(),r.canUse1080p(),r.canUse1080pHigh(),r.canUse4k());else{var a=t.definitions;a&&a.length||(a=[o.CAMERA_QUALITY_MAP[o.VIDEO_QUALITY_LOW]]),i=S(a,n)}return i}(),qualityListVisible:!1,lossRateLevel:0}},watchers:{audioOn:function(e,t){var n=this.inputVolumeTimer;n&&(e?n.start():n.stop())},cameraIndex:function(e,t){var n=!this.get("isAssist");this.set("qualityList",h(this.get("language"),n?u.getCameraIndex():u.getAssistCameraIndex(),r.canUseSuper(),r.canUse720p(),r.canUse720pHigh(),r.canUse1080p(),r.canUse1080pHigh(),r.canUse4k())),this.switchHighestQuality()},videoRatio:function(e,t){this.fire("videoRatioChange",{videoRatio:e})},quality:function(e,t){this.fire("qualityChange",{quality:e})},volume:function(e,t){this.fire("volumeChange",{volume:e})}},computed:{isSelf:function(){return r.isSelfByNumber(this.get("user.number"))},mediaOn:function(e){return this.get("videoOn")||this.get("audioOn")},bandwidthStatus:function(){var e,t,n=this;if(n.get("audioOn")){var i=d(a.get("class.liveAudioCodec"),o.AUDIO_CODEC_AAC)==o.AUDIO_CODEC_AAC?_.AUDIO_CODEC.AAC:_.AUDIO_CODEC.SPEEX;e=(t=n.get("isSelf")?n.get("uplinkAudioBandwidth"):n.get("downlinkAudioBandwidth"))<i.OFF?_.BANDWIDTH_STATUS_OFF:t>=i.OFF&&t<i.BAD?_.BANDWIDTH_STATUS_BAD:t>=i.BAD&&t<i.OK?_.BANDWIDTH_STATUS_OK:_.BANDWIDTH_STATUS_GOOD}else e=(t=n.get("isSelf")?n.get("uplinkVideoBandwidth"):n.get("downlinkVideoBandwidth"))>=10&&t<50?_.BANDWIDTH_STATUS_BAD:t>=50&&t<100?_.BANDWIDTH_STATUS_NORMAL:t>=100&&t<200?_.BANDWIDTH_STATUS_OK:t>=200&&t<300?_.BANDWIDTH_STATUS_GOOD:_.BANDWIDTH_STATUS_NICE;return e||_.BANDWIDTH_STATUS_OFF},volumeLevel:function(){var e=~~(this.get("volume")/E);return e>10?10:e},canMicSwitched:function(){var e=this.get("user",{});return!(!this.get("isSelf")&&r.isTeacher(e.type))&&(e.endType!==o.END_TYPE_MOBILE_BROWSER&&e.endType!==o.END_TYPE_XIAOCHENGXU&&s.isStarted()&&this.get("userIn"))},canToggleMic:function(){return!this.get("isSelf")&&this.get("canSwitchMic")&&this.get("canMicSwitched")}},filters:{formatBandwidth:function(e){return e>=0?e:0},formatQuality:function(e){var t;return $.each(this.get("qualityList"),function(n,i){if(i.value===e)return t=i,!1}),t?t.text:this.get("language.QUALITY")}},methods:{getPlayer:function(){var e=BJY.Player.instances[this.get("user.id")];return e&&!e.isDisposed()?e:null},openMic:function(){this.fire("openMic")},closeMic:function(){this.fire("closeMic")},toggleMic:function(){this.get("audioOn")?this.closeMic():this.openMic()},playerMicClick:function(){this.get("canToggleMic")&&this.toggleMic()},showQualityList:function(){this.set("qualityListVisible",!0)},hideQualityList:function(){this.set("qualityListVisible",!1)},selectQuality:function(e,t){var n=this,i=n.getPlayer();n.hideQualityList(),n.get("isSelf")?c.trigger(n.get("isAssist")?c.ASSIST_CAMERA_QUALITY_CHANGE_TRIGGER:c.CAMERA_QUALITY_CHANGE_TRIGGER,{value:e}):i&&i.user&&(i.user.videoOn||i.user.audioOn)&&(i.isPlayingExtraStream=t>0,i.replay(!0),n.set("quality",e))},exitFullScreen:function(){this.fire("exitFullScreen")},enterFullScreen:function(){this.fire("enterFullScreen")},zoomIn:function(){this.fire("zoomIn")},zoomOut:function(){this.fire("zoomOut")},popup:function(){this.fire("popUp")},popdown:function(){this.fire("popDown")},onToggleClick:function(){this.get("onToggleClick")&&this.get("onToggleClick")()},checkIsInQualityList:function(e,t){var n=!1;return $.each(t,function(t,i){if(i.value===e)return n=!0,!1}),n},cameraQualityRestore:function(){var e=this.get("qualityList");if(e.length){var t=this.get("lastQuality"),n=this.checkIsInQualityList(t,e)?t:e[e.length-1].value;c.trigger(this.get("isAssist")?c.ASSIST_CAMERA_QUALITY_CHANGE_TRIGGER:c.CAMERA_QUALITY_CHANGE_TRIGGER,{value:n})}},switchHighestQuality:function(){if(this.get("isSelf")){var e=this.get("qualityList");if(this.get("useHighestQuality")&&e&&e.length>0){var t=e[e.length-1];t.value!==this.get("quality")&&this.selectQuality(t.value,e.length-1)}}},computeLossRateLevel:function(e){var t=this;e>=g[4]?t.set("lossRateLevel",5):e>=g[3]?t.set("lossRateLevel",4):e>=g[2]?t.set("lossRateLevel",3):e>=g[1]?t.set("lossRateLevel",2):e>=g[0]?t.set("lossRateLevel",1):t.set("lossRateLevel",0)}},afterMount:function(){var e=this;e.container=$(e.$el),e.switchHighestQuality();var t=e.namespace=".defaultplayer-footer"+Math.random(),n=p(function(){var t="function"==typeof e.getPlayer?e.getPlayer():null;if(t){var n=!e.get("isAssist"),i=t.isMediaPlaying||t.isScreenSharing||t.isThirdPushRunning;e.set("qualityList",h(e.get("language"),n?u.getCameraIndex():u.getAssistCameraIndex(),r.canUseSuper(),r.canUse720p(),r.canUse720pHigh(),r.canUse1080p(),r.canUse1080pHigh(),r.canUse4k(),i)),i?(e.set("isInSharingMode",!0),e.set("lastQuality",e.get("quality"))):e.get("isInSharingMode")&&(e.set("isInSharingMode",!1),e.cameraQualityRestore()),e.set({cameraIndex:n?u.getCameraIndex():u.getAssistCameraIndex(),quality:n?u.getCameraQuality():u.getAssistCameraQuality(),micIndex:u.getMicIndex()})}},1e3,!0);e.get("isSelf")?(c.SCREEN_SHARE_START&&c.on(c.SCREEN_SHARE_START+t,function(t,n){e.canPopupBeforeScreenShare=e.get("canPopup"),e.canFullScreenBeforeScreenShare=e.get("canFullScreen"),e.set("canFullScreen",!1),e.set("canPopup",!1),e.get("isPopup")&&e.get("user.id")===a.get("presenterId")&&e.popdown()}).on(c.SCREEN_SHARE_STOP+t,function(t,n){e.set({isScreenSharing:!1,canPopup:e.canPopupBeforeScreenShare,canFullScreen:e.canFullScreenBeforeScreenShare})}),e.get("isAssist")?c.on(c.ASSIST_CAMERA_INDEX_CHANGE+t,function(){e.set("cameraIndex",u.getAssistCameraIndex())}).on(c.ASSIST_CAMERA_QUALITY_CHANGE+t,function(){e.set("quality",u.getAssistCameraQuality())}).on(c.ASSIST_MEDIA_SWITCH_TRIGGER+t,n).on(c.ASSIST_MEDIA_PUBLISH_TRIGGER+t,n).on(c.ASSIST_MEDIA_REPUBLISH_TRIGGER+t,n):c.on(c.CAMERA_INDEX_CHANGE+t,function(){e.set("cameraIndex",u.getCameraIndex())}).on(c.MIC_INDEX_CHANGE+t,function(){e.set("micIndex",u.getMicIndex())}).on(c.CAMERA_QUALITY_CHANGE+t,function(){e.set("quality",u.getCameraQuality())}).on(c.CAMERA_QUALITY_LIST_CHANGE+t,n).on(c.MEDIA_SWITCH_TRIGGER+t,n).on(c.MEDIA_PUBLISH_TRIGGER+t,n).on(c.MEDIA_REPUBLISH_TRIGGER+t,n),e.inputVolumeTimer=new l({task:function(){var t=e.getPlayer();if(t&&!t.isDisposed()){var n=t.getInputVolume();n&&n.then&&n.then(function(t){e.set("volume",t.volume)})}},interval:1e3}),e.get("audioOn")&&e.inputVolumeTimer.start()):(c.on(c.LINK_VOLUME_CHANGE+t,function(t,n){var i=n.player;i&&i===e.getPlayer()&&e.set("volume",i.getLinkVolume())}),e.get("isAssist")||(c.on(c.VIDEO_RESOLUTION_CHANGE+t,function(t,n){var i=e.getPlayer();if(i&&n.userId===e.get("user.id")){var r=n.definitions;if(r&&r.length>0){var a=S(r,e.get("language")),o=0;i.isPlayingExtraStream&&(r.length>1?o=1:(i.isPlayingExtraStream=!1,i.replay(!0))),e.set({qualityList:a,quality:a[o].value})}}}),e.set("quality",e.get("qualityList.0.value"))));var i=-1;c.on(c.MEDIA_PUBLISH+t,function(t,n){var i=n.user,r=e.getPlayer();if(r&&i.id===e.get("user.id")){var a=n.definitions;if(a&&a.length||(a=[o.CAMERA_QUALITY_MAP[o.VIDEO_QUALITY_LOW]]),!e.get("isSelf")&&!e.get("isAssist")){var s=S(a,e.get("language")),u=a.length>1&&r.isPlayingExtraStream?1:0;e.set({qualityList:s,quality:s[u].value})}}}).on(c.MEDIA_REPUBLISH+t,function(t,n){var i=n.user,r=e.getPlayer();if(r&&i.id===e.get("user.id")){var a=n.definitions;if(a&&a.length||(a=[o.CAMERA_QUALITY_MAP[o.VIDEO_QUALITY_LOW]]),!e.get("isSelf")&&!e.get("isAssist")){var s=S(a,e.get("language")),u=a.length>1&&r.isPlayingExtraStream?1:0;e.set({qualityList:s,quality:s[u].value})}}}).on(c.PLAYER_RUN_INFO_CHANGE+t,function(t,n){var a=n.player,o=e.getPlayer();if(a&&o){a===o&&e.set({uplinkVideoBandwidth:n.uplinkVideoBandwidth,uplinkAudioBandwidth:n.uplinkAudioBandwidth,downlinkVideoBandwidth:n.downlinkVideoBandwidth,downlinkAudioBandwidth:n.downlinkAudioBandwidth});var s=n.uplinkVideoAverageLossRate||n.uplinkAudioAverageLossRate,u=n.downlinkVideoAverageLossRate||n.downlinkAudioAverageLossRate;a.isPush()&&(r.isSelf(a.id)&&(i=s),a===e.getPlayer()&&e.computeLossRateLevel(s)),a.isPull()&&a===o&&(s>-1?u>=2*s?e.computeLossRateLevel(0):e.computeLossRateLevel(s):2*i>=u?e.computeLossRateLevel(0):e.computeLossRateLevel(u))}});var s=e.getPlayer();s&&e.set({downlinkAudioBandwidth:s.getDownlinkAudioBandwidth(),downlinkVideoBandwidth:s.getDownlinkVideoBandwidth(),uplinkAudioBandwidth:s.getUplinkAudioBandwidth(),uplinkVideoBandwidth:s.getUplinkVideoBandwidth()})},beforeDestroy:function(){this.namespace&&c.off(this.namespace),this.inputVolumeTimer&&this.inputVolumeTimer.dispose()}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.AUDIO_CODEC={AAC:{OFF:10,BAD:15,OK:20},SPEEX:{OFF:5,BAD:10,OK:15}},t.BANDWIDTH_STATUS_OFF="off",t.BANDWIDTH_STATUS_BAD="bad",t.BANDWIDTH_STATUS_NORMAL="normal",t.BANDWIDTH_STATUS_OK="ok",t.BANDWIDTH_STATUS_GOOD="good",t.BANDWIDTH_STATUS_NICE="nice"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){return function(){return BJY.getLanguage({english:n(618),chineseLive:n(619),chineseClassroom:n(620)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.VIDEO_QUALITY_LOW="Fluent",t.VIDEO_QUALITY_MEDIUM="SD",t.VIDEO_QUALITY_HIGH="HD",t.VIDEO_QUALITY_SUPER="SHD",t.VIDEO_QUALITY_720P="720P",t.VIDEO_QUALITY_720P_HIGH="720P-HR",t.VIDEO_QUALITY_1080P="1080P",t.VIDEO_QUALITY_1080P_HIGH="1080P-HR",t.VIDEO_QUALITY_4K="4K",t.QUALITY="Quality",t.DOWNLINK_VIDEO_BANDWIDTH="Receive Video:",t.DOWNLINK_AUDIO_BANDWIDTH="Receive Audio:",t.UPLINK_VIDEO_BANDWIDTH="Uplink Video:",t.UPLINK_AUDIO_BANDWIDTH="Uplink Audio:",t.FULLSCREEN_ENTER="Fullscreen",t.FULLSCREEN_EXIT="Exit Fullscreen",t.POPUP="Click to Pop up Window",t.POPDOWN="Fold",t.PLAYER_WHITEBOARD_TOGGLE="Click to Switch PPT and Video Windows",t.LOSS_RATE_LEVEL_ONE="Poor Network",t.LOSS_RATE_LEVEL_TWO="Bad Network",t.LOSS_RATE_LEVEL_THREE="Terrible Network"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.VIDEO_QUALITY_LOW="流畅",t.VIDEO_QUALITY_MEDIUM="标清",t.VIDEO_QUALITY_HIGH="高清",t.VIDEO_QUALITY_SUPER="超清",t.VIDEO_QUALITY_720P="720P",t.VIDEO_QUALITY_720P_HIGH="720P-HR",t.VIDEO_QUALITY_1080P="1080P",t.VIDEO_QUALITY_1080P_HIGH="1080P-HR",t.VIDEO_QUALITY_4K="4K",t.QUALITY="清晰度",t.DOWNLINK_VIDEO_BANDWIDTH="接收视频：",t.DOWNLINK_AUDIO_BANDWIDTH="接收音频：",t.UPLINK_VIDEO_BANDWIDTH="上送视频：",t.UPLINK_AUDIO_BANDWIDTH="上送音频：",t.FULLSCREEN_ENTER="全屏",t.FULLSCREEN_EXIT="退出全屏",t.POPUP="点击弹出窗口",t.POPDOWN="收起",t.PLAYER_WHITEBOARD_TOGGLE="点击切换PPT与视频窗口",t.LOSS_RATE_LEVEL_ONE="网络较差",t.LOSS_RATE_LEVEL_TWO="网络差",t.LOSS_RATE_LEVEL_THREE="网络极差"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.VIDEO_QUALITY_LOW="流畅",t.VIDEO_QUALITY_MEDIUM="标清",t.VIDEO_QUALITY_HIGH="高清",t.VIDEO_QUALITY_SUPER="超清",t.VIDEO_QUALITY_720P="720P",t.VIDEO_QUALITY_720P_HIGH="720P-HR",t.VIDEO_QUALITY_1080P="1080P",t.VIDEO_QUALITY_1080P_HIGH="1080P-HR",t.VIDEO_QUALITY_4K="4K",t.QUALITY="清晰度",t.DOWNLINK_VIDEO_BANDWIDTH="接收视频：",t.DOWNLINK_AUDIO_BANDWIDTH="接收音频：",t.UPLINK_VIDEO_BANDWIDTH="上送视频：",t.UPLINK_AUDIO_BANDWIDTH="上送音频：",t.FULLSCREEN_ENTER="全屏",t.FULLSCREEN_EXIT="退出全屏",t.POPUP="点击弹出窗口",t.POPDOWN="收起",t.PLAYER_WHITEBOARD_TOGGLE="点击切换PPT与视频窗口",t.LOSS_RATE_LEVEL_ONE="网络较差",t.LOSS_RATE_LEVEL_TWO="网络差",t.LOSS_RATE_LEVEL_THREE="网络极差"}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bjy-footer {{#if type !== FOOTER_TYPE_SIMPLE}}bjy-layer bjy-transition{{/if}}" data-loss-rate-level="{{lossRateLevel}}">{{#partial netStatus}}{{#if mediaOn}}<div class="bjy-bandwidth {{#if type === FOOTER_TYPE_SIMPLE}}bjy-circle{{/if}}"><div class="bjy-label bjy-icon bjy-bandwidth-signal" data-status="{{bandwidthStatus}}"></div><div class="bjy-bandwidth-layer bjy-tooltip bjy-top bjy-light">{{#if isSelf}}{{#if !isAudioMediaType}}<div class="bjy-row">{{language.UPLINK_VIDEO_BANDWIDTH}}<span class="bjy-bandwidth-value">{{formatBandwidth(uplinkVideoBandwidth)}}</span> kbps</div>{{/if}}{{#if !isAssist}}<div class="bjy-row">{{language.UPLINK_AUDIO_BANDWIDTH}}<span class="bjy-bandwidth-value">{{formatBandwidth(uplinkAudioBandwidth)}}</span> kbps</div>{{/if}}{{else}}{{#if !isAudioMediaType}}<div class="bjy-row">{{language.DOWNLINK_VIDEO_BANDWIDTH}}<span class="bjy-bandwidth-value">{{formatBandwidth(downlinkVideoBandwidth)}}</span> kbps</div>{{/if}}{{#if !isAssist}}<div class="bjy-row">{{language.DOWNLINK_AUDIO_BANDWIDTH}}<span class="bjy-bandwidth-value">{{formatBandwidth(downlinkAudioBandwidth)}}</span> kbps</div>{{/if}}{{/if}}</div></div>{{/if}}{{/partial}}{{#partial micStatus}}{{#if audioOn}}{{#if !isVideoDisabled}}{{#if type === FOOTER_TYPE_SIMPLE}}<div class="bjy-circle bjy-mic-status">{{#if volume > 20}}<div class="bjy-label bjy-icon bjy-mic-on-wave" data-volume="{{volume}}"on-click="playerMicClick()" lazy="1000" data-can-toggle="{{canToggleMic ? 1 : 0}}"></div>{{else}}<div class="bjy-label bjy-icon bjy-mic-on" on-click="playerMicClick()" lazy="1000" data-can-toggle="{{canToggleMic ? 1 : 0}}"></div>{{/if}}</div>{{else}}<div class="bjy-label bjy-icon{{volume > 20 ? \' bjy-mic-on-wave\' : \' bjy-mic-on\'}}" data-volume="{{volume}}" data-can-toggle="{{canToggleMic ? 1 : 0}}" on-click="playerMicClick()" lazy="1000">{{#if type !== FOOTER_TYPE_SIMPLE && needMicStatusBar}}<div class="bjy-mic-status-bar" data-level="{{volumeLevel}}">{{#each volumeLevels:index}}<span class="{{volumeLevels.length - index <= volumeLevel ? \' bjy-active\' : \'\'}}"></span>{{/each}}</div>{{/if}}</div>{{/if}}{{/if}}{{else}}{{#if !isAssist && type !== FOOTER_TYPE_SIMPLE}}{{#if micIndex >= 0 || !isSelf}}<div class="bjy-label bjy-icon bjy-mic-off" on-click="playerMicClick()" lazy="1000" data-can-toggle="{{canToggleMic ? 1 : 0}}"></div>{{else}}<div class="bjy-label bjy-icon bjy-mic-not-found"></div>{{/if}}{{else if !isAssist && type === FOOTER_TYPE_SIMPLE}}<div class="bjy-circle bjy-mic-status">{{#if micIndex >= 0 || !isSelf}}<div class="bjy-icon bjy-mic-off" on-click="playerMicClick()" lazy="1000" data-can-toggle="{{canToggleMic ? 1 : 0}}"></div>{{else}}<div class="bjy-icon bjy-mic-not-found"></div>{{/if}}</div>{{/if}}{{/if}}{{/partial}}{{#partial qualitySelector}}{{#if type === FOOTER_TYPE_SIMPLE}}<div class="bjy-left">{{#if qualityList.length > 0}}<div class="bjy-quality-select{{#if qualityListVisible}} {{CLASS_ACTIVE}}{{/if}}"><ul class="bjy-quality-options">{{#each qualityList:index}}{{#if quality !== value}}<li class="bjy-quality-option" on-click="selectQuality(value, index)">{{text}}</li>{{/if}}{{/each}}</ul><div class="bjy-quality-button bjy-button" {{#if qualityListVisible}}on-outside="hideQualityList()"{{else}}on-click="showQualityList()"{{/if}}>{{formatQuality(quality)}}</div></div>{{/if}}</div>{{else}}{{#if qualityList.length > 1}}<div class="bjy-quality-select{{#if qualityListVisible}} {{CLASS_ACTIVE}}{{/if}}"><ul class="bjy-quality-options">{{#each qualityList:index}}{{#if quality !== value}}<li class="bjy-quality-option" on-click="selectQuality(value, index)">{{text}}</li>{{/if}}{{/each}}</ul><div class="bjy-quality-button bjy-button" {{#if qualityListVisible}}on-outside="hideQualityList()"{{else}}on-click="showQualityList()"{{/if}}>{{formatQuality(quality)}}</div></div>{{/if}}{{/if}}{{/partial}}{{#if type === FOOTER_TYPE_SIMPLE}}{{#if isSelf && needQualitySelector}}{{> qualitySelector}}{{else}}<div class="bjy-left">{{#if user.name}}<span class="bjy-footer-name" title="{{user.name}}">{{user.name}}</span>{{/if}}{{#if labelAfterName(user)}}<span class="bjy-label">{{labelAfterName(user)}}</span>>{{/if}}</div>{{/if}}<div class="bjy-right">{{> micStatus}}{{> netStatus}}</div>{{else}}<div class="bjy-float">{{#if type === FOOTER_TYPE_POPUP}}<div class="bjy-video-footer bjy-transition bjy-layer">{{#if user.name}}<div class="bjy-footer-name bjy-label">{{user.name}}</div>{{/if}}<div class="bjy-float">{{#if isFullScreen}}<div class="bjy-button bjy-icon bjy-exit-fullscreen" on-click="exitFullScreen()" lazy="1000"></div>{{else}}{{#if needRatio}}<div class="bjy-button bjy-icon bjy-video-ratio-4-3{{#if videoRatio === VIDEO_RATIO_4_3}} bjy-active{{/if}}" on-click="set(\'videoRatio\', VIDEO_RATIO_4_3)" lazy="1000"></div><div class="bjy-button bjy-icon bjy-video-ratio-16-9{{#if videoRatio === VIDEO_RATIO_16_9}} bjy-active{{/if}}" on-click="set(\'videoRatio\', VIDEO_RATIO_16_9)" lazy="1000"></div>{{/if}}{{#if needZoom}}<div class="bjy-button bjy-icon bjy-zoom-in" on-click="zoomIn()" lazy="1000"></div><div class="bjy-button bjy-icon bjy-zoom-out" on-click="zoomOut()" lazy="1000"></div>{{/if}}{{#if canPopdown}}<div class="bjy-button bjy-icon bjy-popdown" on-click="popdown()" lazy="1000"></div>{{/if}}{{#if canFullScreen}}<div class="bjy-button bjy-icon bjy-enter-fullscreen" on-click="enterFullScreen()" lazy="1000"></div>{{/if}}{{> netStatus}}{{> micStatus}}{{/if}}</div>{{#if needQualitySelector}}{{> qualitySelector}}{{/if}}</div>{{else if type === FOOTER_TYPE_DEFAULT}}{{#if isFullScreen}}<div class="bjy-button bjy-icon bjy-exit-fullscreen" on-click="exitFullScreen()" lazy="1000"></div>{{else}}{{#if onToggleClick}}<div class="bjy-button bjy-icon bjy-toggle" on-click="onToggleClick()" lazy="1000" data-title="{{language.PLAYER_WHITEBOARD_TOGGLE}}" data-skin="bjy-light" data-placement="left"></div>{{/if}}{{#if videoOn && !isVideoDisabled}}\x3c!-- 自己正在屏幕共享，不能弹出，否则会出现画中画 --\x3e{{#if canPopup && (!isSelf || !isScreenSharing)}}<div class="bjy-button bjy-icon bjy-popup" on-click="popup(null)" lazy="1000"></div>{{/if}}{{#if canFullScreen && (!isSelf || !isScreenSharing)}}<div class="bjy-button bjy-icon bjy-enter-fullscreen" on-click="enterFullScreen()" lazy="1000"></div>{{/if}}{{/if}}{{/if}}{{> netStatus}}\x3c!--辅助摄像头没有mic状态--\x3e{{#if !isAssist}}{{> micStatus}}{{/if}}{{else if type === FOOTER_TYPE_SIMPLE}}{{ /if }}</div>{{#if !isSelf&& user.name&& (qualityList.length <= 1 || !needQualitySelector)}}<div class="bjy-footer-name bjy-label" title="{{user.name}}">{{user.name}}</div>{{/if}}{{#if isSelf && !needQualitySelector}}<div class="bjy-footer-name bjy-label" title="{{user.name}}">{{user.name}}</div>{{/if}}{{#if needQualitySelector && type === FOOTER_TYPE_DEFAULT}}{{> qualitySelector}}{{/if}}{{/if}}{{#if !isAssist && mediaOn && lossRateLevel}}<div class="bjy-loss-rate-info">{{#if lossRateLevel > 2}}{{language.LOSS_RATE_LEVEL_THREE}}{{else if lossRateLevel > 1}}{{language.LOSS_RATE_LEVEL_TWO}}{{else if lossRateLevel}}{{language.LOSS_RATE_LEVEL_ONE}}{{/if}}</div>{{/if}}</div>'},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.auth,a=BJY.store,o=BJY.config,s=BJY.data.adminAuth,u=BJY.eventEmitter;return{template:n(623),propTypes:{user:{type:"object"},needInteraction:{type:"function",value:function(){return!1}},hasRedPacket:{type:"boolean",value:!1}},data:function(){var e=this.get("user");return{isClassStarted:a.get("class.started"),canManageInteraction:r.canManageInteraction(),interactionCount:a.get("interactionRecord."+o.INTERACTION_AWARD+"."+e.number+".count",0),redPacket:0,canUsePaint:r.isAssistant(e.type)?s.getUserPainterAuth(e):r.canStudentPaintByNumber(e.number)}},computed:{isStudent:function(){return r.isStudent(this.get("user.type"))}},methods:{interactionClick:function(){u.trigger(u.INTERACTION_SEND,{to:this.get("user.number"),toUser:this.get("user"),type:o.INTERACTION_AWARD})}},afterMount:function(){var e=this;e.container=$(e.$el);var t=e.namespace=".defaultplayer-igroup"+Math.random();e.classStartedHandler=function(t){e.set("isClassStarted",t)},e.studentAuthChangeHandler=function(t){var n=e.get("user"),i=!!n&&Yox.array.has(a.get("class.studentDocumentControlAuth",[]),n.number),r=!!n&&Yox.array.has(a.get("class.studentPaintAuth",[]),n.number),o=!!n&&Yox.array.has(a.get("class.studentScreenShareAuth",[]),n.number);e.set("canDocumentControl",i),e.set("canUsePaint",r),e.set("canScreenShare",o)},a.watch("class.started",e.classStartedHandler),a.watch("class.studentDocumentControlAuth",e.studentAuthChangeHandler),a.watch("class.studentPaintAuth",e.studentAuthChangeHandler),a.watch("class.studentScreenShareAuth",e.studentAuthChangeHandler),u.on(u.INTERACTION_RECEIVE+t,function(t,n){(n.to===e.get("user.number")||n.fromCache||n.resetAll)&&e.set("interactionCount",a.get("interactionRecord."+n.type+"."+e.get("user.number")+".count",0))}),e.get("hasRedPacket")&&(u.on(u.RED_PACKET_END+t,function(t,n){e.increase("redPacket",+n.amountGot)}).on(u.RED_PACKET_QUERY_AMOUNT_GOT_RES+t,function(t,n){e.set("redPacket",+n.amountGot)}),r.isSelf(e.get("user.id"))&&u.trigger(u.RED_PACKET_QUERY_AMOUNT_GOT_REQ))},beforeDestroy:function(){var e=this;e.classStartedHandler&&a.unwatch("class.started",e.classStartedHandler),e.studentAuthChangeHandler&&(a.unwatch("class.studentDocumentControlAuth",e.studentAuthChangeHandler),a.unwatch("class.studentPaintAuth",e.studentAuthChangeHandler),a.unwatch("class.studentScreenShareAuth",e.studentAuthChangeHandler)),e.namespace&&u.off(e.namespace)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bjy-player-icon-group">{{#if isClassStarted && needInteraction(user) && (canManageInteraction || interactionCount)}}<div class="bjy-interaction-button">{{#if canManageInteraction}}<i class="bjy-icon bjy-click-able" on-click="interactionClick()" lazy="3000"></i>{{else}}<i class="bjy-icon"></i>{{/if}}{{#if interactionCount}}<span>{{interactionCount}}</span>{{/if}}</div>{{/if}}{{#if hasRedPacket && isStudent }}<div class="bjy-red-packet"><i class="bjy-icon"></i>{{#if redPacket}}<span class="bjy-red-packet-result">{{redPacket}}</span>{{/if}}</div>{{/if}}{{#if canDocumentControl && isStudent }}<div class="bjy-icon-wrap"><i class="bjy-icon bjy-auth-ppt"></i></div>{{/if}}{{#if canUsePaint && isStudent }}<div class="bjy-icon-wrap"><i class="bjy-icon bjy-auth-paint"></i></div>{{/if}}{{#if canScreenShare && isStudent }}<div class="bjy-icon-wrap"><i class="bjy-icon bjy-auth-screen-share"></i></div>{{/if}}</div>'},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.auth,a=BJY.data.media,o=BJY.eventEmitter,s=n(625);return{template:n(629),propTypes:{user:{type:"object"},isAssist:{type:"boolean",value:!1}},data:function(){return{language:s(),quality:this.get("isAssist")?a.getAssistCameraQuality():a.getCameraQuality(),videoRatio:this.get("isAssist")?a.getAssistCameraRatio():a.getCameraRatio(),uplinkVideoBandwidth:0,uplinkAudioBandwidth:0,downlinkVideoBandwidth:0,downlinkAudioBandwidth:0}},computed:{isSelf:function(){return r.isSelfByNumber(this.get("user.number"))},cameraConfig:function(){return a.getCameraConfig(this.get("quality"),this.get("videoRatio"),this.get("isAssist"))},resolutionText:function(){var e=this.get("cameraConfig");return e&&e.cameraWidth&&e.cameraHeight?e.cameraWidth+"*"+e.cameraHeight:""},frameRate:function(){var e=this.get("cameraConfig");return e&&e.cameraFps?e.cameraFps:""},audioBitRate:function(){return this.formatBandwidth(this.get(this.get("isSelf")?"uplinkAudioBandwidth":"downlinkAudioBandwidth"))+"kbps"},videoBitRate:function(){return this.formatBandwidth(this.get(this.get("isSelf")?"uplinkVideoBandwidth":"downlinkVideoBandwidth"))+"kbps"}},methods:{getPlayer:function(){var e=BJY.Player.instances[this.get("user.id")];return e&&!e.isDisposed()?e:null},formatBandwidth:function(e){return e>=0?e:0}},afterMount:function(){var e=this;e.container=$(e.$el);var t=e.namespace=".defaultplayer-debug"+Math.random();e.get("isAssist")?o.on(o.ASSIST_CAMERA_RATIO_CHANGE+t,function(t,n){e.set("videoRatio",n.value)}):o.on(o.CAMERA_RATIO_CHANGE+t,function(t,n){e.set("videoRatio",n.value)}).on(o.PLAYER_RUN_INFO_CHANGE+t,function(t,n){var i=n.player;e.getPlayer()===i&&e.set({uplinkVideoBandwidth:n.uplinkVideoBandwidth,uplinkAudioBandwidth:n.uplinkAudioBandwidth,downlinkVideoBandwidth:n.downlinkVideoBandwidth,downlinkAudioBandwidth:n.downlinkAudioBandwidth})})},beforeDestroy:function(){this.namespace&&o.off(this.namespace)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){return function(){return BJY.getLanguage({english:n(626),chineseLive:n(627),chineseClassroom:n(628)})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.QUALITY="Quality",t.FRAME_RATE="Frame rate",t.AUDIO_BIT_RATE="Audio bit rate",t.VIDEO_BIT_RATE="Video bit rate",t.IS_SCREEN_SHARING="Screen sharing"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.QUALITY="清晰度",t.FRAME_RATE="帧率",t.AUDIO_BIT_RATE="音频码率",t.VIDEO_BIT_RATE="视频码率",t.IS_SCREEN_SHARING="已开启屏幕共享"}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){t.QUALITY="清晰度",t.FRAME_RATE="帧率",t.AUDIO_BIT_RATE="音频码率",t.VIDEO_BIT_RATE="视频码率"}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bjy-media-info"><div class="bjy-info-item">{{language.QUALITY}}：{{resolutionText}}</div><div class="bjy-info-item">{{language.FRAME_RATE}}：{{frameRate}}</div><div class="bjy-info-item">{{language.AUDIO_BIT_RATE}}：{{audioBitRate}}</div><div class="bjy-info-item">{{language.VIDEO_BIT_RATE}}：{{videoBitRate}}</div></div>'},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(25),a=BJY.store,o=BJY.logger,s=BJY.eventEmitter,u=(BJY.config,BJY.data.user),c=BJY.is,l=BJY.auth;t.watch=function(e,t,n,i){if(e){var d=u.findByNumber(e),_=!1,f=!1,p=!1;Yox.string.startsWith(t,".")||(t="."+t);var h=function(t){n[t]&&n[t](e)};if(n.onEntered&&(e===a.get("user.number")?(s.on(s.ROOM_SERVER_LOGIN_SUCCESS+t,function(){h("onEntered")}),h("onEntered")):(Yox.nextTick(function(){s.on(s.USER_ADD+t,function(t,n){Yox.array.each(n.userList,function(t){if(t.number==e)return h("onEntered"),!1})})}),d&&h("onEntered"))),n.onLeaved&&(s.on(s.CLASSROOM_CONNECT_TRIGGER+t,function(){_=f=!1,e===a.get("user.number")&&h("onLeaved")}),e!==a.get("user.number")&&(s.on(s.USER_OUT+t,function(t,n){n.user.number==e&&(h("onLeaved"),_=f=!1)}),d||h("onLeaved"))),n.onCameraOpened||n.onMicOpened||n.onCameraMicOpened||n.onCameraClosed||n.onMicClosed||n.onCameraMicClosed||n.onCameraOpenedMicClosed||n.onCameraClosedMicOpened||n.onMediaOpened||n.onMediaClosed||n.onScreenSharing||n.onScreenSharingStopped){var g,E;if(d)if(i){var v=d.id2,m=(d.mediaExtMap||{})[v];m&&(g=r(m.videoOn,!1),E=r(m.audioOn,!1)),A(g,E,c.isUserAssistScreenSharing(d))}else A(g=r(d.videoOn,!1),E=r(d.audioOn,!1),c.isUserScreenSharing(d));l.isWebRTC()?function(){i||s.on(s.MEDIA_PUBLISH+t,function(t,n){n.user.number==e&&A(n.videoOn,n.audioOn,n.isScreenSharing)});s.on(s.ASSIST_MEDIA_PUBLISH+t,function(t,n){var r=n.mediaId;if(!c.mediaFile(r)){var a=n.user;c.mediaPopupScreenShare(a)&&(c.mediaMainScreenShare(r)||c.mediaAssistScreenShare(r))||a.number==e&&(i?(c.mediaAssistScreenShare(r)&&A(_,!1,n.videoOn),c.mediaAssistCamera(r)&&A(n.videoOn,n.audioOn,p)):c.mediaMainScreenShare(r)&&A(_,f,n.videoOn))}})}():function(){var n=i?s.ASSIST_MEDIA_PUBLISH:s.MEDIA_PUBLISH;s.on(n+t,function(t,n){n.user.number==e&&A(n.videoOn,n.audioOn,n.isScreenSharing)})}()}if(n.onRepublished){var S=i?s.ASSIST_MEDIA_REPUBLISH:s.MEDIA_REPUBLISH;s.on(S+t,function(t,n){n.user.number==e&&h("onRepublished")})}}else o.warn("userstatus","userNumber is not found.");function A(e,t,n){e=r(e,!1),t=r(t,!1),n=r(n,!1),p!==n&&h(n?"onScreenSharing":"onScreenSharingStopped"),_!==e&&f!==t?h(e&&t?"onCameraMicOpened":e&&!t?"onCameraOpenedMicClosed":!e&&t?"onCameraClosedMicOpened":"onCameraMicClosed"):_!==e?h(e?"onCameraOpened":"onCameraClosed"):f!==t&&h(t?"onMicOpened":"onMicClosed"),_||f?e||t||h("onMediaClosed"):(e||t)&&h("onMediaOpened"),_=e,f=t,p=n}},t.unwatch=function(e){Yox.string.startsWith(e,".")||(e="."+e),s.off(e)},BJY.userStatus=t}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,r=n(0)(n(273));void 0===(i=function(e,t,i){var a=BJY.blockLog,o=n(31),s=n(3),u=n(25),c=n(215),l=n(274),d=n(580),_=n(339),f=n(158),p=n(354),h=n(118),g=BJY.cef,E=!1;if(g){var v=BJY.auth,m=BJY.store,S=BJY.config,A=BJY.eventEmitter,y=BJY.data.media,T=BJY.server.live,R=BJY.server.liveUdp,I=BJY.Player,C=new _({extension:g}),O=new o({task:function(){g.send("getStreamsInfo"),g.send("getLinksVolume")},interval:1e3}),b={},L="LocalCameraVideoStream",D="LocalDesktopVideoStream",N="thirdPartyStream",P=0,k=1;g.name="cef",A.one(A.CLIENT_INIT_SUCCESS,function(){m.get("isShuangshi")&&h()&&v.canUseVirtualCamera()?A.one(A.VERIFY_CAPTURE_CARD_SUPPORT_CALLBACK,V):V()}),window.onPluginReady=function(e){var t=I.instances[e.pluginId];t&&t.onReady()},g.initPlayer=function(e){e.isHidden||d.initPlayer(e)},g.disposePlayer=function(e){e.isNativePopup&&(e.isNativePopup=!1),e.isHidden||d.disposePlayer(e)},g.openCamera=function(e,t){g.closeCamera(e),z(e,L),g.send("setPreviewCamera",t||G(e));var n=e.id;e.isAssist||W(n),g.send("startPlayLocalVideo",{identifier:n}),e.isCameraOpened=!0},g.closeCamera=function(e){e.isCameraOpened&&(delete e.isCameraOpened,q(e,L),g.send("stopPlayLocalVideoWithID",{identifier:e.id}))},g.openMic=function(e){e.isAssist||(g.closeMic(e),Y(),g.send("micPlayback",{enable:!0}),e.isMicOpened=!0)},g.closeMic=function(e){e.isMicOpened&&(delete e.isMicOpened,g.send("micPlayback",{enable:!1}))},g.getInputVolume=function(){return g.send("getSpeechLevel").then(function(e){var t=s(e.speechLevel,0);return{volume:t=t>=0&&t<=100?t:0}})},g.getMicScalingInfo=function(){return g.send("getBoostParam").then(function(e){return{step:e.step,value:e.curLevel,max:e.maxLevel}})},g.popupWindow=function(e,t){if(BJY.os.windows){var n=e.playStreamName;return e.isPush()&&(n=e.id),g.send("popupVideoWindow",{id:n,popup:t.popup,extended:!!m.get("setting.popupToAuxEnable",0)}),e.isNativePopup=t.popup,!0}},g.setStreamBuffer=function(e,t){var n=e.playStreamName;n&&g.send("setStreamBuffer",{streamBuffer:t,streamName:n})},g.initStreamBuffer=function(e,t){g.send("initStreamBuffer",t)},g._publishAV=function(e,t){var n={linkType:e.linkType,streamName:t.streamName,identifier:t.pushMixedAudio?e.user.id3:e.id,publishIp:t.publishIp,publishPort:t.publishPort,pushHLS:t.pushHLS,audioCodec:s(m.get("class.liveAudioCodec"),S.AUDIO_CODEC_AAC)};if(e.audioCodec=n.audioCodec,g.send(v.canUseCombinedAttachAV()?"publishAV":"publishAVWithID",n),v.canPublishExtraStream()&&!t.pushMixedAudio){var i=e.user,r=e.getServer();n.streamName=r.getUplinkStreamName(i.id4,e.getUserPublishIndex()),n.identifier=i.id4,e.extraStreamName=n.streamName,g.send("publishAV",n)}},g._publishAVClose=function(e,t){if(v.canUseCombinedAttachAV()){var n=e.user;t.pushMixedAudio?g.send("publishAVClose",{identifier:n.id3}):(g.send("publishAVClose",{identifier:e.id}),v.canPublishExtraStream()&&g.send("publishAVClose",{identifier:n.id4}))}else g.send("publishAVCloseWithID",{streamName:t.streamName,identifier:t.pushMixedAudio?e.user.id3:e.id})},g._publishAVRelease=function(e,t){v.canUseCombinedAttachAV()||g.send("publishAVReleaseWithID",{streamName:t.streamName,identifier:t.pushMixedAudio?e.user.id3:e.id})},g._playAV=function(e,t){var n,i=e.user,r=e.getUserPublishServer();n=e.isAssist?0:i.supportMuteStream?1:i.audioOn?1:0,g.send("playAV",{linkType:e.linkType,streamName:t.streamName,identifier:t.identifier,playIp:t.playIp,playPort:t.playPort,mount:t.mount,publishIp:r.ip,publishPort:r.port,hasAudioStream:n,audioOnly:t.audioOnly?1:0,streamBuffer:e.playBuffer})},g._playAVClose=function(e,t){g.send("playAVClose",{streamName:t.streamName})},g._playAVRelease=function(e,t){g.send("playAVRelease",{streamName:t.streamName})},g.publishAV=function(e,t){var n;return n=e.linkType,b.pushLinkType!==n&&(b.pushLinkType=n,g.send("setPushLinkType",{pushLinkType:n})),C.publishAV(e,t)},g.publishAVClose=function(e,t){C.publishAVClose(e,t)},g.publishAVRelease=function(e,t){C.publishAVRelease(e,t)},g.attachVideo=function(e,t,n){if(v.canUseCombinedAttachAV())ee(e,0,n);else if(t)g.sendBlackFrame(e,!1);else{n?g.sendBlackFrame(e,!0):v.canPublishBlackStream()&&g.sendBlackFrame(e,!1);var i=G(e);if(!i)return;g.send("setVideoDeviceWithID",i);var r=e.id;e.isMainPush()&&K(r);var a,o={identifier:r};e.isThirdPushing?(o.source="stream",a=N):e.isScreenSharing?(o.source="desktop",o.mode=e.shareMode,o.mode==S.SCREEN_SHARE_MODE_PROGRAM&&(o.windowName=e.shareProgram),o.fps=m.get("partner.liveScreenShareFps",10),o.keyframeInterval=m.get("partner.liveScreenFrameInterval",5),o.fixBlackWindow=m.get("setting.fixBlackWindowEnable",0),a=D,j(e)):(o.source="camera",a=L),e.attachVideoStreamName=a,e.attachVideoOptions=o,z(e,a),m.get("cefApiVersion")>="6.4.0"?setTimeout(function(){e.hasVideoStream&&g.send("attachVideo",o)},200):g.send("attachVideo",o)}},g.detachVideo=function(e,t){if(v.canUseCombinedAttachAV())t?ee(e,0,!0):(g.send("detachVideo",{identifier:e.id}),v.canPublishExtraStream()&&g.send("detachVideo",{identifier:e.user.id4}),q(e,e.attachVideoStreamName),delete e.attachVideoOptions,delete e.attachVideoStreamName);else if(t)g.sendBlackFrame(e,!0);else{v.canPublishBlackStream()&&g.sendBlackFrame(e,!1);var n=e.attachVideoOptions;n&&(g.send("detachVideoWithID",n),q(e,e.attachVideoStreamName),delete e.attachVideoOptions,delete e.attachVideoStreamName)}},g.sendBlackFrame=function(e,t){g.send("SendBlackFrame",{identifier:e.id,pause:t})},g.attachAudio=function(e,t,n){if(!e.isAssist)if(v.canUseCombinedAttachAV())!function(e,t,n){var i,r=e.user,a=!0;if(Y(),n?i="MuteData":e.isThirdPushing?i="RtmpAgent":e.isMediaPlaying?(i="MediaAv",a=e.mixMicWhileMediaPlaying):i="Default",g.send("attachAudio",{identifier:e.id,ChannelType:"SingleChannel",ContentType:i,replaceMicData:!a}),v.canPublishExtraStream()&&g.send("attachAudio",{identifier:r.id4,ChannelType:"SingleChannel",ContentType:i,replaceMicData:!a}),v.canPublishMixedAudioStream()){if(!t){var o=r.publishServer,s=e.getServer().getUplinkAudioMixedStreamName(r.id3,r.publishIndex);e.mixedAudioStreamName=s,g._publishAV(e,{pushMixedAudio:!0,streamName:s,publishIp:o.ip,publishPort:o.port,pushHLS:v.canPushHLS()?1:2})}g.send("attachAudio",{identifier:r.id3,ChannelType:"MixChannel",ContentType:i,replaceMicData:!a})}}(e,t,n);else if(Y(),t)g.send("unMuteMic",{identifier:e.id});else if(g.send("attachAudioWithID",{identifier:e.id,muted:!t&&n?1:0}),v.canPublishMixedAudioStream()){var i=e.user,r=i.publishServer,a=e.getServer().getUplinkAudioMixedStreamName(i.id3,i.publishIndex);e.mixedAudioStreamName=a,g._publishAV(e,{pushMixedAudio:!0,streamName:a,publishIp:r.ip,publishPort:r.port,pushHLS:v.canPushHLS()?1:2}),g.send("attachMixedAudioWithID",{identifier:i.id3,muted:!t&&n?1:0})}},g.detachAudio=function(e,t){e.isAssist||(t&&v.canUseCombinedAttachAV()?function(e){var t=e.user;g.send("attachAudio",{identifier:e.id,ChannelType:"SingleChannel",ContentType:"MuteData",replaceMicData:!1}),v.canPublishExtraStream()&&g.send("attachAudio",{identifier:t.id4,ChannelType:"SingleChannel",ContentType:"MuteData",replaceMicData:!1}),v.canPublishMixedAudioStream()&&g.send("attachAudio",{identifier:t.id3,ChannelType:"MixChannel",ContentType:"MuteData",replaceMicData:!1})}(e):t?g.send("muteMic"):(g.send("detachAudio",{identifier:e.id}),v.canPublishExtraStream()&&g.send("detachAudio",{identifier:e.user.id4}),e.mixedAudioStreamName&&g.detachMixedAudio(e)))},g.detachMixedAudio=function(e){g.send("detachMixedAudioWithID",{identifier:e.user.id3}),g._publishAVClose(e,{streamName:e.mixedAudioStreamName,pushMixedAudio:!0}),delete e.mixedAudioStreamName},g.playAV=function(e,t){t.audioOnly?(!function(e,t){e.isHidden||d._playAV(e,{streamName:t,userNumber:e.isPlayingExtraStream?e.user.id4:e.id,isSelf:!!v.isSelf(e.user.id),playIp:"127.0.0.1",audioOnly:!0})}(e,e.playStreamName),C.playAV(e,{audioOnly:!0,actionType:t.actionType})):(C.playAV(e,{audioOnly:!1,actionType:t.actionType}),e.isNativePopup&&e.popupWindow(!0))},g.playAVClose=function(e){e.isNativePopup&&(e.popupWindow(!1),A.trigger(A.CLIENT_PLAYER_POPDOWN,{player:e})),C.playAVClose(e)},g.playAVRelease=function(e){C.playAVRelease(e)},g.showVideo=function(e){z(e,e.playStreamName)},g.hideVideo=function(e){q(e,e.playStreamName)},g.switchAudioStream=function(e,t){g.send("switchAudioStream",{streamName:e.playStreamName,hasAudioStream:t?1:0})},g.remount=function(e){e.videoOn&&!e.disableVideo&&g.showVideo(e)},g.getStreamResolution=function(e){var t=$.Deferred(),n={width:null,height:null};return m.get("cefApiVersion")>="7.4.0"?g.send("getVideoResolution",{id:e.isPush()?e.id:e.playStreamName}).then(function(e){e.width&&(n.width=e.width),e.height&&(n.height=e.height),t.resolve(n)},function(e){t.resolve(n)}):setTimeout(function(){t.resolve(n)},0),t},g.extensions={asyncReady:!0,hasPublishAuth:!0,hasPlayAuth:!0,hasUplinkStatisticsAuth:!0,createSWF:function(){var e=this.id;return m.get("cefApiVersion")>"6.4.0"?(this.isPPAPI=!0,v.canNotifyPluginLoaded()||setTimeout(function(){window.onPluginReady({pluginId:e})},100),'<embed id="user'+e+'" class="bjy-player-object" path="Native/Release" src="Native/Release/MediaPlayer.nmf" type="application/x-ppapi-release" style="width:100%;height:100%;">'):'<object id="user'+e+'" class="bjy-player-object" type="application/x-gsxplayerplugin"><param name="onload" value="onPluginReady" /></object>'}};var w,U=!1,M=0,x=0;Yox.object.extend(g.callbacks,{closePopup:function(e){var t=e.streamName;if(t!=m.get("user.id")&&t!=m.get("user.id2")&&null==(t=Z(t,e.linkType).userId))return;var n=I.instances[t];n&&A.trigger(A.CLIENT_PLAYER_POPDOWN,{player:n})},switchUpAV:function(e){var t=Z(e.streamName,e.linkType).player;if(t){if(v.isTeacher()&&v.canSetLinkType()){var n,i=$.now();if(i-w<6e4)return;if(!1!==BJY.autoSwitchLinkType&&x<=4)return n=4===x&&t.linkType===S.LINK_TYPE_TCP?S.LINK_TYPE_UDP:t.linkType===S.LINK_TYPE_TCP?S.LINK_TYPE_UDP:S.LINK_TYPE_TCP,A.trigger(A.UPLINK_LINK_TYPE_CHANGE_TRIGGER,{value:n,actionType:S.LINK_TYPE_CHANGE_BY_BAD_NETWORK}),x++,void(w=i)}A.trigger(A.UPLINK_SERVER_CHANGE_TRIGGER,{player:t})}},switchDownAV:function(e){var t=Z(e.streamName,e.linkType).player;t&&A.trigger(A.DOWNLINK_SERVER_CHANGE_TRIGGER,{player:t,actionType:S.LINK_TYPE_CHANGE_BY_BAD_NETWORK})},connectLSSucceeded:function(e){var t=Z(e.streamName,e.linkType,[S.STREAM_ID_EXTRA_DEFINITION],P).player;t&&(t.isPush()?t.publishAVConnectSuccess():t.playAVConnectSuccess())},connectLSFailed:function(e){var t=Z(e.streamName,e.linkType,[S.STREAM_ID_MIX_AUDIO],k).player;0==e.reason&&(t.serverShutDown=!0,a.setLogTypeMediaServerFail(t)),t&&(t.isPush()?t.publishAVConnectFail():t.playAVConnectFail())},downlinkBlockReport:function(e){var t=Z(e.streamName,e.linkType).player;t&&t.user&&(window.DEBUG&&t&&t.user&&console.log("downlink block on user: ",t.user.id),t.audioOn&&A.trigger(A.DOWNLINK_BLOCK,{player:t,blockCount:e.blockCounter}))},cancelDownlinkBlockReport:function(e){var t=Z(e.streamName,e.linkType).player;t&&t.user&&t.audioOn&&A.trigger(A.DOWNLINK_BLOCK_RECOVERY,{player:t})},getStreamsInfo:function(e){var t=e.streamsInfo;t&&$.each(t,function(e,t){var n=Z(t.name,t.stream.linkType,[S.STREAM_ID_EXTRA_DEFINITION],P).player;n&&(n.videoOn||n.audioOn||(t=null),n.isPush()?n.setUplinkStream(t):n.setDownlinkStream(t))})},deviceChanged:function(e){"cef"===f().name&&("camera"===e.type||"video"===e.type?J():(Q(),U&&clearTimeout(U),U=setTimeout(function(){U=null},3e4)))},audioCaptureError:function(){U||M>=3||(A.trigger(A.MIC_CAPTURE_FAIL),M++)},audioPlaybackError:function(){A.trigger(A.AUDIO_PLAYBACK_ERROR)},openCameraFailed:function(){A.trigger(A.CAMERA_OPEN_FAIL),A.trigger(A.MEDIA_SWITCH_TRIGGER,{videoOn:!1})},openMicFailed:function(){A.trigger(A.MIC_OPEN_FAIL),A.trigger(A.MEDIA_SWITCH_TRIGGER,{audioOn:!1})},openSpeakFailed:function(){A.trigger(A.SPEAKER_OPEN_FAIL)},reopenCamera:function(e){var t=Z(e.streamName,e.linkType).player;t&&t.isPush()&&t.reopenCamera()},reopenMic:function(e){var t=Z(e.streamName,e.linkType).player;t&&t.isPush()&&t.reopenMic()},videoResolutionChanged:function(e){var t=y.getCameraQuality(),n=I.instances[m.get("user.id")],i=[S.CAMERA_QUALITY_MAP[t]];if(v.canPublishExtraStream()&&n&&!n.isScreenSharing){var r=y.getExtraStreamQuality(t);r>=0&&i.push(S.CAMERA_QUALITY_MAP[r])}e.definitions=i,A.trigger(A.VIDEO_RESOLUTION_CHANGE_TRIGGER,e)},linksVolumeReport:function(e){var t=e.linksVolume;t&&$.each(t,function(e,t){var n=Z(t.streamName,t.linkType).player;n&&n.setLinkVolume(t.volume)})},playAVComplete:function(e){var t=Z(e.streamName,e.linkType).player;t&&(t.getDownlinkServer().originIp=e.playIp)},publishAVComplete:function(e){var t=Z(e.streamName,e.linkType).player;t&&(t.getUplinkServer().originIp=e.playIp)},beautifyDenoiseChanged:function(e){},upUDPLinkAudioLostRate:function(e){A.trigger(A.UDP_UPLINK_AUDIO_LOST_RATE,{value:e.lostRate})},upUDPLinkVideoLostRate:function(e){A.trigger(A.UDP_UPLINK_VIDEO_LOST_RATE,{value:e.lostRate})},udpUpAverageLostRate:function(e){A.trigger(A.UDP_UPLINK_AVERAGE_LOST_RATE,{value:e.averageLostRate})},tcpUpTooManyPacketsDelay:function(){A.trigger(A.TCP_UPLINK_PACKETS_DELAY)},tcpUpBetter:function(){A.trigger(A.TCP_UPLINK_GET_BETTER)},streamBlockReport:function(e){var t=Z(e.streamName,e.linkType).player;t&&a.setLogTypeBlock(t)}})}function V(){if("cef"===f().name){J(),Q();var e=function(e,t){Yox.object.each(I.instances,function(n){n.isAssist||!n.isPush()&&!n.isSetting||(H(n,e),Yox.is.func(t)&&t(n))})},t=function(e,t){Yox.object.each(I.instances,function(n){n.isAssist&&(n.isPush()||n.isSetting)&&(H(n,e),Yox.is.func(t)&&t(n))})};m.watch({"media.micScaling":function(){var e=y.getMicScaling();null!=e&&g.send("setBoostLevel",{level:e})},"media.micEc":function(){g.send("setEC",{enable:u(y.getMicEc())})},"media.micNr":function(){g.send("setNS",{enable:u(y.getMicNr())})},"media.micAgc":function(){g.send("setAGC",{enable:u(y.getMicAgc())})},"media.micCss":{watcher:function(){F(u(y.getMicCss()))},sync:!1},"media.audioRepair":function(){var e=y.getAudioRepair();g.send("fixChannelBug",{enable:e!==S.AUDIO_REPAIR_NO,left:e===S.AUDIO_REPAIR_LEFT,right:e===S.AUDIO_REPAIR_RIGHT,auto:e===S.AUDIO_REPAIR_AUTO})}},!0),O.start(),v.canSetMicCss()&&F(!1),A.on(A.CLASSROOM_EXIT_END,X).on(A.CLASSROOM_CONNECT_SUCCESS,function(e,t){if(t.reconnect&&(b={}),v.isPresenter(m.get("user.id"))){var n=y.getCameraQuality(),i=[S.CAMERA_QUALITY_MAP[n]],r=y.getCameraConfig(n,y.getCameraRatio());if(v.canPublishExtraStream()){var a=y.getExtraStreamQuality(n);a>=0&&i.push(S.CAMERA_QUALITY_MAP[a])}A.trigger(A.VIDEO_RESOLUTION_CHANGE_TRIGGER,{width:r.cameraWidth,height:r.cameraHeight,definitions:i})}}).one(A.AUDIO_DEVICE_DETECT,function(){var e=function(){m.watch({"media.micVolume":function(){g.send("setMicVolume",{micVolume:y.getMicVolume()})}},!0)},t=function(){m.watch({"media.speakerVolume":function(){g.send("setAudioDevicesVolume",{speakerVolume:10*y.getSpeakerVolume(),micVolume:y.getMicVolume()})}},!0)};g.send("getSpeakerVolume").then(function(e){t()},t),g.send("getMicVolume").then(function(t){e()},e)}).on(A.CAMERA_INDEX_CHANGE,function(){e(S.MEDIA_PUBLISH_BY_CAMERA_DEVICE)}).on(A.CAMERA_CROP_CHANGE,function(){e(S.MEDIA_PUBLISH_BY_CAMERA_SETTING)}).on(A.CAMERA_VERTICAL_FLIP_CHANGE,function(){e(S.MEDIA_PUBLISH_BY_CAMERA_SETTING)}).on(A.CAMERA_HORIZONTAL_FLIP_CHANGE,function(){e(S.MEDIA_PUBLISH_BY_CAMERA_SETTING)}).on(A.ASSIST_CAMERA_INDEX_CHANGE,function(){t(S.MEDIA_PUBLISH_BY_CAMERA_DEVICE)}).on(A.CAMERA_QUALITY_CHANGE,function(){e(S.MEDIA_PUBLISH_BY_CAMERA_SETTING,function(e){e.attachVideoStreamName===D&&j(e)})}).on(A.ASSIST_CAMERA_QUALITY_CHANGE,function(){t(S.MEDIA_PUBLISH_BY_CAMERA_SETTING,function(e){e.attachVideoStreamName===D&&j(e)})}).on(A.CAMERA_RATIO_CHANGE,function(){e(S.MEDIA_PUBLISH_BY_CAMERA_SETTING)}).on(A.ASSIST_CAMERA_RATIO_CHANGE,function(){t(S.MEDIA_PUBLISH_BY_CAMERA_SETTING)}).on(A.MIC_INDEX_CHANGE,function(){Y(S.MEDIA_PUBLISH_BY_MIC_DEVICE)}).on(A.SPEAKER_INDEX_CHANGE,Y).on(A.BEAUTIFY_DENOISE_CHANGE,function(){Yox.object.each(I.instances,function(e){if(!e.isAssist&&(e.isPush()||e.isSetting)){var t=e.id;e.isCameraOpened?W(t):e.attachVideoStreamName&&K(t)}})}).on(A.PLAYER_CREATE_END,function(e,t){var n=t.player;n.hasDetectCamera=g.hasDetectCamera,n.hasDetectMic=g.hasDetectMic})}}function G(e){var t=e.id;return e.isAssist?B(t,y.getAssistCameraIndex(),y.getAssistCameraQuality(),y.getAssistCameraRatio()):B(t,y.getCameraIndex(),y.getCameraQuality(),y.getCameraRatio())}function B(e,t,n,i){var r=y.getCameraList()[t],a=y.getCameraConfig(n,i);if(a)return{cameraGuid:r?r.guid:"",cameraWidth:a.cameraWidth,cameraHeight:a.cameraHeight,cameraBandwidth:a.cameraBandwidth,cameraFps:a.cameraFps,cameraKeyframeInterval:a.cameraKeyframeInterval,identifier:e,crop:a.cameraCrop,vflip:a.cameraHorizontalFlip,hflip:a.cameraVerticalFlip}}function H(e,t){if(e&&g.hasDetectCamera){var n=e.isCameraOpened,i=e.attachVideoStreamName,r=G(e),a=function(){v.canPublishBlackStream()?s.videoOn?e.attachVideo():e.attachVideo(!1,!0):e.attachVideo()},o=function(){A.trigger(e.isAssistPush()?A.ASSIST_MEDIA_REPUBLISH_TRIGGER:A.MEDIA_REPUBLISH_TRIGGER,{videoOn:e.videoOn,audioOn:e.audioOn,linkType:e.linkType,actionType:t,isScreenSharing:e.isScreenSharing})};if(r&&r.cameraGuid){if(v.canUseCombinedAttachAV())n?g.openCamera(e,r):!i||!e.user.videoOn||e.isThirdPushing||e.isScreenSharing||t!==S.MEDIA_PUBLISH_BY_CAMERA_DEVICE&&t!==S.MEDIA_PUBLISH_BY_CAMERA_SETTING&&t!==S.MEDIA_PUBLISH_BY_MIC_SETTING||(e.attachVideo(),t===S.MEDIA_PUBLISH_BY_CAMERA_DEVICE&&A.trigger(e.isAssistPush()?A.ASSIST_MEDIA_PUBLISH_TRIGGER:A.MEDIA_PUBLISH_TRIGGER,{videoOn:e.videoOn,audioOn:e.audioOn,linkType:e.linkType,actionType:t,isScreenSharing:e.isScreenSharing}));else if(n)g.openCamera(e,r);else if(i)if(i===L){var s=e.user;t!==S.MEDIA_PUBLISH_BY_CAMERA_SETTING&&t!==S.MEDIA_PUBLISH_BY_MIC_SETTING||e.isMediaPlaying||e.isThirdPushing||e.isScreenSharing?(e.detachVideo(),a(),o()):(e.increaseUserPublishIndex(),e.detachVideo(),e.audioOn&&e.detachAudio(),e.publishAVRelease(),e.publishAV().then(function(){e.isAssist||(v.canPublishMuteStream()?s.audioOn?e.attachAudio():e.attachAudio(!1,!0):s.audioOn&&e.attachAudio()),a(),o()}))}else g.send("setVideoDeviceWithID",r)}else n?e.closeCamera():i&&e.detachVideo()}}function Y(e){if(g.hasDetectMic&&g.hasDetectSpeaker){var t=y.getMicIndex(),n=y.getSpeakerIndex(),i=y.getMicList()[t],r=y.getSpeakerList()[n];if(i&&r){var a=b.micGuid!==i.guid,o=b.speakerGuid!==r.guid;(a||o)&&(b.micGuid=i.guid,b.speakerGuid=r.guid,g.send("setAudioDevice",{micGuid:i.guid,speakerGuid:r.guid}),g.send("setMicVolume",{micVolume:y.getMicVolume()}),a&&Yox.object.each(I.instances,function(t){t.isPush()&&!t.isAssist&&t.reopenMic(e)})),a||E&&(E=!1,A.trigger(A.MEDIA_SWITCH_TRIGGER,{audioOn:!0}))}else!i&&m.get("user.audioOn")&&(A.trigger(A.MEDIA_SWITCH_TRIGGER,{audioOn:!1}),E=!0)}}function F(e){g.send("recSystemPlayout",{enable:e})}function j(e){if(v.canUseCombinedAttachAV())e.attachVideo();else{var t=e.isMainPush()?y.getCameraQuality():y.getAssistCameraQuality();g.send("setScreenShareQualityWithID",{level:t,identifier:e.id})}}function W(e){g.send("setPreviewCameraBeauty",{identifier:e,beauty:u(y.getBeautifyDenoise())})}function K(e){v.canUseCombinedAttachAV()||g.send("beautifyAndDenoiseWithID",{identifier:e,enable:u(y.getBeautifyDenoise())})}function J(){return g.send("enumVideoDevices").then(function(e){var t=c([e.cameraNames,e.cameraGuids],["name","guid"]);m.get("supportVirtualCamera")&&(t=p.filterCameraList(t,!1)),null===e.camera1080&&(e.camera1080=[]),null===e.camera720&&(e.camera720=[]),Yox.is.array(e.camera1080)&&Yox.is.array(e.camera720)&&Yox.array.each(t,function(t){Yox.array.has(e.camera1080,t.guid)||(t.support1080p=!1),Yox.array.has(e.camera720,t.guid)||(t.support720p=!1)});var n=J.counter,i=l(y.filterDeviceList(t),y.getCameraList(),n?A.CAMERA_ADD:null,n?A.CAMERA_REMOVE:null);t=(0,r.default)(i,1)[0],n?n++:n=1,J.counter=n;var a=y.getCameraGuid(),o=y.getAssistCameraGuid();y.setCameraList(t);var s=y.getCameraGuid(),u=y.getAssistCameraGuid();s!==a&&A.trigger(A.CAMERA_INDEX_CHANGE,{index:y.getCameraIndex()}),u!=o&&A.trigger(A.ASSIST_CAMERA_INDEX_CHANGE,{index:y.getAssistCameraIndex()}),g.hasDetectCamera=!0,A.trigger(A.VIDEO_DEVICE_DETECT,{cameraList:y.getCameraList()})})}function Q(){return g.send("enumAudioDevices").then(function(e){var t=c([e.micNames,e.micGuids,e.micHardwareIds||[]],["name","guid","hardwareId"]),n=Q.counter,i=l(y.filterDeviceList(t),y.getMicList(),n?A.MIC_ADD:null,n?A.MIC_REMOVE:null);t=(0,r.default)(i,1)[0];var a=y.getMicGuid();y.setMicList(t);var o=y.getMicGuid();o!==a&&A.trigger(A.MIC_INDEX_CHANGE,{micIndex:y.getMicIndex()}),g.hasDetectMic=!0;var s=c([e.speakerNames,e.speakerGuids,e.speakerHardwareIds||[]],["name","guid","hardwareId"]),u=l(y.filterDeviceList(s),y.getSpeakerList(),n?A.SPEAKER_ADD:null,n?A.SPEAKER_REMOVE:null);s=(0,r.default)(u,1)[0],n?n++:n=1,Q.counter=n,a=y.getSpeakerGuid(),y.setSpeakerList(s),(o=y.getSpeakerGuid())!==a&&A.trigger(A.SPEAKER_INDEX_CHANGE,{speakerIndex:y.getSpeakerIndex()}),g.hasDetectSpeaker=!0,A.trigger(A.AUDIO_DEVICE_DETECT,{micList:y.getMicList(),speakerList:y.getSpeakerList()})})}function z(e,t){if(!e.isHidden){var n=e.user;d._playAV(e,{streamName:t,userNumber:e.isPlayingExtraStream?e.user.id4:e.id,isSelf:!!v.isSelf(n.id),playIp:"127.0.0.1",audioOnly:!1,applyClip:!(!m.get("class.useVideoClip")||n.isScreenSharing)}),d.showVideo(e)}}function q(e,t){e.isHidden||(d.hideVideo(e),d._playAVClose(e,{streamName:t}))}function X(){g.send("allPlayAVRelease"),g.send("allPublishAVRelease"),O.stop()}function Z(e,t,n,i){var r,a={},o=T;if(null!=t&&t===S.LINK_TYPE_UDP&&(o=R),o.getUplinkStreamNamePattern().test(e)?r=RegExp.$2:o.getDownlinkStreamNamePattern().test(e)&&(r=RegExp.$2),r){var s=I.instances[r];if(s)a.userId=r,a.player=s;else if(n instanceof Array)for(var u=n.length;u--;)if(r-=n[u],s=I.instances[r]){(i===P&&s.isPull||i===k&&s.isPush||null==i)&&(a.userId=r,a.player=s);break}}return a}function ee(e,t,n){var i,r=G(e),a={identifier:e.id,width:r.cameraWidth,height:r.cameraHeight,fps:r.cameraFps,keyframeInterval:r.cameraKeyframeInterval,bitrate:r.cameraBandwidth};if(r){if(n)$.extend(a,{ContentType:"BlackFrame"}),i=L;else if(e.isThirdPushing)$.extend(a,{ContentType:"RtmpAgent",rtmpAgentUrl:""}),i=N;else if(e.isScreenSharing){var o=e.isMainPush()?y.getCameraQuality():y.getAssistCameraQuality(),s=m.get("partner.liveScreenShareFps",10);a.fps=s,a.keyframeInterval=m.get("partner.liveScreenFrameInterval",5)*s,e.shareMode===S.SCREEN_SHARE_MODE_PROGRAM?$.extend(a,{ContentType:"AppWindow",appWindowName:e.shareProgram,screenQuality:o}):$.extend(a,{ContentType:"Desktop",isFullscreen:e.shareMode===S.SCREEN_SHARE_MODE_FULLSCREEN,screenQuality:o}),i=D}else e.isMediaPlaying&&e.videoFromMediaFile?($.extend(a,{ContentType:"MediaAv"}),i=L):($.extend(a,{ContentType:"Camera",devGuid:r.cameraGuid,crop:r.crop,vflip:r.vflip,hflip:r.hflip,enableFilter:u(y.getBeautifyDenoise())}),i=L);e.attachVideoStreamName=i,e.attachVideoOptions=a,z(e,i),setTimeout(function(){if(e.hasVideoStream&&g.send("attachVideo",a),v.canPublishExtraStream()){a=$.extend(!0,{},a);var t=y.getExtraStreamQuality();if(t>=0&&!e.isScreenSharing){var n=B(e.id,y.getCameraIndex(),t,y.getCameraRatio());a.identifier=e.user.id4,a.fps=n.cameraFps,a.width=n.cameraWidth,a.height=n.cameraHeight,a.bitrate=n.cameraBandwidth,a.keyframeInterval=n.cameraKeyframeInterval,a.render=!1,g.send("attachVideo",a)}else a.identifier=e.user.id4,a.ContentType="BlackFrame",a.render=!1,g.send("attachVideo",a),A.trigger(A.VIDEO_RESOLUTION_CHANGE_TRIGGER,{width:a.width,height:a.height,definitions:[S.CAMERA_QUALITY_MAP[y.getCameraQuality()]]})}},200)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.data.media,a=n(497);t.getAudioStreamOptions=function(){var e,t=r.getMicList()[r.getMicIndex()];return t&&(e=t.guid),{type:"audio",microphoneId:e}},t.getVideoStreamOptions=function(e,t,n){var i=a(e,t,n),o=e.isAssist,s={type:"video",cameraId:i.cameraId,quality:i.cameraQuality,fps:i.cameraConfig.cameraFps,size:{width:i.cameraConfig.cameraWidth,height:i.cameraConfig.cameraHeight}};return o&&(s.agoraVideoProfile=r.getAgoraAssistCameraProfile()),s},t.getAVStreamOptions=function(e){var t,n=a(e),i=e.isAssist;if(!i){var o=r.getMicList()[r.getMicIndex()];o&&(t=o.guid)}var s={id:e.id,type:i?"video":"av",quality:n.cameraQuality,cameraId:n.cameraId,microphoneId:t,fps:n.cameraConfig.cameraFps,size:{width:n.cameraConfig.cameraWidth,height:n.cameraConfig.cameraHeight}};return i&&(s.agoraVideoProfile=r.getAgoraAssistCameraProfile()),s}}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,r=n(0),a=r(n(273)),o=r(n(128)),s=r(n(117)),u=r(n(131)),c=r(n(174)),l=r(n(210)),d=r(n(175)),_=n(355),f=n(356);void 0===(i=function(e,t,i){var r=BJY.is,p=BJY.auth,h=BJY.store,g=BJY.config,E=BJY.Player,v=BJY.storage,m=BJY.data.media,S=BJY.server.room,A=BJY.eventEmitter,y=n(325),T=n(541),R=n(3),I=n(596),C=n(722),O=n(597),b=n(139),L=n(200),D=n(199),N=n(274),P=n(930),k=n(357),w=n(931),U=n(497),M=n(932),x=n(933),V=n(934),G=n(935),B=n(354),H={},Y={},F=L("webrtc-camera:"),j=0,W=1,K=2,J=3,Q=200,z=!1,q=!1,X=!1,Z=!1,ee=null,te=1,ne=!1,ie=R(v.get("bjy_camera_quality"),null,"int");function re(){return ae.apply(this,arguments)}function ae(){return(ae=(0,d.default)(c.default.mark(function e(){var t,n,i,r,a,o,s,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(z=!0,t=m.getCameraList(),n=[],i={},Yox.object.each(m.getDefinitions(),function(e,t){if(null!=e){var r=[e.width,e.height];n.push(r),i[t]=r}}),!n.length){e.next=31;break}r=t.slice(),h.get("supportVirtualCamera")&&r.push(h.get("virtualMainCamera")),a=0;case 9:if(!(a<r.length)){e.next=31;break}if((o=r[a]).isScanned||o.isComposed){e.next=28;break}return e.prev=12,e.next=15,RTCat.scanCamera(o.guid,n);case 15:s=e.sent,o.isScanned=!0,o.supportSuper=s.includes(i.super),o.support720p=s.includes(i["720p"]),o.support720pHigh=s.includes(i["720pHigh"]),o.support1080p=s.includes(i["1080p"]),o.support1080pHigh=s.includes(i["1080pHigh"]),o.support4K=s.includes(i["4k"]),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(12),F("scan camera failed ".concat(o.guid),e.t0);case 28:a++,e.next=9;break;case 31:z=!1,m.setCameraList(t),ie&&(m.setCameraQuality(m.getAdjustCameraQuality(m.getCameraIndex(),ie)),ie=null),A.trigger(A.CAMERA_QUALITY_LIST_CHANGE),Z&&(Z=!1,(u=E.instances[h.get("user.id")])&&u.republish());case 36:case"end":return e.stop()}},e,null,[[12,25]])}))).apply(this,arguments)}function oe(){return se.apply(this,arguments)}function se(){return(se=(0,d.default)(c.default.mark(function e(){var t,n,i,r,o,s,u,l,d,_;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return F("enum video devices"),e.next=3,RTCat.getCameraDevices();case 3:t=e.sent,n=m.filterDeviceList(t.filter(function(e){return"default"!==e.deviceId&&"communications"!==e.deviceId}).map(function(e,t){return{name:e.label,guid:e.deviceId,index:t,supportSuper:!0,support720p:!0,support720pHigh:!1,support1080p:!0,support1080pHigh:!1,support4K:!1}})),r=oe.counter,n=m.filterDeviceList(n),o=N(n,m.getCameraList(),r?A.CAMERA_ADD:null,r?A.CAMERA_REMOVE:null),s=(0,a.default)(o,2),n=s[0],i=s[1],u=m.getCameraGuid(),l=m.getAssistCameraGuid(),h.get("supportVirtualCamera")&&(n=B.filterCameraList(n,!0)),m.setCameraList(n),d=m.getCameraGuid(),_=m.getAssistCameraGuid(),d!==u&&A.trigger(A.CAMERA_INDEX_CHANGE,{index:m.getCameraIndex()}),_!==l&&A.trigger(A.ASSIST_CAMERA_INDEX_CHANGE,{index:m.getAssistCameraIndex()}),F("trigger video device"),A.trigger(A.VIDEO_DEVICE_DETECT,{cameraList:m.getCameraList()}),(!r||i)&&re(),oe.counter=r?r+1:1;case 23:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ue(){return ce.apply(this,arguments)}function ce(){return(ce=(0,d.default)(c.default.mark(function e(){var t,n,i,r,o,s,l,d,_,f,p,h,g;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return F("enum audio devices"),t=ue.counter,e.next=4,u.default.all([RTCat.getAudioInputDevices(),RTCat.getAudioOutputDevices()]);case 4:n=e.sent,i=(0,a.default)(n,2),r=i[0],o=i[1],s=r.filter(function(e){return"default"!==e.deviceId&&"communications"!==e.deviceId}).map(function(e,t){return{name:e.label,guid:e.deviceId,hardwareId:e.groupId,index:t}}),l=N(m.filterDeviceList(s),m.getMicList(),t?A.MIC_ADD:null,t?A.MIC_REMOVE:null),d=(0,a.default)(l,1),s=d[0],_=m.getMicGuid(),m.setMicList(s),m.getMicGuid()!==_&&A.trigger(A.MIC_INDEX_CHANGE,{micIndex:m.getMicIndex()}),f=o.filter(function(e){return"default"!==e.deviceId&&"communications"!==e.deviceId}).map(function(e,t){return{name:e.label,guid:e.deviceId,hardwareId:e.groupId,index:t}}),p=N(m.filterDeviceList(f),m.getSpeakerList(),t?A.SPEAKER_ADD:null,t?A.SPEAKER_REMOVE:null),h=(0,a.default)(p,1),f=h[0],g=m.getSpeakerGuid(),m.setSpeakerList(f),m.getSpeakerGuid()!==g&&A.trigger(A.SPEAKER_INDEX_CHANGE,{speakerIndex:m.getSpeakerIndex()}),F("trigger audio device"),A.trigger(A.AUDIO_DEVICE_DETECT,{micList:m.getMicList(),speakerList:m.getSpeakerList()}),ue.counter=t?t+1:1;case 27:case"end":return e.stop()}},e)}))).apply(this,arguments)}function le(e,t){t=t||0,clearTimeout(ee),t>=3||(ee=setTimeout(function(){var n=e?m.getAssistCameraGuid():m.getCameraGuid();navigator.mediaDevices.getUserMedia({audio:!1,video:{deviceId:n?{exact:n}:void 0}}).then(function(t){t.getTracks().forEach(function(e){return e.stop()}),re().then(function(){e?A.trigger(A.ASSIST_CAMERA_INDEX_CHANGE,{index:m.getAssistCameraIndex()}):A.trigger(A.CAMERA_INDEX_CHANGE,{index:m.getCameraIndex()})})}).catch(function(n){le(e,t++)})},2e3))}function de(e){return function(n,i){var a=r.isBJYWebRTC(),o=r.isAGORAWebRTC(),s=e?A.ASSIST_CAMERA_INDEX_CHANGE:A.CAMERA_INDEX_CHANGE;Yox.object.each(E.instances,function(r){if(F("update ".concat(e?"assist ":"","camera"),r,n,i),!e||r.isAssist){var u=e?r.user&&r.user.id:r.id;if(i&&-1===i.index){if(r.isCameraOpened&&r.closeCamera(),e&&r.isScreenSharing)return;r.__avStream&&p.isSelf(u)&&(t.publishAVRelease(r),A.trigger(e?A.ASSIST_MEDIA_SWITCH_TRIGGER:A.MEDIA_SWITCH_TRIGGER,{videoOn:!1,audioOn:!1}))}else if(r.isSetting)r.isCameraOpened?a&&r.__videoStream&&n.type===s?r.__videoStream.updateTracks(t.streamManager.constructV3Opts(C.getVideoStreamOptions(r))).catch(function(t){F("update ".concat(e?"assist ":"","video track fail"),t),A.trigger(A.CAMERA_OPEN_FAIL)}):(r.closeCamera(),O(1e3).then(function(e){return r.openCamera()})):r.openCamera();else if(p.isSelf(u)&&h.get("class.started")&&r.__avStream)if(a&&n.type===s){var c=t.streamManager.constructV3Opts(C.getAVStreamOptions(r));r.__avStream.updateTracks({video:c.video}).catch(function(t){F("update ".concat(e?"assist ":"","video track fail"),t),A.trigger(A.CAMERA_OPEN_FAIL)})}else r.republish(!0,null,o?1e3:null),!e&&n.type===A.CAMERA_QUALITY_CHANGE&&r.runInfo&&(r.runInfo.minUplinkAudioBandwidth=.5*m.getAudioBitrate(m.getCameraQuality()))}})}}var _e=b(de(!1),1e3),fe=b(de(!0),1e3),pe=b(function(e,n){var i=m.getMicIndex(),a=m.getMicList()[i];Yox.object.each(E.instances,function(i){if(!a&&h.get("user.audioOn")&&p.isSelf(i.id))A.trigger(A.MEDIA_SWITCH_TRIGGER,{audioOn:!1});else if(i.isSetting)a&&(r.isBJYWebRTC()&&i.__audioStream&&e.type===A.MIC_INDEX_CHANGE?i.__audioStream.updateTracks(t.streamManager.constructV3Opts(C.getAudioStreamOptions())).then(function(){n.mute&&i.__audioTag.pause()}).catch(function(e){F("update audio track fail",e),A.trigger(A.MIC_OPEN_FAIL)}):(i.closeMic(),i.openMic(n.mute)));else if(p.isSelf(i.id))if(F("update mic",i),r.isBJYWebRTC()&&i.__avStream&&e.type===A.MIC_INDEX_CHANGE){var o=t.streamManager.constructV3Opts(C.getAVStreamOptions(i));i.__avStream.updateTracks({audio:o.audio}).catch(function(e){F("update audio track fail",e),A.trigger(A.MIC_OPEN_FAIL)})}else i.__avStream&&i.republish(!0)}),p.canSetMicSpeakerSeparately()&&A.trigger(A.SYSTEM_MIC_CHANGE,{micName:m.getMicName()})},500);function he(){Yox.object.each(E.instances,function(e){var t=e.atag,n=m.getSpeakerList()[m.getSpeakerIndex()];n&&t&&"function"==typeof t.setSinkId&&t.setSinkId(n.guid).catch(function(e){return console.log(e)})}),p.canSetMicSpeakerSeparately()&&A.trigger(A.SYSTEM_SPEAKER_CHANGE,{speakerName:m.getSpeakerName()})}function ge(e,n){if(F("session emit: add publisher",n.playerId),H[n.playerId]){if(H[n.playerId].status===j){var i=E.instances[n.playerId];i?(F("should subscribe because play av called",i.id,i),clearTimeout(i.playTimer),i.playTimer=null,H[n.playerId].stream=n.stream,F("begin subscribe",i.id,i),t.subscribe({player:i,playerId:n.playerId,stream:n.stream}),H[n.playerId].status=K):(F("player not found but status is PUBLISHER_STATUS_PLAYED",n.playerId),H[n.playerId]={playerId:n.playerId,status:W,stream:n.stream})}}else{H[n.playerId]={playerId:n.playerId,status:W,stream:n.stream};var r=E.instances[n.playerId];r&&(F("should replay because found player",r&&r.id,r),r.replay(!0))}}function Ee(e,n){var i=n.playerId;F("session emit: remove publisher",i),t.removeResubscribeTimer(i),delete H[i]}function ve(e,n,i){var a=n.playerId;if(F("session emit: add stream",a,i),q)if(Y[a]=n,t.removeResubscribeTimer(a),3!==i){var o=!1,s=E.instances[n.playerId];if(s){if(!r.isAGORAWebRTC()&&s.__avStream&&s.__avStream.sid===n.stream.sid)return o=!0,void F("stream ".concat(n.playerId," existed, return"));s.__avStream=n.stream;var u=s.__avStream.stream,c=u.getAudioTracks&&u.getAudioTracks()||[],l=u.getVideoTracks&&u.getVideoTracks()||[];if(l.length){var d=new MediaStream;d.addTrack(l[0]),s.vtag&&(s.vtag.srcObject=d);var _=[s.id];s.user&&_.push(s.user.id),s.isHidden&&_.every(function(e){return!p.isSelf(e)})&&(s.isAssist?t.assistSessionManager:t.sessionManager).subMute({video:!0},s.id,s.__avStream),o=!0}if(c.length){var f=new MediaStream;f.addTrack(c[0]),s.atag.volume=m.getSpeakerVolume()/g.SPEAKER_VOLUME_MAX,s.atag.srcObject=f,p.isSelf(n.playerId)?s.atag.pause():s.__volumeTimer=setInterval(function(){s.getInputVolume().then(function(e){return s.setLinkVolume(e.volume)})},Q),o=!0}s.__avStream.on("replaceTrack",function(e,t){if("video"===t){if(s.vtag){var i=new MediaStream;i.addTrack(e),s.vtag.srcObject=i}}else if("audio"===t&&s.atag){var r=new MediaStream;r.addTrack(e),s.atag.srcObject=r,p.isSelf(n.playerId)&&s.atag.pause()}})}o||(i||(i=0),O(500).then(function(){ve(e,n,i+1)}))}else F("stop add stream attempt")}function me(e){F("clean av stream",e),!p.canSetMicSpeakerSeparately()&&h.get("partner.enableWebAudioGain",1)&&function(e){e.gainSource&&(e.gainSource.disconnect(),e.gainSource=null);e.gainNode&&(e.gainNode.disconnect(),e.gainNode=null,e.gainDestination=null)}(e),e.__volumeTimer&&(clearInterval(e.__volumeTimer),delete e.__volumeTimer),e.__avStream&&(e.__avStream.close(),e.__avStream=null),e.vtag&&(e.vtag.srcObject=null),e.atag&&(e.atag.srcObject=null),p.isSelf(e.id)?(e.setUplinkVideoBandwidth(0),e.setUplinkAudioBandwidth(0)):(e.setDownlinkVideoBandwidth(0),e.setDownlinkAudioBandwidth(0),A.trigger(A.AV_PLAY_CLOSE_START,{player:e})),t.removeResubscribeTimer(e.id),delete Y[e.id]}function Se(e,t){F("session emit: clean stream",t.playerId);var n=E.instances[t.playerId];n&&me(n),delete Y[t.playerId]}function Ae(e,n){F("session emit: published",n.playerId);var i=E.instances[n.playerId];i&&(i.publishAVConnectSuccess(),r.isAGORAWebRTC()&&(t.detachAudio(i),i.audioOn&&t.attachAudio(i),t.detachVideo(i),i.videoOn&&t.attachVideo(i)))}function ye(e,t){if(F("session emit: republish",t.playerId),q=!0,r.isAGORAWebRTC()){var n=E.instances[t.playerId];n&&(F("republishing..."),n.republish())}}function Te(e){F("session emit: reconnect session");var t=e?h.get("user.id2"):h.get("user.id"),n=BJY.Player.instances[t];n&&n.republish(),q=!0}function Re(e,t){var n=E.instances[t.playerId];n&&(n.isScreenSharing||n.isMediaPlaying||(n.setUplinkVideoLossRate(t.uplinkVideoLossRate),n.setUplinkVideoBandwidth(t.uplinkVideoBandwidth)),n.setUplinkAudioLossRate(t.uplinkAudioLossRate),n.setUplinkAudioBandwidth(t.uplinkAudioBandwidth),n.setRtt(t.rtt))}function Ie(e,t){var n=E.instances[t.playerId];n&&(n.isScreenSharing||n.isMediaPlaying||(n.setDownlinkVideoLossRate(t.downlinkVideoLossRate),n.setDownlinkVideoBandwidth(t.downlinkVideoBandwidth)),n.setDownlinkAudioLossRate(t.downlinkAudioLossRate),n.setDownlinkAudioBandwidth(t.downlinkAudioBandwidth))}function Ce(){F("session emit: session disconnect"),q=!1,t.publisherQueue=H={},Yox.object.each(E.instances,function(e){p.isSelf(e.id)||(e.__avStream&&(e.__avStream.close(),e.__avStream=null,e.vtag.srcObject=null,e.atag.srcObject=null),e.__volumeTimer&&(clearInterval(e.__volumeTimer),delete e.__volumeTimer),A.trigger(A.AV_PLAY_CLOSE_START,{player:e}))})}function Oe(e,t){F("session emit: publish error",t),A.trigger(A.PUBLISH_ERROR)}function be(e,t){F("session emit: subscribe error",t),A.trigger(A.SUBSCRIBE_ERROR)}function Le(e,t){F("session emit: session error",t),A.trigger(A.WEBRTC_SERVER_CONNECT_TIMEOUT)}function De(){F("session emit: renew webrtc info"),S.getWebrtcInfo()}function Ne(){Yox.object.each(E.instances,function(e){var t=(0,l.default)(m.getMicVolume()/g.MIC_VOLUME_MAX),n=t*t*I.MAX_GAIN;e.gainNode&&(e.gainNode.gain.value=n),e.__audioGainNode&&(e.__audioGainNode.gain.value=n)}),p.canSetMicSpeakerSeparately()&&A.trigger(A.SYSTEM_MIC_VOLUME_CHANGE,{volume:m.getMicVolume()})}function Pe(){Yox.object.each(E.instances,function(e){p.canSetMicSpeakerSeparately()&&A.trigger(A.SYSTEM_SPEAKER_VOLUME_CHANGE,{volume:m.getSpeakerVolume()}),p.isSelf(e.id)||e.isMicOpened||(e.isWebRTCMixPull()?e.flvPlayer&&e.flvPlayer.setVolume(m.getSpeakerVolume()):e.atag.volume=m.getSpeakerVolume()/g.SPEAKER_VOLUME_MAX)})}var ke=b(function(){F("device changed"),oe(),ue()},500),we=b(function(e){r.isAGORAWebRTC()?u.default.all([t.sessionManager.disconnect(),t.assistSessionManager.disconnect()]).then(function(){Ce(),e&&setTimeout(function(){return t.createSession()},1e3)}):r.isBJYWebRTC()&&(e?t.createSession():(t.sessionManager.disconnect(),t.assistSessionManager.disconnect()))},500);function Ue(e,n){if(t.streamManager.getGainSupported()&&e.stream.getAudioTracks().length>0){n.gainNode||(n.gainNode=t.streamManager.audioContext.createGain(),n.gainDestination=t.streamManager.audioContext.createMediaStreamDestination(),n.gainNode.connect(n.gainDestination)),n.gainSource&&(n.gainSource.disconnect(),n.gainSource=null);var i=(0,l.default)(m.getMicVolume()/g.MIC_VOLUME_MAX);n.gainSource=t.streamManager.audioContext.createMediaStreamSource(e.stream),n.gainSource.connect(n.gainNode),n.gainNode.gain.value=i*i*I.MAX_GAIN,e.stream.removeTrack(e.stream.getAudioTracks()[0]),e.stream.addTrack(n.gainDestination.stream.getAudioTracks()[0])}return e}function Me(e){return F("create camera stream",e),p.canUseDoubleCamera()&&M(e.cameraId),t.streamManager.createAVStream(e)}function xe(e){return Ve.apply(this,arguments)}function Ve(){return(Ve=(0,d.default)(c.default.mark(function e(t){var n,i,r,a,o,s;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.isAssist,i=C.getAVStreamOptions(t),e.prev=2,e.next=5,Me(i);case 5:return r=e.sent,e.abrupt("return",p.canSetMicSpeakerSeparately()||!h.get("partner.enableWebAudioGain",1)?r:Ue(r,t));case 9:e.prev=9,e.t0=e.catch(2),F("createAVStream error:",e.t0),e.t1=e.t0.name,e.next="NotFoundError"===e.t1?15:"DevicesNotFoundError"===e.t1?15:"NotReadableError"===e.t1?47:"TrackStartError"===e.t1?47:"NotAllowedError"===e.t1?47:"OverconstrainedError"===e.t1?50:51;break;case 15:if(a=n?m.getAssistCameraList().length:m.getCameraList().length,o=m.getMicList().length,!n){e.next=20;break}return!a&&A.trigger(A.CAMERA_OPEN_FAIL),e.abrupt("return");case 20:if(a||o){e.next=26;break}throw A.trigger(A.CAMERA_OPEN_FAIL),A.trigger(A.MIC_OPEN_FAIL),new Error(I.CREATE_AV_STREAM_ERROR);case 26:if(a){e.next=35;break}return A.trigger(A.CAMERA_OPEN_FAIL),i={type:"audio"},e.next=31,Me(i);case 31:return s=e.sent,e.abrupt("return",p.canSetMicSpeakerSeparately()||!h.get("partner.enableWebAudioGain",1)?s:Ue(s,t));case 35:if(o){e.next=44;break}return A.trigger(A.MIC_OPEN_FAIL),i.type="video",delete i.microphoneId,e.next=41,Me(i);case 41:return e.abrupt("return",e.sent);case 44:oe(),ue();case 46:return e.abrupt("break",52);case 47:throw"could not start video source"!==e.t0.message&&"Could not start video source"!==e.t0.message||(A.trigger(A.CAMERA_OPEN_FAIL),le(playser.isAssist)),"could not start audio source"!==e.t0.message&&"Could not start audio source"!==e.t0.message||A.trigger(A.MIC_OPEN_FAIL),new Error(I.CREATE_AV_STREAM_ERROR);case 50:return e.abrupt("return",Me({id:t.id,type:n?"video":"av",cameraId:i.cameraId,microphoneId:n?void 0:i.microphoneId}));case 51:throw new Error(I.CREATE_AV_STREAM_ERROR);case 52:case"end":return e.stop()}},e,null,[[2,9]])}))).apply(this,arguments)}function Ge(e,t,n){return Be.apply(this,arguments)}function Be(){return(Be=(0,d.default)(c.default.mark(function e(t,n,i){var r=arguments;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return F("try publish av",t.webrtcPublishTryCount),e.prev=1,e.next=4,n.publishAV(i);case 4:e.next=16;break;case 6:if(e.prev=6,e.t0=e.catch(1),!(t.webrtcPublishTryCount>=I.PUBLISH_TRY_COUNT)){e.next=14;break}return e.next=11,u.default.reject(e.t0);case 11:return e.abrupt("return",e.sent);case 14:t.webrtcPublishTryCount++,Ge.apply(void 0,r);case 16:case"end":return e.stop()}},e,null,[[1,6]])}))).apply(this,arguments)}function He(e){F("publish av close",e);var n=(e.isAssist?t.assistSessionManager:t.sessionManager).publishAVClose({playerId:e.id,stream:e.__avStream});return r.isAGORAWebRTC()?u.default.resolve():n}function Ye(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&e.isVideoHide&&(F("show video",e.id),n&&(e.isAssist?t.assistSessionManager:t.sessionManager).subMute({video:!1},e.id,e.__avStream),e.vtag&&(e.vtag.style.position="static",e.vtag.style.left="",e.vtag.style.right=""),e.stag&&(e.stag.style.position="static",e.stag.style.left="",e.stag.style.right=""),e.snapshot&&(e.snapshot.style.backgroundImage="",e.snapshot.style.display="none"),e.isVideoHide=!1)}function Fe(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e&&e.isReady&&!e.isVideoHide&&!e.isWebRTCMixPull()){if(F("hide video",e.id),i&&e.snapshotCanvas&&!e.isScreenSharing){e.__screenStream?e.stag&&(e.snapshotCanvas.width=e.stag.videoWidth,e.snapshotCanvas.height=e.stag.videoHeight,e.snapshotCanvas.getContext("2d").drawImage(e.stag,0,0)):e.vtag&&(e.snapshotCanvas.width=e.vtag.videoWidth,e.snapshotCanvas.height=e.vtag.videoHeight,e.snapshotCanvas.getContext("2d").drawImage(e.vtag,0,0));var r=e.snapshotCanvas.toDataURL("image/jpeg");r.length>6&&(e.snapshot.style.backgroundImage="url("+r+")",e.snapshot.style.display="block")}else e.snapshot.style.display="none";e.vtag&&(e.vtag.style.position="fixed",e.vtag.style.left="-10000px",e.vtag.style.right="-10000px"),n&&(e.isAssist?t.assistSessionManager:t.sessionManager).subMute({video:!0},e.id,e.__avStream),e.isVideoHide=!0}}function je(){return(je=(0,d.default)(c.default.mark(function e(n){var i;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(F("play av release",n&&n.id,n.user),Fe(n,!1,!1),!n.isWebRTCMixPull()){e.next=5;break}return n.flvPlayer&&n.flvPlayer.playClose(),e.abrupt("return");case 5:if(i=n.id,!H[i]||H[i].status!==K){e.next=18;break}if(!r.isBJYWebRTC()){e.next=17;break}return e.prev=8,e.next=11,t.unsubscribe({player:n,playerId:i,stream:H[i].stream});case 11:e.next=15;break;case 13:e.prev=13,e.t0=e.catch(8);case 15:e.next=18;break;case 17:r.isAGORAWebRTC()&&t.unsubscribe({player:n,playerId:i,stream:H[i].stream});case 18:H[i]&&(H[i].status=J),n.__avStream&&(n.__avStream=null);case 20:case"end":return e.stop()}},e,null,[[8,13]])}))).apply(this,arguments)}t.init=function(){$.extend(g,n(596)),r.isBJYWebRTC()?(t.streamManager=new f.StreamManager,t.sessionManager=new _.SessionManager(k(g.PLAYER_TYPE.MAIN_CAMERA),!1,"camera-main"),t.assistSessionManager=new _.SessionManager(k(g.PLAYER_TYPE.ASSIST_CAMERA),!0,"camera-assist")):r.isAGORAWebRTC()&&(t.streamManager=new webrtcEngineAdapter.AgoraStreamManager,t.sessionManager=new webrtcEngineAdapter.AgoraSessionManager,t.assistSessionManager=new webrtcEngineAdapter.AgoraSessionManager),RTCat.setLogLevel(RTCat.LogLevels.ERROR),t.sessionManager.on("addPublisher",ge).on("removePublisher",Ee).on("addStream",ve).on("cleanStream",Se).on("uplinkStats",Re).on("downlinkStats",Ie).on("published",Ae).on("republish",ye).on("publishError",Oe).on("subscribeError",be).on("sessionDisconnect",Ce).on("sessionError",Le).on("renewWebrtcInfo",De).on("reconnect",Te.bind(null,!1)),p.supportDoubleCamera()&&t.assistSessionManager.on("addPublisher",ge).on("removePublisher",Ee).on("addStream",ve).on("cleanStream",Se).on("uplinkStats",Re).on("downlinkStats",Ie).on("published",Ae).on("republish",ye).on("publishError",Oe).on("subscribeError",be).on("sessionDisconnect",Ce).on("sessionError",Le).on("renewWebrtcInfo",De).on("reconnect",Te.bind(null,!0)),function(){if(h.watch("class.started",we,!0),A.on(A.ROOM_SERVER_OFFLINE,function(){q=!1}).on(A.CAMERA_INDEX_CHANGE,function(e,t){!t.isVirtualCameraSwitch&&_e(e,t)}).on(A.CAMERA_QUALITY_CHANGE,_e).on(A.ASSIST_CAMERA_INDEX_CHANGE,fe).on(A.ASSIST_CAMERA_QUALITY_CHANGE,fe).on(A.MIC_AGC_CHANGE,pe).on(A.MIC_INDEX_CHANGE,pe).on(A.SPEAKER_INDEX_CHANGE,he).on(A.CAMERA_VERTICAL_FLIP_CHANGE,_e).on(A.CAMERA_HORIZONTAL_FLIP_CHANGE,_e).on(A.CAMERA_RATIO_CHANGE,_e).on(A.MIC_VOLUME_CHANGE,Ne).on(A.SPEAKER_VOLUME_CHANGE,Pe),r.isAGORAWebRTC())A.on(A.CLASSROOM_CONNECT_SUCCESS,function(e,t){(t.reconnect||t.isClassSwitching)&&we(h.get("class.started"))}).on(A.WEBRTC_INFO_RES,function(e,t){X=!0,we(h.get("class.started"))});else if(r.isBJYWebRTC()){var e=function(){var e=(0,d.default)(c.default.mark(function e(n,i){var r,a,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=D(n.from.name),a=D(n.to.name),o=n.player.isAssist?t.assistSessionManager:t.sessionManager,e.t0=r!==a,!e.t0){e.next=7;break}return e.next=7,o.switcArea(a);case 7:i?o.switchDownlinkServer(n.player,n.to):o.switchUplinkServer(n.to);case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}();A.on(A.WEBRTC_SERVER_CONNECT_SUCCESS,function(){X=!0,we(h.get("class.started"))}).on(A.CLASSROOM_CONNECT_SUCCESS,function(e,n){n.isClassSwitching&&(t.sessionManager&&t.sessionManager.updateChannel(k(g.PLAYER_TYPE.MAIN_CAMERA)),t.assistSessionManager&&t.assistSessionManager.updateChannel(k(g.PLAYER_TYPE.ASSIST_CAMERA)))}).on(A.ROOM_SERVER_OFFLINE,function(){t.sessionManager.disconnect(),t.assistSessionManager.disconnect()}).on(A.UPLINK_SERVER_CHANGE,function(t,n){return e(n,!1)}).on(A.DOWNLINK_SERVER_CHANGE,function(t,n){return e(n,!0)})}navigator.mediaDevices.addEventListener("devicechange",ke),document.addEventListener("click",function e(){document.removeEventListener("click",e),t.streamManager.resumeAudioContext()})}();var e=function(){return P().then(function(){return u.default.all([oe(),ue()])})};if(!1!==t.initVirtualCamera(e))return e()},t.createSession=(0,d.default)(c.default.mark(function e(){var n,i,a,o,l;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(F("create session"),n=h.get("user.webrtcInfo"),i=[],(r.isAGORAWebRTC()||r.isBJYWebRTC()&&!t.sessionManager.isConnected())&&(i.push(t.sessionManager.createSession({appId:n.appId||g.AGORA_APPID,channel:k(g.PLAYER_TYPE.MAIN_CAMERA),playerId:(0,s.default)(h.get("user.id")),userId:h.get("user.id"),codec:h.get("partner.webrtcCodec","h264"),streamType:g.PLAYER_TYPE.MAIN_CAMERA,token:n.token,webrtcInfo:n})),p.supportDoubleCamera()&&i.push(t.assistSessionManager.createSession({appId:n.appId||g.AGORA_APPID,channel:k(g.PLAYER_TYPE.ASSIST_CAMERA),playerId:(0,s.default)(h.get("user.id2")),userId:h.get("user.id"),codec:h.get("partner.webrtcCodec","h264"),streamType:g.PLAYER_TYPE.ASSIST_CAMERA,token:n.token2,webrtcInfo:n}))),!i.length){e.next=11;break}return a=setTimeout(function(){return A.trigger(A.WEBRTC_SERVER_CONNECT_TIMEOUT)},3e4),e.next=8,u.default.all(i);case 8:o=e.sent,l=function(){if(clearTimeout(a),q=!0,X){X=!1;var e=E.instances[h.get("user.id")];e&&e.republish()}},r.isBJYWebRTC()?l():r.isAGORAWebRTC()&&(o.every(function(e){return-1!==e})?(l(),A.trigger(A.WEBRTC_SERVER_CONNECT_SUCCESS)):(clearTimeout(a),A.trigger(A.WEBRTC_SERVER_CONNECT_TIMEOUT)));case 11:case"end":return e.stop()}},e)})),t.initPlayer=function(e){if(!e.isIniting){F("init player",e.id,e),e.isIniting=!0,t.disposePlayer(e);var n=$('<div class="bjy-webrtc-swf"></div>'),i=document.createElement("video");i.setAttribute("class","bjy-player-object"),i.setAttribute("autoplay",""),i.setAttribute("playsinline","");var r=document.createElement("audio");r.setAttribute("autoplay","");var a=i.cloneNode();a.setAttribute("style","display: none"),a.setAttribute("class","bjy-player-object bjy-player-screen-share"),a.setAttribute("autoplay",""),a.setAttribute("playsinline","");var o=i.cloneNode();o.setAttribute("style","display: none"),o.setAttribute("class","bjy-player-object bjy-player-media-file"),o.setAttribute("autoplay",""),o.setAttribute("playsinline","");var s=document.createElement("div");s.setAttribute("class","bjy-player-object bjy-player-snapshot"),s.setAttribute("style","background-size: 100% 100%;display:none;"),n.prepend(s),n.prepend(r),n.prepend(i),n.prepend(a),n.prepend(o),e.element&&e.element.append(n),e.vtag=i,e.atag=r,e.stag=a,e.ftag=o,e.snapshot=s,e.snapshotCanvas=document.createElement("canvas"),e.swf=n[0],function(e){e.vtagPlayingHandler=function(){e.playAVSuccess(),F("vtag playing",e&&e.id)},e.vtagPauseHandler=function(){F("vtag paused",e&&e.id),O(200).then(function(){return e.vtag&&e.vtag.play()})},e.atagPlayingHandler=function(){e.playAVSuccess(),F("atag playing",e&&e.id)},e.atagPauseHandler=function(){F("atag paused",e&&e.id),p.isSelf(e.id)||O(200).then(function(){return e.atag&&e.atag.play()})},e.stagPauseHandler=function(){O(200).then(function(){return e.stag&&e.stag.play()})},e.vtag.addEventListener("playing",e.vtagPlayingHandler),e.vtag.addEventListener("pause",e.vtagPauseHandler),e.atag.addEventListener("playing",e.atagPlayingHandler),e.atag.addEventListener("pause",e.atagPauseHandler),e.stag.addEventListener("pause",e.stagPauseHandler),p.isSelf(e.id)&&(e.videoResolutionChange=function(){var t=this;setTimeout(function(){G(e,t.videoWidth,t.videoHeight)},500)},e.vtag.addEventListener("loadedmetadata",e.videoResolutionChange),e.stag.addEventListener("loadedmetadata",e.videoResolutionChange),e.ftag.addEventListener("loadedmetadata",e.videoResolutionChange))}(e),e.isWebRTCMixPull()&&(e.flvPlayer=new T({element:e.vtag,timeout:I.FLV_TIMEPUT_TIME,onPlaying:function(){e.playAVSuccess()},onPaused:function(){e.vtag.load()},onTimeout:function(){e.playAVFail()},onError:function(){e.playAVFail()},onStalled:function(){e.playAVFail()},onFlvPlayerError:function(t){e.playAVFail()},onFlvPlayerMediaInfo:function(t){e.videoOn&&!e.audioOn?(e.setDownlinkVideoBandwidth(t.videoBandwidth),e.setDownlinkAudioBandwidth(0)):!e.videoOn&&e.audioOn?(e.setDownlinkVideoBandwidth(0),e.setDownlinkAudioBandwidth(t.audioBandwidth)):(e.setDownlinkVideoBandwidth(t.videoBandwidth),e.setDownlinkAudioBandwidth(t.audioBandwidth))},onReplay:function(){e.replay()}}));var u=m.getSpeakerList()[m.getSpeakerIndex()];u&&"function"==typeof e.atag.setSinkId&&!p.isWebRTCRecord()&&e.atag.setSinkId(u.guid).catch(function(e){return console.log(e)}),O(500).then(function(){delete e.isIniting,e.isDisposed()||e.onReady()})}},t.disposePlayer=function(e){e.isDisposing||(F("dispose player",e&&e.id,e),e.isDisposing=!0,e.isWebRTCMixPull()&&e.flvPlayer&&(e.flvPlayer.dispose(),e.flvPlayer=null),e.vtagPlayingHandler&&(e.vtag.removeEventListener("playing",e.vtagPlayingHandler),e.vtagPlayingHandler=null),e.vtagPauseHandler&&(e.vtag.removeEventListener("pause",e.vtagPauseHandler),e.vtagPauseHandler=null),e.atagPlayingHandler&&(e.atag.removeEventListener("playing",e.atagPlayingHandler),e.atagPlayingHandler=null),e.atagPauseHandler&&(e.atag.removeEventListener("pause",e.atagPauseHandler),e.atagPauseHandler=null),e.stagPauseHandler&&(e.stag.removeEventListener("pause",e.stagPauseHandler),e.stagPauseHandler=null),e.videoResolutionChange&&(e.vtag.removeEventListener("loadedmetadata",e.videoResolutionChange),e.stag.removeEventListener("loadedmetadata",e.videoResolutionChange),e.ftag.removeEventListener("loadedmetadata",e.videoResolutionChange),e.videoResolutionChange=null),$(e.swf).remove(),e.swf=null,e.atag=null,e.vtag=null,e.stag=null,e.ftag=null,e.snapshotCanvas=null,e.__volumeTimer&&(clearInterval(e.__volumeTimer),delete e.__volumeTimer),e.playTimer&&(clearTimeout(e.playTimer),delete e.playTimer),delete e.isDisposing)},t.openCamera=function(){var e=(0,d.default)(c.default.mark(function e(n){var i,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!z){e.next=3;break}return F("scanning camera"),e.abrupt("return");case 3:if(!n.isCameraOpened){e.next=9;break}return n.closeCamera(),e.next=7,O(1e3);case 7:return n.openCamera(),e.abrupt("return");case 9:if(i=U(n),n.vtag&&(n.vtag.style.transform=x(i.cameraConfig)),r=function(){var e=(0,d.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,F("open camera"),e.next=4,Me(C.getVideoStreamOptions(n));case 4:(t=e.sent)&&t.stream.active?n.cameraOn?((r=new MediaStream).addTrack(t.stream.getVideoTracks()[0]),n.__videoStream&&n.__videoStream.close(),n.__videoStream=t,n.vtag&&(n.vtag.srcObject=r),n.isCameraOpened=!0,n.__videoStream.on("replaceTrack",function(e,t){if("video"===t){var i=new MediaStream;i.addTrack(e),n.vtag&&(n.vtag.srcObject=i)}})):t.close():A.trigger(A.CAMERA_OPEN_FAIL),e.next=18;break;case 8:if(e.prev=8,e.t0=e.catch(0),F(e.t0),"NotReadableError"!==e.t0.name&&"TrackStartError"!==e.t0.name){e.next=16;break}A.trigger(A.CAMERA_OPEN_FAIL),le(n.isAssist),e.next=18;break;case 16:if("OverconstrainedError"!==e.t0.name){e.next=18;break}return e.abrupt("return",Me({type:"video",cameraId:i.cameraId}));case 18:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),!1!==t.initVirtualCamera(r)){e.next=14;break}return e.abrupt("return");case 14:ne=!0,r();case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),t.initVirtualCamera=function(e){var t=m.getCameraList()[m.getCameraIndex()];if(t&&t.virtual&&!ne)return A.trigger(A.OPEN_VIRTUAL_CAMERA),t.isComposed?A.trigger(A.SWITCH_COMPOSE_VIRTUAL_CAMERA,{index:t.index}):A.trigger(A.SWITCH_VIRTUAL_CAMERA_CHANNEL,{channel:t.channelIndex}),A.one(A.OPEN_VIRTUAL_CAMERA_COMPLETE,e),ne=!0,!1},t.closeCamera=function(e){F("close camera",e.__videoStream),e.__videoStream&&(e.__videoStream.close(),e.__videoStream=null,e.vtag.srcObject=null),e.isCameraOpened=!1},t.openMic=function(){var e=(0,d.default)(c.default.mark(function e(n){var i,r,a,o,s=arguments;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>1&&void 0!==s[1]&&s[1],F("open mic",n),e.prev=2,e.next=5,Me(C.getAudioStreamOptions());case 5:(r=e.sent)&&(n.micOn?((a=new MediaStream).addTrack(r.stream.getAudioTracks()[0]),n.__audioStream=r,n.__audioTag||(n.__audioTag=document.createElement("audio"),n.__audioTag.setAttribute("autoplay",""),n.element[0].appendChild(n.__audioTag)),t.streamManager.getGainSupported()?(o=(0,l.default)(m.getMicVolume()/g.MIC_VOLUME_MAX),n.__audioGainNode=t.streamManager.audioContext.createGain(),n.__audioGainSource=t.streamManager.audioContext.createMediaStreamSource(a),n.__audioGainDestination=t.streamManager.audioContext.createMediaStreamDestination(),n.__audioGainSource.connect(n.__audioGainNode),n.__audioGainNode.connect(n.__audioGainDestination),n.__audioGainNode.gain.value=o*o*I.MAX_GAIN,n.__audioTag.srcObject=n.__audioGainDestination.stream):(n.__audioTag.volume=m.getMicVolume()/g.MIC_VOLUME_MAX,n.__audioTag.srcObject=a),i&&n.__audioTag.pause(),n.isMicOpened=!0,n.__audioStream.on("replaceTrack",function(e,t){if("audio"===t){var r=new MediaStream;r.addTrack(e),n.__audioTag&&(n.__audioTag.srcObject=r,i&&n.__audioTag.pause())}})):r.close()),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),F(e.t0),A.trigger(A.MIC_OPEN_FAIL);case 13:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),t.closeMic=function(e){F("close mic",e.__audioStream),e.__audioStream&&(t.streamManager.getGainSupported()&&(e.__audioGainSource&&e.__audioGainSource.disconnect(),e.__audioGainNode&&e.__audioGainNode.disconnect(),e.__audioGainNode=null,e.__audioGainSource=null,e.__audioGainDestination=null),e.__audioTag.srcObject=null,e.element[0].removeChild(e.__audioTag),e.__audioTag=null,e.__audioStream.close(),e.__audioStream=null),e.isMicOpened=!1},t.getInputVolume=function(e){var t=-1;return e.__audioStream?t=e.__audioStream.getAudioLevel():e.__avStream&&(t=e.__avStream.getAudioLevel()),u.default.resolve({volume:w(t)})},t.reopenDevice=function(e){F("reopen device",e),e.republish(!0)},t.publishAV=function(){var e=(0,d.default)(c.default.mark(function e(n){var i,a,s,l,d,_,f;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(F("publish av",n),n.webrtcPublishTryCount=0,!z){e.next=5;break}return Z=!0,e.abrupt("return");case 5:if(!1!==q){e.next=8;break}return X=!0,e.abrupt("return");case 8:if(i=U(n),n.vtag.style.position="static",n.vtag&&(n.vtag.style.transform=x(i.cameraConfig)),a=i.cameraConfig.cameraBandwidth,s=m.getAudioBitrate(i.cameraQuality),l=n.isAssist?t.assistSessionManager:t.sessionManager,d={player:n,playerId:n.id,bandwidth:a,audioBandwidth:s,firPeriod:h.get("partner.webrtcKeyFrameInterval",1e3)},!n.__avStream){e.next=18;break}return _=(0,o.default)({},d,{stream:n.__avStream}),e.abrupt("return",Ge(n,l,_));case 18:return e.prev=18,e.next=21,xe(n);case 21:if(!(f=e.sent)){e.next=34;break}return f.on("videomute",function(){F("video_mute for device problem",f),te<=I.VIDEO_MUTE_TRY_COUNT&&(A.trigger(A.LOCAL_VIDEO_MUTE),f.stream.getVideoTracks().forEach(function(e){return e.stop()}),setTimeout(function(){t.reopenDevice(n),te++},1e3*te))}),f.on("audiomute",function(){F("audio_mute for device problem",f),te<=I.VIDEO_MUTE_TRY_COUNT&&(A.trigger(A.LOCAL_AUDIO_MUTE),setTimeout(function(){t.reopenDevice(n),te++},1e3*te))}),r.isBJYWebRTC()?(f.disableVideo(),f.disableAudio()):r.isAGORAWebRTC()&&(f.muteVideo(),f.muteAudio()),e.prev=26,e.next=29,Ge(n,l,(0,o.default)({},d,{stream:f}));case 29:e.next=34;break;case 31:return e.prev=31,e.t0=e.catch(26),e.abrupt("return",u.default.reject(e.t0));case 34:e.next=39;break;case 36:return e.prev=36,e.t1=e.catch(18),e.abrupt("return",u.default.reject(e.t1));case 39:case"end":return e.stop()}},e,null,[[18,36],[26,31]])}));return function(t){return e.apply(this,arguments)}}(),t.publishAVClose=He,t.publishAVRelease=function(){var e=(0,d.default)(c.default.mark(function e(t){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(F("publish av release",t),!r.isBJYWebRTC()){e.next=12;break}return e.prev=2,e.next=5,He(t);case 5:me(t),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:e.next=13;break;case 12:r.isAGORAWebRTC()&&(He(t),me(t));case 13:case"end":return e.stop()}},e,null,[[2,8]])}));return function(t){return e.apply(this,arguments)}}(),t.attachVideo=function(){var e=(0,d.default)(c.default.mark(function e(n,i,r){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i||!r){e.next=4;break}F("attach mute video"),e.next=6;break;case 4:return F("attach video"),e.abrupt("return",(n.isAssist?t.assistSessionManager:t.sessionManager).attachVideo(n));case 6:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),t.detachVideo=function(){var e=(0,d.default)(c.default.mark(function e(n,i){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(F("detach video"),!(n.isAssist?t.assistSessionManager:t.sessionManager).detachVideo(n)){e.next=5;break}return e.next=4,O(200);case 4:p.isSelf(n.id)?n.setUplinkVideoBandwidth(0):n.setDownlinkVideoBandwidth(0);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),t.muteVideo=function(e){F("mute video",e.user),(e.isAssist?t.assistSessionManager:t.sessionManager).muteVideo(e)},t.unmuteVideo=function(e){F("unmute video",e.user),(e.isAssist?t.assistSessionManager:t.sessionManager).unmuteVideo(e)},t.attachAudio=function(e,n,i){!n&&i?F("attach mute audio"):(F("attach audio"),(e.isAssist?t.assistSessionManager:t.sessionManager).attachAudio(e))},t.detachAudio=function(){var e=(0,d.default)(c.default.mark(function e(n,i){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(F("detach audio"),!(n.isAssist?t.assistSessionManager:t.sessionManager).detachAudio(n)){e.next=5;break}return e.next=4,O(200);case 4:p.isSelf(n.id)?n.setUplinkAudioBandwidth(0):n.setDownlinkAudioBandwidth(0);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),t.setResubscribeTimer=function(e){t.subscribeTimer=t.subscribeTimer||{},t.subscribeTimer[e.playerId]=setTimeout(function(){return t.subscribe(e)},4e3)},t.removeResubscribeTimer=function(e){t.subscribeTimer&&t.subscribeTimer[e]&&(clearTimeout(t.subscribeTimer[e]),t.subscribeTimer[e]=null)},t.unsubscribe=function(e){return t.removeResubscribeTimer(e.playerId),(e.player.isAssist?t.assistSessionManager:t.sessionManager).unsubscribe(e)},t.subscribe=function(){var e=(0,d.default)(c.default.mark(function e(n){var i;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.player,t.setResubscribeTimer(n),e.next=4,(i.isAssist?t.assistSessionManager:t.sessionManager).subscribe(n);case 4:H[i.id]&&H[i.id].audioOnly?Fe(i):Ye(i);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),t.playAV=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};F("play av",e.id,e.user,n);var i=e.id,r=!!e.__avStream,a=H[i],o=e.isAssist?t.assistSessionManager:t.sessionManager;e.isWebRTCMixPull()?(e.webRTCMixStreamUrl=V(e),e.flvPlayer&&e.flvPlayer.play(e.webRTCMixStreamUrl)):r?F("==== player av stream already set"):a&&o.isConnected()&&[W,K,J].includes(a.status)?(F("play av: player has published, do subscribe, status PUBLISHER_STATUS_SUBSCRIBED",e.user.id,e.user.name,"status:"+a.status),a.audioOnly=n.audioOnly,t.subscribe({player:e,playerId:i,stream:a.stream}),a.status=K):(F("play av: player not published, add publisherQueue, status PUBLISHER_STATUS_PLAYED",e.user.id,e.user.name),H[i]={playerId:i,status:j,audioOnly:n.audioOnly},clearTimeout(e.playTimer),delete e.playTimer,e.playTimer=setTimeout(function(){return!e.isDisposed()&&e.playAVFail()},g.AV_PLAY_TIMEOUT)),r&&(n&&n.audioOnly?Fe(e):Ye(e)),setTimeout(function(){e.isDisposed()||(F("trigger playAVConnectSuccess",e&&e.id,e),e.playAVConnectSuccess())},0)},t.playAVClose=function(e){F("play av close",e&&e.id,e&&e.user),Fe(e,!0,!1),e.isWebRTCMixPull()&&e.flvPlayer&&e.flvPlayer.playClose()},t.playAVRelease=function(e){return je.apply(this,arguments)},t.showVideo=Ye,t.hideVideo=Fe,t.getStreamResolution=function(e){return new u.default(function(t){setTimeout(function(){var n={width:null,height:null},i=e.isScreenSharing?e.stag:e.isMediaPlaying?e.ftag:e.vtag;i&&(i.videoWidth&&(n.width=i.videoWidth),i.videoHeight&&(n.height=i.videoHeight)),t(n)},0)})},t.extensions={asyncReady:!0,hasPublishAuth:!0,hasPlayAuth:!0},t.name="webrtc",t.publisherQueue=H,t.streamQueue=Y,BJY.Player.webrtc=t,BJY.flvjs=y}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(131));void 0===(i=function(e,t,n){return function(){return new r.default(function(e){if(BJY.auth.isWebRTCRecord())return e();"permissions"in navigator?r.default.all([navigator.permissions.query({name:"camera"}),navigator.permissions.query({name:"microphone"})]).then(function(t){t.some(function(e){return"prompt"===e.state})?navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(function(t){t.getTracks().forEach(function(e){return e.stop()}),e()}).catch(function(t){e()}):e()}):navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(function(t){t.getTracks().forEach(function(e){return e.stop()}),e()}).catch(function(t){e()})})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,r=n(0)(n(210));void 0===(i=function(e,t,n){return function(e){return 230*(0,r.default)(e).toPrecision(4)}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var n=BJY.data.media,i=BJY.config;return function(e){var t=null;$.each(n.getCameraList(),function(r,a){if(a.guid===e){a.supportSuper&&(t=i.VIDEO_QUALITY_SUPER),a.support720p&&(t=i.VIDEO_QUALITY_720P),a.support1080p&&(t=i.VIDEO_QUALITY_1080P),a.support4K&&(t=i.VIDEO_QUALITY_4K);var o=n.getCameraConfig(t,n.getCameraRatio(),!1);return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia({audio:!1,video:{width:o.cameraWidth,height:o.cameraHeight,frameRate:o.cameraFps,deviceId:{exact:e}}}),!1}})}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e){var t="";return e&&e.cameraHorizontalFlip&&(t+="rotateY(180deg)"),t}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){return function(e){var t=e.getServer(),n=e.getServer().getActiveDownlinkServer(),i=t.getDownlinkWebRTCMixedStreamName();return location.protocol+"//"+n.ip+"/mgclient/"+i+".flv"}}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,n){var i,r,a=BJY.config,o=BJY.data.media,s=BJY.eventEmitter;return function(e,t,n){var u=o.getCameraQuality();i===t&&r===n||(i=t,r=n,s.trigger(s.VIDEO_RESOLUTION_CHANGE_TRIGGER,{width:i,height:r,definitions:[a.CAMERA_QUALITY_MAP[u]]}))}}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=n(325),a=n(541),o=n(3),s=n(1011),u=BJY.os,c=BJY.store,l=BJY.config,d=BJY.auth,_=BJY.data.media,f=BJY.eventEmitter,p=3e4,h={},g={},E="bjy-video",v="width: 100%;height: 100%;";function m(e){var n,i,r=e.id,a=e.user,s=e.getServer(),_=e.getDownlinkServer();return a.endType!==l.END_TYPE_PC_BROWSER&&o(c.get("class.liveAudioCodec"),l.AUDIO_CODEC_AAC)!==l.AUDIO_CODEC_SPEEX||(n=_.speexToAacSuffix||""),d.isWebRTC()?(i=s.getDownlinkWebRTCMixedStreamName(),n=""):(i=a.audioMixed&&(u.android||u.ios)?e.audioStreamOnly?s.getDownlinkAudioOnlyMixedStreamName(r,a.publishIndex):s.getDownlinkAudioMixedStreamName(r,a.publishIndex):e.audioStreamOnly?s.getDownlinkAudioOnlyStreamName(r,a.publishIndex):s.getDownlinkStreamName(r,a.publishIndex),t.isSupportFlv()&&(n=_.speexToAacSuffix||"")),t.isSupportFlv()?location.protocol+"//"+_.ip+"/mgclient/"+i+(n||"")+".flv":"http://"+_.ip+"/mgclient/"+i+(n||"")+"/"+(_.hlsSuffix||"playlist.m3u8")}function S(e){var n=e.video;if(!n){var i=$(function(e){e=e||"";var n=["playsinline","webkit-playsinline","x5-playsinline",'preload="none"'];return t.showControls&&n.push("controls"),t.autoPlay&&n.push("autoplay"),'<video poster="'+e+'" class="'+E+'" '+n.join(" ")+' x-webkit-airplay="allow" style="'+v+'"></video>'}(e.poster));e.element.append(i),i.addClass("bjy-video"),i[0].src=m(e);var r=t.isSupportFlv()?a:s;n=e.video=new r({element:i[0],timeout:p,onLoading:function(){f.trigger(f.HTML_VIDEO_LOAD_START)},onPlaying:function(){f.trigger(f.HTML_VIDEO_PLAY,{player:e}),e.playAVSuccess()},onPaused:function(){f.trigger(f.HTML_VIDEO_PAUSE,{player:e}),i[0].load()},onTimeout:function(){f.trigger(f.HTML_VIDEO_LOAD_TIMEOUT),e.playAVFail()},onError:function(){f.trigger(f.HTML_VIDEO_LOAD_FAIL),e.playAVFail()},onStalled:function(){f.trigger(f.HTML_VIDEO_LOAD_FAIL)},onSourceChange:function(){},onFlvPlayerError:function(e){f.trigger(f.HTML_FLV_VIDEO_ERROR)},onFullscreenEnter:function(){f.trigger(f.HTML_VIDEO_FULLSCREEN_ENTER)},onFullscreenExit:function(){f.trigger(f.HTML_VIDEO_FULLSCREEN_EXIT)},onFlvPlayerMediaInfo:function(t){e.videoOn&&!e.audioOn?(e.setDownlinkVideoBandwidth(t.videoBandwidth),e.setDownlinkAudioBandwidth(0)):!e.videoOn&&e.audioOn?(e.setDownlinkVideoBandwidth(0),e.setDownlinkAudioBandwidth(t.audioBandwidth)):(e.setDownlinkVideoBandwidth(t.videoBandwidth),e.setDownlinkAudioBandwidth(t.audioBandwidth))},onReplay:function(){e.replay()}})}}function A(e){if(!BJY.os.ios||e.downlinkUrl!=m(e)||BJY.Player.html.disposeVideoWhileClose||t.isSupportFlv()){var n=e.video;n&&(n.dispose(),e.video=null)}else T(e)}function y(e){var t=e.video;t&&(t.element.style.cssText=v)}function T(e){var t=e.video,n=v+"position: fixed;left: -1000px;top: -1000px;";t&&(t.element.style.cssText=n)}t.name="html",t.showControls=!1,t.autoPlay=!0,t.init=function(){t.init=$.noop;var e=document.hidden;u.windows||u.mac||u.linux||setInterval(function(){e&&!document.hidden&&(t.isSupportFlv()?$.each(BJY.Player.instances,function(e,n){n.video&&function(e){A(e),t.playAV(e,{audioOnly:!e.videoOn})}(n)}):$("."+E).each(function(){this.load(),this.play()})),e=document.hidden},1e3),f.on(f.PLAYER_CREATE_END,function(e,t){var n=t.player;if("html"===n.extension.name){var i=n.user.videoOn&&!n.disableVideo,r=n.user.audioOn;(i||r)&&S(n)}}).on(f.AV_PLAY_CLOSE_START,function(e,t){var n=t.player;"html"===n.extension.name&&(h[n.id]=!0)}).on(f.AV_PLAY_CLOSE_END,function(e,t){var n=t.player;h[n.id]&&delete h[n.id]}).on(f.AV_PLAY_START,function(e,t){var n=t.player;"html"===n.extension.name&&(g[n.id]=!0)}).on(f.AV_PLAY_END,function(e,t){var n=t.player;g[n.id]&&delete g[n.id]}).on(f.USER_REMOVE,function(e,t){var n=BJY.Player.instances[t.user.id];n&&"html"===n.extension.name&&n.video&&(n.video.dispose(),n.video=null)}).on(f.SPEAKER_VOLUME_CHANGE,function(){Yox.object.each(BJY.Player.instances,function(e){!function(e){var t=e.video;t&&"html"===e.extension.name&&t.setVolume&&t.setVolume(_.getSpeakerVolume())}(e)})})},t.disposePlayer=function(e){var t=e.video;t&&(t.dispose(),e.video=null)},t.playAV=function(e,t){S(e);var n=m(e);e.downlinkUrl=n,e.video&&e.video.play(n),t&&t.audioOnly||e.audioStreamOnly?T(e):y(e)},t.playAVClose=A,t.playAVRelease=A,t.showVideo=function(e){h[e.id]||g[e.id]||y(e)},t.hideVideo=function(e){h[e.id]||g[e.id]||T(e)},t.getStreamResolution=function(e){var t=$.Deferred();return setTimeout(function(){var n={width:null,height:null};if(e.video&&e.video.element){var i=e.video.element;i.videoWidth&&(n.width=i.videoWidth),i.videoHeight&&(n.height=i.videoHeight)}t.resolve(n)},0),t},t.extensions={asyncReady:!1,hasPublishAuth:!1,hasPlayAuth:!u.ios&&!u.android},t.isSupportFlv=function(){return d.isWebRTC()&&d.canSupportFlv()},BJY.Player.html=t,BJY.flvjs=r}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(e,t,n){"use strict";var i=0,r={};function a(e){$.extend(this,e),this.status=i,this.init()}return a.prototype={constructor:a,init:function(){var e,t,n=this,i=n.element,a=n.namespace=".cc_util_media"+Math.random(),o=function(a,o){!n.disposed&&i.src&&i.src!==location.href&&a!==n.status&&(t=$.now(),e&&t-e<500||(e=t,n.playTimer&&(clearTimeout(n.playTimer),n.playTimer=null),2===a&&(r[i.src]=!0),function(e,t){n.status=e,$.isFunction(n[t])&&n[t]()}(a,o)))};n.timeoutHandler=function(){n.disposed||!i.paused||r[i.src]||o(6,"onTimeout")};var s=function(){o(2,"onPlaying")};(n.wrapper=$(i)).on("play"+a,function(){2!==n.status&&o(1,"onLoading")}).on("canplay"+a,function(){r[i.src]=!0}).on("playing"+a,s).on("timeupdate"+a,s).on("pause"+a,function(){2===n.status&&o(3,"onPaused")}).on("error"+a,function(){2!==n.status&&o(4,"onError")}).on("stalled"+a,function(){2!==n.status&&o(5,"onStalled")})},play:function(e){var t=this,n=t.element;if(e){var r=n.src;r?e!==r&&(t.setSource(e),$.isFunction(t.onSourceChange)&&t.onSourceChange()):t.setSource(e)}t.timeout&&(t.playTimer&&clearTimeout(t.playTimer),t.playTimer=setTimeout(t.timeoutHandler,t.timeout)),t.status=i,n.load(),n.play()},setSource:function(e){try{this.element.src=e}catch(e){}},show:function(){this.wrapper.show()},hide:function(){this.wrapper.hide()},getWidth:function(){return this.element.clientWidth||0},setWidth:function(e){this.element.width=e},getHeight:function(){return this.element.clientHeight||0},setHeight:function(e){this.element.height=e},remove:function(){var e=this.element;e.pause();var t=e.parentNode;t&&t.removeChild(e)},dispose:function(){this.wrapper.off(this.namespace),this.remove(),this.disposed=!0}},a.STATUS_WAITING=i,a.STATUS_LOADING=1,a.STATUS_PLAYING=2,a.STATUS_PAUSED=3,a.STATUS_ERROR=4,a.STATUS_STALLED=5,a.STATUS_TIMEOUT=6,a}.call(t,n,t,e))||(e.exports=i)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){var r=BJY.auth,a=BJY.logger,o=BJY.config,s=BJY.Player,u=BJY.eventEmitter,c=BJY.getExtension,l=BJY.data.user,d=BJY.data.media,_=BJY.userStatus;return BJY.BlueThemePlayer={template:n(1121),propTypes:{user:{type:"object",required:!0},isHidden:{type:"boolean",value:!1},isAssist:{type:"boolean",value:!1},extension:{type:"object",value:c},onComplete:{type:"function"},isWebRTCMix:{type:"boolean",value:function(){return!1}}},data:function(){var e=this;return{isPlaying:null,isFullScreen:!1,userIn:!1,videoOn:!1,audioOn:!1,volumeSliderVisible:!1,volumeSliderOptions:{min:0,max:o.SPEAKER_VOLUME_MAX,value:d.getSpeakerVolume(),onChange:function(t){e.set("volumeSliderOptions.value",t),u.trigger(u.SPEAKER_VOLUME_CHANGE_TRIGGER,{value:t})}}}},components:{VolumeSlider:n(309)},methods:{showVolumeSlider:function(){this.set("volumeSliderVisible",!0)},hideVolumeSlider:function(){this.set("volumeSliderVisible",!1)},enterFullScreen:function(){u.trigger(u.FULLSCREEN_ENTER_TRIGGER),this.set("isFullScreen",!0)},exitFullScreen:function(){u.trigger(u.FULLSCREEN_EXIT_TRIGGER),this.set("isFullScreen",!1)},play:function(){this.createPlayer(),this.set("isPlaying",!0)},pause:function(){this.player.dispose(),this.player=null,this.set("isPlaying",!1)},createPlayer:function(){var e=this,t=e.get("user");t.id&&(t=l.findByNumber(t.number))&&(e.player=new s({element:$(e.$el).find(".bjy-video-player"),user:t,extension:e.get("extension"),isHidden:e.get("isHidden"),isAssist:e.get("isAssist"),isWebRTCMix:e.get("isWebRTCMix"),onComplete:function(){var t=e.get("onComplete");t&&t()}}))}},afterMount:function(){var e=this,t=e.namespace=".default_blue_player"+Math.random(),n=function(n){_.watch(n,t,{onCameraOpened:function(){e.set({videoOn:!0})},onMicOpened:function(){e.set({audioOn:!0})},onCameraMicOpened:function(){e.set({videoOn:!0,audioOn:!0})},onCameraClosed:function(){e.set({videoOn:!1})},onMicClosed:function(){e.set({audioOn:!1})},onCameraMicClosed:function(){e.set({videoOn:!1,audioOn:!1})},onCameraOpenedMicClosed:function(){e.set({videoOn:!0,audioOn:!1})},onCameraClosedMicOpened:function(){e.set({videoOn:!1,audioOn:!0})},onMediaOpened:function(){var t=e.player;t&&!t.isDisposed()||e.createPlayer()},onEntered:function(){var t=l.findByNumber(e.get("user.number"));t?e.set("user",t):a.warn("Blue Theme Player","user not found on entered.");var n=e.player;n&&(n.isDisposed()||n.dispose(),e.player=null),e.set({userIn:!0,videoOn:!1,audioOn:!1})},onLeaved:function(){e.set({isPlaying:!1,userIn:!1,videoOn:!1,audioOn:!1})}},e.get("isAssist"))},i=e.get("user.number");i?n(i):r.isTeacher(e.get("user.type"))&&u.one(u.TEACHER_ADD+t,function(t,i){var r=i.userList[0];e.set("user",r),n(r.number)}),u.on(u.AV_PLAY_START+t,function(t,n){n.player===e.player&&e.set("isPlaying",!0)}).on(u.AV_PLAY_CLOSE_START+t,function(t,n){n.player===e.player&&e.set("isPlaying",!1)})},beforeDestroy:function(){var e=this.player;e&&!e.isDisposed()&&e.dispose(),this.namespace&&(_.unwatch(this.namespace),u.off(this.namespace))},create:function(e){return new Yox($.extend({el:e.element[0],replace:!1!==e.replace,props:{user:e.user,isHidden:e.isHidden,isAssist:e.isAssist,extension:e.extension,onComplete:e.onComplete,isWebRTCMix:e.isWebRTCMix}},BJY.BlueThemePlayer))}}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bjy-player-theme-blue" data-user-id="{{user.id}}" data-user-number="{{user.number}}" data-user-type="{{user.type}}" data-fullscreen="{{#if isFullScreen}}1{{else}}0{{/if}}" data-playing="{{#if isPlaying}}1{{else}}0{{/if}}"><div class="bjy-video-player"></div><div class="bjy-footer"><div class="bjy-float"><div class="bjy-button bjy-volume{{#if volumeSliderOptions.value === 0}} bjy-volume-muted{{else if volumeSliderOptions.value < volumeSliderOptions.max / 2}} bjy-volume-low{{else}} bjy-volume-normal{{/if}}{{#if volumeSliderVisible}} bjy-volume-slider-visible{{/if}}" on-click="showVolumeSlider()" on-outside="hideVolumeSlider()"><VolumeSlider {{...volumeSliderOptions}} /></div>{{#if isFullScreen}}<div class="bjy-button bjy-exit-fullscreen" on-click="exitFullScreen()"></div>{{else}}<div class="bjy-button bjy-enter-fullscreen" on-click="enterFullScreen()"></div>{{/if}}</div>{{#if isPlaying}}<div class="bjy-button bjy-pause" on-click="pause()"></div>{{/if}}</div>{{#if isPlaying === false && (videoOn || audioOn)}}<div class="bjy-play" on-click="play()"></div>{{/if}}</div>'},function(e,t,n){"use strict";var i;void 0===(i=function(e,t,i){BJY.is;var r=BJY.auth,a=BJY.store,o=BJY.Player,s=o.html,u=BJY.data.user,c=(BJY.eventEmitter,BJY.webrtcMixMediaPublish),l=n(377)();return BJY.H5Player={template:n(1123),language:l,data:function(){return{language:l,isPresenterIn:!1,showPlayerBtn:!1,showStatus:!0,videoOn:!1,audioOn:!1,defaultCoverImg:a.get("partner").logoPrefix+"/m-no-ppt.png",coverImg:a.get("partner").liveCourseCover}},methods:{createPlayer:function(){if(!this.player){var e,t;if(r.isWebRTC())e=a.get("webrtcMixUser");else if(t=a.get("class.mixStreamUserId")||a.get("presenterId")||a.get("teacher.id"),!(e=u.find(t))||!e.publishServer)return!1;var n=this.container;return s.showControls=this.get("showControls")||!1,this.player=new o({element:n.find(".bjy-video-player .bjy-player-container"),user:e,extension:s,isWebRTCMix:r.isWebRTC()}),!0}},play:function(){var e=this;if((e.container.removeClass("bjy-video-player-off"),!e.player)&&!e.createPlayer())return;e.set({showPlayerBtn:!1}),r.isWebRTC()&&c();var t=e.get("videoOn");e.player.playAV(t)}},components:{Watermark:n(378)},afterMount:function(){var e=this,t=e.container=$(e.$el),n=t.width(),i=Math.floor(9*n/16);t.height(i);e.container.find(".bjy-video-player .bjy-player-container");var o=e.get("language");a.watch("presenterId",function(t){e.set({playerStatusText:t?o.PRESENTER_IN:o.PRESENTER_OUT}),!t&&e.player&&(e.player.dispose(),e.player=null)},!0);e.namespace=".h5_theme_player"+Math.random();var s=r.isWebRTC()?"webrtcMixUser":"presenter";a.watch("class.started",function(t){e.set({playerStatusText:t?o.CLASS_STARTED:o.CLASS_NOT_STARTED})},!0);var u=function(){var t=a.get(s+".videoOn"),n=a.get(s+".audioOn");if(e.set({videoOn:t,audioOn:n}),!t&&!n||e.player||(e.set({showPlayerBtn:!0}),n&&e.set({playerStatusText:o.USER_AUDIO_ONLY_AUDIO_ON})),e.player)if(t)e.player.showVideo();else{e.player.hideVideo();var i=o.USER_AUDIO_ONLY_AUDIO_ON;n||(i=o.PRESENTER_VIDEO_OFF_AUDIO_OFF),e.set({showStatus:!0,playerStatusText:i})}};a.watch(s+".videoOn",function(n,i){n&&void 0!==i?(t.addClass("bjy-video-player-off"),e.set({showStatus:!0}),setTimeout(function(){t.removeClass("bjy-video-player-off"),u()},8e3)):u()},!0),a.watch(s+".audioOn",function(){u()},!0),r.isCameraCoverEnabled()&&a.watch("presenter.cameraCover",function(t){e.set({coverImg:t||a.get("class.cover")||a.get("partner").liveCourseCover})},!0)},create:function(e){var t=Yox.object.copy(BJY.H5Player);return t.el=e.element[0],t.replace=!1!==e.replace,t.props=e,new Yox(t)}}}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bjy-player-h5-theme"><div class="bjy-video-player">\x3c!-- 重要：这个dom用来做player的根元素，不能在里面再加dom结构，因为其他地方可能会操作里面的dom--\x3e<div class="bjy-player-container"></div>\x3c!-- 点击播放按钮 --\x3e{{#if showPlayerBtn}}<div class="bjy-player-play" on-click="play()"><div class="bjy-player-play-btn"></div><div class="bjy-player-play-text">{{language.START_PLAY_TIPS}}</div></div>{{/if}}\x3c!-- 课程状态背景图 --\x3e{{#if showStatus || showPlayerBtn}}<div class="bjy-player-mask"></div>{{#if !showPlayerBtn}}<div class="bjy-player-status-text">{{playerStatusText}}</div>{{/if}}<div class="bjy-player-status-img"><img src="{{coverImg || defaultCoverImg}}" alt="cover"></div>{{/if}}</div></div>'},function(e,t,n){"use strict";var i;void 0===(i=function(e,t){var i=BJY.auth,r=BJY.store,a=BJY.config,o=BJY.Player,s=BJY.eventEmitter,u=/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent),c=o.html,l={SERVER_LINE_PREFIX:"线路-",SWITCH_LINE:"切换线路",ERROR_LOGIN_FAIL:"登录教室失败",ERROR_LOGIN_OVERFLOW:"教室人数已达上限，无法进入",ERROR_LOGIN_KICKED_OUT:"你已被踢出教室，无法再次进入",ERROR_LOGIN_CONFLICT:"登录冲突，无法进入教室"};t.init=function(e){var t={template:n(1125),replace:!0,propTypes:{theme:{type:"string",value:"default"},pluginUrl:{type:"string",value:(BJY.cdnOrigin||"//live-cdn.baijiayun.com/js-sdk/0.36.0")+"/player/extension/flash.swf"},canSwitchServer:{type:"boolean",value:!0}},data:function(){return{language:l,isMobile:u,showPlayButton:!1,switchLayerVisible:!1,serverList:[],currentServer:{},errorInfo:""}},filters:{isCurrentServer:function(e){var t=this.get("currentServer");return e.ip===t.ip&&e.port===t.port}},methods:{playButtonClick:function(){var e=this.player;(e.videoOn||e.audioOn)&&e.playAVClose(),e.playAV(r.get("presenter.videoOn"))},serverListClick:function(e){s.trigger(s.DOWNLINK_SERVER_NODE_CHANGE_TRIGGER,{index:e}),this.set("switchLayerVisible",!1)}},afterMount:function(){var t,n=this,d=$(n.$refs.themePlayer);if(n.namespace=".universal_play"+Math.random(),u)t=function(){n.player&&n.player.dispose(),n.player=new o({element:d,user:r.get("presenter")||r.get("teacher"),extension:c,poster:e.poster})},s.on(s.TEACHER_MEDIA_ON+n.namespace,function(){n.player||t(),n.set("showPlayButton",!0)}).on(s.TEACHER_REMOVE+n.namespace,function(){n.player&&(n.player.destroy(),n.player=null)}).one(s.VIEW_RENDER_TRIGGER+n.namespace,function(){s.trigger(s.USER_ACTIVE_REQ)}).on(s.HTML_VIDEO_PLAY+n.namespace,function(){n.set("showPlayButton",!1)}).on(s.HTML_VIDEO_PAUSE+n.namespace,function(){n.set("showPlayButton",!0)}).on(s.HTML_VIDEO_LOAD_TIMEOUT+n.namespace,function(){n.set("showPlayButton",!0)}).on(s.HTML_VIDEO_LOAD_FAIL+n.namespace,function(){n.set("showPlayButton",!0)}).on(s.HTML_AUDIO_PLAY+n.namespace,function(){n.set("showPlayButton",!1)}).on(s.HTML_AUDIO_PAUSE+n.namespace,function(){n.set("showPlayButton",!0)}).on(s.HTML_VIDEO_LOAD_FAIL+n.namespace,function(){n.set("showPlayButton",!0)}).on(s.HTML_AUDIO_LOAD_TIMEOUT+n.namespace,function(){n.set("showPlayButton",!0)}).on(s.HTML_AUDIO_LOAD_FAIL+n.namespace,function(){n.set("showPlayButton",!0)});else{c.pluginUrl=n.get("pluginUrl");var _="blue"===n.get("theme")?BJY.BlueThemePlayer:BJY.DefaultThemePlayer;t=function(){n.player&&n.player.destroy(),n.player=_.create({element:d,user:r.get("presenter")||r.get("teacher")||{type:a.ROLE_TYPE_TEACHER},extension:c,canPopup:!1,replace:!1,isWebRTCMix:i.isWebRTC()})},s.one(s.CLASSROOM_CONNECT_TRIGGER+n.namespace,function(e,t){return c.init().then(function(){s.trigger(s.CLASSROOM_CONNECT_TRIGGER,t)}),!1}).on(s.VIEW_RENDER_TRIGGER+n.namespace,t).trigger(s.SPEAKER_VOLUME_CHANGE_TRIGGER,{value:a.SPEAKER_VOLUME_MAX})}s.on(s.PRESENTER_CHANGE+n.namespace,t).on(s.ROOM_SERVER_LOGIN_FAIL+n.namespace,function(){n.set("errorInfo",l.ERROR_LOGIN_FAIL)}).on(s.ROOM_SERVER_LOGIN_OVERFLOW+n.namespace,function(){n.set("errorInfo",l.ERROR_LOGIN_OVERFLOW)}).on(s.ROOM_SERVER_LOGIN_KICKED_OUT+n.namespace,function(){n.set("errorInfo",l.ERROR_LOGIN_KICKED_OUT)}).on(s.ROOM_SERVER_LOGIN_CONFLICT+n.namespace,function(){n.set("errorInfo",l.ERROR_LOGIN_CONFLICT)}),n.get("canSwitchServer")&&s.on(s.DOWNLINK_LINK_TYPE_CHANGE+n.namespace,function(e,t){n.set({serverList:t.serverList,currentServer:t.server})}).on(s.DOWNLINK_SERVER_NODE_CHANGE+n.namespace,function(e,t){r.get("isClassSwitching")||(n.set("currentServer",t.server),console.log("Switch Server Success..."))}).on(s.TEACHER_MEDIA_ON+n.namespace,function(){n.set("canSwitchServer",!0)}).on(s.TEACHER_MEDIA_OFF+n.namespace,function(){n.set("canSwitchServer",!1)})},beforeDestroy:function(){s.off(this.namespace),this.player&&(this.player.destroy(),this.player=null)}};t.el=e.element[0],t.replace=!1!==e.replace,t.props={theme:e.theme,pluginUrl:e.pluginUrl,canSwitchServer:e.canSwitchServer},e.user=e.user||{number:"0",type:0,name:"游客",avatar:""};var d=e.class&&"number"==typeof e.class.webrtcType&&e.class.webrtcType>0;u||(o.ignoreHLS=!0,d&&!i.canSupportWebRTC()&&i.canSupportFlv()?(c=o.html,u=!0):c=d&&!i.canSupportWebRTC()&&!i.canSupportFlv()||BJY.browser.wechat?o.flash:d&&i.canSupportWebRTC()?BJY.Player.webrtc:window.bjyAppVersion?BJY.cef:BJY.Player.flash),o.html.showControls=!!e.showControls;var _=new Yox(t);return BJY.init(e),_},window.BJYPlayer=t}.call(t,n,t,e))||(e.exports=i)},function(e,t){e.exports='<div class="bjy-universal-player"><div class="bjy-placeholder" ref="themePlayer"></div>{{#if isMobile && showPlayButton}}<div class="bjy-operate-layer"  on-click="playButtonClick()"><div class="bjy-play-button"></div></div>{{/if}}{{#if canSwitchServer && serverList.length > 1}}<div class="bjy-switch-server" on-outside="set(\'switchLayerVisible\', false)"><div class="bjy-layer{{#if switchLayerVisible}} bjy-active{{/if}}">{{#each serverList:index}}{{#if isCurrentServer(this)}}<li class="bjy-current" on-click="set(\'switchLayerVisible\', false)">{{language.SERVER_LINE_PREFIX}}{{index + 1}}</li>{{else}}<li on-click="serverListClick(index)">{{language.SERVER_LINE_PREFIX}}{{index + 1}}</li>{{/if}}{{/each}}</div><div class="bjy-button" on-click="toggle(\'switchLayerVisible\')" lazy="2000">{{language.SWITCH_LINE}}</div></div>{{/if}}{{#if errorInfo}}<div class="bjy-error">{{errorInfo}}</div>{{/if}}</div>'},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){n(390),n(459),n(655),n(465),n(489),n(721),n(929),n(1010),n(598),n(1120),n(1122),e.exports=n(1124)}]);
//# sourceMappingURL=http://127.0.0.1:8858/output/0.71.0/moduleMin.js.map